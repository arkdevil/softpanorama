                                            (C) MasterSoft , А. Сесса
    ОПИСАНИЕ ВИРУСА VHP648 ("TIMESTAMP")

    Этот примитивный и вредный вирус распространяется по .COM-файлам,
добавляя к ним 648 байт ( отсюда и название ). Зараженный файл особым
образом отмечен в каталоге - указатель секунд времени создания  файла
становится равным 62 ! Вместо 3 первых байтов файла вирус подставляет
инструкцию перехода на свое  начало , а  сам  приклеивается  в  конец
зараженного  файла .  Таким  образом ,  при  запуске  больного  файла
управление сразу передается вирусу, который тут же вершит свое черное
дело - заражает еще один файл. Стратегия размножения VHP648 состоит в
следующем : сначала здоровый файл ищется в текущем  каталоге , а  при
неудаче - в других каталогах, описанных в переменной PATH . Найденная
жертва с вероятностью 7/8  инфицируется , а  с  1/8  ( когда  секунды
системного времени кратны 8) - убивается. В последнем случае вместо 5
первых байтов файла записывается инструкция перехода на  произвольный
адрес . По окончании "работы" , вирус  восстанавливает  первые  байты
загруженной программы и передает ей управление.
    VHP648 имеет несколько особенностей: первая - он не  обрабатывает
системные  сообщения  об  ошибках , что приводит к  выводу  сообщения
"...Abort, Retry, Ignore"  при  обращении  к  защищенному  от  записи
диску; вторая особенность - при поиске переменной PATH вирус  "клюет"
на первую же переменную, у которой имя оканчивается на  PATH  ( таким
образом , строка  SET VPATH = X:\ILLEGAL  в начале AUTOEXEC.BAT файла
будет препятствовать размножению данного вируса ); третья особенность
- программа вируса содержит некоторые "излишества" в размере 20 байт,
которые   исчезают  в  процессе   дизассемблирования  и   последующей
трансляции VHP648. Большинство  детекторов  не  выявляет  присутствие
"мутанта" . Последняя  тревожная  особенность  относится  не к самому
вирусу , а к антивирусным программам : одни из них вакцинируют файлы,
устанавливая указатель секунд  равным  62 , а другие только по  этому
признаку ищут зараженные файлы ( и даже  пытаются  при этом  вылечить
совершенно здоровую программу !). Не применяйте ANTI.COM (ANTI87.COM,
ANTI88.COM), AVIR.EXE и EF.EXE ! Они портят здоровые файлы.
    Нет никаких замечаний к программам-лекарям  AIDSTEST.EXE, AV.EXE,
CURE.EXE, DOCTOR.EXE, HEALER.EXE, KILLER.EXE, SERUM2.EXE, SERUM3.COM,
PILL2.EXE, VIRDOCT.EXE.
---------------------------------------------------------------------
---------------------------------------------------------------------

  Шеховцов Александр:

  Убийство файла, то есть запись в него перехода на произвольный
адрес приводит к тому, что при запуске файла система начинает перезаг-
рузку. Отсюда еще одно название вируса: REBOOTER (перезагрузчик).
  Если убит COMMAND.COM, то перезагрузка зацикливается. В этом
случае человек часто теряется и не знает, то ли диск "полетел", то ли
вся машина "рухнула". Прежде чем думать о самом худшем, попробуйте
загрузиться с другой дискеты и запустите вирусный локатор.