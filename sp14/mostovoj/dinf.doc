  ╔════════════════════════════════════════════════════════════════╗
  ║                                                                ║
  ║                      Disk Informator                           ║
  ║                                                                ║
  ║                     (c) Мостовой Д.Ю.                          ║
  ║                                                                ║
  ║      Институт прикладной математики им. М.В.Келдыша АН СССР    ║
  ║                                                                ║
  ║                        16.11.1989     Версия 6.04              ║
  ║                                                                ║
  ╚════════════════════════════════════════════════════════════════╝


   При случайном занесении программного "вируса" на машину труднее всего
вовремя  обнаружить,  что  машина  заражена,  чтобы  предпринять меры по
лечению  и  предотвращению  "эпидемии".  Если  своевременно   обнаружить
появление "вируса", то можно избежать потери большей части информации на
винчестере. Программа "Disk Informator" предназначена для предотвращения
"вирусной эпидемии" на Вашем диске. Она следит за появлением "вирусов" в
файлах, BOOT-секторе, плохих кластерах и PARTITION TABLE.

                          В Н И М А Н И Е !
   Программа DINF снабжена системой защиты от несанкционированного копи-
рования. При первом запуске программа запоминает параметры машины и  при
попытке переписи ее на другую  машину перестает работать. Эта защита  не
ущимляет  права  владельца  программы  устанавливать  ее на произвольные
машины, но гарантирует, что никто  в его отсутствие не сможет  списать у
него программу.

  Чтобы  не  потерять  программу,  храните  ее  дистрибутивную копию! Не
запускайте программу с дистрибутивной дискеты!

                         Основные принципы
   Программные  "вирусы",  заражая  машину,  могут  поселиться  в  Вашем
компьютере  в  файлах,  BOOT-секторе  или  в PARTITION TABLE.  Некоторые
вирусы помечают хороший кластер как плохой и селятся там.  Записываясь в
файлы, вирусы меняют  их длину, не  меняя даты и  времени создания файла
(за исключением двух вирусов длиной 648 и 534 байт, о чем будет  сказано
ниже).   Записываясь в  BOOT-сектор или  PARTITION TABLE  они меняют  их
контрольную сумму.   На отслеживании  перечисленных изменений  построена
работа  программы  DINF,  контролирующей  появление  "вирусов"  на Вашем
диске.

                          Работа программы
   Первой  операцией,  необходимой  для  использования программы DINF на
Вашей машине, является создание таблицы файлов. Эта операция  проводится
один  раз.   Для  создания  таблицы  необходимо  запустить  программу  с
указанием ключа  "/w".   По умолчанию  строится таблица  файлов, имеющих
расширения  COM,  EXE,  SYS,  BAT,  OS2.   Таблица  содержит   следующую
информацию  о  диске:   длины  файлов,  даты  создания  файлов,  времена
создания файлов,  контрольные суммы  PARTITION TABLE  и BOOT-сектора,  а
также список плохих кластеров.

Пример создания таблиц файлов на дисках C: и D:

  C:\ANTIVIR>DINF C: D: /w

Если Вы хотите следить за  файлами с другими расширениями, при  создании
таблицы файлов можно явно перечислить расширения, например:

  C:\ANTIVIR>DINF C: D: /w COM EXE SYS BAT OVL BIN OBJ LIB

В дальнейшем все контрольные операции будут автоматически осуществляться
для файлов с указанными расширениями.

   Контрольные  операции  осуществляются   следующим  образом.   Сначала
программа  просматривает  свою  таблицу  и  сверяет  хранящуюся  в   ней
информацию с информацией,  полученной из каталога  диска. В этом  режиме
программа  фиксирует  удаленные  с  диска  файлы  и просит разрешение на
исключение  информации  об  этих   файлах  из  своей таблицы.  Программа
известит Вас   об изменении  длины любого  файла, занесенного  в таблицу
файлов.   Если   изменилась   длина   файла,   с которыми  Вы работаете,
разрешите программе подкорректировать свою  таблицу, ответив  "Y" на  ее
вопрос.  Если же изменилась длина системного файла, например длина файла
COMMAND.COM, то ВНИМАНИЕ ! это скорее всего работа "вируса".

   Большинство  известных  вирусов,   меняя  длину  зараженного   файла,
сохраняет нетронутыми  дату  и  время  его  создания. По этим  признакам
(изменение длины   без  изменения   даты  и   времени  создания   файла)
программа DINF сообщит   Вам,  что   файл  инфецирован.   В этом  случае
выдается сообщение "I_N_F_E_C_T_E_D". Если Вы получили  такое сообщение,
то  с   вероятностью  99,999%  Ваша  машина  подверглась  атаке   вируса
(оставшиеся 0,001%  оставим на шутки Ваших  товарищей, имеющих доступ  к
Вашему  компьютеру).   В  этом  случае  запасайтесь всеми известными Вам
программами вирус-детекторами  и ищите вирус.

   После  первой  проверки  программа  DINF  делает  обратную  проверку,
сканируя  диск  и  сверяя  файлы  на  диске  с  таблицей.  В этом режиме
выявляются новые  файлы, появившиеся  на диске  после создания  таблицы.
Если  такие  файлы  обнаружены,  программа  просит  разрешения  добавить
информацию о них в таблицу.

   Для экономии  времени Вы  можете использовать  эти режимы  раздельно.
Ключ "/c" задает  первый режим работы,  а ключ "/n"  - второй. Например,
если  вы  удалили  какие-либо  файлы,  либо внесли изменения в некоторые
файлы, то быстро подкорректировать таблицу можно следующим образом:

   C:\ANTIVIR>DINF D: /c

   Если Вы записали новые файлы и хотите сразу внести информацию о них в
таблицу, наберите:

   C:\ANTIVIR>DINF D: /n


                        Использование программы
   Программу  DINF,  на  мой  взгляд,  удобнее  всего  включить  в  файл
AUTOEXEC.BAT. Для этого туда необходимо добавить строку:

   C:\ANTIVIR\DINF C: D: /d

Ключ  "/d"  включает  режим,  при  котором проверки будут осуществляться
только один раз в сутки при первом включении машины. Это сэкономит  Ваше
время при последующих перезагрузках.


                        Дополнительные возможности
   Существуют  еще  два  ключа,  реализующие  дополнительные возможности
программы.  Ключ  "/i"  включает  "информационный"  режим,  при   котром
программа не корректирует  таблицу файлов (и  не задает вопросов).  Ключ
"/u" включает режим, при котором все изменения автоматически заносятся в
таблицу.
   Если вы наберете

   C:\ANTIVIR>DINF  ,

не указав параметры, то программа DINF выдаст на экран краткую справку о
своих параметрах и режимах работы.

   Существует  возможность  обозначить  часть  директорий  на  диске как
"рабочие".  Такими  директориями  Вы  можете  сделать  те подкаталоги, в
которых  Вы  занимаетесь  программированием  и  часто сами меняете длины
файлов. Для назначения рабочих директорий необходимо набрать команду:

  C:\ANTIVIR>DINF D: /e

На  экран  будет  выдано  окно  со  списком  всех подкаталогов диска, из
которого клавишами пермещения курсора  и клавишей "ENTER" можно  выбрать
рабочие. Выбранные директории  будут помечены ярко-белыми  значками. При
обработке  этих  директорий  программа   не  спрашивает  разрешения   на
исправление таблицы и автоматически корректирует все изменения (при этом
сохраняется контроль на наличие вируса по принципу "изменилась длина, не
изменились дата и время создания файла").

                         В Н И М А Н И Е !
  Чтобы избежать лишнего диалога с программой, пометьте все свои рабочие
подкаталоги сразу после создания таблицы файлов.

   При  всех  операциях  с  оглавлением  диска программа DINF производит
проверку   на   наличие   вируса,   получившего   название   "REBOOTER".
Особенностью  этого  вируса  является  то,  что  он  заносит  в  каталог
зараженных  файлов  время  создания  файла  равное  62 секундам. Если вы
получите  сообщение  о  возможности  заражения  этим вирусом, рекомендую
проверить  подозрительный  файл.  Однако,   он  может  оказаться  и   не
инфецированным, так как все известные мне программы - антивирусы, удаляя
вирус "REBOOTER", не исправляют время создания файла.
   Аналогичным  образом  файлы  проверяются  и  на возможность заражения
вирусом "TOOTHLESS"  ("БЕЗЗУБЫЙ") длиной  534 байта,  который заносит  в
каталог значение месяца создания файла, равное 13-ти.


                            Примечание
   Если Вы заметили,   что  скорость  работы  программы  DINF снизилась,
то после  очередной проверки,  когда  Вы  убедитесь,  что  на  диске все
в порядке, пересоздайте  таблицу файлов. Для  этого выполните DINF,  как
было  указано  выше,  с  ключем  "/w".  Скорость работы программы должна
возрасти.  Это  связано с   тем, что структура   таблицы оптимальна  для
поиска файлов сразу  после  ее  создания.  Со  временем  при  добавлении
новых файлов  оптимальная    структура    нарушается, хотя    замедление
работы  программы столь мало, что скорее всего Вы его не заметите. Имеет
смысл пересоздать таблицу   после  добавления   или  уничтожения   сразу
большого количества  файлов.    При   небольших    изменениях    таблица
будет   откорректирована  автоматически (после запроса на  разрешение) в
процессе проверок.

                   Изменения относительно версии 4.08.
   С версии 5.00 поддерживаются все графические адаптеры (CGA, EGA, VGA,
Gercules).
   С версии 5.01 при всех операциях с диском производится поиск  вируса,
получившего название "TOOTHLESS" ("БЕЗЗУБЫЙ") длиной 534 байта.
   С версии 5.02 исправлены атрибуты цвета для адаптера Gercules.
   С версии 6.00 введен контроль на наличие вирусов в PARTITION TABLE  и
в BOOT-секторе. В связи с изменением формата таблицы файлов при переходе
на эту версию необходимо  пересоздать таблицу, используя ключ  "/w" (см.
выше). Таблицы, соответствующие предыдущей версии, можно стереть с
диска.
   В версии 6.01 внесены незначительные изменения.
   В версии 6.02 внесены незначительные изменения.
   В версии 6.03  введен  контроль  появления  новых  плохих кластеров и
исправлена ошибка, допущенная в версии 6.02. При переходе на эту  версию
необходимо  пересоздать  таблицы,  используя  ключ  "/w". Старые таблицы
заместятся автоматически. Смена таблиц необходима для занесения  номеров
плохих кластеров.
   В версии  6.04 введен  дополнительный контроль  сохранности файлов  с
таблицами.

                                      ┌─────────────────────────────────┐
                                      │                                 │
                                      │  Мостовой Дмитрий Юрьевич       │
                                      │  Институт прикладной математики │
                                      │  им.М.В.Келдыша АН СССР,        │
                                      │  тел. 333-65-12, 250-79-87      │
                                      │                                 │
                                      └─────────────────────────────────┘


