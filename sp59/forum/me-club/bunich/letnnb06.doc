
                                            Л.Г.Бунич   14.09.1993
                                            тел. 148-48-27 (служ.)
                                                 591-93-09 (дом.)


             Очередные материалы по Multi-Edit (6.1)
             ---------------------------------------

   1.  В  редакции 6.1 еще сохранились несколько ошибок предыдущей
версии.

        - Компилятор не воспринимает коды клавиш:

          CtrlShftCntr (и CtrlShftCenter)
          CtrlShftGreyEnter  (Setup срезает два последних символа)
          CtrlShftGrey/ (воспринимается как CtrlShft)
          AltShftGrey/  (аналогично)

        - Закладка (bookmark) запоминается верно только если теку-
          щим является режим вставки (INS). В режиме OVR она зати-
          рает  первую  из  старых закладок.  Для исправления надо
          скорректировать и перекомпилировать MEHELP.S:

             (строка  47) добавить описание  int im;
             (строка 978) перед CR; добавить:

                          im = Insert_Mode;  Insert_Mode = True;

             (строка 984) восстановить значение: Insert_Mode = im;

        - Вопреки Help,  щелчок мышки помечает слово как непрерыв-
          ный, а не прямоугольный, блок.

        - Слова в индексе не могут содержать строчные буквы.


   2.  Макроязык умнее, чем это может показаться по Help'у. Напри-
мер, поддерживаются Си-операторы вида k+=1.  Конструкции ++N и N++
(последняя  также не упомянута)  могут быть не только операторами,
но и выражениями. Есть и многократное присваивание, например:

        A = B = C + D


   3.  Можно  динамически включать/выключать раскраску синтаксиса,
используя переменную KeyWord_Highlighting.  Если она равна 1, рас-
краска выполняется. Пример (переключить текущий режим):

   KeyWord_Highlighting = 1 - KeyWord_Highlighting;  New_Screen;


   4. По поводу заметок А.В.Милюкова (СП 5.6): работать с архивами
в Multi-Edit можно несколькими способами.

   Сначала я также попытался использовать три стандартные перемен-
ные xxxDIR_COMMAND, но они позволяют только просмотреть оглавление
архива.

   Другой путь:  доработка системного макро DIRSHELL.S - например,
так,  как  это сделал Геннадий Стерник (СП 4.5).  Тоже неудобно по
многим причинам.

   В  конце концов я решил использовать уже имеющиеся оболочки ар-
хиваторов (LGAVIEW, ARCVIEW, SHEZ и другие). Для их вызова в среде
Multi-Edit  предлагается универсальное макро UTCALL (файл LGB6.S).
Например,  для  вызова SHEZ я подвожу в окне оглавления нужный ар-
хив и нажимаю AltS; формируется команда UTCALL SHEZ.BAT .

   Макрос  UTCALL  удобен и для других вызовов;  например,  вызова
HIEW.EXE для просмотра двоичного файла.


   5. Предлагаю еще несколько макросов.

LANGKIT.S Для макросов Multi-Edit поддерживаются удобные средства:

             - справка по макросам, имеющимся в текущем файле;
             - автоматический  запуск компилятора и отладчика  для
               текущего макроса;
             - повторный запуск отладчика без блуждания по меню;
             - запуск текущего макро.

          Для  Ассемблера еще раз доработан макрос форматирования.
          Он выравнивает строки программы  по стандартам Ассембле-
          ра.  Не  забудьте  пометить  нужные  строки как строчный
          блок.

LGB6.S    Макрос В.Мунтьянова для сравнения текстов (СП 5.4) лучше
          своего  аналога  из библиотеки American Cybernetics,  но
          проигрывает последнему по качеству интерфейса. Предлагаю
          макрос FCmenu - красивая оболочка и автоматизация вызова
          FC;  она  позволяет  выбрать сравниваемые файлы из числа
          редактируемых  окон или загрузить их с диска в разделен-
          ное окно,  затем настраивает параметры и вызывает макрос
          FC.  Еще одно назначение клавиш нужно для операции "про-
          должить сравнение" (вызов FC без параметров).

          Я несколько доработал макрос FC: курсор после несовпаде-
          ния  устанавливается на первую несовпавшую колонку (пер-
          вого файла). Текст FC не приводится.

          Макрос  IND_UND_1 сдвигает все содержимое блока строк на
          одну  колонку  направо  или налево (аргумент /L означает
          сдвиг налево).
