Cофтпанорама 1991, No. 1 (15) *** NEWVIR *** Составитель: Н.Н. БЕЗРУКОВ
************************************************************************

        ╔════════════════════════════════════════════════════╗
        ║                  П А Н О Р А М А                   ║
        ║  К О М П Ь Ю Т Е Р Н О Й   П Р Е С Т У П Н О С Т И ║
        ╚════════════════════════════════════════════════════╝

***************** Вирусы группы "Гимн", по-видимому, ******************
******************  созданы технокрысой из Харькова *******************

  По некоторым (впрочем, очень ненадежным) данным опасные вирусы-вандалы
группы Гимн - RCE-1865, RCE-1962 и RCE-2144 - разработаны в Харькове.

                                                                  Б.Н.Н.


********************** Паршивую овцу с поля вон ***********************

Австралийская Ассоциация по Программному Обеспечению (Business  Software
Association of  Australia -  BSAA) получила  доказательства по обвинению
одного местного продавца  компьютеров в пиратском  копировании программ.
Расположенная в Сиднее фирма Computer Exchange Corporation в  результате
обыска, проведенного представителями BSAA, лишилась 10 компьютеров и  90
жестких дисков.

Австралийский федеральный суд предоставил BSAA право без предупреждения
посетить эту фирму и изъять товары, которые нарушают права компаний-чле-
нов BSAA. Были изъяты программы фирм Lotus, Ashton-Tate, Word Perfect, а
также ряд нелегально размноженных руководств. Анонимный "сигнал"  посту-
пил от "покупателя, обеспокоенного тем, что торговец извлекал прибыли из
продажи компьютеров, начиненных ворованными программами". Перед рейдом и
изъятием компьютеров BSAA произвела "контрольную закупку", чтобы  убеди-
ться в том, что поступившая информация правдива.

                                             Newsbytes, August 13, 1990.
                                                   КомпьютерПресс 12'90

************************* Компьютерный шантаж **************************

Лондонская газета Independent опубликовала  статью о попытках шантажа  с
использованием компьютерных систем. Сообщается,  что у пяти банков  были
потребованы крупные суммы денег. Шантажист заявлял, что после  требуемой
оплаты банк получит информацию о том, как можно проникнуть в считающуюся
хорошо засекреченной  компьютерную систему  банка. В  статье заявляется,
что с мая 1990 года неизвестные лица получали доступ к банковским компь-
ютерам, чем вызвали большое беспокойство из-за возможного создания хаоса
или повреждения компьютерных  программ. Все пять  не указанных в  статье
банков либо отрицали,  что стали жертвой  шантажа, либо отказывались  от
любых заявлений на эту тему.

                                             Newsbytes, October 17, 1990
                                                    КомпьютерПресс 10'90


     ╔═════════════════════════════════════════════════════════╗
     ║         И Н Ф О Р М А Ц И Я   И   Н О В О С Т И         ║
     ║                                                         ║
     ║   В   О Б Л А С Т И   З А Щ И Т Ы   О Т   В И Р У С О В ║
     ╚═════════════════════════════════════════════════════════╝

************* Версия 3.3 становится слишком вирусоопасной **************

     Поскольку многие технокрысы  ориентируются при своей  разработке на
особенности MS DOS  версии 3.3, появлется  очевидный смысл переходить  с
нее на только что появившуюся  версию 5.0, тем более, что  она позволяет
увеличить количество свободной памяти для прикладных программ.
     Пользователям компьютеров с процессором 80386 или 80286 с 2M памяти
имеет смысл переходить  на Desqview 2.3,  которая сейчас является  самой
гибкой многозадачной средой для персональных компьютеров.  Действительно
исключительно  удобно  не  выходя  из  одной  задачи переходить в Norton
Commander, запускать PKZIP или в фоновом режиме проверять файловую  сис-
темы детектором или ревизором.
                                                                   Б.Н.Н.


***************** Еще один аргумент в пользу покупки *******************
**************** компьютеров на базе процессора 80386 ******************


     Многие вирусы не работоспособны на процессоре 80386. Поэтому  испо-
льзование этого процессора можно рассматривать как одну из форм  антиви-
русной защиты.
                                                                   Б.Н.Н.

******************* Полифаг -V будет продавать Новинтех ****************

    Как  сообщил  автору  Е.Касперский,  достигнуто соглашение о продаже
коммерческой версии полифага -V с СП Новинтех. Цена пока неизвестна.

                                                                  Б.Н.Н.

****************  Антивирусная программа AIDSTEST.EXE ******************
****************  Версия 76 от 27.12.90, длина 44139. ******************

   Ниже приводится фрагмент из документации к предыдущей версии полифага
Aidstest (текущая на 10.01.91 версия 82 выкусывает соответственно 82 ви-
руса, причем, как уже указывалось, в отличие от -V, автор которого  "ув-
лекается импортом", все новые, выкусываемых AIDSTEST вирусы относятся  к
реально найденным вирусам отечественной разработки. К сожалению докумен-
тация к указанной версии к автору еще не поступила, поэтому
для ориентации ниже приводится

51 -  V-572.

52 -  Loz-1023.
        Пользуюсь случаем  выразить глубокую  благодарность
     автору этого  вируса за высокую оценку моего скромного
     вклада в  дело уменьшения  вреда от  деятельности  ему
     подобных.

53 -  V-516.

54 -  MSTU-554 (551).

55 -  V-948.

56 -  SVC-1689.

57 -  V-699.

58 -  V-696.

59 -  MLTI-830.

62 -  HYMN-1865, HYMN-1962, HYMN-2144.

63 -  Kuku-448,  реализована  работа  не  только  с  полным
     диском.

64 -  V-1024.

67 -  Mgn, Fu-417, Minsk-1075.

68 -  Loz-1915.

69 -  Loz-776, выдача копии протокола в файл.

70 -  AT-144.

71 -  Loz-1018, M53-1905(1909).

72 -  Words-1085.

73 -  V-1150.

75 -  Words-1069, Words-1387, V-370.
                                                                  Б.Н.Н.




**************** -V первым из ведущих советских полифагов *************
*************** перешагнул границу 100 выкусываемых вирусов  **********

    В то время как текущие версии SOS и Aidstest выкусывают менее 90 ви-
русов, Е.В.Касперский в конце 1990 года "ушел в отрыв" и первым перешаг-
нул этапное число 100: к 1.01.91 текущая версия -V выкусывала более  100
компьютерных вирусов. Правда в отличие от предельно прагматического под-
хода Д.Н.Лозинского, который включает в AidsTest только вирусы,  обнару-
женные в "диком" состоянии на у отечественных пользователей, Е.В.Каспер-
ский "увлекся импортом". В частности его полифаг выкусывает экзотический
вирус "Sylvia" - нерезидентный файловый вирус, содержащий в начале свое-
го тела приглашение послать  почтовую карточку некоей Сильвии  Веркад из
Голландии:

      ┌────────────────────────────────────────────────────────┐
      │ This program is infected by a HARMLESS Text-Virus V2.1 │
      │ Send a FUNNY postcard to : Sylvia Verkade,             │
      │                            Duinzoom 36b,               │
      │                            3235 CD Rockanje            │
      │                            The Netherlands.            │
      │ You might get an ANTIVIRUS program.....                │
      └────────────────────────────────────────────────────────┘

************** Приближается кризис разработки полифагов:  **************
******** отечественные технокрысы скоро "съедят" разработчиков  ********
*********************** "монолитных" полифагов ************************

    Поскольку количество выявленных вирусов непрерывно растет можно  по-
пытаться предсказать, какой полифаг  первым перешагнет границу 200.  Бо-
юсь, что наиболее правдоподобным ответ звучит достатоно пессемистически:
шансы выживания полифагов существующей монолитной конструкции в обстано-
вке советского вирусного  взрыва проблематичны, поскольку  интенсивность
потока новых вирусов стала такова, что отечественные разработчики "моно-
литов" для которых это  занятие является дополнительным, а  не основным,
могут захлебнуться в "бурном потоке" создаваемом интенсивно размножающи-
мися отечественными технокрысами. По-видимому, необходим переход к "кас-
сетным полифагам", подобным "кассетным боеголовкам", когда одно "средст-
во доставки" несет множество сравнительно простых модулей, каждый из ко-
торых рассчитан на отдельный вирус. Этот подход, по сути, является возв-
ращением на качественно новом уровне к методу, использовавшемуся на ран-
них этапах борьбы с вирусам -- распространявшимся бюллетенем "антивирус-
ным интеграторам". Для максимального упрощения, детектор стоит  парамет-
ризовать и включить в  интегратор. Целесообразна выработка стандарта  на
подключаемые модули. Тогда  подключаемый модуль может  разрабатываться в
расчете на обработку файла, имя которого передается как параметр (но он,
конечно, должен контролировать, что ему подсовывают). При этом ограниче-
ния на язык программирования отсутствуют, что упрощает обмен модулями  и
позволяет оперативно включать последние в бюллетень.

                                                                   Б.Н.Н.



╔═════════════════════════════════════════════════════════════════════╗
║         В И Р У С Ы,  О Б Н А Р У Ж Е Н Н Ы Е   В  С С С Р          ║
║                                                                     ║
║Х Р О Н И К А   С О В Е Т С К О Г О   В И Р У С Н О Г О   В З Р Ы В А║
╚═════════════════════════════════════════════════════════════════════╝


                Обещанный в  прошлом номере  бюллетеня обзор  делался в
                страшном цейтноте  и состоит  в основном  из фрагментов
                документации Д.Н.Лозинского  и Е.В.Касперского,  причем
                из-за спешки я мог перепутать где-чей фрагмент
                                                                  Б.Н.Н.


**************************** Группа HYMN ******************************


    В данную группу  входят три достаточно  близких по кодировке  вируса
RCE-1865 (наиболее ранняя версия, записывается в программу без модифика-
ции) RCE-1962 (кодирует свое тело при записи в заражаемую программу, ос-
тавляя  стабильным  лишь  фрагмент  инсталлятора с циклом раскодировки);
RCE-2144 (помимо кодирования тела содержит примитивную защиту от трасси-
ровки) .

    Формально указанные вирусы  представляют собой файловые  резидентные
вирусы, заражающие как COM, так и EXE-файлы, причем не только при загру-
зке программы, но и при открытии файла, переименовании, изменении аттри-
бутов, а также при создании нового программного файла.

    Среда  функционирования  вируса  ограничена  версиями, начиная с 3.3
(как и во многих других вирусах, используются недокументированнные  осо-
беннности именно этой версии), однако проверка версии в теле вируса  от-
сутствует.

    Фаза проявления вирусов этой группы наступает при совпадении числа с
номером месяца (например 12 декабря, 1 января и т.д.) и состоит в  обну-
лении ряда параметров винчестера (размер блока, количество FAT, и  т.д.)
после чего делается попытка  исполнить Гимн Советского Союза  (по мнению
Д.Н.Лозинского довольно фальшиво) с выводом на экран саморекламы. На  PC
XT в момент  загрузки системы стоит  дата 01.01.80, и,  если COMMAND.COM
заражен, диск "C" сразу портится.

    Как оказалось,  обнуления параметров  оказывается достаточно,  чтобы
процесс восстановления винчестера стал весьма непростой проблемой.  Экс-
перименты показали, что после этого компьютер перестает грузиться с дис-
кеты. Поэтому все, кто еще этого не сделал должны немедленно создать ре-
зервные копии системных блоков винчестера на дискете (для этой цели  ре-
комендуется использовать утилиту DiskTool из Norton Utilities 5.0, а при
ее отсутствии хорошо известную утилиту NU) и CMOS. Тогда исправление мо-
жно выполнить следующим образом:
   - отключить винчестер через CMOS;
   - загрузиться с дискеты;
   - изменить SMOS загрузив его из файла или вручную (например с помощью
CMOSER);
   - исправить BOOT Sector диска  "C" можно при помощи программы  NU.EXE
или DiskEdit.
     Для этого ее следует запустить с дискеты командой "nu c: /m",  выб-
рать сектор 0,  скопировать вручную 9  байт, которые стоят  со смещением
1F3, в байты со смещением 0C и записать сектор на диск.

                                                                  Б.Н.Н.


**************************** Вирус RC-488 *****************************
        (Flu-2 -- Грипп-2, LoveChild -- Внебрачный ребенок)

     Неформальное название данного вируса связано с тем, что в теле виру-
са имеются  текстовые строки  "v2 (c)  Flu Systems  (R)" и "LoveChild in
reward for software sealing". Формально RC-488 является файловым резиде-
нтным вирусом, заражающим COM-файлы. Тип файла определяется по  расшире-
нию имени. Длина  вируса 488 (1E8h)  байтов совпадает с  приращением при
заражении. Файлы заражаются  однократно. Командный процессор  заражается
как обычный COM-файл. Среда  функционирования вируса ограничена MS  DOS-
3.30, причем из-за  ошибки запуск зараженной  программы на любой  другой
версии приводит к зависания операционной системы
    При заражении COM-файлов вирус дописывает себя в конец, изменяя пер-
вые четыре байта. Файлы заражаются при их загрузке в память, при  откры-
тии и создании (21-3C, 21-3D, 21-4B и 21-5B). При этом заражение  файлов
при исполнении функций OPEN и RENAME начинается не сразу, а только после
того как с момента инсталляции вируса будет выполнено 5000 вызовов  ука-
занных функций. Для посчета вирус использует специальный счетчик.
    При инсталляции записывает свое тело во вторую половину таблицы век-
торов прерываний, начиная с адреса 0000:01E0h. Проверяет версию операци-
онной cистемы. Для версии 3.3 вирус определяет "истинные" адреса 21 и 13
прерываний. Для получения управления по 21 прерыванию использует  сплай-
синг. Обработка 13 прерывания  сводится к замене адреса  его обработчика
на первоначальное  значение, что  "отрубает" сторожа,  следящие за  этим
прерыванием, как, впрочем, и драйверы типа 800, обеспечивающие нестанда-
ртные форматы записи на дискеты.
    Фаза проявления наступает при определенных значениях счетчика време-
ни. При этом вирус либо уничтожает файлы, либо создает вместо файла под-
каталог с таким же именем. Следует обратить особое внимание на тот факт,
что вирус может троянизировать  COM-файлы, модифицируя их таким  образом
тачто их запуск вызовет стирание секторов винчестера (стирается вся  ин-
формация, расположенная на  всех секторах, соответствующих  0-3 головкам
записи/чтения).
    Исторические замечания. Судя по текстовым строкам, RC-488 имеет  за-
рубежное происхождение, однако в доступной автору версии списка  П.Хофф-
ман, датированном  10.10.90, описание  этого вируса  отсутствует. В СССР
появился примерно в августе 1990  г. Автору был передан Е.Касперским.  B
Киеве не отмечался.
    Неформальные названия. Помимо приведенных выше, неизвестны.
    Программные средства защиты. Полифаг Aidstest, начиная с версии  45.
Детектирование возможно по сигнатурам, приведенным в прил.1.


       Фрагмент дампа дрозофилы, зараженной вирусом RC-488

000: FBE9F200B402B207 CD21CD2000000000   .........!. ....
010: 0000000000000000 0000000000000000   ................
***  далее следуют строки, идентичные предыдущей ***
0E0: 7632202863292046 6C75205379737465   v2 (c) Flu Syste
0F0: 6D732028522933C0 8EC0E800005E8BEE   ms (R)3......^..
100: BFE001FC26813D76 32744881EE1D00B9   ....&.=v2tH.....
110: E801F3A4B430CD21 3D031E7527BE7000   .....0.!=..u'.p.
120: 8EDEBEB400BF4C00 A5A5B80312CD2F26   ......L......./&
130: 8C1EC803BE6014C6 04EA8C4403C74401   .....`.....D..D.
140: CD02EB0F061FBE84 00A5A58C44FEC744   ............D..D
150: FCCD028CC88EC08E D8BF00018BF581C6   ................
160: 6E00A5A533C083EF 04FFE790909090FB   n...3...........
170: E90000B003CFB901 00BA80038BD9B810   ................
180: 03CD13FECE79F7B6 03FEC5EBF14C6F76   .....y.......Lov
190: 654368696C642069 6E20726577617264   eChild in reward
1A0: 20666F7220736F66 7477617265207365    for software se
1B0: 616C696E672E2EF6 066C0407750A1F5A   aling....l..u..Z
1C0: 595B58B441E9FD00 E9EE0088132EFF0E   Y[X.A...........
1D0: CB027803E9EE002E FF06CB0280FC4075   ..x...........@u
1E0: 24578BFA813D4D5A 751A2EF6066C0406   $W...=MZu....l..
...   .. .. .. .. .. .. .. .. .. .. .. ..  .. .. .. .. ..
2B0: B440CD215BB43ECD 212EC706CB02FFFF   .@.![.>.!.......
2C0: 1F5A595B58EA6714 0000               .ZY[X.g...

                             С-273 (MGTU)

     Заражает только COM в текущей директории, различая их по имени. Со-
держит  текст  "Эта  пpогpамма  написанна  в  МГТУ студентом гpуппы ИУ4"

                                                  По материалам докумен-
                                                  тации к Aidstest



              RC-1023, RC-1018 (Anti-Loz-1, Anti-loz-2)

   Заражает только COM, однако заметно желание в дальнейшем  распростра-
нить деятельность и на EXE- программы. Заражение происходит и при откры-
тии файла на  чтение. Атрибуты и  дата файла портятся.  Главной задачей,
которую поставил перед собой автор, является борьба против AIDSTEST. Ви-
рус, как и большинство остальных, остается резидентным в памяти,  перех-
ватывая обработку функции 4B (загрузка программ). При попытке  исполнить
программу AIDSTEST он вместо этого выдает текст:

                  Welcom to demo version (C) Zherkov
                  Лозинский-ДУБ , AIDSTEST - горбуха

и пытается стереть AIDSTEST с  диска. Для лечения необходимо работать  в
чистой операционной системе, загружаемой с дискеты, либо, если у вас та-
кой нет,  переименовать AIDSTEST  (защита от  переименования снята). Еще
раз напоминаю - имейте копию на защищенной дискете. В вирусе  предусмот-
рена и еще  одна пакость: при  записи на дискету  BOOT Sector (например,
при форматизации) в нем заменяется на 0 параметр количества поверхностей
(смещение 1A). Как ни странно, исправить такую дискету довольно  трудно.
Программу NU (Norton Utilities)  следует запустить командой "nu  a: /m",
причем в это время дискета не должна быть загружена, и только после  на-
чала работы программы ее можно загрузить. В противном случае NU зацикли-
вается. Из анализа текста вируса видно, что автор знаком с довольно тон-
кими возможностями MS DOS, но применяет их довольно бессмысленно.

                                                  По материалам докумен-
                                                  тации к Aidstest

                         RE-1915 (Anti-Loz-3)

    Новая версия вируса того же автора. На этот раз добавлена  обработка
EXE-программ. Пострадавшим от этого вируса могу сообщить координаты  ав-
тора.

                                                  По материалам докумен-
                                                  тации к Aidstest

                          C-776 (Anti-Loz-4)

    Очередная вариация на тему  "Vienna (DOS 62)". Пометка  зараженности
заменена с 62 на 58 секунд. Автору можно быть благодарным за то, что он,
по крайней мере, выкинул порчу программ и заражает только программы дли-
ной от 813 до 3302. Иногда выдает сообщение:

              Я, кажется, подхватила какую-то заразу... 
             Срочно звоните Дмитрию Николаевичу Лозинскому
             по телефону 292-40-76 (Москва) и приобретите
                        ПРОГРАММУ AIDSTEST !!!

                                                  По материалам докумен-
                                                  тации к Aidstest



                             CE-554 (MSTU)

    Заражает и COM (длина 554), и EXE (длина 551) только в текущей дире-
ктории, различая их  по имени. В  качестве признака зараженности  ставит
фиксированное время (10:47:22).  Файлы с флагом  Read only не  заражает.
Содержит текст "This program was written in MSTU,1990". Думаю, что позо-
рит МГТУ своим  безграмотным творением тот-же,  кто сочинил и  MGTU-273.
Поскольку никакие проверки длин  в вирусе не предусмотрены,  полноценное
лечение всех файлов не гарантируется.

                                                  По материалам докумен-
                                                  тации к Aidstest


                            RCE-1689 (SVC)

    Заражает COM  и EXE.  Содержит близко  от конца  текст: "(c) 1990 by
SVC,Vers. 4.0". Корректирует  время создания файла,  ставя в нем  60 се-
кунд. Если  зараженную программу  загружает DEBUG,  вирус ее исправляет.
При вызове функций просмотра каталога, вирус корректирует в информации о
зараженных программах время и длину, скрывая свое наличие в них.

                                                  По материалам докумен-
                                                  тации к Aidstest

                           RC-830 (MLTI)

Заражает только COM. Дату портит. По пятницам после трех часов непрерыв-
ной работы стирает с  диска все загружаемые программы.  Содержит тексты,
свидетельствующие о том, что вирус изготовлен в МЛТИ. Способ фиксации  в
оперативной памяти заимствован из  одной из последних версий  "музыкаль-
ных" вирусов (как и в V-1049).

                                                  По материалам докумен-
                                                  тации к Aidstest




                             C-448 (Kuku)

    Заражает только COM. Алгоритм поиска содран из классического  вируса
"Vienna (DOS 62)" (поиск через  PATH). Пишется в начало, копируя  старое
начало в конец.  Метит зараженные файлы  во времени -  ставит 20 секунд.
Ранее зараженные программы портит, переписывая первые 49 байт. При запу-
ске такой программы  на экране (только  цветном) начинает бегать  весьма
остроумная надпись "Kuku!". Успешное  лечение от этого вируса  не всегда
возможно. В случае сомнения в возможности правильного лечения  программа
спрашивает разрешение на удаление файла с диска.

                                                  По материалам докумен-
                                                  тации к Aidstest

                       Группа Магнитогорск (Mgn)

     По данным Д.Н.Лозинского в настоящее время имеется три разновиднос-
ти этого вируса. Заражают и COM и EXE. Длина первого RCE-2048, RCE-2560a
и RCE-2560b.

    Фаза проявления RCE-2048 состоит переворачиваии "картинки" дисплея
причем  восстанавливает расположение  всех рамок  и скобок.

    Фаза  проявления  RCE-2560a  состоит  в  выдаче  приветствия в адрес
Д.Н.Лозинского, а RCE-2560b  содержит обе эти  шутки.

    Вирусы написаны  весьма квалифицированно.  В частности,  не заражает
сегментированные программы. В теле вируса предусмотрена ветвь, обеспе-
чивающая выкусывания тела вируса  и зараженной программы (т.е.  их можно
отнести к подгруппе самоедов).

    Исторические замечания. Вирус был выделен Д.Н.Лозинским в конце 1990
г. По данным Д.Н.Лозинского разработан в Магнитогорске.

    Неформальные названия. Помимо приведенных выше, неизвестны.

    Программные средства защиты.  Для защиты можно  использовать, приво-
денный СП 2-10 сторож MVT или его более позднюю версию. В качестве  фага
можно использовать полифаг Aidstest, начиная с версии 76. Детектирование
возможно по  сигнатурам, приведенным  в прил.1  Компьютерной вирусологии
(версии 5.6 и более поздние).

                                         Приводимые сведения основываются
                                         на данных Д.Н.Лозинского.


                              RC-417 (Fu)

  Заражает только COM. Портит дату. Приблизительно через каждый час сти-
рает экран и выдает в центре текст, который не принято приводить в печа-
ти.
                                                  По материалам докумен-
                                                  тации к Aidstest

                           RCE-1075 (Minsk)

Длина 1075. Заражает COM и EXE, однако различает их по имени. Портит да-
ту. Безнадежно портит сегментированные программы. Заражает, в отличие от
большинства вирусов, только при открытии программного файла.  Предусмот-
рена пакость против файлов DBF: при каждом 20-м чтении вместо  прочитан-
ного блока возвращаются пробелы.
                                                  По материалам докумен-
                                                  тации к Aidstest

                                RC-144

       Заражает только COM,  резидентный. Содержит пару  команд, которых
нет в процессоре 8088, в связи с чем не должен работать на PC-XT.  Напи-
сан явно способным программистом в расчете на побитие рекорда длины  ви-
руса. Должен, однако, его  разочаровать - есть болгарский  вирус имеющий
длину 133, причем без PUSHA. Причем его автор отличается и большей поря-
дочностью - этот вирус существует только в коллекциях вирусологов.

        Файловый резидентный безобидный вирус. Поражает COM-файлы при их
загрузке в память (int 21h, ah=4Bh), стандартно записываясь в их  конец.
Владельцы  EC-1840  могут  не  бояться  этого вируса, т.к. он использует
команды процессоров 80x86   POPA и PUSHA.  Отличается малой длиной  (144
байта), но все-таки отстает от лучших представителей семейства "Tiny". К
тому же вирусы "Tiny" работают и на процессоре 8086.

                                         Приводимые сведения основываются
                                         на  данных   Д.Н.Лозинского   и
                                         Е.В.Касперского

                                 Words

      Группа вирусов, изготовленных,  судя по тексту  в одном из  них, в
Киеве. Заражают и COM и EXE, причем последние превращением в COM.  Рези-
дент в середине памяти (алгоритм взят из вируса осыпания букв).  Предус-
мотрена весьма гнусная пакость - при записи любых файлов в них перестав-
ляются соседние слова, под которыми понимаются последовательности  букв,
цифр и  знаков препинания,  разделенные пробелами.  Поскольку в качестве
букв принимаются и русские, очевидно отечественное  происхождение.Версия
длиной 1069 портит дату и атрибуты файла. В версии 1085 эти ошибки  исп-
равлены. Версия 1387 кодируется и в алгоритме перестановки слов содержит
что-то дополнительное, в чем я не разбирался.

                                                  По материалам докумен-
                                                  тации к Aidstest

                             RC-492 (sI)

    Заражает только COM. В памяти остается в области второй половины век-
торов прерываний (0:200-0:3FF). Кроме прерывания 21 берет и 1C,  которое
использует для выбора момента  порчи случайного места диска  "C:". Есть,
впрочем, надежда, что  автор немного напутал  и такой момент  никогда не
наступает. Первым делом вирус пытается заразить "C:\COMMAND.COM". До за-
ражения в конец файла дописывается от  1 до 16 нулей, чтобы длина  стала
кратной 16.  Исходную длину  файла восстановить  невозможно. Время также
портится. Более того, время постоянно указывает на момент последнего за-
пуска программы, пока количество запусков с момента заражения не  станет
равным 256. Сообщение о попытке записи на защищенную дискету не блокиру-
ется. Комбинация "sI" присутствует со  смещением 3 от начала всех  зара-
женных программ и используется вирусом в качестве опознавательного  зна-
ка.

    Очень опасный файловый резидентный вирус. Заражает COM-файлы при
запуске их на выполнение (int 21h, ax=4B00h), длин файлов не  проверяет.
Копирует  себя   в  конец   файла  и   изменяет  его   первые  6    байт
(JMP xx xx zz zz zz).

    При активизации ищет файл C:\COMMAND.COM и инфицирует его. Затем ос-
тается резидентным в памяти. Для этого он копирует себя в область  памя-
ти, содержащую таблицу векторов прерываний, по адресу 0000:0200. Если  в
памяти компьютера находятся  программы, использующие уничтоженные  таким
образом вектора прерываний, то произойдет зависание системы.

	Имеет  деструктивную  функцию:  периодически  стирает  несколько
секторов со случайными номерами. Изменяет вектора прерываний 1Сh и  21h.
Содержит команду `PUSH 100h', поэтому не распространяется на компьютерах
с процессором 8086/88.
                                                  По материалам докумен-
                                                  тации Е.Касперскогок


                                RC-516

     Заражает только COM, причем только начинающиеся командой JMP. Явля-
ется первым представителем давно ожидаемой мной разновидности - не меня-
ет начало, а вставляет JMP на  себя в позицию перехода первого JMPа.  По
мелким приметам похоже, что и его сочинил автор "Dark Avenger". Содержит
ошибку в использовании системных буферов, приводящую к повисанию  систе-
мы, впрочем, с вероятностью вдвое ниже, чем у V-512.

     Файловый резидентный опасный вирус. Поражает COM-файлы при их запу-
ске на  выполнение (int  21h, ax=4B00h).  При этом  заражаются только те
файлы, первый байт которых равен E9h (т.е. файл начинается с команды JMP
Loc_Progr). Вирус заменяет  4 байта по  адресу Loc_Progr на  код команды
JMP Loc_Virus и байт-идентификатор зараженности (см. рис.). Таким  обра-
зом, при заражении файла его заголовок не изменяется.

             Незараженный файл          Зараженный файл

             ┌─────────────┐            ┌─────────────┐
          ┌──│JMP Loc_Progr│         ┌──│JMP Loc_Progr│
          │  │             │         │  │             │
          │  │             │         │  │             │
          └─>│             │         └─>│JMP Loc_Virus│──┐ ─┐ 4 байта
             │             │            │DB  Infected │  │ ─┘
             │             │            │             │  │
             └─────────────┘            ├─────────────┤  │
                                        │ Вирус       │<─┘
                                        │             │
                                        └─────────────┘

     При  активизации  обрабатывает  DOS  2.x,  3.x,  4.0.  Уменьшает
количество дисковых  буферов на  1 и  записывает свою  копию в последний
буфер.

     Периодически при опросе версии  DOS (int 21h, f.30h)  возвращает
ноль  (т.е.  версия  DOS  0.0).  Помимо  этого  никак  не   проявляется.
Перехватывает прерывание 21h. Текстовых строк не содержит.

                                                  По материалам докумен-
                                                  тации Е.Касперскогок


                          E-637  (VCOMM-637)

     Файловый нерезидентный опасный вирус. При запуске зараженного файла
инфицирует не более одного EXE-файла в текущем оглавлении: выравнивнива-
ет файл на границу блока (512 байт), дописывается в его конец и добавля-
ет один элемент таблицы настройки адресов в заголовке файла.  Записывает
в видео-память (сегментный адрес BFFEh) небольшую резидентную программу,
блокирующую запись на диск.
                                                  По материалам докумен-
                                                  тации Е.Касперскогок

                               RC-699

     Заражает только COM, отличая их по имени. Не заражает COMMAND.COM и
файлы короче 1700. Истинное удлинение  файлов от 704 до 719.  В качестве
пакости предусмотрена периодическая симуляция сбоев на устройствах  гиб-
ких дисков, но,  как мне кажется,  в этом месте  имеется ошибка, которая
может приводить к повисанию системы.
                                                  По материалам докумен-
                                                  тации к Aidstest


                                RC-696

     Заражает только  COM, просматривая  каталоги. Это,  кажется, первый
вирус, который работает  не только в  текущем каталоге (если  не считать
"A", работающего через PATH). Впрочем, хотя в алгоритме хождения по  ка-
талогам я детально не разбирался,  некоторые ошибки в нем обнаружил.  До
заражения округляет длину  до кратной 16,  причем точную исходную  длину
восстановить не удается. Дату и время портит. Не заражает COMMAND.COM  и
файлы с атрибутами Read only, Hidden, System. После 64 запусков заражен-
ной программы предусмотрено ее стирание и попытка испортить первый твер-
дый диск.

                                                  По материалам докумен-
                                                  тации к Aidstest

                              RC-707

     Заражает только COM, отличая их по имени. При определенных условиях
появляется треск (18 раз в секунду включает и выключает звук). Текст ви-
руса интересен упорной борьбой автора с несуществующими трудностями. Ви-
рус активизируется только в MS DOS- 3.30, однако, зачем автору это пона-
добилось понять трудно, поскольку все специфичное для этой версии  можно
было в вирус не вставлять.

     Файловый резидентный  неопасный вирус.  Поражает .COM-файлы  при их
запуске на выполнение  (int 21h, ah=4Bh).  Изменяет первые 5  байт файла
(MOV AX,Start_Virus; PUSH AX; RET near) и дописывается в его конец.

      Активизируется только в DOS 3.30, определяет (сканированием  памя-
ти) точки входа обработчиков 13-го  и 21h-го прерывания в DOS  и активно
их использует при заражении файлов. Располагается в самых старших  адре-
сах памяти, корректируя последний MCB и уменьшая размер доступной памяти
(слово по адресу [0000:0413]).

      При заражении ведет подсчет  уже зараженных файлов, и,  как только
встречается 30-й зараженный файл, устанавливает прерывание 8h на подпро-
грамму генерации звукового сигнала.

      Перехватывает прерывания 8 и 21h. Текстовых строк не содержит.

                                                  По материалам докумен-
                                                  тации Е.Касперского

                                RE-905

        Файловый резидентный неопасный вирус. Поражает EXE-файлы при  их
запуске на выполнение (int  21h, ah=4B00h). Изменяет заголовок  файла и,
НЕ дополняя файл до параграфа, дописывается в его конец.

        При  активизации  уменьшает  последний  блок  (Z-блок)  памяти и
копируется в освободившееся место.

        Проявляется  в  зависимости  от  своих  внутренних  счетчиков  и
текущего года, месяца, дня и  только при наличии адаптера EGA.  При этом
наблюдается достаточно интересный видео-эффект: приблизительно через  20
минут  после  активизации  вируса  все  знаки,  отображенные  на экране,
"перевернутся вверх  ногами", т.е.  'P' ->  'Ь', 'U'  -> 'П' (начертание
приблизительно).  Знаки  остаются  на  своих  местах, изменяется лишь их
изображение. Через приблизительно 10 секунд восстановится первоначальное
состояние экрана, еще через 10 секунд - знаки перевернутся и т.д.

	Перехватывает прерывания 8 и 21h. Текстовых строк не содержит.

                                                  По материалам докумен-
                                                  тации Е.Касперского

                               RCE-948

Заражает COM и EXE. За  счет округления истинное изменение длины  больше
на 1-16. При заражении COMMAND.COM его длину не меняет. Работает  только
в MS DOS 3.xx. В качестве шутки предусмотрено изменение случайно выбира-
емых букв на экране, но мне кажется, что эта ветка никогда не работает.

                                                  По материалам докумен-
                                                  тации к Aidstest

                        RCE-1024 (Best Wishes)

        Файловый резидентный  очень опасный  вирус. Стандартно  поражает
.COM-  и  .EXE-файлы  при  их  открытии  или запуске (int 21h, ax=3D00h,
4B00h).  При  каждом  пятом  заражении  модифицирует  BPB   Boot-сектора
текущего  диска:  уменьшает  на  единицу  (если  при этом текущий день -
"тринадцатая  пятница",  то  обнуляет)  содержимое  слова,  указывающего
число кластеров на диске,

       Заражает COM и EXE. Содержит безграмотный плагиат из чужого виру-
са, в результате чего очень быстро делает неработоспособной операционную
систему. Предусмотрено периодическое уменьшение, а в пятницу 13-го и об-
нуление параметра размера диска (BOOT+13h). Если у вас произойдет  такое
на  твердом  диске,  для  восстановления  можно использовать значение из
Partition Table. Лечение возможно только при загрузки с чистой  операци-
онной системы, поскольку  зараженная успевает безнадежно  испортиться до
начала работы программы.

       Вирус обходит сторожа типа ANTI4US.

                                                  По материалам докумен-
                                                  тации Е.Касперского

                               RCE-1150

     Все откровенно украдено из "музыкальных" вирусов, хотя украдено да-
леко не все. В частности, автор не сумел даже обеспечить однократное за-
ражение модуля. Впрочем, автору можно быть благодарным за то, что он  не
вставил какой-нибудь пакостной самодеятельности.
                                                  По материалам докумен-
                                                  тации к Aidstest
