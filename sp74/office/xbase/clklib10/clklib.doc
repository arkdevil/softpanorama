CLKLIB.DOC - Documentation for the CLK Lib dBASE routines.

Introduction/Features:

These procedures and UDFs are essential to the serious dBASE* programmer.
They will add a professional and clean look to your programs and with both a
simple interface, and very powerful one, your programs will outshine any
other.

Here is an abbreviated feature List:

  o  Draw backgrounds
  o  Draw a moving banner
  o  Beep
  o  Center text between two columns
  o  Check boxes
  o  Clear the keyboard buffer
  o  Clipboard functions
  o  Append dots to a string
  o  Dump a text file at a given position
  o  Extract a character from a string
  o  Get a message from a resource file
  o  Get a password
  o  Draw a "nice box" or "nice window"
  o  Message boxes (OK message, Retry/Cancel, Yes/No)
  o  Display a "Percent Job Done" indicator
  o  Make words plural and/or possessive
  o  Draw "Radio" Buttons
  o  Convert numbers to roman numerals
  o  A screen saver for your programs
  o  Shadows for your windows/boxes
  o  Convert state abrv. to state names
  o  Display a status line w/ system info

Requires: dBASE version 2.0 for DOS, utilities adaptable to other programmable
database systems.

Registration: See file REGISTRA.TXT

------------------------------------------------------------------------------

THESE ROUTINES ARE PROVIDED AS IS.  USE THEM AT YOUR OWN RISK.  THE AUTHOR
IS *NOT* RESPONSIBLE FOR ANY DAMAGES RESULTING FROM THE USE OF THESE
ROUTINES. THE RIGHTS TO THESE ROUTINES ARE HELD BY CARL KINGSFORD.
(SEE FILE REGISTRA.TXT FOR MORE INFORMATION)

------------------------------------------------------------------------------

Nameware Concept:

These routines are distributed under the Nameware concept.

The Nameware concept is simple.  It is very similar to the Shareware concept,
except that if you can't pay, simply tell a friend that you like the author's
software (Carl Kingsford).  There are many ways of doing this: tell a
co-worker or include in your commercial, shareware, freeware program a
message mentioning the software and the author.

The basic concept is: if you can pay please do so, if you can't (or even if
you can and just want to) please tell someone about this software (or even
give them a copy!) and the author. In any case you must send in the
Registration Form included on disk.

------------------------------------------------------------------------------

Rights Granted by Registration:

When you register, you are granted the right to use these routines beyond
the 21 day limit. You are allow to use them any way you wish, including,
but not limited to including them in your commercial, shareware, freeware,
programs.

You are allowed to modify the source and object files, as long as the comment
at the beginning is not removed or altered. (you may append comments to this
one, but you may not remove it)

You may not distribute them as, or part of, a routine library for dBASE,
or any other database system.

Apart from the above two limitations, you may do what you want with the
utilities.

All other rights are reserved by Carl Kingsford.

REMEMBER: YOU MUST REGISTER TO GET THESE RIGHTS.

------------------------------------------------------------------------------

How to reach the author:

Regular Mail:
    Carl Kingsford
    4 Winterberry Dr.
    Amherst, NH

e-mail:
    carlk@mv.mv.com   or
    ckingsford@shs.mv.com


If the date is after June 1996:

These addresses (e-mail and reg. mail) will probably change by June 1996,
any mail sent to the reg. mail address after 1996 will still get to me.
Of the e-mail address carlk@mv.mv.com is the most likely to be around after
1996.  Note: I *really* hope I have another version out by then :-)

------------------------------------------------------------------------------

Function/Procedure Description and Usage:
''''''''''''''''''''''''''''''''''''''''''

Each procedure or function has an entry that looks like this:

    Procedure: Name (in FILE.PRG)
    Action   : What this procedure does.

    Usage    : name WITH <row1>, <col1>
               Types:    <int>,  <int>

    Arguments: <row1> the name will be on this row
               <col1> the name will start at this column

The word "Procedure" at the start will be "Function" if the routine that
is being described is a UDF (user defined function).

The "(in FILE.PRG)" supplies the disk file where the source code to this
routine can be found. It will usually be the first 8 letters of the
routine's name, but this is not always the case.

The "Usage" line describes the arguments, and the "Types" line describes
the type of each of those arguments.  For more information about the what
each type means see the "Type Definitions" section below. The "Arguments"
section gives further detail about each argument.

Sometimes these entries are followed by an "Example" section or a "Notes"
section, these provide examples, cautions, programming notes, etc. You
should read these sections carefully if provided.


Type Definitions:

In the "Types" section of the routine description, the type of each argument
is described.  What follows is an table of what each type means.

    <int>       an integer (number with not decimal: 34)
    <color>     a string in the form: "foreground color/background color"
                such as "B/W".  See your dBASE documentation for more
                information on colors.
    <string>    character string ("Hello World!")
    <char>      character string of length 1 ("A")
    <var name>  the name of a variable (wind_var)
    <bool>      boolean: .T. or .F.


- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Function/Procedure Descriptions:
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: Backgrnd (in BACKGRND.PRG)
Action   : This simple procedure draws a background in given colors, up to
           a given row, with a given character.

Usage    : backgrnd WITH <screen_size>, <char>, <color>
           Types:        <int>,         <char>, <color>

Arguments: <screen_size> backgrnd will fill lines 0-<screen_size>
           <char>        backgrnd will use this char as the background
           <color>       the background will be the given color

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: Banner (in BANNER.PRG)
Action   : This procedure draws a continuously scrolling boarder with user
           defined text, colors, position, and size.  The text scrolls like
           a "ticker-tape" until the user presses a key.

Usage    : banner WITH <message>, <line>, <col1>, <col2>, <color>, <speed>
           Types:      <string>,  <int>,  <int>,  <int>,  <color>, <int>

Arguments: <message> this message will be displayed
           <line>    the banner will be put on this line
           <col1>    the banner will start at this column
           <col2>    the banner will end at this column
           <color>   the banner will be in this color
           <speed>   the larger this value, the slower the banner

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: Beep (in BEEP.PRG)
Action   : This procedure makes a simple beep through the PC Speaker

Usage    : beep

Arguments: none.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: CenterBet (in CENTERBE.PRG)
Action   : This procedure outputs a string centered between two user
           given columns, in the given color.

Usage    : centerbe WITH <line>, <col1>, <col2>, <message>, <color>
           Types:        <int>,  <int>,  <int>,  <string>,  <color>

Arguments: <line>    the message will be drawn on this line
           <col1>    starting on this column
           <col2>    ending at this column
           <message> the string to display
           <color>   message will be in this color

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : CheckBox (in CHECKBOX.PRG)
Actions  : This procedure puts up a "check box", with up to five
           options. Users can select 0 to 5 of the presented options.
           The state of a check box is gotten by IsChecked().
           CheckBox returns a string in the form:
             "yyyyy" where "y" is an "X" if the box is checked or an "O"
             if it is not. (boxes not used are "O")

Usage    : checkbox( <row1>, <col1>, <numchoices>, <color>, <mesg>... )
           Types:    <int>,  <int>,  <int>,        <color>, <string>

Arguments: <row1>       the check box will start on this line
           <col1>       the check box will start on this column
           <numchoices> the number of choices (up to 5)
           <color>      the color of the check box text
           <mesg>       the text for the choice - can be repeated up to
                          <numchoices> times.

Example  :
    The command:

    ? checkbox(1,1, 4,"B/W", "Option 1", "Option 2", "Option 3", "Option 4")

    will display at (1,1):

        [ ] Option 1
        [ ] Option 2
        [ ] Option 3
        [ ] Option 4

    The user will be able to use the arrow keys and <pageup>, <pagedown>.
    <enter> accepts the choices, <space> toggles an option.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: ClearKBD (in CLEARKBD.PRG)
Action   : This routine will simple clear the keyboard buffer.

Usage    : ClearKBD

Arguments: none

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Library  : ClipBoard (in CLIPBOAR.PRG)
Action   : Provides basic clipboard routines (cut,copy,paste,etc.)

                                ---

Procedure: ShowClip (in CLIPBOAR.PRG)
Action   : Dump the clipboard at a given position, in a given color

Usage    : showclip WITH <row1>, <col1>, <fcolor>
           Types:        <int>,  <int>,  <color>

Arguments: <row1>   the dump will start at this row
           <col1>   the dump will start at this column
           <fcolor> the dump will be in this color

                                ---

Procedure: Cut (in CLIPBOAR.PRG)
Action   : Cut from the given variable to the jClipBoard public var.

Usage    : cut WITH <var name>
           Types:   <var name>

Arguments: <var name> name of the variable to cut from

                                ---

Procedure: Copy (in CLIPBOAR.PRG)
Action   : Copy from the given variable to the jClipBaord public var.

Usage    : copy WITH <var name>
           Types:    <var name>

Arguments: <var name> name of the variable to copy from

                                ---

Procedure: Paste (in CLIPBOAR.PRG)
Action   : Paste from jClipBoard into the variable.

Usage    : paste WITH <var name>
           Types:     <var name>

Arguments: <var name> name of the variable to paste to.

                                ---

Procedure: ClipBoard (in CLIPBOAR.PRG)
Action   : Store text to the jClipBoard variable. THIS PROCEDURE MUST BE
           CALLED BEFORE ANY OF THE ABOVE!!!

Usage    : clipboard WITH <text>
           Types:         <string>

Arguments: <text> the text to store to the clipboard.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Library  : CLKLib10 (in CLKLIB10.PRG)
Action   : All of the routines in one file, for easy inclusion.
           If you use many of the functions it may be simpler to use this
           file instead of many of the others.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : Dots (in DOTS.PRG)
Action   : Appends dots ('.') to the end of a string to a given size.
           The function returns the new string.

Usage    : dots(  <name>,    <size> )
           Types: <varname>, <int>

Arguments: <name> the name of the variable that contains the string.
           <size> dots will be added to the string until it equals this length

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: DrawPict (in DRAWPICT.PRG)
Action   : Dump a special text file out to the screen, in a given color,
           at a given place.

Usage    : drawpict WITH <row>, <col>, <filename>, <color>
           Types:        <int>, <int>, <string>,   <color>

Arguments: <row>      the dump will start on this row
           <col>      the dump will start on this column
           <filename> the text file will be in this string
           <color>    the color of the text

Notes    : The file must be in this format:
            <number of lines>
            <line 1>
               .
               .
               .
            <line n>

           for example:
             2
             Hello
             There!

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : ExtractC (in EXTRACTC.PRG)
Action   : This function returns character n from within a string.

Usage    : ExtractC( <str>,    <num> )
           Types:    <string>, <int>

Arguments: <str> the string to get the character from
           <num> the number character to get

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : GetMsg (in GETMSG.PRG)
Action   : Gets a string from a special database file.  Use this to
           implement easily changed strings.  All string constants
           could be stored in this file to facilitate changes from version
           to version.

Usage    : GetMsg( <rcfile>, <topic> )
           Types:  <string>, <string>

Arguments: <rcfile> the database file name
           <topic>  the topic to return

Notes    : The database must have the character fields: TOPIC and MESSAGE
           If the given topic is not in the file, the string: "Message not
           found." will be returned.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : GetPass (in GETPASS.PRG)
Action   : Reads (and returns) a string without echoing it to the screen.
           The user can use the keys: <escape> clears all entered chars,
           <backspace> backspaces, <enter> enters the password.

Usage    : getpass( <row1>, <col1>, <size>, <color> )
           Types:   <int>,  <int>,  <int>,  <color>

Arguments: <row1>  the text entry field will be on this row
           <col1>  the test entry field will start at this column
           <size>  the maximum number of chars. in the password
           <color> the color of the text

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : IsChecked (in ISCHECKE.PRG)
Action   : Returns true if the given choice box is checked.  This function
           is passed the string returned by CheckBox().

Usage    : ischecked( <str>,    <num> )
           Types:     <string>, <int>

Arguments: <str> the string returned by CheckBox()
           <num> the number you want to check

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: NiceBox (in NICEBOX.PRG)
Action   : this procedure draws a "nice" box given two sets of coordinates.
           A nice box has a single line boarder, with a different shade for
           the top and left, and bottom and right. (a nice color setup is:
           "W+/W","B/W")

Usage    : nicebox WITH <row1>, <col1>, <row2>, <col2>, <fcolor>, <ncolor>
           Types:       <int>,  <int>,  <int>,  <int>,  <color>,  <color>

Arguments: <row1>   top left row
           <col1>   top left column
           <row2>   bottom right row
           <col2>   bottom right col
           <fcolor> color of top and left
           <ncolor> color of bottom and right

Programmer Note: this procedure does NOT clear the area under the box,
                 if you want this done either do it yourself before you
                 call this procedure, or uncomment the lines in the code.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: NiceWindow (in NICEWIND.PRG)
Action   : simply creates a "Nice" Box and then defines a window within it.
           The NiceBox procedure must be callable.

Usage    : nicewindow WITH <row1>, <col1>, <row1>, <col2>, <fcolor>, <ncolor>,
                           <name>
           Types:          <int>,  <int>,  <int>,  <int>,  <color>,  <color>,
                           <var name>

Arguments: <row1>   top left row
           <col1>   top left column
           <row2>   bottom right row
           <col2>   bottom right col
           <fcolor> color of top and left
           <ncolor> color of bottom and right
           <name>   name of the Window variable

See NiceBox

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: OKMsg (in OKMSG.PRG)
Action   : Draws a nice box with a message centered in it, and an OK
           button. The user can type <enter> or "O" or "o" to end the
           message.

Usage    : okmsg WITH <row1>, <col1>, <message>, <fcolor>, <ncolor>
           Types:     <int>,  <int>,  <string>,  <color>,  <color>

Arguments: <row1>    message box starts at this row
           <col1>    box starts at this column
           <message> the message to display
           <fcolor>  the top color of the nice box
           <ncolor>  the bottom color of the nice box

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: PJobDone (in PJOBDONE.PRG)
Action   : This draws a nice status bar that can be updated, showing
           the percent of a job that is done.

Usage    : pjobdone WITH <row1>, <col1>, <total>, <current>, <size>, <char>,
                         <fcolor>, <bcolor>, <text>
           Types:        <int>,  <int>,  <int>,   <int>,     <int>,  <char>,
                         <color>,  <color>,  <string>

Arguments: <row1>    the box starts at this row
           <col1>    the box starts at this column
           <total>   total items in the job
           <current> number of items done
           <size>    number of chars to make bar
           <char>    character to use for the graph
           <fcolor>  color of top of box
           <bcolor>  color of bottom of box (and bar)
           <text>    text to display in box

Notes    : if you have, for example, 100 records to print, <total> would
           be 100, <current> would be the number that you had already printed
           and size would be, perhaps 20, the length (in characters) of the
           bar.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: PJUpdate (in PJOBDONE.PRG)
Action   : updates the bar that has been set up with PJobDone. This
           eliminates some of the flicker that would result if you
           redrew the whole box.
           NiceBox must be callable.

Usage    : pjupdate WITH <row1>, <col1>, <total>, <current>, <size>, <bcolor>
           Types:        <int>,  <int>,  <int>,   <int>,     <int>,  <color>

Arguments: <row1>    the row of the PJobDone display to update
           <col1>    the column of the PJobDone display to update
           <total>   total size of the job
           <current> current amout done
           <size>    number of characters in the bar
           <bcolor>  the color of the bar (bottom color)

See PJobDone

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : Plural (in PLURAL.PRG)
Action   : Makes most English words plural. Handles most special cases ('es')
           Because of the exceptions of the English language, some words
           will be wrong.
           Returns the plural word.

Usage    : plural( <word> )
           Types:  <string>

Arguments: <word> the word to make plural

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : Possesive (in POSSESIV.PRG)
Action   : Makes most English words possessive. Handles most special cases.
           Because of the exceptions of the English language, some words
           will be wrong.
           Returns the possessive word.
           Can be used with Plural.

Usage    : Possesive( <word> )
           Types:     <string>

Arguments: <word> the word to make possessive.

Notes    : Yes, I know "Possesive" is spelled wrong.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : Radio (in RADIO.PRG)
Action   : Displays a Radio box, similar to the Check Box but the user
           can only select one of the choices.
           Radio returns the number of the choice.

Usage    : radio( <row1>, <col1>, <numchoices>, <color>, <mesg>... )
           Types: <int>,  <int>,  <int>,        <color>, <string>

Arguments: <row1>       the radio box will start on this line
           <col1>       the radio box will start on this column
           <numchoices> the number of choices (up to 5)
           <color>      the color of the radio box text
           <mesg>       the text for the choice - can be repeated up to
                          <numchoices> times.

Example  :
    The command:

    ? radio(1,1, 4,"B/W", "Option 1", "Option 2", "Option 3", "Option 4")

    will display at (1,1):

        (*) Option 1
        ( ) Option 2
        ( ) Option 3
        ( ) Option 4

    The user will be able to use the arrow keys and <pageup>, <pagedown>
    to move the '*'. <enter> accepts the choice.

See CheckBox
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : Ret_Can (in RET_CAN.PRG)
Action   : Displays a nice message box with a line of text at the given
           position, and allows the user to select either "Retry" or
           "Cancel". Returns .t. if user select "Retry" and .f. if
           "Cancel".

Usage    : ret_can( <row1>, <col1>, <message>, <fcolor>, <ncolor>, <default>
           Types:   <int>,  <int>,  <string>,  <color>,  <color>,  <bool>

Arguments: <row1>    the box starts at this row
           <col1>    the box starts at this column
           <message> this message is displayed
           <fcolor>  this is the "top" color of the box
           <ncolor>  this is the "bottom" color of the box
           <default> this is the default choice (enter returns this)

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : Roman (in ROMAN.PRG)
Action   : returns the roman numeral for any number up to 10 (zero returns
           "0")

Usage    : roman( <num> )
           Types: <int>

Arguments: <num> the number to convert (0-10)

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: ScrnSave (in SCRNSAVE.PRG)
Action   : displays a message at random places in given colors.

Usage    : scrnsave WITH <screen_size>, <message>, <fcolor>
           Types:        <int>,         <string>,  <color>

Arguments: <screen_size> size of the screen (25, 50, 43, etc.)
           <message>     message to display
           <fcolor>      colors of message

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: Shadow (in SHADOW.PRG)
Action   : adds a shadow to any box.

Usage    : shadow WITH <row1>, <col1>, <row2>, <col2>, <fcolor>
           Types:      <int>,  <int>,  <int>,  <int>,  <color>

Arguments: <row1>   the top left row of box to shadow
           <col1>   the top left col of box to shadow
           <row2>   the bottom right row of box to shadow
           <col2>   the bottom right col of box to shadow
           <fcolor> the color of the shadow

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : State (in STATE.PRG)
Action   : Return the name of a state given its abbreviation.

Usage    : state( <name> )
           Types: <string>

Arguments: <name> the 2 letter abrv. for the state.

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: StatusLine (in STATUSLI.PRG)
Action   : Display a status line with information about the state of the
           computer, with optional text message.
           if message passed equals ".none." then the amount of free HD
           space is given instead.
           The clock is moved to the status line.

Usage    : statusline WITH <line>, <fcolor>, <message>
           Types:          <int>,  <color>,  <string>

Arguments: <line>    statusline will be put on this line
           <fcolor>  the color of the status line
           <message> the message to display (if not ".none.")

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Procedure: UpdateSL (in STATUSLI.PRG)
Action   : updates the statusline, with less flicker.

Usage    : updatesl WITH <line>, <fcolor>, <message>
                         <int>,  <color>,  <string>

Arguments: <line>    line that the status line will be on
           <fcolor>  color of the status line
           <message> the message to display (if not ".none.")

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

Function : YesNo (in YESNO.PRG)
Action   : displays a Yes/No box with a message. The user can type "Y" or
           "N" or enter to choose the default.  Yes returns true, No returns
           false.

Usage    : yesno( <row1>, <col1>, <message>, <fcolor>, <ncolor>, <default>
           Types: <int>,  <int>,  <string>,  <color>,  <color>,  <bool>

Arguments: <row1>    the top left row of the box
           <col1>    the top left column of the box
           <message> the message to display in the box
           <fcolor>  the "top" color of the box
           <ncolor>  the "bottom" color of the box
           <default> the default choice (returned when <enter> is pressed)

------------------------------------------------------------------------------

Don't forget to register! (see the file REGISTRA.TXT) and fill out the
REG_FORM.TXT!

I hope you can make good use of these utilities! (remember this is release
1.0 - I think they're a pretty nice group of routines, but there is always
room for improvement. Send me a letter telling me what you think!

<end clklib.doc>