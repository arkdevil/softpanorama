
                           ДОКУМЕНТАЦИЯ
                     пользователю программы
                           DISTINCT.EXE

      Программа DISTINCT  поставляется  в  форме "КАК  ЕСТЬ", в
   соответствии  с принципом "AS  IS",  общепринятым в   между-
   народной  компьютерной  практике.   Это  означает,  что   за
   проблемы,  возникающие в  процессе  эксплуатации   программы
   DISTINCT, разработчик ответственности не несет.

       Содержание.

   1.  Назначение программы.
   2.  Запуск программы.
   3.  Описание параметров командной строки.
   4.  Описание выводимых на экран результатов.
   5.  Режим останова обработки.
   6.  Обработка критических ошибок.


1. Назначение программы.

      Программа DISTINCT предназначена для обнаружения и удале-
   ния дублирующих записей в базе данных формата DBF.  Под тер-
   мином "дублирующий"  понимается следующее.  Пусть записи R1,
   R2, ... , Rn   содержат одинаковую информацию т.е. совпадают
   в каждом байте, тогда записи R2, ... , Rn считаются дублиру-
   ющими.
      После обработки в базе остается только запись  R1,  а ос-
   тальные удаляются.  Следует отметить,  что после обработки в
   базе не произойдет потери информации  т.к. из нее будет уда-
   лена только "лишняя" информация.

      Вывод.   Программа позволяет уменьшить размер базы данных
               без потери информации.

      Пример использования.
      Пусть вы ведете базу данных,  в которой содержится список
   слов  английского языка, и их перевод.  База пополняется при
   встрече незнакомого слова. В этом случае, вам не нужно вспо-
   минать и искать, встречалось ли это слово ранее. Можно смело
   набить информацию, а после пополнения, воспользоваться прог-
   раммой DISTINCT.


2. Запуск программы.

      Запустить программу очень просто - достаточно  напечатать
   в командной строке  DOS слово  DISTINCT.  На экране появится
   окно, содержащее краткое изложение формата командной строки.


3. Описание параметров командной строки.

   Формат командной строки :
   DISTINCT  [ Опции ]   Элементы обработки

     Элементы обработки - список файлов и/или каталогов, разде-
   ленных друг от друга пробелами. При отсутствии списка файлов
   будет выдаваться  окно помощи.  Если  имя файла  не содержит
   имени каталога, то предполагается,  что база находится в те-
   кущем каталоге. Если имя файла не содержит расширения, то по
   умолчанию считается .DBF. Если элемент обработки каталог, то
   в данном  каталоге будут обработаны все файлы  с расширением
   DBF.

   Обнаруживаемые ошибки :
   1. Файл  ( каталог )  не существует.   Вероятно вы ошиблись,
      когда печатали имя.
      Замечание. Если вы хотите обработать корневой каталог, то
                 следует задавать D:\, а не D:.
   2. Файл не является  базой данных. Следует отметить, что эта
      ошибка может быть  не выдана, даже  если файл не является
      базой данных т.к. проводится достаточно простая проверка.

   Опции.
   1. Опции являются необязательными параметрами. Поэтому, что-
      бы отличить их от элементов обработки,  первым символом в
      параметре должен быть знак '-'.
   2. Все опции должны стоять перед списком элементов обработки.
   3. Порядок указания опций произволен.
   4. Если в списке опций  встречается неизвестный  символ,  то
      никакой ошибки не выдается. Таким образом можно написать:
      DISTINCT -pack -root  список файлов.

   Выполняемое действие и модификация, вносимая ключами.
   -p - устанавливает  режим пакования базы данных.   Если этот
        флаг не установлен, то все дублирующие записи не удаля-
        ются физически из базы данных, а просто помечаются, как
        удаленные. Таким образом по умолчанию программа работа-
        ет в режиме обнаружения.  Если флаг установлен, то про-
        изводиться физическое  удаление дублирующих записей,  и
        следовательно, база данных уменьшается в размере.

        Замечание 1. Если  до  выполнения  программы в базе су-
                     ществовали  удаленные записи,  то  они  не
                     участвуют  в обработке.  Если при этом был
                     задан  режим пакования,  то  они физически
                     удаляются  из  базы вместе  с дублирующими
                     записями.
        Замечание 2. Для  увеличения  скорости, пакование  базы
                     ведется одновременно с обработкой.

   -r - устанавливает режим обработки каталога  со всеми своими
        подкаталогами.  По умолчанию,  если параметром является
        каталог,  обрабатываются  только  те базы,  которые не-
        посредственно находятся в нем.

   Примеры.
   1. DISTINCT base1 base2 basen  -  обработать  указаные базы,
      находящиеся в текущем каталоге.
   2. DISTINCT -r  C:\ D:\  -  обработать все базы, находящиеся
      на логических устройствах C и D.
   3. DISTINCT -rp C:\ D:\  -  аналогично  предыдущему  случаю,
      но все базы будут спакованы.  Полезно давать эту команду,
      когда вам нужна дополнительная свободная память на вашем
      винчестере.


4. Описание выодимых на экран результатов.

   1. Окно результатов.
      В него выводится результаты работы программы.
      Колонки :
      База данных - содержит имена обработаных баз данных.  Имя
                    каталога для этой базы выводится  на строку
                    раньше. Если несколько  подряд  обработаных
                    баз принадлежат одному каталогу, то имя ка-
                    талога выводится только для первой из баз.
      Исходное    - содержит число записей в исходной базе.
      Дубль       - содержит число дублирующих записей в базе.
      Конечное    - содержит число записей в результирующей ба-
                    зе. Эта колонка полезна, когда используется
                    режим пакования.
      Замечание 1.  Если в режиме пакования Исходное - Дубль !=
                    Конечное,  то это  означает, что в базе уже
                    существавали записи,  помеченные,  как уда-
                    ленные.
      Замечание 2.  Если обработка базы была прервана ( возмож-
                    но по ошибке ),  то  в окно выводится соот-
                    ветствующее сообщение.

   2. Окно обработки.
      В него выводится информация по процессу обработки текущей
      базы данных. Информация переиздается через каждые  50 за-
      писей.  Если база  имеет большой объем  ( более 400 Кб ),
      т. е.  вся  не помещается в ОЗУ,  то произойдет временное
      замирание информации  на экране.  Не следует думать,  что
      програма зависла.  В  это  время  осуществляется  внешняя
      проверка т.е. проверка на совпадение записей, находящихся
      в памяти, со всеми оставшимися записями,  находящимися на
      внешнем носителе.


5. Режим останова обработки.
   В любой момент времени  вы можете  остановить обработку. Для
   этого  достаточно  нажать  клавишу  ESC.  На экране появится
   следующее окно :

          ╔════════ Обработка остановлена ═══════╗
          ║                                      ║█
          ║            Ваши действия :           ║█
          ║   Продолжить Пропустить Завершить    ║█
          ║                                      ║█
          ╚══════════════════════════════════════╝█
           ████████████████████████████████████████

      Произведите  выбор  одного  из  вариантов меню, используя
   клавиши перемещения курсором, а затем нажав Enter.

   Продлжить -  обработка будет продолжена с точки останова. Вы
                можете использовать  останов с  целью просмотра
                окна результатов.

   Пропустить - прервать обработку текущей базы данных.  В этом
                случае,  независимо  от  режима  обработки,   в
                результирующей   базе   останется   столько  же
                записей,   сколько   их   было   перед  началом
                обработки.    Полезно    использовать    данную
                возможность  при   обработке  каталога,   когда
                достоверно   известно,   что   база   не  имеет
                дублирующих  записей.  Я  бы  не   рекомендовал
                прерывать  обработку  при  установленном режиме
                пакования в  случае, когда  возможно уменьшение
                размера  базы  данных.   Причина  в  том,   что
                пакование идет одновременно с обработкой.  Хотя
                база  не  испортится,  в  ней  появятся   новые
                дублирующие записи вместо старых.
                Замечание. Если вы задали режим обработки  базы
                           и :
                а) полностью обработали базу.
                б) прервали    обработку,  а   затем   повторно
                   полностью  обработали,  то результаты работы
                   СОВПАДУТ !

   Завершить  - выполняется  то же  действие, что и  при выборе
                "Пропустить",  но  в  отличии  от   предыдущего
                случая,  программа  завершает  свою  работу, не
                пытаясь обработать следующую базу.

   Замечание.   Если  в процессе обработки возникла  ошибка, то
                будет  выдано  сообщение  об  ошибке,  и  далее
                программа  будет  выполнятся  так,  как   будто
                пользователь выбрал пункт "Пропустить".


6. Обработка критических ошибок.

   При  возникновении  критической  ошибки  появится  следующее
   окно :

          ╔══════════ Критическая ошибка ════════╗
          ║                                      ║█
          ║              Смысл ошибки            ║█
          ║         Прервать      Повторить      ║█
          ║                                      ║█
          ╚══════════════════════════════════════╝█
           ████████████████████████████████████████

   Повторить - программа   пытается    повторить    неудавшееся
               действие.  Предпологается,   что  вы   устранили
               причину ошибки.

   Прервать  - завершить    неудавшуюся   операцию.   Программа
               пытается обработать полученную ошибку, и поэтому
               возможно  повторное  появление  этого окна. Так,
               при  отсутствии   дискеты  в   дисководе,   окно
               появится 3 раза.


----------------------------- Конец ---------------------------
