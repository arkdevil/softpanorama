   FDFORMAT - Форматирование дискет с повышенной емкостью


ЛИЦЕНЗИЯ
--------

   Эта программа - свободно распространяемый продукт для частного и
образовательного применения. Вы можете свободно копировать и
использовать это без любой платы.

   Эту программу нельзя продавать для прибыли. Можно запрашивать
соответствующую плату для покрытия расходов на копирование, пересылку
и поддержку при распространении этой программы.

   Вы можете изменять и улучшать эту программу, но выполняемая программа
должна выводить сообщение что ваша версия изменилась .

   Если вы находите, что эта программа стоит вознаграждения за нее,
без колебаний высылайте наличные, чек, 3" -дискеты или что-нибудь еще.


БЛАГОДАРНОСТЬ
-------------

   Специальная благодарность следующим людям :

   Jochen Roderburg : За предложения и усовершенствования, которые
обеспечивают совместимость с несколькими версиями BIOS.

   Michael Ho : За усовершенствования в сдвиге сектора.

   Joel Armengaud : За поддержку автоматического обнаружения дискет
720 Кб в FDREAD.

   Jörg-Stefan Sell : За поддержку подпрограммы интерфейса для менее
совместимых компьютеров XT.

   Michael D. Lawler : За большое количество предложений по
усовершенствованию.

   Peter Summers : За усовершенствования в FDREAD/FDR88


КОММЕНТАРИИ И ПРОБЛЕМЫ
----------------------

   Комментарии, усовершенствования, предложения и проблемы могут быть
посланы Автору

Christoph H. Hochstätter
Carl-Strehl-Strasse 20
D-3550 Marburg
WEST-GERMANY

Телефон : +49 6421 14618 (VOICE/BTX)

ЭЛЕКТРОННАЯ ПОЧТА : HAMPE2@DMRHRZ11.BITNET (BITNET/INTERNET)
                    Christoph Hochstaetter на 2:243/22 (Fido)


ТРЕБОВАНИЯ К СИСТЕМЕ
--------------------

   IBM или совместимая ЭВМ
   ДОС 3.20 или выше


ОСОБЕННОСТИ FDFORMAT
--------------------

   FDFORMAT - замена для программы FORMAT ДОСа, которая имеет следующие
преимущества :
   1) Поддержка 3" дисководов 1.44 Мб с любыми версиями BIOS в AT и клонах.
Это сохраняет ваши деньги, если Вы нуждались в новой версии BIOS.
   2) Форматирование и использование 720/820 Кб дискет в 5" AT-дисководах
1.2 Мб, используя дешевые (DD) дискеты с удвоенной плотностью.
   3) Увеличение емкости ваших дисков на 300 Кб дополнительной памяти.
   4) Поддержка 3" формата 360 Кб. Это полезно, когда Вы хотите делать
копии 5" дискет на 3" дискеты с помощью DISKCOPY.
   5) Увеличивает скорость чтения/записи дискет до 100% с применением
сдвига сектора. Это - метод упорядочения физических секторов в полном смысле,
так что ваш дисковод готов читать следующий логический сектор, когда головка
передвигается на одну дорожку .
   6) Улучшен СЕКТОР НАЧАЛЬНОЙ ЗАГРУЗКИ, который автоматически загружает
с жесткого диска, если дискета в дисководе A: не системная. Это позволяет
Вам оставлять дискету в дисководе А:, когда вы перезагружаете систему.


НАЧАЛО
------

   Чтобы полноценно использовать FDFORMAT, Вы должны установить маленький
TSR резидент в памяти. Есть два различных TSRа для XT и АТ компьютеров.
80386/80486 компьютеры обрабатываются как АТ. TSR для АТ - FDREAD.EXE,
а для XT - FDR88.EXE. Оба TSRа используют менее 200 байтов памяти.

   Чтобы сделать FDREAD (или FDR88) резидентом просто наберите FDREAD (или
FDR88) в СТРОКЕ КОМАНДЫ ДОСа. Или установите это в вашем AUTOEXEC.BAT файле.
Если у Вас установлен администратор памяти, поддерживающий UMB (типа QEMM,
QRAM , mov'em или 386-Max), не загружайте FDREAD (или FDR88) вверх (high).
TSR автоматически обнаруживает администратора памяти и будет загружаться
вверх самостоятельно.

   FDREAD будет также автоматически загружаться вверх на ЭВМ с 286 (!!!)
процессором при использовании DOS 5.0 или выше. Вы должны иметь установленный
HIMEM.SYS (или другой XMS - ДРАЙВЕР) и поместить DOS=HIGH в вашем CONFIG.SYS
файле. Так как эта методика высоко загружающего - quite tricky, вы должны
гарантировать, этот FDREAD загружен перед любой программой, которая балуется
с линией A20 и захватывает Прерывание 13.
Это в случае для программ оптимизирующего ввода-вывода типа HYPERDISK (TM).
Если вы используете программу оптимизирующего ввода-вывода, загружайте FDREAD
перед кэширующей программой. В случае зависания системы после установки FDREAD,
загружайте FDREAD как самый первый TSR.

   Если вы получаете ошибку "Too much memory available", необходимо загружать
FDREAD дважды чтобы устранить эту ошибку.

   TSR требуется для того, чтобы поддерживать нестандартные форматы дискет.
Если вы предполагаете использовать FDFORMAT только со стандартными форматами,
вы не нуждалась в FDREAD (или FDR88).

   Заметьте, что нельзя создавать самозагружаемые дискеты, требующие TSR.
Также может быть, что формат, который может читаться без TSR на вашей ЭВМ,
будет недоступен на другой ЭВМ. Если вы создаете самозагружаемые дискеты,
рекомендуется использовать только стандартные форматы ДОСа.


ИСПОЛЬЗОВАНИЕ FDFORMAT
----------------------

   Общий Синтаксис для FDFORMAT:

      FDFORMAT <drive> [опции]

   <drive> может быть A: или B:. FDFORMAT не форматирует жесткие диски.
Опции начинаются с буквы или цифры. Опции может предшествовать '/' или
'-'. Если вы указываете опции без '/' или '-', вы должны разделять их
пробелами. '.' и ':' всегда игнорируются. Так что все следующие команды
будут форматировать Диск 1.44 Мб в Дисководе А:

   FDFORMAT А: /F:1.44
   FDFORMAT А: -F144
   FDFORMAT А: F144

   Вы можете указывать перед числами знак '$', чтобы указать, что это
шестнадцатеричные числа.


ИСПОЛЬЗУЕМЫЕ В FDFORMAT ОПЦИИ
-----------------------------

   Наиболее важная опция - F. Опция F определяет общий Формат, используемый
для целевой дискеты.

   Следующая таблица показывает какие параметры и для каких дисководов
допустимы в опции F :

F-Opt Format          360k-Drive 720k-Drive 1.2M-Drive 1.44M-Drive
----- --------------- ---------- ---------- ---------- -----------
F160  160 kByte Disk  yes        FDREAD     yes        FDREAD
F180  180 kByte Disk  yes        FDREAD     yes        FDREAD
F200  200 kByte Disk  FDREAD     FDREAD     FDREAD     FDREAD
F205  205 kByte Disk  FDREAD     FDREAD     FDREAD     FDREAD
F320  320 kByte Disk  yes        FDREAD     yes        FDREAD
F360  360 kByte Disk  yes        FDREAD     yes        FDREAD
F400  400 kByte Disk  FDREAD     FDREAD     FDREAD     FDREAD
F410  410 kByte Disk  FDREAD     FDREAD     FDREAD     FDREAD
F720  720 kByte Disk  no         yes        FDREAD     yes
F800  800 kByte Disk  no         FDREAD     FDREAD     FDREAD
F820  820 kByte Disk  no         FDREAD     FDREAD     FDREAD
F120  1.2 MByte Disk  no         no         yes        yes
F12   1.2 MByte Disk  no         no         yes        yes
F144  1.44 MByte Disk no         no         FDREAD     yes
F14   1.44 MByte Disk no         no         FDREAD     yes
F148  1.48 MByte Disk no         no         FDREAD     yes
F16   1.6 MByte Disk  no         no         no         FDREAD
F164  1.64 MByte Disk no         no         no         FDREAD
F168  1.68 MByte Disk no         no         no         FDREAD
F172  1.72 MByte Disk no         no         no         FDREAD

   FDREAD в таблице означает, этот этот формат будет работать только, если
установлен FDREAD (или FDR88). Вы можете выяснить, что эта таблица не будет
соответствовать для вашей машины и что вы можете использовать определенные
форматы дискеты и без FDREAD (или FDR88).

   Другие опции:

1    : Форматировать односторонний Диск (совместимый формат ДОСА).
4    : Форматировать Стандартный 360 Кб диск (совместимый формат ДОСА).
8    : Форматировать Диск с 8 секторами (совместимый ФОРМАТ ДОСА ).
А    : Использовать для переключения на различные типам дискет только
       вызовы BIOS.
Bnnn : Использовать БАЙТ ТИПА ДИСКА nnn (для применения с более старыми
       Версиями BIOS).
Cnnn : Использовать nnn Секторов на Кластер (nnn = 1 или 2).
Dnnn : Использовать nnn входов корневого каталога (nnn = 1-224).
Gnnn : Использовать ДЛИНА ПРОМЕЖУТКА nnn (для применения только экспертами).
Hnnn : Использовать nnn головок (nnn = 1 или 2).
Innn : Использовать Чередование (Interleave) nnn (для применения только
       экспертами).
K    : не ждaть ввода с клавиатуры, при старте FDFORMAT (Полезно, при запуске
FDFORMAT из командных файлов).
Mnnn : Использовать Media-Descriptor-Byte nnn (Полезно при форматировании
       дисков для ATARI ST).
Nnnn : Использовать nnn Секторов.
O    : Форматировать диск 720 Кб для применения с AT&T/OLIVETTI M24/M28.
Q    : Быстрый Формат. Перезаписывает только системную ОБЛАСТЬ.
R    : не проверять диск (и сохранить 33% времени).
S    : Сделать СИСТЕМНЫЙ ДИСК.
Snnn : Использовать nnn Секторов.
Tnnn : Использовать nnn Дорожек.
U    : Безоговорочно форматировать дискету.
V    : Записать Метку Диска.
W    : Форматировать без стирания. Физически переформатирует дискету без
       потери данных.
Xnnn : Сдвиг на nnn Секторов при смене головки.
Ynnn : Сдвиг на nnn Секторов при смене дорожки.

   Примеры :

FDFORMAT A: /4                             (форматировать 360 Кб диск)
FDFORMAT А: /F:1.72                       (форматировать диск 1.72 Мб)
FDFORMAT А: /T:80 /N:9                     (форматировать диск 720 Кб)
FDFORMAT А: /O             (форматировать диск 720 Кб для AT&T M24/28)
FDFORMAT А: /F:720 M$F7 B$54  (форматировать диск 720 Кб для ATARI ST)
FDFORMAT А: /F:12 D64    (форматировать диск 1.2 Мб с 64 входами Root)
FDFORMAT А: /F:410 R          (форматировать диск 410 Кб без проверки)


ПОДРОБНОЕ ОПИСАНИЕ ОПЦИЙ
------------------------

Опции Q и U
-----------

   Начало с версии 1.8 FDFORMAT форматирует диски тем же способом, что и
FORMAT ДОСа 5.0. Если Q и U опции не определяются, FDFORMAT проверяет,
сфоматирована ли уже дискета в том формате, который Вы выбрали. Если
это так, FDFORMAT только проверяет диск и перезаписывает системную область.
Если диск форматируется в другом формате, выполняется действительное
низкоуровневое форматирование. Если вы определяете опцию U, дискета будет
подвергнута низкоуровневому форматированию в любом случае .

   Опция Q определяет быстрое форматирование. FDFORMAT пробует определять
текущий формат дискеты и затем только перезаписать системную область. При
определении опции Q все опции, определяющие другой формат игнорируются.
FDFORMAT будет также пропускать проверку, если выбрана опция Q. Если выбрана
опция Q и FDFORMAT не может найти сектор начальной загрузки, дискета будет
отформатирована низкоуровневым форматом который вы определили.


Опция Tnnn - Использовать nnn Дорожек
-------------------------------------

   Эта опция сообщает FDFORMAT сколько должно использоваться дорожек.
Стандартная дискета 360 Кб имеет 40 дорожек, все другие стандартные форматы
имеют 80 дорожек. Вы можете устанавливать эту опцию в 1 - 41 для дисковода
360 Кб и в 1 - 82 для всех других дисководов. Чем больше дорожек вы
используете, тем больше памяти получите. Некоторые дисководы поддерживают
даже больше чем 41 или 82 доржки, но может возникнуть проблема при попытке
чтения этой дискеты на другом дисководе. По умолчанию - 40 для Дисковода
360 Кб и 80 для всех других дисководов .

   Пример : FDFORMAT А: /T:41 ( форматирует диск с 41 дорожкой. Это даст
емкость диска 369 Кб в дисководе 360 Кб)


Опция Nnnn - Использовать nnn Секторов на Дорожке
-------------------------------------------------

   Эта опция определяет число секторов на дорожке, которое вы будете
использовать. Стандартные и значения по умолчанию для различных форматов:
Формат Диска  стандартное значение  макс. возможное значение
------------  --------------------  ------------------------
360 kб            9                  10
720 kб            9                  10
1.2 Mб           15                  18
1.44 Mб          18                  21

   Вы можете использовать эту опцию, чтобы увеличить емкость вашей дискеты.

   Пример: FDFORMAT А: /N:10 (форматирует диск с 10 секторами. Это даст
емкость 400 Кб в дисководе 360 Кб).


Опция Hnnn - Использовать nnn сторон (1 или 2)
----------------------------------------------

   Вы можете устанавливать эту опцию в 1 или 2. По умолчанию - всегда 2.
Обычно вы не нуждаетесь в этой опции, так как односторонние диски редко
используются.


Использование T, N и H вместе
-----------------------------

   Эти три опции определяют емкость дискеты. Формула емкости дискеты:

                      дорожки * сектора * стороны
      емкость в Кб = ---------------------------
                                   2

   С применения обычных 2 сторонних дискет, вы можете упростить эту формулу:

   емкость в КБ = дорожки * сектора

   Примеры: FORMAT A: /T:80 /N:9 /H:2 (форматировать диск 720 Кб)
            FORMAT A: /T:82 /N:10 /H:2 (форматировать диск 820 Кб)
            FORMAT A: /T:40 /N:9 /H:2 (форматировать диск 360 Кб)
            FORMAT A: /T:41 /N:10 /H:2 (форматировать диск 410 Кб)

   Вы можете использовать опцию F (описанную выше) как сокращение для опций
T, H и N (напр. FORMAT A: /F:1.44 то же что FORMAT A: /T:80 /N:18 /H:2).

   Примечание: Всегда используйте дискеты ВЫСОКОЙ ПЛОТНОСТИ (HD), когда Вы
форматируете с более чем 11 секторов/дорожку и всегда используйте дискеты
двойной плотности (DD), когда вы форматируете с 10 секторами и ниже.

   Просмотрите следующую таблицу чтобы видеть, как оценивается максимум
для T, H и N.

Дисковод/дискета            макс.T  макс.N  макс.H  емкость
--------------------------  ------  ------  ------  -------
360 kб / DD                   41      10       2    410 kб
720 kб / DD                   82      10       2    820 kб
1.2 Mб / DD                   82      10       2    820 kб
1.2 Mб / HD                   82      18       2   1.48 Mб
1.44 Mб/ DD                   82      10       2    820 kб
1.44 Mб/ HD                   82      21       2   1.72 Mб


Опция Cnnn - Использовать nnn секторов в кластере (1 или 2)
-----------------------------------------------------------

   Кластер - минимальная единица распределения дискового пространства,
которую может обрабатывать ДОС. ДОС поддерживает 1 или 2 сектора на кластер
для гибких дисков. Если вы определяете /C:1 - объем диска распределяется с
дискретностью 512 Байтов, /C:2 - 1024 Байта. Вы можете оптимизировать
организацию дискеты, если используете /C:1, когда вы планируете сохранять
большое количество маленьких файлов, и /C:2 , когда вы планируете сохранять
небольшое количество больших файлов на форматируемом диске. По умолчанию -
/C:1 для дисков с высокой плотностью и /C:2 для дисков двойной плотности.

   Пример : FORMAT A: /F:360 /C:1 (форматирует диск 360 Кб с 1 сектором на
кластер)

   Примечание: пространство форматируемого диска с /C:2 всегда имеет большее
число свободных байтов, чем с /C:1. Но когда файлы будут сохранены на диске,
ваше дисковое пространство будут обработаны более динамично.


Опция Dnnn - Использовать nnn ВХОДОВ КОРНЕВОГО КАТАЛОГА
-------------------------------------------------------

   Эта опция определяет число ВХОДОВ КОРНЕВОГО КАТАЛОГА. По умолчанию - 112
для дисков двойной плотности и 224 для дисков с высокой плотностью. Это
значение может быть уменьшено, чтобы получить дополнительное пространство на
диске, или увеличено до 240 чтобы зарезервировать пространство для большего
числа файлов в корневом каталоге. Эта опция не влияет на любой из подкаталогов.
Подкаталоги распределяются динамически. Вы должны определять размер только
корневого каталога. Допустимые значения для дисков с 1 сектором на кластер -
16, 32, 48, ...; для дисков с 2 секторами на кластер - 16, 48, 80, ...
Если вы определяете значение между двумя допустимыми значениями, оно будет
автоматически увеличиваться к следующему допустимому значению.

   Пример : Вам нужен диск, который не будет иметь больее 40 файлов в
корневом каталоге. Наберем: FDFORMAT А: /D:40. Вы получите диск с 48 входами
корневого каталога и большее пространство для данных.


Опции O - Форматировать диск для компьютера AT&T/OLIVETTI M24/M28
-----------------------------------------------------------------

   Эта опция фактически - сокращение для /T:80 /N:9 /H:2 /D:144. Компьютеры
AT&T и Olivetti M24/M28 используют Диски 720 Кб с 144 входами корневого
каталога. Стандартный IBM формат 720 Кб имеет 112 входов корневого каталога.
Таким образом, просто используйте /O опцию чтобы форматировать дискету в 5"
дисководе 1.2 Мб или 720 Мб.

   Пример : FDFORMAT : /O

   Примечание : Если вы не могли читать диски M24/M28 720 Кб в вашем
дисководе 1.2 Мб до сих пор, попробуйте снова с установленным FDREAD.
Это будет прекрасно работать.


Опция Mnnn - Определить Media Descriptor
----------------------------------------
   FDFORMAT использует тот же самый Media descriptor что и FORMAT ДОСa.
   Если вы измените это значение, это не даст никакого эффекта под ДОСом
3.3x или выше. Но вы не сможете читать диск под ДОСом 3.2x или ниже. Эта
опция добавлена, чтобы обеспечить форматирование дисков для ATARI ST.
Обратитесь к Документации по ATARI чтобы устанавливать правильные Значения
для Media Descriptor и числа дорожек, головок, секторов.


Опция R - не проверять диск
---------------------------

   Опция R пропускает проверку каждой дорожки после того, как она была
отформатирована.

   Это сохраняет 33%-50% времени в течение форматирования дискеты.
Недостаток тот, что ошибки на дискете не будут обнаружены. Типичный пример:
для отсутствия обнаружения ошибок набираем FDFORMAT А: /R, в дисковод 1.2 МБ
вставлен диск двойной плотности - FDFORMAT в этом случае не будет сообщать
ни о каких ошибках. Если вы не сомневаетесь в том, что имеете хорошую дискету
и вы не определили никакие неправильные параметры, опция /R - хороший выбор
чтобы сохранить время.


Опция K - Никакого ввода с клавиатуры
-------------------------------------

   Опция K подавляет сообщение "Insert new disk in drive..." и начинает
форматирование немедленно после запуска FDFORMAT. Это полезно, если вы
хотите стартовать FDFORMAT из командного файла или внешней программы. Вы
можете также подавить любой вывод на экран, если добавите ">NUL" к команде
FDFORMAT (См. Руководство по ДОС - конвейерные пересылки ввода и вывода).
FDFORMAT  возвращает код завершения или уровень ошибки , который
может использоваться в командных файлах . Коды завершения :

Код Завершения   Значение
-------------------------------------------------------------
  0         нормальное завершение
  1         ошибка синтаксиса или запрещенные параметры
  2         указанный дисковод не может форматироваться
  3         невозможно определить формат для формата без стирания
  4         прерван пользователем (после ошибки ввода/вывода или CTRL-BREAK)
  8         ошибка ввода/вывода для файла конфигурации
 16         ошибка синтаксиса или запрещенные параметры в файле конфигурации
 32         ошибка записи метки тома
128         неправильная версия ДОСа ( < 3.20 )


Опция S - Форматирование системного диска
-----------------------------------------

   Опция S позволяет вам форматировать системный диск. При этом на ваш диск
копируются сектор начальной загрузки, системные файлы ДОСА и COMMAND.COM.
FDFORMAT не делает эту задачу самостоятельно, а вызывает КОМАНДУ ДОСА SYS,
чтобы она это сделала. Таким образом, вы должны удостовериться что, SYS.COM
или SYS.EXE находится в каталоге, который включен в Системной Переменной PATH.
Вызов SYS сделан так, чтобы гарантировать совместимость с любой Версией ДОС.

   Примечание: Вы не можете создавать системный диск, который не читается
без FDREAD.

   Пример : FDFORMAT А: /F:360 /S   (правильно)
            FDFORMAT А: /F:410 /S   (неправильный, потому что этот формат
                                     требует FDREAD)


Опция 1 - Односторонний диск
----------------------------

   Это - то же самое, что /H:1, обеспечивает совместимость синтаксиса с
программой FORMAT ДОСа.


Опция 8 - диск с 8 секторами
----------------------------

   Это - то же самое, что /S:8, обеспечивает совместимость синтаксиса с
программой FORMAT ДОСа.


Опция 4 - диск 360 Кб
---------------------

   Это - то же самое, что /F:360, обеспечивает совместимость синтаксиса с
программой FORMAT ДОСа.


Опция P - Не делает ничего
---------------------------

   Эта опция действительно не делает ничего в FDFORMAT Версиях выше 1.2,
обеспечивает совместимость с более ранними версиями .


Опция V - Записать метку тома
-----------------------------

   Эта опция записывает метку тома на диск. Вы можете определять просто /V.
При этом впоследствии будет запрос метки тома. Вы можете также определять
/V:<метка_тома>. При этом на ваш диск будет записана метка <метка_тома>.

   Пример: FDFORMAT А: /F:820 /V   (запрашивает метку тома)
           FDFORMAT А: /V:MYDISK   (записывает метку тома MYDISK)


Опции X и Y - Реализовать сдвиг сектора
---------------------------------------

   Эти опции могут использоваться, чтобы улучшить эффективность вашего диска
до 100%. Этот момент - трудный для объяснения. Вообразите стандартный диск
360 КБ. Он имеет 9 секторов на каждой дорожке с номерами от 1 до 9. Обычно
сектора на всех дорожках имеют порядок "1 2 3 4 5 6 7 8 9". Со сдвигом
сектора на 1 вы делаете порядок "1 2 3 4 5 6 7 8 9" на 0-й дорожке,
"9 1 2 3 4 5 6 7 8" на 1-й дорожке, "8 9 1 2 3 4 5 6 7" на 2-й дорожки
и так далее.

   Вы можете легко представить, что требуется некоторое время, чтобы головки
дисковода перешли от одной дорожки к другой. Но дискета продолжает вращаться.
Без сдвига сектора к моменту окончания перемещения головок дискета
установится на 3-й или 4-й сектор. Потребуется почти полное вращение пока
не появится возможность чтения 1-го сектора следующей дорожки. Со сдвигом
сектора на 1 или 2 к началу чтения дискета установится точно на 1-й сектор.

   Программа FORMAT ДОСа всегда форматирует со сдвигом сектора 0.
FDFORMAT обеспечивает два параметра чтобы делать сдвиг сектора.
/Xn сдвигает на n секторов, когда сменяется головка, но не дорожка.
/Ym сдвигает на m секторов, когда сменяется дорожка. Обычно полезен только
/Y, но на некоторых системах, особенно XT, вы можете достигнуть
дополнительного быстродействия при использовании /X.

   Теперь о том, как определить правильное значение для сдвига сектора.
В общем, можно сказать, что хорошие значения для /X 0-2 и для /Y 0-4. По
умолчанию - 0 для /X и /Y. Вы должны поэкспериментировать с вашей
конфигурацией, чтобы оценить оптимальные для вас значения. Вы можете
реконфигурировать сдвиг сектора по умолчанию в FDFORMAT.CFG файле
(будет описан позже). Вы должны выяснять это для каждого формата отдельно.
Всегда хороший выбор - следующий:

Размер диска       Хороший выбор для сдвига сектора
------------------ ------------------------------------
320-410 kб              /X:1 /Y:3
720-820 kб              /X:1 /Y:2
1.2 MB-1.72 Mб          /X:2 /Y:3

   Это улучшит производительность дискет на 50%-100% в почти любой системе.

   Пример: FDFORMAT А: /4 /X:1 /Y:2 /R/K/V:SLIDE_DISK


Опция W - Форматирование без стирания
-------------------------------------

   Эта опция используется чтобы переформатировать дискету. Это полезно,
когда вы имеете дискету, которая еще читается, но только с несколькими
повторениями. Это частый случай, если вы пробуете читать Дискету 360 Кб в
дисководе 360 Кб, после того как на нее была выполнена запись в дисководе
1.2 мб.

   Если вы выберете эту опцию, на дискете не будет никаких изменений.
Если вы, например, определите другой формат или метку тома, то эти опции
игнорируются. Дискета будет считана дорожка за дорожкой. После того, как
дорожка будет переформатирована, данные записываются обратно на дискету.

   Совершенно безопасно можно нажать CTRL-BREAK в течение форматирования без
стирания, потому что запрос прерывания программы регистрируется, когда вы
нажимаете CTRL-BREAK, а выполняется только когда текущая дорожка полностью
будет записана.


Опция А - Для смены типа диска использовать только вызовы BIOS
--------------------------------------------------------------

   Эта опция сообщает, чтобы FDFORMAT использовать только вызовы BIOS, чтобы
изменять тип дискеты и чтобы не записывать Media Byte непосредственно.
Эта опция требуется в большинстве XT-систем с HD-контроллерами и внешними
дисководами. Это типичный недостаток, так как некоторые Версии BIOS не на
каждом приводе поддерживают все типы носителей. Итак, используйте эту опцию
только, если вы столкнетесь с подобной проблемами. Эта опция также может
быть указана в файле FDFORMAT.CFG файле (см. ниже).


Опция Innn - Использовать Чередование nnn
-----------------------------------------

   Опция I изменяет Параметр Чередования (Interleave factor) секторов при
форматировании дискеты.

   Обычно лучшее чередование - 1, таким образом требуется единственный
оборот чтобы читать всю дорожку. Но имеются два исключения из этого. При
форматировании 3" HD-диска с 21 сектором или 5" HD-диска с 18 секторами
необходимо чередование 2, потому что в этом случае сектор данных используется
как ПРОМЕЖУТОК. Если вы не использовали чередование по крайней мере 2, диск
может стать нечитабельным .

   Но вам не нужно соблюдать осторожность относительно этой опции, FDFORMAT
автоматически определяет лучшее чередование (1 или 2). Однако, вы можете
устанавливать любое свое чередование, но единственый эффект, которого Вы
при этом достигаете - ваш диск становится медленнее.

   Пример: FDFORMAT А: /I:6    (форматируют очень медленный диск)


Опция Gnnn - Определить длину ПРОМЕЖУТКА
----------------------------------------
   Длина ПРОМЕЖУТКА (Gap length) - заполненное пространство между двумя
секторами на одной дорожке. Как и с Чередованием, FDFORMAT определяет лучшее
значение. Вы можете уменьшить длину ПРОМЕЖУТКА чтобы ускорить вашу дискету.
Но это уменьшит вашу безопасность при сохранении данных, если вы не выберете
чередование 2. В результате чередование решительно замедлит дисковую
эффективность. Если вы хотите уменьшить длину ПРОМЕЖУТКА все равно, не
устанавливайте его ниже 32 для дисков с высокой плотностью и ниже 40 для
дисков двойной плотности.

   Для безопасности ваших данных рекомендуется не изменять длину ПРОМЕЖУТКА.
Сдвиг Сектора - лучший метод ускорения эффективности дискеты, не
воздействующий на безопасность ваших данных.


Опция Bnnn - Установка байта типа диска
---------------------------------------

   Эта опция действует только на компьютерах 80286/80386/80486 и должна
устанавливаться, если вы имеете несовместимый или более старый BIOS, который
не обеспечивает Дисководы 1.44 Мб. Используется в файле FDFORMAT.CFG,
описанном позже. Этот байт состоит из следующих компонентов :

Группа  Десят.  Шестн.     Значение
-----------------------------------------------------------------
         0         0       Media Type неизвестен
 1      16        10       Media Type известен
-----------------------------------------------------------------

        32        20       удвоенный шаг (40 дорожек)
 2       0         0       одиночный шаг (80 дорожек)
-----------------------------------------------------------------
         0         0       скорость обмена данными: 500 кбод
        64        40       скорость обмена данными: 300 кбод
 3     128        80       скорость обмена данными: 250 кбод
-----------------------------------------------------------------
         0         0       360 kб диск в 360 kб дисководе, без проверки
         1         1       360 kб диск в 1.2 Mб дисководе, без проверки
         2         2       1.2 Mб диск в 1.2 Mб дисководе, без проверки
         3         3       360 kб диск в 360 kб дисководе, с проверкой
         4         4       360 kб диск в 1.2 Mб дисководе, с проверкой
         5         5       1.2 Mб диск в 1.2 Mб дисководе, с проверкой
 4       7         7       состояние не определено (3"-дисковод)
-----------------------------------------------------------------

    Чтобы получить правильное значение для вашего формата, выбирают одно
значение из каждой группы и складывают эти значения. Обычно байт Media type
будет установлен правильно, если следовать правилам:

   1 Группа: Всегда устанавливать в 16
   2 Группа: 32, если число дорожек 1-43, иначе 0
   3 Группа: диски с высокой плотностью: всегда 0
             диски двойной плотности: 64 для 5", 128 для 3"
   4 Группа: всегда уставливать в 3

   Почему 4 группу всегда устанавливать в 3 ? Из-за проблемы с DTK-BIOS.
DTK-BIOS, кажется, не работает с любым другим значением чем 3. Все другие BIOS,
Версии Которых Мы проверили, кажется, игнорируют Значение 4 Группы. Так что
это будет лучший выбор - устанавливать всегда в 3. В редких случаях Ваша
Система не будет работать со значением по умолчанию. В этом случае, пробуйте
любые значения 0-7 для 4 Группы. Это должно сработать по крайней мере с одним
значением. Если вы определили правильное значение, можно записать это в файл
FDFORMAT.CFG.


КОНФИГУРИРОВАНИЕ FDFORMAT ПОСРЕДСТВОМ FDFORMAT.CFG
--------------------------------------------------

   Прежде, чем вы начинаете установку файла конфигурации, вы должны
пробовать, все ли форматы будут работать правильно. FDFORMAT обычно
автоматически определяет лучшие опции. Если что-нибудь приведет к неудаче,
тогда следует установить файл конфигурации.

   Вы должны также создать файл конфигурации, если имеете одну из
следующих ситуаций:

   1 ) Вы имеете XT с контроллером с высокой плотностью для поддержки
дисководов 1.2 Мб или 1.44 Мб.
   2 ) Вы имеете AT c дисководом 1.44 Мб, но не можете установить его вашей
программой SETUP (например IBM/Advanced diagnostics) .
   3 ) Вы имеете XT ( подобно EPSON QX-16 или AT&T/OLIVETTI M24/M28 ) ,
который имеет один или большее количество дисководов 720 Кб, поддерживающий
дискеты 360 Кб.
   4 ) Вы имеете 5" дисковод 720 Кб на AT.


Формат файла конфигурации FDFORMAT.CFG
--------------------------------------

   Общий формат для FDFORMAT.CFG :

<drive>: [XT|AT] [BIOS] [40=n] [80=n] [F=n] [360=n] [720=n] [1.2=n]
[1.44=n] [X=n [Y=n]

   Пример для файла конфигурации :

REM Конфигурирует дисковод B: для 1.44 Мб
B: AT BIOS F=7 360=$B7 1.44=$17 720=$97 X=2 Y=2

REM Конфигурирует дисковод A: для 5" 720 Кб
A: AT F=2 BIOS 720=$54 X=0 Y=0
REM Все числа, которым предшествует знак $ - шестнадцатеричные

   Опции в подробности :

XT   : Сообщает FDFORMAT, что ваша ЭВМ - XT или совместимая и не выполняет
       никакие функции AT-BIOS. Эта опция необходима, если только FDFORMAT не
       распознает автоматически, что ваша ЭВМ - XT. Эта опция также необходима,
       если ваш XT обеспечивает дисководы 720 Кб, которые могут обрабатывать
       также дискеты 360 Кб.

AT   : Сообщает FDFORMAT, что ваша ЭВМ - 80286/386 или 80486 или XT,
       поддерживающая AT-BIOS функции. Эта опция необходима, если только
       FDFORMAT не распознает, что вы можете использовать функции AT-BIOS.
       Типичный случай, когда вы нуждаетесь в этом параметре, если вы имеете
       XT с установленным контроллером высокой плотности.

BIOS : Эта опция работает только с AT-подобным BIOS. Она сообщает FDFORMAT,
       чтобы не изменять байт типа диска непосредственно, как принято по
       умолчанию, а пробовать изменять информацию формата через ВЫЗОВЫ BIOS.
       Эта опция должна использоваться, только если без нее FDFORMAT не
       работает. Опция BIOS имеет типичный недостаток тот, что некоторые
       версии BIOS не поддерживают все форматы для всех дисководов.В этом
       случае вы должны устанавливать байт типа диска для неподдерживаемого
       формата в вашем файле конфигурации. Эта опция описана позже.

40   : Эта опция работает только с небольшим числом версий XT-BIOS для
       дисководов 720 Кб. Вы можете определить смещение к физическому номеру
       дисковода при вызове дисковых операций ввода/вывода, который указывают,
       что вставлена 40-Дорожечная дискета (360 Кб). Обычно эта опция
       установлена в 0.

80   : Эта опция работает с большинством версий XT-BIOS, поддерживающими
       Дисководы 720 Кб, которые также могут обрабатывать дискеты 360 КБ.
       Это ,например, AT&T M24/M28 или EPSON-QX16. Наиболее часто используется
       смещение 64. Попробуйте сначала 64, если это не сработает - попробуйте
       32, 16, 8, 4 или 2. Не пробуйте другие значения, они не будут работать.

F    : Эта опция должна устанавливаться только, если ваш BIOS не обеспечивает
       требуемый тип дисковода. Вы нуждаетесь в этой опции, если имеете
       установленный дисковод 1.44 Мб, а BIOS его не поддерживает. Если вы
       хотите устанавить эту опцию используйте следующие значения :
       F=0 для Дисковода 360 КБ, F=1 для дисковода 1.2 МБ, F=3 для Дисковода
       720 КБ и F=7 для дисковода 1.44 Мб.

360  : Используйте эту опцию для установки другого байта типа диска для дискет
       360 КБ, чем значение по умолчанию $73. Если вы установили опцию BIOS,
       формат 360 Кб не будет установливаться через BIOS, а будет
       непосредственноно использовано заданное значение байта типа диска.
       Обратитесь к опции B командной строки, чтобы увидеть как можно
       правильнее определить байт типа диска.

720  : То же, что 360, но для формата 720 Кб.
1.2  : То же, что 360, но для формата 1.2 Мб.
1.44 : То же, что 360, но для формата 1.44 Мб.

X    : Может использоваться чтобы отменять значение по умолчанию для сдвига
       сектора при смене головки.
Y    : Может использоваться чтобы отменять значение по умолчанию для сдвига
       сектора при смене дорожки.


Примеры Файла Конфигурации
--------------------------

A: XT PC80=64                         дисковод 720 Кб в XT подобной AT&T M24
A: AT F=7                             дисковод 1.44 Мб в AT или XT
A: AT F=1                             дисковод 1.2 Мб в AT или XT
A: AT F=2 720=$57 360=$74             5" дисковод 720 Кб в AT
A: AT F=2 720=$53 360=$73             5" дисковод 720 Кб в АТ & DTK-BIOS

____________________________________________________________________________

Руководство по использованию FDFORMAT 1.80

Машинный перевод выполнен с помощью пакета MULTIS.
Редактирование: А. Сесса (извините, ошибки искать было некогда).
