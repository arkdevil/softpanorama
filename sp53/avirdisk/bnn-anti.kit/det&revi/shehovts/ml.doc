



                               Маскоискатель.
                             ( Mask Looker 1.1 )


  Маскоискатель (далее- ML) предназначен как вспомогательная программа для
Вирусного Локатора (VL). ML исследует файлы, зараженные одним и тем же вирусом
и выводит в текстовом виде распечатку шестнадцатиричных кодов вируса. Те коды,
которые изменяются при размножении вируса, заменяются символом подчеркивания.
  Таким образом, после запуска ML вы получите готовую маску для Вирусного
Локатора.


                       1. Работа с ML.

  Необходимо поместить зараженые одним и тем же вирусом файлы в один каталог,
заменить их расширение на .VIR и запустить ML, находясь в этом каталоге. При
работе ML на экран выводится имя текущего обрабатываемого файла, его размер
и точка входа (первый исполняемый оператор). Начиная с точки входа читается
блок размером до 4 Кб. Затем блоки сравниваются.По окончании работы
Маскоискателя в текущем каталоге будет создан файл MASK.ML, хранящий информацию
об обработанных файлах и содержащий распечатку кодов вируса. Пример такой
распечатки приводится в конце данного документа.
  Желательно иметь не менее трех зараженных файлов для надежного выбора маски.
  Если в текущем каталоге окажется только один файл с расширением .VIR, то в
результате работы Маскоискателя вы получите просто дамп вируса из этого файла.
  ML версии 1.1 отличается от 1.0 тем, что распознает как EXE-файлы не только
файлы с двумя первыми байтами 'MZ', но и с 'ZM' (недокументированное свойство
MS DOS).

                       2. Ограничения.

  Рекомендуется использовать Маскоискатель отдельно для сканирования .COM и
отдельно для .EXE файлов. Существуют вирусы, которые по-разному заражают файлы
этих двух типов, и для таких вирусов "смешанное" сканирование зараженных файлов
приведет к некорректному результату.


                       3. Пример.

  Ниже приводится файл MASK.ML, полученный в результате обработки Маскоискателем
нескольких программ, зараженных вирусом C534 Microsoftyright.
  В правом столбце (ASCII коды) точками заменяются управляющие символы (со зна-
чением меньше 32), подчерком - коды, несовнадающие в дампах разных файлов.
  JMP= означает позицию первого исполняемого оператора программы.




                   Mask Looker ver 1.1
Detecting of viruses in infected files with .VIR extension

Mask Looker was written by Shehovtsov Alexander , KIEV, TechnoSoft
             Tel. 266-00-97 (Kiev) from 9.00 till 18.00

File COMMAND.VIR size= 25842 JMP=25308
File MORE.VIR size= 816 JMP=282
File COMP.VIR size= 4717 JMP=4183
File LABEL.VIR size= 2880 JMP=2346
File MODE.VIR size= 15974 JMP=15440
Dump length=534
Processed correctly 5 files



   0| 50 BE __ __ 8B D6 81 C6 00 00 FC B9 03 00 BF 00     P╛__Л╓Б╞..№╣..┐.
  16| 01 F3 A4 8B FA B4 30 CD 21 3C 00 75 03 E9 3F 01     .єдЛ·┤0═!<.u.щ?.
  32| BA 2C 00 03 D7 8B DA B4 1A CD 21 BD 00 00 8B D7     ║,..╫Л┌┤.═!╜..Л╫
  48| 81 C2 07 00 B9 03 00 B4 4E CD 21 E9 04 00 B4 4F     Б┬..╣..┤N═!щ..┤O
  64| CD 21 73 15 3C 12 74 03 E9 0D 01 83 FD FF 75 03     ═!s.<.t.щ..Г¤ u.
  80| E9 05 01 4A BD FF FF EB DB 8B 4F 18 81 E1 E0 01     щ..J╜  ы█ЛO.Бср.
  96| 81 F9 A0 01 74 D8 81 7F 1A 00 FA 77 D1 81 7F 1A     Б∙а.t╪Б..·w╤Б.

                      ...

 272| 02 CD 21 73 03 E9 1E 00 3D 16 02 75 19 B8 00 42     .═!s.щ..=..u.╕.B
 288| B9 00 00 8B D1 CD 21 72 0D B4 40 B9 03 00 8B D7     ╣..Л╤═!r.┤@╣..Л╫
 304| 81 C2 03 00 CD 21 8B 8D 24 00 8B 95 26 00 81 E2     Б┬..═!ЛН$.ЛХ&.Бт
 320| 1F FE 81 CA A0 01 B8 01 57 CD 21 B4 3E CD 21 B8     .■Б╩а.╕.W═!┤>═!╕
 336| 00 43 8B 8D 22 00 CD 21 BA 80 00 B4 1A CD 21 58     .CЛН".═!║А.┤.═!X
 352| BF 00 01 57 C3 __ __ __ E9 __ __ 5C 3F 3F 3F 3F     ┐..W├___щ__\????
 368| 3F 3F 3F 3F 2E 43 4F 4D 00 __ __ __ __ __ __ __     ????.COM._______
 384| __ __ __ __ 00 00 00 20 00 __ __ __ __ 00 00 00     ____... .____...
 400| 00 __ 3F 3F 3F 3F 3F 3F 3F 3F 43 4F 4D 03 __ 00     ._????????COM._.
 416| 00 00 __ __ __ __ 20 __ __ __ __ __ __ 00 00 __     ..____ ______.._
 432| __ __ __ __ __ __ __ __ __ __ 00 00 6F 73 6F 66     __________..osof
 448| 74 79 72 69 67 68 74 20 4D 69 63 72 6F 73 6F 66     tyright Microsof
 464| 74 79 72 69 67 68 74 20 4D 69 63 72 6F 73 6F 66     tyright Microsof
 480| 74 79 72 69 67 68 74 20 4D 69 63 72 6F 73 6F 66     tyright Microsof
 496| 74 79 72 69 67 68 74 20 4D 69 63 72 6F 73 6F 66     tyright Microsof
 512| 74 79 72 69 67 68 74 20 4D 69 63 72 6F 73 6F 66     tyright Microsof
 528| 74 20 31 39 38 38                                   t 1988
 544|




                      4. Новые вирусы, знакомые с Локатором.


   Пользуясь терминологией VL можно сказать, что Маскоискатель исследует
файлы в режиме Quick Search.
   Появились вирусы, которые обманывают подобный алгоритм. Распознать их
просто, стоит только посмотреть на файл MASK.ML. Если его содержимое выглядит
примерно так:


   0| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________
  16| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________
  32| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________
  48| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________
  64| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________
  80| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________
  96| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________
 112| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________
 128| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________

                       ...

2080| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________
2096| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________
2112| __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __     ________________
2128| __ __ __ __ __ __                                   ______
2144|

то Вам попался очередной хитрый вирус.
  Какой имеется выход? Попытаться выделить маску вируса без помощи ML и
перейти в Локаторе на режим поиска Full Search и/или постоянно держать
в резиденте утилиту RVL (Resident Virus Locator) с маской этого вируса.
  Еще лучше - к тому же связаться со мной (адрес указан ниже) и выслать
мне дискету с одним или несколькими зараженными файлами. Я внесу необхо-
димые дополнения в алгоритм поиска вирусов Turbo Search (Локатор версии
2.1 и выше) и вышлю Вам дискету с новой версией Локатора, способной
распознавать вирус в режиме быстрого поиска.





  Вирусный Локатор и все его утилиты являются некоммерческими продуктами и
распространяются бесплатно.
  Я буду Вам благодарен, если при распространении Вирусного Локатора Вы не
забудете скопировать все его файлы.

╔════════════════════════════════════════════════════════════════════════════╗
║                                                                            ║
║  Любое распространение Локатора, преследующее коммерческую выгоду, а также ║
║его включение в другие пакеты, неважно, бесплатные или продаваемые, возможно║
║только после получения на то моего письменного разрешения.                  ║
║                                                                            ║
╚════════════════════════════════════════════════════════════════════════════╝

  Все претензии, советы и предложения я принимаю с благодарностью и постараюсь
с Вашей помощью улучшать Локатор. В свою очередь готов предоставлять Вам
информацию о новых вирусах, их масках и о новых версиях моей программы.
  Если же Вам удастся обнаружить новый вирус, то я буду очень признателен,
если Вы сообщите мне о нем. Желательно, чтобы информация о вирусе включала
его дамп (сделанный с помощью ML не менее чем для 3-х зараженных файлов),
а лучше всего - сам вирус на дискете. Возврат дискеты гарантирую и постараюсь
ее заполнить либо новой версией Локатора, либо свежей вирусной информацией.



  По всем вопросам, связанным с VL, обращайтесь ко мне по адресу:


       252207 Киев-207, проспект академика Глушкова, 20-а , Технософт,
              отдел Ковалева, комната 13, Шеховцов Александр.


    и / или по телефону (044) 266-00-97 (Киев,с 10.00 до 18.00 Моск. время
                                   по рабочим дням).



 Вы можете стать зарегистрированным пользователем Вирусного Локатора.
 Для этого достаточно выслать сумму в 25 руб. по адресу:

  252142 Киев-142, ул. Семашко, д.10, кв 16, Шеховцову Александру Людвиговичу

 и указать свой полный адрес.

  Получив эти деньги, я вышлю Вам подтверждение и зарегистрирую Вас в списке
пользователей.
  Все пользователи из этого списка получают от меня информацию (в письменном
виде) о новых вирусах, которые стали мне известны (маска вируса, его название
и проявления).  Таким образом, зарегистрированный пользователь всегда имеет в
Локаторе свежий список вирусов, что достаточно надежно защищает компьютер.





                       октябрь 1990 г.         Шеховцов Александр
