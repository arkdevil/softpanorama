Назначение: Программное средство для оформления экрана в текстовом
----------- режиме персонального компьютера (EGA,VGA).

Аналоги:    PicMaker и многие другие.
--------

Справки:    141400, г.Химки, Московская обл., ул. Московская, 21,
--------    ВНПОлеспром, сектор ПЭВМ,
            Абдряшитов Рушан Ирфанович, тел. 572-70-03, доб.5-40 или 2-41.

Дом.адрес:  141400, г.Химки, Московская обл., ул. Калинина, 3а, кв.53.
__________________________________________________________________________
 

                  Комментарии к программе TMG
                  ---------------------------

    При создании прикладных программ, ориентированных на пользователя,
часто возникает задача оформления экрана. Один из возможных путей упрос-
тить эту задачу заключается в предварительной подготовке разного рода
вспомогательных окон, меню, заставок и проч. с помощью специального ре-
дактора, записи этих заготовок на диск и вызове их по мере необходимости
в оперативную память компьютера в прикладной программе. Впрочем, такой
редактор мог бы помочь и в случае "рисования картинок" внутри самой при-
кладной программы как удобное средство эскизного проектирования будущей
"картинки" - подбора цветов, компоновки элементов и т.п.

    Примером такого редактора и является TMG (Text Mode Generator).
Само название редактора говорит о том, что речь идет о подготовке "кар-
тинок" только в текстовом режиме работы персонального компьютера, точнее
в режиме CO80 ( цветной монитор с размером экрана 80 символов по гори-
зонтали и 25 строк по вертикали ). Существует версия TMG для монохром-
ного видеоадаптера, однако область ее применимости существенно уже цветной
версии.

    Редактор прост и удобен в эксплуатации, легко осваивается более или
менее подготовленным программистом - для этого вполне достаточно инструк-
ции, вызываемой нажатием клавиши F1.

    Остановимся на некоторых возможностях редактора TMG, на которые следует
обратить внимание.

     При нажатой комбинации клавиш Alt-F6 Вы можете заменить данный цвет
фона или цвет символов в пределах текущего окна на новый. Данным считается
цвет фона или символа над курсором. Отличие этого режима от того, который
действует при нажатии клавиши F6, состоит в том, что в последнем случае
происходит смена цвета фона целиком всего текущего окна на новый. То же
касается и цвета символов. Если нажаты одновременно обе клавиши, то акти-
вен первый режим (Alt-F6).

     Нажав клавишу F5, Вы можете записать текущее окно на диск. Запись
в указанный Вами файл производится побайтно, первые 2 байта содержат раз-
меры окна по горизонтали и вертикали. Пример прикладной программы на язы-
ке Turbo Pascal, использующей окно, предварительно подготовленное с помо-
щью редактора TMG, Вы можете увидеть, нажав клавишу F8.

     Другой путь использования окон, подготовленных с помощью TMG, заключа-
ется в автоматической генерации исходного текста программы на TurboPascal'е
при нажатии комбинации клавиш Alt-P. Текст программы, рисующей текущее окно
на экране, записывается в указанный Вами файл на диске и включает процедуру
Picture, которую Вы можете вставить в Вашу прикладную программу. Оптималь-
ность сгенерированной программы как с точки зрения ее компактности, так и
с точки зрения ее быстродействия, не гарантируется. Однако исходный текст
р а б о т а ю щ е й  программы - это не так уж мало для программиста. Если
файл, в который Вы записываете исходный текст программы, не имеет расширения,
то ему автоматически присваивается расширение .PAS .

     С помощью комбинации клавиш Alt-V можно переключать видеорежимы с "обыч-
ного" - 8 цветов фона плюс мерцание символов - на альтернативный с 16 цветами
фона. Следует иметь в виду, что окна, подготовленные во втором режиме с исполь-
зованием хотя бы одного яркого цвета фона, можно включить в прикладную програм-
му лишь предварительно установив тот же альтернативный видеорежим. Сделать это
можно, например, с помощью предлагаемой ниже процедуры VideoRegim(R:byte):

     Пример использования окон, подготовленных в режиме 16 цветов фона:

-----------------------------------------------------------------------------
Uses Dos,Crt;

Var VideoNorma:boolean;    { Индикатор активного видеорежима }
    regg      :Registers;

Procedure VideoRegim(R:byte);
{
  R=0 - 16 цветов фона           :  альтернативный видеорежим
  R=1 -  8 цветов фона+мерцание  :  "обычный" видеорежим
}
begin
 if R=0 then VideoNorma:=false else
  if R=1 then VideoNorma:=true else Exit;
 regg.AH:=16;
 regg.AL:=3;
 regg.BL:=R;
 intr($10,regg);
end;

begin

 VideoRegim(0);    { Установим альтернативный видеорежим }

 {...Пример чтения окна см. в подсказке к программе TMG (клавиша F8).....}

 VideoRegim(1);    { Восстановим "обычный" видеорежим }

end.
-----------------------------------------------------------------------------

     Функция Alt-P (генерация Паскаль-программы, рисующей текущее окно) некор-
ректно обрабатывает окна, подготовленные в альтернативном видеорежиме из-за
использования в сгенерированной программе процедур TextBackGround и TextColor 
модуля Crt (разумеется, это касается только ярких цветов фона).
     Для исправления "сбойных" мест достаточно заменить указанные процедуры в 
тексте сгенерированной программы на прямое присвоение переменной TextAttr (мо-
дуль Crt) соответствующего выражения, например, так:

  ....TextBackGround(Yellow);TextColor(Red);......{ До замены...   }

  ....TextAttr:=16*Yellow+Red;....................{ После замены...}

  и использовать процедуру VideoRegim по приведенной выше схеме.


     В распоряжении автора имеется специальный модуль на языке Turbo Pascal
(Unit ARICrt), включающий средства вызова окон, подготовленных с помощью TMG,
по их номерам из общего файла "картинок". Модуль в сочетании с TMG существен-
но облегчает дизайн прикладных программ. Файл TMG.PIC представляет собой как
раз такой общий файл "склеенных" окон для самой программы TMG.EXE.


                   Перечень файлов и их назначение:

    TMG.EXE - основной модуль редактора TMG.

    TMG.PIC - файл "картинок" к основному модулю.

    TMG.DOC - комментарии к программе TMG (этот файл перед Вами).

    PTK_SCR - пример окна, равного экрану, подготовленного с помощью TMG
              (попробуйте запустить TMG.EXE и вызвать на экран это окно
               с помощью функции F4). 
  
___________________________________________________________________________
