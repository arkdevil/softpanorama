












     ┌───────────────────────────────────────────────────────────────────┐
     │                                                                   │
     │                                                                   │
     │ wИнтегрированная Среда Архиваторов│
     │                                                                   │
     │                  ( Data Compression Integrated System )           │
     │                                                                   │
     │                         Версия от 90/07/16.                       │
     │                                                                   │
     └──────────────────────────────────────────────── ┬m BVMsoft ───────┘

                                -  1 -

                             Содержание.

  1. Введение  . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2

  2. Настройка и запуск DArc  . . . . . . . . . . . . . . . . . . . . 2

  3. Функциональные возможности интегрированной среды  . . . . . . . . 3

        3.1. Просмотр каталога архивного файла . . . . . . . . . . . . 5

        3.2. Помещение файлов в архив  . . . . . . . . . . . . . . . . 5

        3.3. Смена текущего диска  . . . . . . . . . . . . . . . . . . 6

        3.4. Смена типа архиватора . . . . . . . . . . . . . . . . . . 7

        3.5. Установка/снятие пароля . . . . . . . . . . . . . . . . . 8

        3.6  Извлечение файлов из архива . . . . . . . . . . . . . . . 8

        3.7. Просмотр файлов . . . . . . . . . . . . . . . . . . . . . 8

        3.8. Распечатка файлов . . . . . . . . . . . . . . . . . . . . 9

        3.9. Помощь пользователю . . . . . . . . . . . . . . . . . . . 9

       3.10. Завершение работы . . . . . . . . . . . . . . . . . . .  10


  4. Сообщения об ошибках  . . . . . . . . . . . . . . . . . . . . .  11 





                                -  2 -
   
                     1. Введение.


   При работе на ПЭВМ для рационального использования внешней памяти часто
применяют различные программы упаковки-распаковки файлов(архиваторы).
Как правило, большинство из них работает в командном режиме. Некоторые
архиваторы (например, NARC) функционируют в интерактивном режиме, однако
выполняют лишь распаковку архивных файлов конкретного типа (например .ARC,
.ZIP).
   С целью обеспечения возможностей упаковки-распаковки в интерактивном
режиме для архивных файлов различного типа была разработана Интегрированная
Среда Архиваторов ( DArc ).
   Интегрированная Среда Архиваторов обеспечивает интерактивное взаимодей-
ствие пользователей со следующими программами - архиваторами:

    1. PKARC, PKXARC  version 3.5    04-27-87   PKWARE Inc.
    2. PKZIP, PKUNZIP version 1.02   10-01-89   PKWARE Inc.
    3. PAK            version 1.6     1988-89   NoGateConsulting
    4. LHARC          version 1.131  89-05-31   Haruyasu Yoshizaki
    5. LHICE          version 1.14   89-07-15   Haruyasu Yoshizaki




  2. Настройка и запуск Интегрированной
                Среды.

   Интегрированная Среда включает в себя следующие компоненты:

      DArc    - интерактивная оболочка;

     PKZIP    -    про
   PKUNZIP    -       грам
     PKARC    -            мы -
    PKXARC    -                 ар
       PAK    -                   хи
   PAKINST    -                     ва
     LHARC    -                       то
     LHICE    -                         ры

  Интерактивная оболочка DArc и программы-архиваторы могут находиться в разных
директориях, на разных дисках; при этом достаточно лишь указать путь в PATCH
для успешного их поиска. При запуске интегрированная оболочка взаимодействует
с программами-архиваторами. Поиск соответствующих программ производится в
следующем порядке:

  - в текущем директории;
  - в директории исполнения программ DOS 3.XX;
  - в директориях, указанных в PATH.



                                -  3 -


          3. Функциональные возможности
          Интегрированной Среды.


   В Интегрированной Среде Архиваторов реализованы следующие функции:

      - просмотр каталогов архивных файлов;
      - помещение файла (или группы файлов) в архив;
      - смена текущего диска;
      - смена текущего типа архиватора;
      - установка/снятие пароля на доступ к архивному файлу;
      - извлечение файла (или группы файлов) из архива;
      - просмотр файлов в архиве;
      - распечатка файлов из архива.

   Запуск Интегрированной Среды Архиваторов осуществляется путем набора
имени DArc.EXE в результате чего на экране появляется изображение(рис.1):

╒═════════════════════Data Compression Integrated System══════════════════════╕
│                                                                             │
│                                                                             │
│                                                                             │
│                                                                             │
│  ╒═════════════════════════════════════════════════════════════════════╕    │
│  │               The Data Compression Integrated System.               │    │
│  │      Supporting following types of data packing programs:           │    │
│  │                                                                     │    │
│  │  1. PKARC, PKXARC  version 3.5    04-27-87   PKWARE Inc.            │    │
│  │  2. PKZIP, PKUNZIP version 1.02   10-01-89   PKWARE Inc.            │    │
│  │  3. PAK            version 1.6     1988-89   NoGateConsulting       │    │
│  │  4. LHARC          version 1.131  89-05-31   Haruyasu Yoshizaki     │    │
│  │  5. LHICE          version 1.14   89-07-15   Haruyasu Yoshizaki     │    │
│  │                                                                     │    │
│  │                                                                     │    │
│  │                                                                     │    │
│  ╘═════════════════════════════════════════════════════════════════════╛    │
│                                                                             │
│                                                                             │
│                   DArc (tm)     Version 1.00     07/15/90                   │
│         Copyright (c)  1990  Babanin V. Tver Software Incorporated.         │
│                            All Rights reserved.                             │
│                                                                             │
╘═════════════════════════════════════════════════════════════════════════════╛

                              Рис.1.


  После нажатия любой клавиши на экране появится директорий текущего диска
(рис.2).  Прописными символами в нем выделены доступные поддиректории,
строчными - имена файлов. Для смены текущего директория нужно выбрать искомый
поддиректорий или <..> и нажать клавишу ENTER.

   Назначение клавиш для всех режимов:

         F1 - помощь
        ESC - возврат на предыдущий уровень
      ENTER - выполнение функции
      SPASE - отметка файлов при групповых операциях


                                -  4 -


╔═════════════════════════════════════════════════════════════════════════════╗
║       -=DArc=-   1.00   (C)  Babanin V., 1990.   Tver Software Inc.         ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                           ╒════════════ G:\VV\TP55\*.* ═════════════╕       ║
║                           │ ..              <dir>   4/14/90  12:01p │       ║
║                           │ FINAL           <dir>   7/17/90   5:43p │       ║
║                           │ KAT1            <dir>   7/17/90   5:43p │       ║
║                           │ alt.exe          2672   5/24/90  12:42p │       ║
║                           │ altern.zip       2834   5/24/90  12:45p │       ║
║                           │ bgi.zip        115238   5/24/90  11:52a │       ║
║                           │ ooptpu.zip      31559   5/24/90  11:53a │       ║
║                           │ pref.exe        23696   3/30/90   8:38a │       ║
║                           │ tpu.zip        135977   5/24/90  11:54a │       ║
║                           ╘═════════════════════════════════════════╛       ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                         Drive G: - 561152 bytes free        ║
║-------- F1 = HELP ---------- Esc = RETURN -------- Space = MARK ------------║
║UnPack     Pack        Cng Drv     Archive     Sound       PassWord          ║
║              Set/reset Password for Archive               Archive type: ZIP ║
╚═════════════════════════════════════════════════════════════════════════════╝

                                Рис.2.


                                -  5 -


     3.1 Просмотр каталога архивного файла.



  Эта команда позволяет отобразить на экране каталог текущего (подсвеченного)
архивного файла(рис.3). Используйте клавиши перемещения подсвеченной строки
для выбора желаемого файла и выберите его нажав клавишу ввода (ENTER).


╔═════════════════════════════════════════════════════════════════════════════╗
║      -=DArc=-   1.00   (C)  Babanin V., 1990.   Tver Software Inc.          ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║╒═ Length  Method  Size  Ratio   Date    Time   CRC-32  Attr  Name        ══┐║
║│     62  Stored     74   0%  02-27-89  05:05  58965022 --w* AMINUS.INC     │║
║│      5  Stored     17   0%  05-30-90  06:11  60240745 --w* ASI.XXX        │║
║│  18144  Implode 10901  40%  07-11-90  17:36  86fc99be --w* COLORS.EXE     │║
║│   2826  Implode  1233  57%  07-11-90  17:37  0d4d5dbe --w* COLORS.PAS     │║
║│      0  Stored     12   0%  07-17-90  10:10  00000000 --w* DArc.EXE       │║
║│  35176  Implode 11493  68%  07-17-90  10:09  f6f7abb9 --w* DArc.PAS       │║
║│   2709  Implode  1177  57%  07-12-90  08:44  f13d52c9 --w* GETCOLOR.PAS   │║
║│   4169  Implode  1662  61%  07-14-90  15:47  3a88b7e5 --w* INSTR.PAS      │║
║│     67  Stored     79   0%  02-27-89  05:05  4e84f54f --w* OMINUS.INC     │║
║│     67  Stored     79   0%  02-27-89  05:05  dad814b3 --w* OPLUS.INC      │║
║│   3248  Implode  2317  29%  07-17-90  10:26  cd890081 --w* SUMMA.EXE      │║
║│    956  Implode   531  45%  07-17-90  10:24  0a4b183f --w* SUMMA.PAS      │║
║│   2688  Implode  1241  54%  05-22-89  12:25  29da9931 --w* TPDEFINE.INC   │║
║│  21948  Implode  6275  72%  05-31-90  12:39  9e5c6bf4 --w* TPDIR.PAS      │║
║╘════════════════════════════════════════════════════════════  Y for more ══╛║
║  170144          69917  59%          <--  Totals                            ║
║                                        Drive G: - 600064 bytes free         ║
║-------- F1 = HELP --------- Esc = RETURN -------- Space = MARK -------------║
║File     View     Print                                   PassWord installed ║
║             Extract Single File or Tagged Files          Archive type: ZIP  ║
╚═════════════════════════════════════════════════════════════════════════════╝

                                  Рис.3.





        3.2 Помещение файлов в архив.

   Эта команда позволяет добавить файлы в архив. Вы можете добавить текущий
(подсвеченный) или выделенные(с помощью клавиши ПРОБЕЛ) файлы. Имя архива
запрашивается при запуске архиватора.


                              -  6 -


                   3.3 Смена текущего диска.

   Эта команда позволяет выбрать новый дисковый драйвер. Список всех имеющихся
драйверов отображается на экране(рис.4). Используя клавиши перемещения
подсвеченной строки выберите нужный драйвер путем нажатия на клавишу ВВОД.
Обьем свободного пространства на текущем диске отображается внизу.
Для создания рабочих наборов используется диск, являвшийся текущим при его
запуске.

╔═════════════════════════════════════════════════════════════════════════════╗
║        -=DArc=-  1.00   (C)  Babanin V., 1990.   Tver Software Inc.         ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                          ╒══════════════╕   ║
║                                                          │   Drive A    │   ║
║                                                          │   Drive B    │   ║
║                                                          │   Drive C    │   ║
║                                                          │   Drive D    │   ║
║                                                          │   Drive E    │   ║
║                                                          │   Drive F    │   ║
║                                                          │   Drive G    │   ║
║                                                          │   Drive H    │   ║
║                                                          │   Drive I    │   ║
║                                                          │   Drive J    │   ║
║                                                          ╘══════════════╛   ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                         Drive G: - 579584 bytes free        ║
║-------- F1 = HELP ---------- Esc = RETURN -------- Space = MARK ------------║
║UnPack     Pack        Cng Drv     Archive     Sound       PassWord          ║
║              Show/selected available Drive(s)             Archive type: ZIP ║
╚═════════════════════════════════════════════════════════════════════════════╝

                                     Рис.4.


                                -  7 -


              3.4 Смена типа архиватора

   Эта команда позволяет выбрать тип архива. Смена типа архива производится
путем установки типа расширения: ARC, ZIP, PAK, LZH, ICE(рис.5).
Допустимы следующие типы расширений архива:

  .LZH - архив архиватора LHARC;
  .ARC - архив архиватора PKARC;
  .PAK - архив архиватора PAK;
  .ZIP - архив архиватора PKZIP;
  .ICE - архив архиватора ICE.

╔═════════════════════════════════════════════════════════════════════════════╗
║        -=DArc=-   1.00   (C)  Babanin V., 1990.   Tver Software Inc.        ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                            ╒════════════════════════╕       ║
║                                            │ LHARC         -> LZH   │       ║
║                                            │ PKARC/PKXARC  -> ARC   │       ║
║                                            │ PAK           -> PAK   │       ║
║                                            │ PKZIP/PKUNZIP -> ZIP   │       ║
║                                            │ ICE           -> ICE   │       ║
║                                            ╘════════════════════════╛       ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                          Drive G: - 569344 bytes free       ║
║--------- F1 = HELP ---------- Esc = RETURN -------- Space = MARK -----------║
║UnPack      Pack        Cng Drv     Archive     Sound      PassWord          ║
║               Change Archive Type                         Archive type: ZIP ║
╚═════════════════════════════════════════════════════════════════════════════╝

                                  Рис.5.

                                -  8 -


           3.5 Установка пароля архива.



   Эта команда позволяет установить/снять пароль на доступ к файлам, хранящимся
в архиве.  Пароль может содержать до 8-ми буквенно-цифровых символов. Признаком
установленного пароля является мерцающее слово "установлен" на экране. Отмена
пароля производится, если на приглашение "введите пароль" нажать клавишу "Enter".



   3.6 Извлечение файлов из архива.


   Подсвеченный или отмеченные в каталоге файлы извлекаются из архива и
помещаются на диск, номер которого запрашивается у пользователя. В процессе
реархивации на экране можно наблюдать ход процесса и сообщения программ -
архиваторов.



            3.7 Просмотр файлов.




Текущий файл(подсвеченный в каталоге) извлекается из архива и выводится на
экран порциями по 22 строки(рис.6). Клавиши PgDn, Home, ° , позволяют легко
просмотреть файл. Для прекращения просмотра нужно нажать клавишу ESC.

╔═════════════════════════════════════════════════════════════════════════════╗
║      -=DArc=-   1.00   (C)  Babanin V., 1990.   Tver Software Inc.          ║
║                                                                             ║
║uses                                                                         ║
║  TPString,                                                                  ║
║  TPCrt,                                                                     ║
║  TPWindow                                                                   ║
║  {$IFDEF UseMouse}                                                          ║
║  ,TPMouse                                                                   ║
║  {$ENDIF};                                                                  ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║function Colors(Color:integer):integer;                                      ║
║Const                                                                        ║
║    a0 = 0; a1 = 1; a4 = 4; a7 = 7;                                          ║
║    un = #4;                                                                 ║
║   sel = #8;                                                                 ║
║   def = #254;                                                               ║
║   AcceptSet : set of char = [#13,#27,#32];                                  ║
║                                                                             ║
║Var                                                                          ║
║    f,b : integer;                                                           ║
║                                                                             ║
║---- PgUp ----- PgDn --- Home --- End -- Esc ---------   ----   -------------║
║File      View      Print                                  PassWord installed║
║               Display Highlighted File on the Screen      Archive type: ZIP ║
╚═════════════════════════════════════════════════════════════════════════════╝

                                  Рис.6.


                                -  9 -


                  3.8 Распечатка файлов.

   Текущий файл(подсвеченный в каталоге) извлекается из архива и выводится на
принтер. Возможна печать с любой строки файла; для этого в начале на приглашение
"текущая строка ?" нужно ввести номер начальной строки и нажать на клавишу
"ВВОД".
Для прекращения выдачи нужно нажать клавишу ESC.



                    3.9 Помощь пользователю.

   В любой момент при нажатии клавиши F1 выводится пояснение подсвеченной
функции (см.рис.7). Для возврата из режима помощи нужно нажать клавишу ESC.




╔═════════════════════════════════════════════════════════════════════════════╗
║       -=DArc=-   1.00   (C)  Babanin V., 1990.  Tver Software Inc.          ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║ ╒═ Length  Method   Size  Ratio   Date    Time   CRC-32  Attr  Name       ═╕║
║ │     62  Stored      74   0%  02-27-89  05:05  58965022 --w* AMINUS.INC   │║
║ │      5  Stored      17   0%  05-30-90  06:11  60240745 --w* ASI.XXX      │║
║ │  ╒══════════════ Display Highlighted File on the Screen ═══════════════╕ │║
║ │  │ The currently highlighted file is read and displayed on the screen. │ │║
║ │  │ The Pg Up, Pg Down, Home, End and arrow keys allow you to move      │ │║
║ │  │ easily through the file. The ESC key aborts the view operation      │ │║
║ │  │ completely.                                                         │ │║
║ │  │                                                                     │ │║
║ │  ╘═════════════════════════════════════════════════════════════════════╛ │║
║ │     67  Stored      79   0%  02-27-89  05:05  dad814b3 --w* OPLUS.INC    │║
║ │   3248  Implode   2317  29%  07-17-90  10:26  cd890081 --w* SUMMA.EXE    │║
║ │    956  Implode    531  45%  07-17-90  10:24  0a4b183f --w* SUMMA.PAS    │║
║ │   2688  Implode   1241  54%  05-22-89  12:25  29da9931 --w* TPDEFINE.INC │║
║ │  21948  Implode   6275  72%  05-31-90  12:39  9e5c6bf4 --w* TPDIR.PAS    │║
║ ╘═════════════════════════════════════════════════════════════  Y for more═╛║
║   170144           69917  59%          <--  Totals                          ║
║                                          Drive G: - 598016 bytes free       ║
║--------- F1 = HELP ---------- Esc = RETURN -------- Space = MARK -----------║
║File      View      Print                                  PassWord installed║
║               Display Highlighted File on the Screen      Archive type: ZIP ║
╚═════════════════════════════════════════════════════════════════════════════╝

                                Рис.7.


                                - 10 -


                        3.10 Завершение работы.

   Для завершения работы нужно нажать клавишу ESC до появления рисунка 8.
После этого нужно выбрать мерцающее слово "ДА" и нажать клавишу "ВВОД".


╔═════════════════════════════════════════════════════════════════════════════╗
║        -=DArc=-   1.00   (C)  Babanin V., 1990.   Tver Software Inc.        ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                   ╒══════════════════════════════════╕                      ║
║                   │   Exit DSIS, really ? YES  NO    │                      ║
║                   ╘══════════════════════════════════╛                      ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                                                             ║
║                                          Drive G: - 593920 bytes free       ║
║--------- F1 = HELP ---------- Esc = RETURN -------- Space = MARK -----------║
║UnPack      Pack        Cng Drv     Archive     Sound      PassWord installed║
║               View Archive File Catalog                   Archive type: ZIP ║
╚═════════════════════════════════════════════════════════════════════════════╝

                              Рис.8


   Интегрированная Среда Архиваторов является расширяемой системой, что достаточно
легко позволяет настроить ее на работу с любым архиватором.




              4. Сообщения об ошибках.

    При возникновении ситуаций, когда дальнейшая работа невозможна DArc
выдает сообщение об ошибках, а именно:

       - файл(ы) не найден(ы);
       - путь не найден;
       - ошибка обмена;
       - непр.обработка файла;
       - нет памяти;
       - непр.формат;
       - файл ххххх не найден;
       - ошибка распаковки;
       - ошибка DOS -> nn.

 Кроме того, перехватываются и выдаются диагностические сообщения программ-
архиваторов.

   В DArc реализовано тестирование на зараженность вирусами:  при запуске
инфицированная DArc выдает предупреждающее сообщение и завершает свою работу.






