

                    П Е Ч А Т Ь    Т Е К С Т О В
                    ============================

                (Инструкция к программе PRPAGE.EXE)



                           Альперович Л. З. t. 386-59-36


     Программа предназначена для вывода на печать тексто-
    вых  файлов.  Она  позволяет просматривать содержимое
    листов на экране дисплея и производить  их выборочную
    печать.

     Возможности программы:
     - Задание размера страниц (высоты и ширины)
     - Управляемая  нумерация  страниц  (по отсчету числа
       строк и по управляющим символам в тексте)
     - Выборочная распечатка страниц
     - Выборочная распечатка листов с просмотром текста на
       экране дисплея
     - Печать в две колонки
     - Печать одних нечетных или четных листов (для печа-
       ти с двух сторон бумаги)
     - Задание отступа от левого края листа
     - Вывод распечатываемой информации в файл
     - Преобразование кодов
     - Преобразование малых букв в большие
     - Печать через строку

     Свойства печати задаются двумя способами:
     - Параметрами вызова программы
     - Управляющими символами в тексте файла, подлежащего
       распечатке.
$

                   ПАРАМЕТРЫ ПРОГРАММЫ
                   -------------------

     Обращение к  программе:
     PRPAGE.EXE <имя_файла> [режимы]

     <имя_файла> обязательный  параметр.  Если  программа
    вызвана без параметров, она выводит на экран описание
    обращения к ней и заканчивает работу.

     Режимы задаются в произвольном наборе через пробелы.
    Каждый режим описывается словом, первая буква которо-
    го кодирует имя режима. Некоторые режимы задаются од-
    ной этой буквой.
     Перечень кодов: H D L N Е V T S R F B X ) $ I К Y

                      Описание режимов
                      ----------------

     Нчисло - высота листа(задается числом строк), напри-
    мер Н72. Это число указывает физическую высоту листа.

     Dчисло - межстраничный промежуток. Указывается коли-
    чество строк листа, остающихся незаполненными текстом
    при печати. Пример, если задано Н72 D10, то заполнено
    текстом на листе будет лишь 62 строки.

     Lчисло - ширина колонки текста (задается числом сим-
    волов в строке), например L80. При одноколонной печа-
    ти - это ширина страницы.

     Nчисло -  автоматическая  нумерация  страниц,  номер
    располагается с заданным отступом в  строке, например
    N60  означает  отступ на 60 символов от левой границы
    колонки.  Если "число" не задано, то номер располага-
    ется  посреди  строки (длина которой задается режимом
    L).  При автонумерации добавляются 4 строки к  каждой
    странице  текста:  одна - пустая,  одна - с номером и
    две - пустые.
     Если "число" = 0, то отмена нумерации.
     При отсутствии этого режима нумерация не производит-
    ся.
  $
     Ечисло-число - диапазон номеров  страниц.  На  печать
    (или  в  файл,  заданный параметром F) выводится часть
    текста,  определенная данными границами. Режим опреде-
    ляет два числа:  начальный и конечный номера выводимых
    страниц.  Числа разделяются знаком "минус" (без пробе-
    ла).
     Пример: Е25-40
     Этот режим отменяет режим V.

     V - визуализация печати. Печать осуществляется с ос-
    тановкой перед  каждым  очередным  листом.  На  экран
    дисплея  выводится  фрагмент листа (20 строк) и подс-
    казка относительно вариантов дальнейшей работы.
    Они выбираются клавишами:
     ENTER - печать  листа и просмотр следующего листа
     ESC   - конец печати, завершение работы программы
     PGDN  - пропуск листа
     PGUP  - возврат к предыдущему листу
     HOME  - переход к первому листу
     END   - переход к последнему листу
     +N    - пропуск N листов
     -N    - возврат на N листов
     UP    - просмотр предыдущих 20 строк листа
     DN    - просмотр последующих 20 строк листа
     LЕFT  - просмотр левой части листа
     RIGHT - просмотр  правой части листа
     F2    - печать до конца текста

     Режим позволяет осуществить  выборочную  и  повторную
    распечатку листов текста.
     Этот режим отменяет режим E.

     Т [или Т2] - двухколонная печать.  В случае Т2, если
    задан режим S1, то в каждой четверке  страниц печата-
    ются 1  и  4  страницы.  Если S2,  - печатаются 3 и 2
    страницы.

     S1 [или  S2]  -  печать  только нечетных [или только
    четных] листов.  Режим дает возможность  сформировать
    печатный документ на двух сторонах рулонной бумаги.

     Rчисло - величина проверяемого остатка страницы (см.
    далее описание управляющих символов печати). Этот ре-
    жим активизируется только совместно с управляющим сим-
    волом $.

     Fимя - Имя файла для вывода информации на диск.

     B -  Преобразование малых букв в больших в альтерна-
    тивной русской кодировке. Режим полезен для подготовки
    файла к перекачке на ЕС и распечатке на АЦПУ.

     Xчисло - величина отступа колонки текста  от  левого
    края листа.  Эта величина не входит в ширину колонки.
    Она может быть отрицательной.

     )Символ - символ,  по которому осуществляется переход
    на новую  страницу  (см.  ниже  описание управляющего
    символа ")").
      Если "Символ" = '0', то данный режим отменяется.

     $Символ - символ,  по которому  проверяется величина
    остатка страницы (см. ниже описание управляющего сим-
    вола "$").
      Если "Символ" = '0', то данный режим отменяется.

     I - Печать через строку

     КСимвол1Символ2Символ3Символ4... -   замена   символа
    первого  на  второй,  третьего на четвертый и т.д.  во
    всем тексте
      Пример:КТ5У6
     В этом случае русские заглавные буквы Т и У  в тексте
     будут при печати заменены цифрами 5 и 6.
$
     YСимвол1Символ2Символ3Символ4... -  замена  символов,
    аналогичная предыдущей,  но в шестнадцатиричном предс-
    тавлении.  Символы  рассматриваются парами:  Символ1 и
    символ2 - шестнадцатиричный код  замещаемого элемента,
    символ3 и символ4 - код его заместителя и т.д.
      Пример1: Y92359336
     В этом случае также,  как и выше, заглавные буквы Т и
     У в тексте будут при печати заменены цифрами  5  и  6.
      Пример2: y0с20
     Здесь признак начала  страницы  (код  0С)  заменяется
     пробелом (код 20).

$
              Значения режимов по умолчанию
              -----------------------------
     Вызов программы без задания режимов эквивалентен вы-
    зову: PRPAGE <имя_файла> H72 D10 L80 R8 X0 )) $$

     Рекомендуется обращение  к  программе   осуществлять
    через (BAT) пакетный файл. Например, файл PRT.BAT:

     prpage %1 h88 L60 t v x3 %2 %3 %4 %5

     При этом печать осуществляется по команде:
     PRT имя_файла

$
               УПРАВЛЯЮЩИЕ СИМВОЛЫ ПЕЧАТИ
               --------------------------

     Программа осуществляет разбивку  на страницы по мере
    заполнения их строками текста в соответствии со  зна-
    чением параметра Н. При этом она вставляет строки ну-
    мерации, если задан режим N.

     Если в  тексте  обнаруживается  управляющий   символ
    печати, то в этом месте осуществляется  условный  или
    безусловный переход к  новой странице.

     Управляющий символ должен находиться в первой  пози-
    ции строки текста. Эта строка не печатается.

     Используются два  символа,  определяемые  режимами -
    ')' и '$' ("закрывающая скобка" и  "доллар").  Первый
    означает безусловный, второй - условный переходы.
     Далее при описании логики работы с управляющими сим-
    волами будем предполагать,  что их значение соответс-
    твено равно ")", "$".

     Вслед за символом ")" может следовать необязательный
    текст вида: -Ч. Например: )-5
     Ч - число, означающее новый текущий номер страницы
     Примеры:
     )-15
     )

     Символ ")"  без последующей добавки типа Ч не влияет
    на нумерацию.
$
     Функция символа '$' отличается  от  функции  символа
    ')'.  Если ')' реализует безусловный переход на новую
    страницу, то управляющий символ '$' означает проверку
    числа строк, остающихся до конца страницы.
     Этот число сравнивается со значением, задаваемым ре-
    жимом  R  (см.  выше).  Если  оно  меньше  указанного
    значения, то переход осуществляется. Если нет, - про-
    должается заполнение страницы текстом.

     Вслед за символом "$" может следовать необязательный
    текст, изображающий число. Например: $15
     В этом  случае  сравнение  величины остатка страницы
    осуществляется с данным числом
     Примеры:
     $12
     $
$
     Замечания
     ---------
     Стандартный символ перехода на страницу (код 12) об-
    рабатывается, как ")".

     При использовании  режима  автонумерации управляющие
    символы рекомендуется размещать  лишь  в  тех  местах
    текста, которые обязательно должны печататься с нача-
    ла страницы (например, в начале разделов документа) и
    проверяться на вмещаемость в страницу (например, таб-
    лицы).

     Программа при старте анализирует свои режимы последо-
    вательно в порядке их задания в командной строке. Если
    дважды  задан  один и тот же режим,  то активизируется
    последнее его значение. При многократном задании режи-
    мов  К и Y происходит "накопление" информации о преоб-
    разованиях. Режимы Е и V взаимно отменяют друг друга.
     Эти факты  можно  учесть  при  разработке  командного
    (bat) файла.
$

               ОГРАНИЧЕНИЯ
               ===========

     Размер листа не более 100 строк
     Ширина страницы не более 160 символов
     Размер межстраничного промежутка не  больше  размера
       листа минус 5.
     Размер отступа номера страницы не более ширины стра-
       ницы минус 5.
     Размер отступа от левого края листа не более 78 и не
       менее отрицательной величины ширины колонки.


                  КОД ЗАВЕРШЕНИЯ
                  ==============
     0 - нормальное окончание
     1 - ошибка в режимах
     2 - выходной файл не создан
     3 - входной  файл не найден

                 - Конец текста -


