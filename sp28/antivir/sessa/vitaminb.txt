                                       А.В.Сесса (MasterSoft)

         ПРОГРАММА ВАКЦИНИРОВАНИЯ ЗАГРУЗЧИКОВ "ВИТАМИН-Б"
__________________________________________________________________________

     Название программы - VITAMINB.EXE,
     Версия 1.0

     Тип программы - инсталлятор нерезидентной вакцины против
вирусов, поражающих загрузчики дисков.

     Назначение программы - замена имеющегося загрузчика на
вакцинированный загрузчик, предотвращающий работу бутовых
вирусов.

     Язык программирования - ассемблер

     Вызов - VITAMINB без параметров. Программа запрашивает имя
диска, подлежащего вакцинированию.

     Ограничения и противопоказания:

- инсталятор способен работать в операционной системе MS DOS или
PC DOS версии не ниже 3.30 (на инсталлированный загрузчик это
ограничение не распространяется);

- при вакцинировании операционной системы DR DOS системные файлы
DRBIOS.COM и DRBDOS.COM должны размещаться в самом начале диска
(как это принято в MS DOS и PC DOS);

- в версии 1.0 не предусмотрено преодоление защиты записи в
системные области диска драйвера MBR.SYS, поэтому во избежание
неприятностей (порчи загрузчика раздела С жесткого диска) следует
на время вакцинирования отключить драйвер ADM.SYS, например,
загрузив систему с дискеты;

- на жестком диске не поддерживаются разделы размером более 32Мб;

- возможно зависание некоторых "неполноценных" ПЭВМ (в частности
первых версий "Нейрона" с ROM-BIOS 3.21) в момент загрузки с
зараженной вакцинированной дискеты, при этом вирус с дискеты не
удаляется, но пользователь все же успеет получить сообщение о
наличии вируса.

     Что делает собственно VITAMINB.EXE:

     При инсталляции вакцины идентифицируются версия операционной
системы и информация в существующем загрузчике. При обнаружении
неизвестной версии ДОС или некорректного загрузчика выводится
предупреждающее сообщение (рекомендуется проверить неопознанный
загрузчик на возможное наличие вируса). Полученые сведения вместе
с адресом обработчиков некоторых прерываний сохраняются в новом
вакцинированном загрузчике или MBR.
     Программа общается с пользователем сразу на двух языках -
альтернативном русском и английском (excuse me my bad English),
причем последний использован не столько для зарубежных потреби-
телей этой программы сколько для не имеющих альтернативного
знакогенератора отечественных.

     Взаимодействие вакцины с вирусом:

     Процесс заражения вакцинированного диска бутовым вирусом ни-
чем не отличается от заражения обычных дисков - вирус переносит
содержимое BOOT-сектора в свободное место диска, а на место за-
грузчика помещает свое тело.
     При загрузке зараженной системы первой получает управление
находящаяся в BOOT-секторе программа инсталляции вируса, при этом
будет перехвачено прерывание Int13 и,возможно, некоторые другие
прерывания. После этого считывается спрятанный вирусом BOOT-сек-
тор и следует нормальная загрузка ДОС, первой фазой которой будет
запуск вакцинированного загрузчика. Вакцина первым делом нейтра-
лизует вирус, восстанавливая важнейшие вектора прерываний. При
обнаружении следов работы вируса на экран выводится значение
векторов захваченных прерываний, после чего на экране появится
предупреждающее сообщение с предложеним о восстановлении загруз-
чика:

              Virus sterilized. Cure BOOT?

или MBR-сектора жесткого диска:

              Virus sterilized. Cure MBR?

     При желании провести исследование вируса пользователь может
отказаться от удаления вируса и продолжить загрузку, нажав кла-
вишу [n]. В этом случае и в памяти и на диске останутся безобид-
ные копии "стерилизованного" вируса. При загрузке с зараженной
вакцинированной дискеты на машине с жестким диском после нейтра-
лизации вируса блокируется доступ к "винчестеру". Для возобнов-
ления возможности работы с жестким диском следует загрузиться с
жесткого диска или здоровой дискеты (можно с той же, если вы не
отказались от восстановления загрузчика).
     Традиционный путь переноса бутовых вирусов - загрузка с ра-
бочей дискеты, "забытой" в дисководе А: - будет блокирован, если
все ваши дискеты будут предварительно вакцинированы "ВИТАМИНОМ-Б".
     Аналогично работает вакцинированный MBR.

     Выводимые на экран адреса захваченных вирусом прерываний
можно использовать для идентификации вирусов:

Int08-ХХХ0:01CE 
Int09-ХХХ0:010A 
Int13-ХХХ0:04FA - JOSHI

Int08-ХХХ0:027B 
Int13-ХХХ0:028F - DISK KILLER 

Int09-ХХХ0:04D9 
Int13-ХХХ0:0526 - DEN ZUK

Int13-ХХХ0:7CD0 - BALL (Italian)

Int13-ХХХ0:0276 - BRAIN/ASHAR

Int13-ХХХ0:0095 - PRINT SCREEN 

Int13-ХХХ0:0015 - STONED (Marijuana)

     Некоторые неприятные ситуации после вакцинирования:

- если Вы не обратили внимание на противопоказания или
предупреждения во время запуска программы VITAMINB, то скорее
всего после вакцинирования Ваша система зависнет при первой же
загрузке. В этом случае Вам уже обязательно придется загрузиться
с дискеты и исправить загрузчик, выполнив команду SYS;
- теперь, когда ADM.SYS уже точно не загружен, повторите вакцини-
рование, если вы работаете с требуемой версии ОС;
- не исключено появление вируса вытирающего на жестком диске
занятый вакциной сектор (известные к данному моменту на это не
способны) - в этом случае система также не будет загружаться -
загрузившись с дискеты, повторно вакцинируйте жесткий диск -
при этом работоспособность диска должна восстановиться; если
и это не поможет - очистите Нортон Утилитой абсолютный(!)
сектор 11 на 0-й стороне 0-й дорожки и повторите вакцинирование.

     Права распространения программы:

     VITAMINB.EXE версии 1.0 может свободно распространяться в
некоммерческих целях (желательно при этом не терять ее описание).
Если же программа понравится Вам настолько, что Вы рискнете стать
зарегистрированным пользователем (это стоит 30 рублей), то Вы
будете со временем вознаграждены получением новой версии программы
(стоимость пересылки включена в регистрационный взнос). В этом
случае Вы можете также расчитывать на получение консультаций. Автор
будет очень рад, если VITAMIN-B сможет поймать новый вирус (не
упомянутый в этом описании) - в этом случае Вы можете переслать
дискету с вирусом и бесплатно стать зарегистрированным пользователем.

Взносы, вирусы и замечания направлять по адресу:

           320130 Днепропетровск
           пер.Фестивальный 12, кв.54
           Сессе Александру
