	    МАКРОС ФОРМАТИРОВАНИЯ ДЛЯ РЕДАКТОРА MULTI-EDIT
            ══════════════════════════════════════════════

     Макрофайл ANMAC6.MAC  содержит  5  макросов,  обеспечивающих
форматирование русских текстов с переносами  (почти  по  правилам
русского языка), быстрое изменение  параметров  форматирования  и
получение информации о текущей установке параметров  форматирова-
ния. В некоторых случаях текст форматируется лучше, чем в  редак-
торе "Лексикон". По скорости макрос не только не уступает, но да-
же  несколько  превосходит  стандартную  макрокоманду   редактора
Multi-Edit "Justify paragraph".  Описание,  которое  Вы  читаете,
набрано в редакторе Multi-Edit v6.0 и отформатировано с использо-
ванием именно этих макросов. В этом разделе  содержится  информа-
ция, достаточная для того, чтобы Вы смогли использовать  макроко-
манды для форматирования, назначив для их вызова некоторые комби-
нации клавиш.

     Основные сведения
     ─────────────────

     Основным является макрос FORMAT_TEXT, именно он  форматирует
текст, все остальные только обеспечивают интерфейс с  пользовате-
лем. Его Вы должны назначить той комбинации клавиш,  при  нажатии
которой будет выполняться форматирование.
     Макрос RUSFORM (не очень удачное название) обеспечивает ввод
пользователем параметров форматирования. Он автоматически вызыва-
ется макросом FORMAT_TEXT при первом запуске, поэтому Вам нет не-
обходимости вызывать его непосредственно, хотя Вы свободно можете
делать это для изменения текущих параметров форматирования.  Опи-
сываемые ниже макросы  позволяют  изменять  параметры  быстрее  и
удобнее.
     Макросы SetFormLevl и AssignFormLevl работают в паре. Обычно
при форматировании текста приходится некоторые фрагменты формати-
ровать иначе, чем основной текст (например, примечания,  печатае-
мые с отступом), поэтому желательно иметь возможность быстро  пе-
реключаться между несколькими фиксированными наборами параметров.
Первый макрос (SetFormLevl) позволяет задать 10 наборов  парамет-
ров форматирования (присвая их цифровым  клавишам  верхнего  ряда
0-9), а второй (AssignFormLevl) делает один из таких наборов  те-
кущим. В большинстве случаев этого вполне достаточно, причем час-
то используется всего 2-3 набора.
     Имея 10 наборов границ выравнивания,  вполне  можно  забыть,
какой номер какой набор имеет, поэтому для  получения  справочной
информации о параметрах  форматирования  Вы  можете  использовать
макрос InfoFormLevl.

     Работа
     ──────

     Для удобства, прежде всего, назначьте вызов макрокоманд фор-
матирования (FORMAT_TEXT),  задания  (SetFormLevl)  и  назначения
(AssignFormLevl) параметров форматирования некоторым клавишам или
комбинациям клавиш. Допустим, что это клавиши <F12>,  <Shift-F11>
и <F11> соответственно. Вызов макрокоманды для получения  справки
о параметрах форматирования также удобно "повесить" на  какую-ни-
будь клавишу, например <Alt-I>. Эти  клавиши  не  используются  в
стандартной раскладке клавиатуры в Multi-Edit 6.0. Указанные  как
пример назначения клавиши будут использоваться в описании.
     После  назначения  клавиш  само  форматирование  выполняется
просто и быстро. Макрос форматирует текст в пределах  отмеченного
блока СТРОК (который будет абзацем).  Стандартная  последователь-
ность такова:

     <F7>
     стрелками курсора отмечаете блок
     [<F7>] <F12>

И все! Блок отформатирован. Дольше рассказывать, что к чему,  чем
реально форматировать абзац. Скорость форматирования  обычно  не-
сколько больше, чем у стандартной макрокоманды выравнивания текс-
та (Justify paragraph, <AltJ>). При форматировании первого абзаца
в течение сеанса работы Вы дополнительно должны будете задать па-
раметры выравнивания: левую границу, правую  границу  и  абзацный
отступ. В строке сообщений будет поочередно  запрашиваться  ввод,
например, для левой границы:


   СЛЕВА: <ENTER> - 12, <SPACE> - 1, <ESC> - отмена.
    │               │             │
    │               │    Текущее значение позиции выравнивания,
    │               │    будет оставлено при нажатии на пробел.
    │               │
    │     Позиция курсора, будет принята как значение
    │     соответствующего параметра при нажатии клавиши
    │     <ENTER> (<ВВОД>).
    │
   Задаваемый параметр (левая позиция выравнивания)


     Перемещая курсор влево-вправо (стрелки влево, вправо,  Ctrl-
влево, Ctrl-вправо, Home, End), установите курсор на нужную пози-
цию и нажмите <ENTER>. В качестве значения соответствующего пара-
метра будет принята позиция курсора. Если Вы нажмете  на  клавишу
пробела, то старое значение соответствующего параметра  сохранит-
ся. Для отказа от форматирования блока нажмите <ESC> (<КЛЮЧ>).

Примечания. Левая граница выравнивания может быть больше абзацно-
         ║  го отступа (как в этом примечании) или меньше  (обыч-
         ║  ный абзац), но правая граница должна быть больше  как
         ║  левой границы, так и позиции абзаца.
         ║
         ║  <F7> - это стандартная клавиша выделения блока строк.
         ║  Вам необязательно заканчивать выделение  блока  явно,
         ║  т.е. нажимая клавишу <F7> в конце блока. Если выделе-
         ║  ние блока не закончено, то макрос форматирования сде-
         ║  лает это за Вас.
         ║
         ║  Для установки текущих параметров как перед форматиро-
         ║  ванием первого абзаца, так и в процессе работы Вы мо-
         ║  жете использовать макрос  RUSFORM.  Эта  макрокоманда
         ║  вызывается из макросов FORMAT_TEXT (если текущие  па-
         ║  раметры еще не установлены)  и  SetFormLevl  (задание
         ║  некоторого набора параметров форматирования). Но фак-
         ║  тически Вы можете даже не знать о существовании этого
         ║  макроса (RUSFORM).
         ║
         ║  Окошко с Copyright-ом появляется  только  при  первом
         ║  назначении текущих  параметров  форматирования,  т.е.
         ║  один раз за сеанс при нормальной работе, так что лиш-
         ║  ние клавиши Вам нажимать не придется. Можно так  наз-
         ║  начить параметры, что оно вообще не появится.

     Для быстрого переключения между наборами параметров формати-
рования используйте клавиши, назначенные макросам  SetFormLevl  и
AssignFormLevl (в нашем примере <Shift-F11> и <F11>). Для задания
параметров форматирования нажмите <Shift-F11>. В строке сообщений
появится запрос:

     Номер определяемого набора параметров (0-9)...

Нажмите клавишу с цифрой, на которую Вы хотите  "повесить"  новую
комбинацию параметров или <ESC> для отмены. Затем, точно так  же,
как описано выше, задайте границы. После задания всех трех границ
(или отмены в процессе задания границ) Вы увидите значения  пара-
метров форматирования для данного набора, например:

     Параметры для набора #1 : левый=1, абзац=1, правый=65

Сокращения очевидны: левый край, абзацный отступ и  правый  край.
Текст будет от 1-й до 65-й колонки  включительно,  первая  строка
абзаца будет также с 1-й позиции.
     Назначение границ для некоторого набора параметров не приво-
дит к автоматическому изменению  текущих  параметров.  Для  того,
чтобы сделать некоторый набор текущим, нажмите клавишу <F11> (то
есть вызовите макрос AssignFormLevl). Появится запрос:

     Номер присваиваемого набора параметров (0-9)...

Нажмите клавишу с номером набора параметров,  который  Вы  хотите
сделать текущим. Появится сообщение о новых текущих параметрах:

     Новые параметры: левый=1, абзац=1, правый=65

Вы можете также нажать <ESC>, если передумали изменять параметры.

     Для получения информации о параметрах форматирования вызови-
те макрос InfoFormLevl (в примере - клавиши <Alt-I>).  На  экране
появится табличка с указанием границ выравнивания для каждого на-
бора параметров. Для продолжения работы нажмите любую клавишу.

     Замеченный недостаток
     ─────────────────────

     Макрос работает некорректно, если в тексте встречаются знаки
табуляции.

     Аналоги и отличительные особенности
     ───────────────────────────────────

     Пару лет назад в СофтПанораме был опубликован макрос TFM (ко
мне он попал окольными путями), но форматировал  текст  он  очень
медленно, поэтому я решил написать свой. Мой  макрос  работает  в
несколько раз быстрее, чем TFM (первая версия на XT работала при-
мерно в 3 раза быстрее). В тоже время,  TFM  может  форматировать
текст "на лету", чего не делает мой макрос. Кроме того, в предла-
гаемом макросе есть возможность быстрой замены параметров  форма-
тирования, чего нет в TFM.
     Других аналогичных макросов я не  видел  (но  есть  редактор
"Лексикон").

     Условия распространения
     ───────────────────────

     Макрос форматирования  русских  текстов  распространяется  в
скомпилированном виде вместе со вспомогательными макросами в мак-
рофайле ANMAC6.MAC (версия для редактора Multi-Edit v6.0). К мак-
росу прилагается описание и условия распространения (этот файл).
     Вы можете свободно пользоваться им, копировать его  и  расп-
ространять его в неизменном виде только вместе  с  описанием  при
условии, что при этом не извлекается прямой или косвенной  выгоды
в каком бы то ни было виде (Вы не можете продавать  его,  обмени-
вать на программы, документацию и т.п., использовать его для фор-
матирования деловых документов, обусловливать его передачу другим
лицам какими-то условиями и т.д., и т.п.). Вы не должны исключать
из макроса строку о правах копирования. Если Вы как-то  изменяете
макрос, то измененный файл должен распространяться не вместо  ис-
ходного макроса, а как дополнение к нему, в виде отдельного  фай-
ла(ов).
     Если Вам понравится этот макрос, и Вы захотите получать  но-
вые версии, то Вы можете зарегистрировать копию у  автора.  Любая
материальная помощь не будет лишней. Если Вы при этом  переведете
сумму, равную 50-ти центам США  по  текущему  курсу  Белорусского
банка (для частных лиц, для организаций в 2 раза больше),  то  Вы
получите исходные тексты программного интерфейса с макросом и, по
крайней мере, 2 новые версии этого макроса (на Ваши дискеты). При
необходимости Вам могут быть высланы  макрофайлы  для  предыдущих
версий (4 и 5) редактора Multi-Edit.
     При использовании макроса в коммерческих целях (форматирова-
ние деловых документов, материалов для печатных изданий  и  т.п.)
Вы должны зарегистрировать копию у автора, выслав почтовым  пере-
водом сумму, эквивалентную 1 доллару США по текущему курсу прода-
жи валюты Национального банка р. Беларусь.

Адрес автора:	220090                        т. 64-51-52 (раб.)
		Республика Беларусь,
		г. Минск,
		ул. Широкая, 36, к.716а
		Медведев Андрей Владимирович

		 РЕГИСТРАЦИОННАЯ ФОРМА

Фамилия ________________________________________________

Имя ____________________________________________________

Отчество _______________________________________________

Уплаченная сумма _______________________________________

Место работы ___________________________________________

________________________________________________________

Должность ______________________________________________

Как часто Вы пользуетесь макросом ______________________

Почтовый адрес _________________________________________

________________________________________________________

________________________________________________________
