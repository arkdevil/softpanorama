
                                Вниманию всех, программирующих на CLIPPER!

                            Тем, кто уже использует CLIPPER-MACRO в работе
                            и  трижды тем, кто впервые об это слышит!

                                                                 ┌──╖  ┌─╖
            ┌────┐┌─╖                                            ╘═╕║  ╘╕║
            │ ╔══╛│ ║   ┌─╖┌────╖┌────╖┌────╖┌─────╖             ┌─┘║   │║
            │ ║   │ ║   │ ║│ ╔╕ ║│ ╔╕ ║│ ╒══╝│ ╔═══╝             │╔═╝   │║
            │ ║   │ ║   │ ║│ ╙┘ ║│ ╙┘ ║│ └─╖ │ ║                 │╙─╖ ┌╖│║
            │ ╙──╖│ ╙──╖│ ║│ ╔══╝│ ╔══╝│ ╔═╝ │ ║                 ╘══╝ ╘╝╘╝
            ╘════╝╘════╝╘═╝╘═╝   ╘═╝   │ ╙──╖╘═╝
                           ┌───────╖   ╘════╝
                           │ ╔╕ ╔╕ ║┌────╖┌────╖┌─────╖╒═════╗
                           │ ║│ ║│ ║│ ╔╕ ║│ ╔══╝│ ╔═══╝│ ╔═╕ ║
                           │ ║│ ║│ ║│ ╙┘ ║│ ║   │ ║    │ ║ │ ║
                           │ ║│ ║│ ║│ ╔╕ ║│ ╙──╖│ ║    │ ╙─┘ ║
                           ╘═╝╘═╝╘═╝╘═╝╘═╝╘════╝╘═╝    ╘═════╝
   ╔══════════════════════════════════════════════════════════════════╗
   ║  С и с т е м а   п о д д е р ж к и    я з ы к а   C L I P P E R  ║
   ╚══════════════════════════════════════════════════════════════════╝
                      ╔════════════════════════════╗
                      ║       Георгий ЖЕРДЕВ       ║
                      ║ 672005 Чита, Рахова, 98-49 ║
                      ╚════════════════════════════╝


   ЭТО - новая версия системы поддержки программирования на CLIPPER в
   среде Multi-Edit 6.x. В нескольких словах, еще Вы еще не знаете о
   таком, система призвана сделать жизнь малиной всем, кто связал ее с
   CLIPPER и Multi-Edit. Насколько это удается - проверьте.


   <!!!> NOTE для пользователей CLIPPER-MACRO 1.0 и 2.0:

         Отличия и вопросы переинсталляции - на второй странице данного
         файла.


   <!!!> Предпосылки...

   Причины, вызвавшие появление CLIPPER-MACRO, очевидно, знакомы многим
   (если лично Вам они не знакомы, я Вам завидую!). В моем характере две
   характерные черты: крайняя рассеянность и расхождение в скорости
   процессов мыслительных и двигательных. Пока пальцы выстукивают на
   клавиатуре имя очередной функции, мысли успевают убежать далеко
   вперед. Пальцы безнадежно отстают, в функциях теряются буквы и
   скобки, в скобках пропадают аргументы, "DO CASE" завершается
   "ENDIF",- и в результате любой акт компиляции становится испытанием
   личного мужества и терпения.

   Когда мне все это надоело, я и взялся писать макросы.


   <!!!> Не топчите попусту клавиатуру...

   Вам больше не нужно выписывать мудреные имена функций, команд, методов
   и т.п.: введите в текст 1-3 буквенную аббревиатуру ("tb" или "sam"),
   нажмите функциональную клавишу - и в тексте появится что-нибудь типа
   TBrowseDB() или, того лучше, CSetAtMUPA().

        Отступление: С большим трудом сейчас набирал эти два имени.
                     Честно говоря, после двух лет работы с CLIPPER-MACRO
                     я уже разучился писать все эти импортные имена.
                     Иногда приходится вместо Multi-Edit использовать
                     какой-либо другой редактор (тот же Norton Editor),
                     и, следовательно, обходиться без CLIPPER-MACRO,-
                     это мучительно!

   В макросах системы содержатся имена практически всех стандарных
   команд, функций, а также переменных и методов классов CLIPPER 5.x
   (поскольку никакой принципиальной разницы в синтаксисе от версии к
   версии CLIIPER не происходило, Вы можете использовать эту систему и с
   более ранними версиями языка). Мало того, Вы можете создать сколько
   угодно дополнительных словарей (скажем по словарю на каждую
   дополнительную используемую Вами библиотеку плюс словарь функций
   проекта, над которым Вы работаете), назначить их хоть всем клавишам
   Вашей клавиатуры,- и в любой момент иметь "под рукой" любую их нужных
   Вам функций. Единственная задача - удержать в голове все существующие
   аббревиатуры. Но, как я проверил на себе, это совершенно не сложно,
   хотя и потребует определенного времени. Чем больше Вы программируете,-
   тем, естественно, меньше времени.


   <!!!> Кто-то теряет, а кто-то находит...

   Наверное, и Вам это знакомо: начнешь писать какой-нибудь цикл типа
   "DO WHILE" экрана на два,- и в пылу вдохновения забудешь завершить
   все финальным "ENDDO". Компилятор ругается: "Unclosed control
   structures", вежливо подсказывая номер последней строки файла, - а
   где она на самом деле, эта "unclosed", и где же ее следует закрыть?!
   Иногда поиски превращаются в захватывающий детектив.

   Я Вам особенно сочуствую, если Вы любитель встроенных присваиваний и
   функции If(). Не приведи, господи, потерять скобку в строке типа:

      cAnswer := If( (nPos := At('рай',(cStr := 'Я крайне рад!'))) > 0,;
                    Substr(cStr, nPos, 3), If((nPos := At('ад',cStr)) > 0,;
                    Substr(cStr, nPos, 2), ''))

   Честно говоря, я и сам порой грешу подобными строкомонстрами.
   Понимаю, что это нехорошо,- но Клиппер слишком многословен и
   медлителен, что и принуждает иногда пожертвовать красотой во имя
   производительности. В подобной же ситуации может оказаться любой из
   нас, сочиняя какой-нибудь особо сложный кодовый блок. И тогда поиски
   утерянной скобки могут занять не один час...

   Но... Теперь я Чебурашка,- то-есть пользуюсь CLIPPER-MACRO. Для того,
   чтобы привести в примере абзацем выше фразу, как ругается компилятор,
   мне пришлось заглянуть в документацию: сам я уже давно не получал
   таких сообщений и забыл, как они выглядят! Стоит мне ввести в текст
   аббревиатуру "dw", как она тут же заменяется на строку "DO WHILE"
   плюс - строкой ниже - "ENDDO". Можно спокойно поместить между двумя
   этими строчками хоть весь файл,- конец цикла у нас уже в тексте, и
   компилятор не будет на нас в обиде. Стоит мне нажать клавишу
   "(" [открывающая скобка], как тут же, следом за ней выскочит
   закрывающая ")", а курсор окажется между скобками! Это относится к
   любым видам скобок и любым кавычкам. Наконец, если я ввожу в текст
   аббревиатуру любой из CLIPPER-функций ("ss" или "ca"), функция
   выводится в текст вместе с полагающимися скобками, а позиция курсора
   будет зависеть от типа функции: имеет она аргументы или нет
   ("SaveScreen(▄)" или "DBCloseArea()▄").

   В таких условиях случайно потерять скобку - это уже фатальное
   невезение! Но уж если Вы все-равно сомневаетесь (ну, бывают такие
   неуверенные в себе люди!), в системе есть целый набор дополнительных
   макросов: проверки скобок в строке, проверки завершенности всех
   циклов, поиска начала или конца цикла и т.п.


   <!!!> И еще, еще, еще...

   Полный перечень всех макросов смотрите в CLIPPER.HLP. Там есть и еще
   кое-что полезное.
   Там же читайте и подробную (в меру моих сил) инструкцию по
   инсталляции системы.


   <!!!> О делах материальных...

   Вы можете пользоваться CLIPPER-MACRO совершенно свободно и как Вам
   заблагорассудится. Можете передавать друзьям и знакомым. Можете,
   наконец, и вовсе ею не пользоваться. Единственная, скромная и очень
   убедительная просьба: если Вы все-таки сохраните систему у себя, не
   выбрасывайте макрос cmabout.mac,- поместите его со всеми остальными
   макросами Multi-Edit. Он используется в Clipper.hlp и там мой адрес.
   Глядишь, и черкнете пару слов. С пожеланиями, и вообще:
   познакомимся,- может, найдем общие интересы.

   Если же Вы пришлете перевод на (скажем округленно) 1000 рублей (что
   за деньги!), будем считать это регистрационным взносом, поводом 
   для меня своевременно уведомлять Вас обо всех усовершенствованиях 
   в макросах и оплатой права на бесплатное (и в первую очередь) 
   получение следующей версии системы.  CLIPPER-MACRO начиналась еще 
   с Multi-Edit 4.0.  Появление новых версий Multi-Edit - это повод 
   для появления новых версий CLIPPER-MACRO. Плюс к тому, в двери 
   стучится CLIPPER 5.2,- и это тоже повод. Ну, и наконец, 
   CLIPPER-MACRO развивается и сама по себе.  Об этом - следующий 
   раздел.


   <!!!> О СЛЕДУЮЩЕЙ ВЕРСИИ

   CLIPPER-MACRO 3.0 уже на подходе! В полном согласии со всеобщей
   закономерностью, она будет не только более совершенной, более
   многофункциональной (это гарантируется!), но и гораздо более
   объемной. Уже сейчас, в не совсем дописанном виде, общий объем файлов
   новой версии - около мегабайта. Понятно, что в СофтПанораму такой
   пакет уже не возьмут (огромная благодарность редакции за публикацию
   данной версии!). Поэтому - читайте предыдущий раздел...

   Что будет в CLIPPER-MACRO 3.0:

   - Главное: полностью стирается грань между встроенными словарями
     макроподстановок (теми, что сейчас находятся в файле clipper.mac) и
     пользовательскими словарями (теми, что сейчас существуют в формате
     Multi-Edit-баз данных / файлы *.uf). Сейчас встроенные словари
     работают гораздо быстрее, чем пользовательские (что естественно,
     так как они являются макросами), зато пользовательские словари
     гораздо проще пополнять и редактировать (что естественно, так как
     они являются базами данных).
     Словарь новой версии будет одновременно и базой данных, доступной
     для модификаций, и макросом, автоматически создаваемым и
     компилируемым на основе базы данных. Удобство + скорость!
     Пользовательские словари в их нынешнем понимании тоже остаются - в
     целях совместимости с предыдущими версиями системы. Однако при
     желании их можно будет автоматически преобразовать в словари нового
     типа. Наконец, в этот же новый формат переведены и все словари
     стандартных CLIPPER-команд и функций. То-есть, Вы сможете без
     проблем редактировать и их, если Вас там что-то не устраивает
     (скажем, Вам захочется изменить аббревиатуру вызова
     макроподстановки).

   - При желании Вы теперь можете включить режим запроса параметров
     выводимой функции. То-есть, прежде чем имя функции будет введено в
     текст, перед Вами появится окошко с перечислением всех требуемых в
     функции параметров и запросом каждого из них. После этого функция
     будет выведена в текст вместе со всеми указанными Вами параметрами.
     Очень удобный способ не забыть порядок и количество параметров в
     много-параметровых функциях (AChoice() или MemoEdit(), например).
     В этом окошке будут также реализованы интерфейс с Norton Guide для
     получения быстрой справки по функции (если Вы пользуетесь в работе
     *.ng-файлами) и возможности просмотра соответствующих
     include-файлов, содержащих макроопределения для данной функции. Вся
     эта система запроса параметров легко создается и модифицируется,-
     так что Вы сможете снабдить ею все словари Ваших макроподстановок.

   - К шести существующим типам макроподстановок (см. CLIPPER.HLP - типы
     вывода мнемонических имен) прибавится седьмой - выполнение
     заданного Вами макроса по выводу макроподстановки. Это еще более
     расширит возможности вывода.

   - Еще более расширяется контроль за синтаксической правильностью
     текста: при вводе закрывающей скобки сразу проверяется наличие
     парной открывающей; при вводе "EXIT" отслеживается, находитесь ли
     Вы внутри цикла "DO WHILE" или "FOR-NEXT".

   - Расширены возможности документирования файлов.

   - Еще целый ряд макросов, облегчающих жизнь. Например, определение
     "на лету" макроподстановок: Вы можете назначить на время сеанса
     редактирования имя переменной какой-либо клавише,- и далее вводить
     это имя в текст одним нажатием клавиши.

   - Существенно расширена HELP-система. В любой момент можно получить
     быструю справку по всем назначениям клавиш, всем актуальным
     макроподстановкам, добавлен макрос загрузки внешних файлов
     (include, prg-examples и т.п.) в HELP-окно.

   - Все загружаемые системой макросы действуют только в окне загрузки!
     Если CLIPPER-MACRO активируется при загрузке *.prg-файла, ее
     макросы будут выполняться только в окне, где редактируется
     *.prg-файл. Во всех остальных окнах будут работать макросы
     стандартного KEYMAP.

   - Полностью автоматизированная инсталляция / переустановка с
     предыдущих версий.

   - Гибкая настройка по типу "Installation and Setup" самого
     Multi-Edit: в любой момент Вы можете переопределить любые параметры
     системы с модификацией загрузочного файла.

    Э т о   т о л ь к о   в к р а т ц е !

        Если желаете подробностей, если есть какие-то вопросы, проблемы,
        пожелания, упреки и т.д. и т.п. -  п и ш и т е !
        Я буду очень рад Вашим письмам!

                                      Георгий ЖЕРДЕВ

                                      672005. Россия, г.Чита-5,
                                              ул. Рахова, 98, кв. 49
                                              Жердеву Георгию
        07-02-93 00:11am                              Владимировичу

*****************************************************************************
 Для пользователей CLIPPER-MACRO 1.0 и 2.0
*****************************************************************************

  ┌───────────────────────────────────┐
  │Что новенького в CLIPPER-MACRO 2.1?│
  └───────────────────────────────────┘

  Не так, чтобы много, но  п р и н ц и п и а л ь н о !

  Р а н ь ш е :   помимо встроенных словарей стандартных CLIPPER-команд,
  CLIPPER-функций и CLIPPER-методов/переменных классов, Вы могли
  использовать только один дополнительный (пользовательский словарь) в
  сеансе работы. Для переназначения словаря требовалось вызвать макрос
  CLIP1^CLIP_USERNEW и заменить один словарь на другой.

  Т е п е р ь :   Вы можете не только иметь сколько угодно
  дополнительных словарей функций, но и сколько угодно их одновременно
  использовать, назначая разные словари разным клавишам (будь у Вас не
  101-, а 1001-кнопочная клавиатура, Вы бы могли использовать 1001
  словарь одновременно!).  Это не роскошь, а необходимость: клипперисты
  обычно используют по несколько допонительных библиотек:  Clipper
  Tools, Planet, Flipper и т.д. Составьте словари наиболее часто
  используемых функций, по одному на бибилиотеку,- и Вам не придется
  выписывать вручную что-то типа csetatmupa().

  К р о м е   т о г о :

  а) Изменены макросы ввода "CASE", "OTHERWISE", "ELSE", "ELSEIF",
  "RECOVER" и "RECOVER USING". Теперь эти слова не просто вводятся с
  нужным отступом, но при этом проверяется, туда ли они попали (т.е., Вы
  будете предупреждены, например, вводя "CASE" при полном отсутствие "DO
  CASE" выше по тексту). Побочным следствием этого нововведения стало
  более корректное выполнение отступа, вне зависимости от величины
  отступа предыдущей строки:

      Раньше:   If lCondition
                   Eval( {|par1,par2| ;
                          If(SomeFunc(par1,par2), DoFunc1(), ;
                                                  DoFunc2()) })
      !! <ElseIf> было бы здесь -->            ElseIf ▄
                EndIf

      Теперь:   If lCondition
                   Eval( {|par1,par2| ;
                          If(SomeFunc(par1,par2), DoFunc1(), ;
                                                  DoFunc2()) })
                ElseIf ▄                  <-- <ElseIf> будет здесь !!
                EndIf


  б) В связи с наличием макросов ввода парных скобок-кавычек (), {}, [],
  "" и '' показались необходимыми и обратные макросы. Если Вы подвязали
  макрос CLIP^TWOBRANCH, как и рекомендовалось, к клавише "(" (т.е.
  <Shft9>), Вы лишились возможности вводить скобку "(" индивидуально,
  без ее правой напарницы. Что, хоть и изредка, но бывает необходимо.  Т
  е п е р ь эта возможность Вам возвращена. Макросу инициализации
  системы "CLIPPER^ON" передайте параметр:  "/SC=1". При этом будут
  установлены все уже известные Вам макросы ввода парных скобок/кавычек
  (т.е., больше нет необходимости назначать их клавишам вручную при
  построении CLIPMAP.DB) и плюс у Вас появятся следующие возможности:

             <Alt9> или <AltShft9> Ввод одиночной (
             <Alt[>                Ввод одиночной [
             <Alt'>                Ввод одиночной '
             <AltShft[>            Ввод одиночной {
             <AltShft'>            Ввод одиночной "

  Обратите внимание: эти установки действуют только в окнах с
  *.PRG-файлами (и с *.CH, если Вы определили CLIPPER^ON для этого
  расширения)! Если Вы находитесь в ином окне эти клавиши будут
  выполнять свои стандартные функции.

  в) Помимо перечисленных выше добавился еще ряд макросов:

        CLIP1^CLIP_NEWWORD    Добавление нового определения в
                              словарь пользовательских функций
                              "на лету", используя слово под
                              курсором.
        CLIP2^CLIP_FIND       Макрос поиска начала / конца
                              текущей структуры, процедуры или
                              функции.
        CLIP2^CLIP_CHMAKE     Теперь макрос CLIP2^CLIP_RMAKE
                              выводит список доступных
                              *.RMK-файлов для выбора только
                              при первом вызове и использует
                              однажды выбранный файл при всех
                              последующих вызовах (если Вы раз
                              по двадцать за сеанс
                              компилируете файлы, это
                              существенно). Для смены
                              *.RMK-файла, используемого по
                              умолчанию и добавлен макрос
                              CLIP2^CLIP_CHMAKE.

  г) Существенно изменен макрос CLIP2^CLIP_BATCOMPILE:  добавлены новые
  параметры. Подробности - в CLIPPER.HLP.

  д) Устранены некоторые досадные мелочи, ранее присутствовавшие в
  версиях 1 и 2.0. Вроде отсутствия автоотступа после "elseif" и
  "recover", знака присвоения "=" вместо ":=" в "FOR = TO ... NEXT"
  (чистая "косметика",- но красивее же!). Более грамотно работает макрос
  вызова пользовательского словаря,- не пишет на экран первую попавшуюся
  функцию, если Вы нажали <ESC> или <F10>, отказавшись от ввода
  Template. Возможно, Вы этих оплошностей и не заметили или не обратили
  внимания, но я, заметив, разумеется, не мог их не исправить.

  В целом большинство наиболее употребимых макросов переработаны в плане
  повышения скорости, расширения возможностей, отработки нестандартных
  ситуаций и устранения погрешностей.

  ┌────────────────────────────────────────────────────────────────────────┐
  │Что сделать, чтобы перейти из CLIPPER-MACRO 1.0/2.0 в CLIPPER-MACRO 2.1?│
  └────────────────────────────────────────────────────────────────────────┘

  1. Разместите файлы согласно указаниям файла FILES.DOC.  Используя
     CMAC.EXE, откомпилируйте макросы и перенесите их в тот каталог, где
     у Вас расположены все макросы Multi-Edit.  Если Вы использовали
     CLIPPER-MACRO версии 1, где-то в каталоге Multi-Edit должен
     располагаться файл USERFUNC.CLP.  Удалите его,- он больше не нужен.

  2. В EXTENSION SETUP меню INSTALL для файлов *.PRG в строке Post-Load
     Macro у Вас указан вызов макроса инициализации системы
     "CLIPPER^ON". Если Вы передавали ему в качестве параметра имя
     Вашего пользовательского словаря функций ("/UL="), можете этот
     параметр убрать, он больше не нужен. (Хотя можете и оставить, если
     лень перекомпилиро- вать после этого INIT.MAC,- никакого вреда этот
     параметр не принесет).

  3. Все Ваши пользовательские словари теперь можете привязывать
     непосредственно к клавишам (см. подробнее CLIPPER.HLP -
     "ПОЛЬЗОВАТЕЛЬСКИЕ ФУНКЦИИ") либо в CLIPMAP.MAC (меню Multi-Edit
     "Installation and Setup" / "Key mapping"), либо оперативно путем
     вызова макроса CLIP1^CLIP_USERNEW. Таким образом, сколько клавиш на
     Вашей клавиатуре, столько словарей одновременно Вы можете
     использовать.

  4. Для нормального функционирования макросов CLIP1^CLIP_USERNEW и
     CLIP1^CLIP_USERWORK зарегистрируйте все Ваши пользовательские
     словари. Для этого вызовите макрос CLIP1^CLIP_USERWORK - появится
     окошко "Выберите словарь".  Пользуясь клавишей <INS> (Create),
     добавьте в окошко имена файлов Ваших словарей с указанием
     каталогов, где они хранятся (см. более подробное описание работы с
     макросом в CLIPPER.HLP - "ПОЛЬЗОВАТЕЛЬСКИЕ ФУНКЦИИ").  Кстати, с
     этим Вы тоже можете не спешить. Если Вы будете использовать свои
     словари, рано или поздно, по мере использования, Вы все равно их
     все зарегистрируете.


     И   В С Ё ? !
     ВСЁ!
     В С Ё ! ! !

     07-02-93 00:15am                               Георгий ЖЕРДЕВ

