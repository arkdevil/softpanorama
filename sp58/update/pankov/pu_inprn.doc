      Комплекс программных средств обслуживания принтеров
                          типа Epson
                и специальных сервисных утилит.

                  ┌─────────────────────────┐
                  │ P U _ I N P R N . D O C │
                  └─────────────────────────┘

                  программист:     Панков Ю.И.
                  дата создания:   1990 г.


     Комплекс программных  средств  разрабатывался  для  личных
нужд автора этих строк:
     1. Быстрое и компактное документирование исходных текстов
        программ.
     2. Оперативная распечатка всевозможной документации в виде
        компактных книг.
     3. Многоязычность,  мобильность и минимальный объем  прог-
        раммных средств.
     Все программные средства этого комплекса написаны  на  ас-
семблере.   Комплекс   эксплуатировался   на   принтерах   типа
"Hyundai" и "Epson Fx-850",  но может быть легко перестроен  на
другие типы принтеров, имеющие загружаемый знакогенератор.



                     I. Состав комплекса.
                     ════════════════════
     - PU_INPRN.COM  - многоязычный загрузчик шрифтов  принтера
                       с внешней настройкой. Имеет  резидентную
                       часть 1056 байт.

     - AR_EPSON.FNT  - шрифты размером 9х12 для принтеров  (ки-
                       риллица и псевдографика в альтернативной
                       кодировке ).

     - PU_EPSON.DEF  - файл  параметров  инициализации   работы
                       программы PU_INPRN и принтера.

     - PU_MODEP.COM  - программа настройки  (перестройки) прин-
                       тера на конкретный режим работы. Если заг-
                       ружен резидентно PU_INPRN, то работает с
                       ним перестраивая его.

     - PU_LSTOP.COM  - драйвер листинга (отслеживает "конец ли-
                       ста" (код 0ch)). Имеет резидентную часть
                       528 байт.

     - PU_LIST.COM   - программа формирования файлов для распе-
                       чатки всевозможной документации и исход-
                       ных текстов программ в  2 колонки. Прог-
                       рамма имеет  внешнюю  настройку  формата
                       листов  печати,  позволяет   формировать
                       файл  для  двусторонней печати текстовых
                       файлов в 2 колонки с полем для  подшивки
                       слева, что, в  конечном итоге, позволяет
                       оформить всевозможные текстовые  файлы в
                       очень небольшие и компактные книги.

     - PU_LIST.DEF   - файл параметров для  программы  PU_LIST,
                       выбираемый   по  умолчанию,  описывающий
                       формат листинга в символах:
                       - высота страницы       - 88
                       - ширина страницы       - 137
                       - ширина колонки        - 60
                       - зазор между колонками - 4
                       - поле для подшивки     - 13
                       - обЪем листа           - 10560 х 2

     - 88x137.65     - аналог PU_LIST.DEF  ... - 11440 х 2

     - 88x137.68     - аналог PU_LIST.DEF  ... - 11968 х 2

     - 88x160.66     - аналог PU_LIST.DEF  ... - 11616 х 2

     - 88x160.75     - аналог PU_LIST.DEF  ... - 13200 х 2

     - 88x160.76     - аналог PU_LIST.DEF  ... - 13376 х 2




            II. Эксплуатация  программных средств.
           ════════════════════════════════════════

    ┌─────────────────┐
    │ 1. PU_INPRN.COM │
    └─────────────────┘

    PU_INPRN начиная с версии 4.0 наделен средствами защиты от
копирования. Он работает только совместно с установочным  файлом
PU_INPRN.INI. Инициализация установочного  файла  производится
только с ключевой дискеты на которой поставляется данный прог-
раммный продукт.

     A. Инициализация установочного файла PU_INPRN.INI
     ──────────────────────────────────────────────────
     Производится запуском  программы  PU_INIT.COM  с ключевой
дискеты в формате:

  PU_INIT.COM Path\PU_INPRN.INI    где:

Path    - адрес и имя справочника, куда будет записан устано-
          вочный файл PU_INPRN.INI.

              Пример инициализации PU_INPRN.INI:
              ──────────────────────────────────

  PU_INIT.COM c:\PU_SK\PU_PRN\PU_INPRN.INI

     Выполнится инициализация  установочного файла по заданному
адресу. Число инсталляций на ключевой дискете уменьшится на 1.

     Работа с  программой  PU_INIT.COM   подробно   описана   в
PU_INIT.DOC.

     B. Инициализация  PU_INPRN.COM
     ──────────────────────────────
     Производится копированием  программы PU_INPRN.COM по адре-
су, определенному в п.1 с ключевой дискеты.

     C. Установка  PU_INPRN.COM
     ───────────────────────────

     Установка программы  производится  из файла первоначальной
загрузки  (что вовсе не обязательно) AUTOEXEC.BAT в формате:

     с установкой  режима  печати:
     PU_INPRN [Имя_файла_шрифтов] [Имя_файла_параметров]
                      или
     без установки режима печати:
     PU_INPRN [Имя_файла_шрифтов] [-параметры]

     где:
Имя_файла_шрифтов    - имя файла загружаемых шрифтов (по  умол-
                       чанию - pu_epson.fnt).
Имя_файла_параметров - имя файла параметров инициализации прин-
                       тера (по умолчанию - pu_epson.def).
параметры            - параметры  инициализации  принтера,  при
                       отсутствии файла инициализации:
        R - оставить резидентом
        G - догрузить псевдографику
        K - не освобождать блок среды.
          - Возможны любые сочетания символов (-KG, -GRK, ...)

     При запуске драйвера с параметрами:  PU_INPRN ??? на экран
выводится минимальная инструкция, которой вполне достаточно для
работы.
     В автоматическом режиме работы (резидентном), драйвер отс-
леживает включение и выключение принтера и производит инициали-
зацию  последнего, каждый  раз  после  его  включения.  Следует
отметить, что при выключении принтера, он переходит в состояние
"выключенно"  только  после полного разряда конденсаторов пита-
ния.  Для некоторых принтеров это время может достигать 10  се-
кунд. Поэтому при использовании драйвера в автоматическом режиме
не рекомендуется выключать принтер на время меньшее  10 секунд.
Инициализация принтера всегда сопровождается индикацией +++++++
в правом верхнем углу экрана.  Повторная  резидентная  загрузка
программы  невозможна  и  рассматривается как переинициализация
принтера новым шрифтом и параметрами.  Это позволяет  использо-
вать программу в многоязычном режиме. Следует отметить, что при
выключении и включении принтера,  драйвер восстановит  первона-
чальную инициализацию принтера.
     Не рекомендуется изменять имя программы или ее текст.


    ┌─────────────────┐
    │ 2. AR_EPSON.FNT │
    └─────────────────┘
     - Файл шрифтов, содержит шрифты кириллицы и псевдографики в
альтернативной кодировке размером 9х12,  "согласован" с  файлом
параметров инициализации принтера pu_epson.def на уровне данных
и не содержит  ESC  последовательностей.  Допускается  загрузка
шрифтов с произвольной "шапкой загрузки" (содержащих ESC после-
довательности).  При этом, указания имени файла параметров ини-
циализации pu_epson.def, не требуется.


    ┌─────────────────┐
    │ 3. PU_EPSON.DEF │
    └─────────────────┘
     - Файл параметров инициализации принтера, определяет пара-
метры работы программы и принтера:
     - порт подключения принтера.
     - выбор загружаемых шрифтов (с псевдографикой или без).
     - резидентность программы.
     - выбор режима работы принтера (обычный, уплотненный, про-
       порциональный, двойной удар,  расширенный, с подчеркива-
       нием и их всевозможные комбинации).
     - выбор межстрочного интервала.
     - выбор координаты левого поля.
     - и другие.
     Данный файл  содержит  ESC последовательности инициализации
принтера,  заключенные между делиметрами "=:" и  "=+",  которые
можно  модифицировать по своему усмотрению под конкретный прин-
тер.  В случае нарушения структуры файла программа PU_EPSON вы-
даст сообщение о некорректности Вашего файла. Поставляемый файл
имеет настройку на принтеры типа Epson.


    ┌─────────────────┐
    │ 4. PU_MODEP.COM │
    └─────────────────┘
     Предназначена для   динамической  настройки  (перестройки)
режима работы принтера.
     Если установлен  резидентно драйвер PU_INPRN c инициализа-
цией режима,  то PU_MODEP перенастраивает режим работы принтера
через драйвер PU_INPRN, который отслеживает последнее состояние
принтера. Если драйвер PU_INPRN не установлен,  PU_MODEP напря-
мую инициализирует режим работы принтера.
     При запуске программы без параметров на экране индицирует-
ся удобное  меню,  которого  вполне  достаточно  для  изменения
режима работы принтера.  В верхнем правом  углу  экрана  описан
формат запуска программы с параметрами,  позволяющий обойти вы-
бор параметров из меню.
     Не рекомендуется изменять имя программы или ее текст.


    ┌─────────────────┐
    │ 5. PU_LSTOP.COM │
    └─────────────────┘
     Этот маленький  драйвер  бывает  очень  полезен при печати
всевозможной документации на листовой бумаге на рулонных  прин-
терах  (типа Hyundai,  Epson и др.) в которых не отрабатывается
сигнал "конец бумаги".  Драйвер в активном  режиме  отслеживает
код "конец  листа"  (0ch).  Не заменим при печати в две колонки
файлов, сформированных программой PU_LIST, т.к. позволяет уста-
новить размер страницы формата А4 в 86-88 строк.
     PU_LSTOP может  находиться в активном и пассивном режимах.
Переключение активности драйвера производится повторным  запус-
ком программы без параметров.
     При запуске программы на экран выводится  минимальная  ин-
формация, которой вполне достаточно для работы.
     Следует заметить,  что активный режим драйвера может  "ме-
шать" работе  других  программ печати (например "лексикону" при
печати в графическом режиме). В этих случаях драйвер необходимо
перевести в неактивный режим перезапуском программы.
     Не рекомендуется изменять имя программы или ее текст.


    ┌────────────────┐
    │ 6. PU_LIST.COM │
    └────────────────┘
     - Программа  формирования текстовых файлов в книжный двух-
колоночный файл для последующей  распечатки  книг на  принтере.
Программа имеет внешнюю настройку формата листов печати в файле
параметров PU_LIST.DEF.
     Формат запуска программы:

     PU_LIST Имя_файла  [Имя_файла_параметров]
                      или
     PU_LIST Имя_файлов  [Имя_файла_параметров]    ,где:

Имя_файла            - имя исходного файла.
Имя_файлов           - имя - шаблон исходных файлов.  Например:
                       *.*, *.doc, text????.* и т.д..
Имя_файла_параметров - имя файла параметров программы (по умол-
                       чанию  - pu_list.def).

     При запуске PU_LIST ??? выводится  минимальная инструкция,
которой вполне достаточно для работы с программой.
     Выходной файл программы будет иметь имя с расширением .LST,
если задано  "Имя_файла" и @LISING.LST,  если задан шаблон фай-
лов. Причем,  в последнем случае,  каждый найденный файл  будет
сформирован с новой колонки.
     Программа игнорирует  разбивку  листинга исходных файлов и
формирует свой, если на это указано.
     Не рекомендуется изменять имя программы или ее текст.


    ┌────────────────┐
    │ 7. PU_LIST.DEF │
    └────────────────┘
     - Файл параметров программы PU_LIST.  Содержит 10 изменяе-
мых параметров. Все размеры даны в символах:

     - ширина страницы                 (LX)   [137]
     - высота страницы                 (LY)   [88 ]
     - ширина колонки                  (LCX)  [60 ]
     - расстояние между колонками      (LS)   [4  ]
     - отступ на нечетной (1) странице (Off1) [13 ]
     - отступ на четной (2) странице   (Off2) [0  ]
     - уменьшение высоты колонки снизу (LL)   [0  ]
     - начальный N страницы            (N1)   [1  ]
     - конечный N страницы             (N2)   [999]
     - управляющие признаки            (Fl)   [1  ]

     Где, в круглых скобках указан идентификатор параметра, а в
прямоугольных скобках указано его значение по умолчанию. Следу-
ет отметить,  что Off1 и Off2 определяют поле для подшивки лис-
та,  и это поле надо делать по возможности максимальным. LL оп-
ределяет  конечную  высоту  колонки,  а  для  рулонной   печати
расстояние между листами.  Если параметры листинга описаны пра-
вильно, то должно выполняться:

                   LCX * 2 + LS + Off < = LX

     Значение управляющих признаков Fl определяется суммой эле-
ментарных признаков:

     1 - оформить конец страницы (код 0ch)
     2 - без переноса длинных строк
     4 - без шапки (без имени файла, даты и времени)
     8 - без нумерации страниц

     Значения параметров N1 и N2 позволяют сформировать  файл с
любой страницы.


     8. 88x137.65 и другие
     ─────────────────────
     - Дополнительные файлы параметров для программы PU_LIST.



                        III. Примечание
                       ════════════════
     1. Для  того,  чтобы  уместить  на  странице формата А4 88
        строк, необходимо установить значение параметра "интер-
        вал" равным 9 (см. II.3 и II.4).
     2. Для установки ширины печати на  "узких"  принтерах  (80
        символов) в 137 или 160 символов необходимо выбрать уп-
        лотненный режим печати  с  10  или 12 символами на дюйм
        (см. II.3 и II.4).
     3. Программы PU_INPRN и PU_LIST предполагают,  что все не-
        обходимые файлы находятся в текущей директории.
     4. Начиная с версии 4.0 - PU_INPRN.COM имеет защиту от ко-
        пирования  и  работает совместно с установочным  файлом
        PU_INPRN.INI.
     5. Принтеры типа EPSON fx-850 допускают  постоянную запись
        шрифтов пользователя в его память. Это делается следую-
        щим образом:
        - установите sw1 = 001 00111 и sw2 = 1000
        - запишите шрифты в память принтера (  например програм-
          мой PU_INPRN)
        - не выключая принтера установите sw1  =  101  00011
        После этого принтер будет работать с Вашими шрифтами да-
        же после его выключения и включения !



           Желаю успехов!   Панков Ю.И.              11.11.90г.
                          т. 252-43-94






