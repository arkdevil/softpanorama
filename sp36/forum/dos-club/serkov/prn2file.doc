**************************************************************
*****     PRN2FILE  Version 1.0 (размер 10192 байта)     *****
**************************************************************
(C) 1991 by SVV&MaxiSoftware

  РЕЗИДЕНТНАЯ  ПРОГРАММА  ДЛЯ  ПЕРЕНАЗНАЧЕНИЯ  СТАНДАРТНОГО

                 ВЫВОДА  НА  ПРИНТЕР  В  ФАЙЛ

            (огромная просьба дочитать до конца)

    Недавно автору данной программы  довелось  столкнуться   с
весьма курьёзной проблемой - было  необходимо  получить  очень
важную и нужную информацию для дальнейшего использования в ви-
де файла; да вот беда - система, содержащая эту информацию мог-
ла выводить её только на принтер. Что же тут делать ? - Вот  и
пришлось "изобразить" нечто весьма похожее на  всем  известную
команду  PRINT, но только с обратным действием, т.е.  происхо-
дит фоновая запись на диск всего того, что поступает на  прин-
тер.
    Однако, как выяснилось немногим позднее, подобная програм-
ма весьма полезна, например, и как "фотограф" (по нажатию кла-
виши PrintScreen при активном PRN2FILE), или ещё  более  изощ-
рённее - сначала "перехватить" в файл  какую-либо  графическую
информацию (скажем, ту же копию графического экрана при актив-
ном GRAPHICS и PRN2FILE), а в последствии свободно, да  ещё  и
в неограниченном количестве, в любое время "штамповать" подоб-
ные графические копии при помощи одной  лишь  обычной  команды
DOS:   COPY <имя_файла> PRN (при неактивном PRN2FILE !).  Ну а
если хорошенько призадуматься, то оказывается, что и это дале-
ко не всё... Например, если кому-нибудь вдруг стало лень  раз-
бираться с ESC-последовательностями для принтера, то их совсем
нетрудно получить от любой, серверующей  принтер  программы  и
т.д. и т.п.  (всё зависит от изобретательности  и  воображения
пользователя). Автору пришлось, например, получить очень  важ-
ные сведения от базы данных, разработанной на CLIPPER, где  не
было никакой возможности использовать сами базы данных в  виде
.DBF файлов.
    Кроме  всего  перечисленного  существует   ещё   несколько
удобств - возможность  исключать  при  "перехвате"  некоторые,
указанные заранее символы, какими, в частности, являются  теже
ESC-последовательности для переключения шрифтов принтера (кому
они нужны в обычном текстовом файле ?), а также  менять  пара-
метры работы : имя выходного файла, исключаемые коды, не  выг-
ружая PRN2FILE из памяти машины.
    Но всё же у программы есть и свои  недостатки, с  которыми
придётся считаться. Они связанны, главным образом, с недостат-
ками операционной системы MS DOS. В частности, это  ограничен-
ность применения данной программы при некоторых условиях, ког-
да исключена возможность записать на диск информацию из-за не-
реентерабельности DOS (прерывание 21h довольно часто  оказыва-
ется почти "наглухо" занятым). Однако, бывают моменты, которые
тут же используются для "сброса" на диск  содержимого,  накоп-
ленного в буфере. Размер этого буфера, естественно, тоже огра-
ничен - 60Кбайт, что в подавляющем большинстве случаев  позво-
ляет устойчиво работать. Поэтому и в памяти активная программа
занимает до  75Кбайт.   Не  рекомендуется  для проверки работы
программы использовать команду COPY <имя чего-либо> PRN,   так
как это может привести к нежелательным последствиям потому что
программа рассчитана на перехват прерывистого потока  информа-
ции не из среды ДОС.

                            - 2 -

    Вполне вероятно, что в не столь отдалённом  будущем  будет
выпущена новая версия (2.0) программы, которая по замыслу  ав-
тора будет "лишена" всех перечисленных  недостатков,  так  как
сама будет обрабатывать весь обмен с  дисковыми  устройствами,
обходя тем самым реентерабельность DOS.

Вызов программы:

  PRN2FILE  <Имя_файла> [Кода_исключаемых_символов...]
  Где:
      Имя файла - это имя предполагаемого файла для переназна-
                  чения вывода в него;
      Кода исключаемых символов - это кода тех символов, кото-
                  рые не будут выводиться в файл,  перечислен-
                  ные через любой разделитель (запятая, точка,
                  точка с запятой и т.д.). Эти кода можно  пи-
                  сать как в десятичной так и  в  шестнадцати-
                  ричной (с добавлением h в конце кода) формах;

 Пример:
  PRN2FILE  C:\PRN2FILE.TXT 27;F7h;CDh;35;48

Если после запуска окажется, что файл C:\PRN2FILE.TXT уже  су-
ществует, то будет выдан дополнительный  запрос  на  необходи-
мость переписать его заново, дополнять или выйти в систему.
Теперь, после того, как резидентная часть программы была уста-
новлена в памяти, можно начинать свои "чёрные" дела.
При запуске программы без параметров на экран выдаётся краткий
Help, исключая только случаи, когда резидентная порция програм-
мы находится в памяти, после чего на экран будут выданы  теку-
щие параметры.
Если при активном PRN2FILE его запустить ещё раз, но уже с дру-
гими параметрами, то произойдёт переустановка этих  параметров
в памяти машины и дальнейшая работа будет происходить в  соот-
ветствии с новыми параметрами.

   Ну вот и всё. Не слишком сложно ?!

  Автор  Серков Вадим Владимирович, проживающий в г. Киеве.
         дом.тел.: 412-44-37 (по интересующим вопросам звонить
         только в выходные дни либо вечером в обычные).
         В составлении  программы  активное  участие  принимал
         М.Грабовецкий.
         Интересные  идеи  были  высказаны  Р.Митницким.

         Программа разработана на Turbo Pascal без  применения
         каких-либо нестандартных библиотек и внешних  подклю-
         чений, исходный  текст прилагается с условием его не-
         изменяемости.

P.S. Недавно автором выпущен в свет еще один "шедевр",  полез-
ность которого смогут оценить все,  кто постоянно имеет дело с
учетом почтовых адресов и их печатью для организации  рассылки
или др. :
     это информационно-поисковая система "Адреса" с  прилагае-
мой к ней базой адресов свыше 40 тыс. НИИ, КБ, НПО, хозрасчет-
ных и многих других предприятий.  Отличается  эта  система  от
всех существующих  и подобных ей намного более высоким быстро-
действием (так как сделана не на Clipper),  очень хорошей ком-

                            - 3 -
пактностью - вся система с документацией и дополнительным сер-
висом занимает до 100 Кб,  а вся база данных к ней  -  1.5  Мб
(благодаря архивированию  данных),   кроме того у системы дру-
жественный интерфейс, который никого не заставит часами сидеть
и разбираться с системой,  ну и наконец цена этой системы нам-
ного ниже (!) чем у своих конкурентов.
     Все, кого  заинтересовала эта информация могут обратиться
к распространителю :
     252030 Киев ул. Леонтовича, 5
            Консультативная маркетинговая фирма "Интерконсалт"
            тел. для справок: 225-01-58.

                                          С уважением SVV.
