                                                 'Доктор'  Е. Касперский
                                                 ═══════════════════════

			  Компьютерные вирусы
			  ═══════════════════

	Вирусом  называется  программа,  которая  может  cоздавать  свои
копии (не обязательно полностью совпадающие с оригиналом) и внедрять  их
в файлы, системные  области компьютера, вычислительные  сети и т.д.  При
этом копия должна сохранять способность дальнейшего распространения.


		 1. Классификация компьютерных вирусов
		 ═════════════════════════════════════

	Вирусы  можно  разделить  на  классы  по следующим признакам: по
среде  обитания  вируса,  по  способу  заражения  среды  обитания  и  по
деструктивным возможностям.

	По cреде обитания вирусы можно разделить на сетевые, файловые  и
загрузочные.   Сетевые  вирусы  распространяются  по  компьютерной сети,
файловые внедряются  в выполняемые  файлы, загрузочные  - в  загрузочный
сектор диска (BOOT-сектор) или в сектор, содержащий системный  загрузчик
винчестера (Master Boot Record).

	Способы  заражения  делятся  на  резидентный  и   нерезидентный.
Резидентный вируc при  инфицировании компьютера оставляет  в оперативной
памяти  свою  резидентную  часть,  которая затем перехватывает обращение
операционной  системы  к   объектам  заражения  и   внедряется  в   них.
Резидентные вирусы  находятся в  памяти и  являются активными  вплоть до
выключения или перезагрузки компьютера. Нерезидентные вирусы не заражают
память компьютера и являются активными ограниченное время.

	По деструктивным возможностям вирусы можно разделить на:

	а) безвредные,  т.е.  никак  не   влияющие  на работу компьютера
	   (кроме  уменьшения  свободной  памяти  на  диске в результате
	   cвоего распространения);

       	б) неопасные,   влияние   которых   ограничивается   уменьшением
	   свободной памяти  на диске  и графическими,  звуковыми и  пр.
	   эффектами;

        в) опасные вирусы,  которые могут привести  к серьезным сбоям  в
	   работе компьютера;

       	г) очень  опасные,  которые  могут  привести к потере  программ,
	   уничтожить данные, стереть необходимую для работы  компьютера
	   информацию, записанную  в системных  областях памяти,  и даже
	   способствовать быстрому  износу движущихся  частей механизмов
	   (например, головок винчестера).


      2. Способы распространения и cтруктура компьютерных вирусов
      ═══════════════════════════════════════════════════════════

	Ниже  приводятся  примеры  структур  и  способов распространения
файловых и загрузочных вирусов.

			 2.1. Файловые вирусы
                         ════════════════════

	Выполняемые  двоичные   файлы  имеют   форматы  COM   или   EXE,
отличающиеся  заголовком  и  способом  запуска  программ  на выполнение.
Расширение  имени  файла  (".COM"  или  ".EXE")  не всегда соответствует
действительному формату файла,  что, правда, никак  не влияет на  работу
программы. Файлы  COM и  EXE заражаются  по-разному, следовательно вирус
должен отличать файлы одного формата  от файлов другого.  Вирусы  решают
эту задачу  двумя способами:   одни анализируют  расширение имени  файла
(".COM" или  ".EXE"), другие  - заголовок  файла.   Первый способ  далее
будет  называться  заражением  .COM-   (или  .EXE-)  файлов,  второй   -
заражением  COM-  (или  EXE-)   файлов.  В  большинстве  случаев   вирус
инфицирует  файл  корректно,  т.е.   по  информации, содержащейся в теле
вируса, можно полностью восстановить зараженный файл.

	Файловые   вирусы   при   распространении   внедряются   в  тело
заражаемого файла: в его начало, конец или середину.

	┌─────────┐   ┌─────────┐       ┌─────────┐   ┌─────────┐
	│Программа│──>│Программа│       │Программа│──>│Вирус    │
	│         │   │         │       │         │   ├─────────┤
	└─────────┘   ├─────────┤       └─────────┘   │Программа│
	              │Вирус    │       	      │         │
	              └─────────┘                     └─────────┘

	Существует несколько  возможностей внедрения  вируса в  середину
файла: он может быть скопирован  в таблицу настройки адресов, в  область
стека  и  т.д.  Кроме  того,  копирование  вируса в середину файла может
произойти в  результате ошибки  вируса. В  этом случае  файл может  быть
необратимо испорчен.

	Известны два  способа внедрения  вируса в  начало файла.  Первый
способ  заключается  в  том,  что  вирус переписывает начало заражаемого
файла  в  его  конец,  а  сам  копируется  в  освободившееся  место. При
заражении файла вторым способом вирус создает в оперативной памяти  свою
копию,  дописывает  к  ней   заражаемый  файл  и  сохраняет   полученную
конкатенацию на диск.

	Наиболее  распространенным  способом  внедрения  вируса  в  файл
является дописывание вируса в конец этого файла. При этом вирус изменяет
начало  файла   таким  образом,   что  первыми   исполняемыми  командами
программы, содержащейся  в файле,  являются команды  вируса. В COM-файле
это достигается  изменением его  первых трех  байтов на  коды инструкции
JMP  Loc_Virus  (передача  управления  на  тело  вируса);  EXE-файл либо
переводится в  формат COM-файла  и затем  заражается как  COM-файл, либо
модифицируется  заголовок  файла.   В  заголовке  EXE-файла   изменяются
значение  стартового  адреса  (CS:IP)  и  значение длины модуля (файла),
реже - регистры-указатели  на стек (SS:SP)  и др. Дополнительно  к этому
длина  EXE-файла  перед  заражением  может  увеличиваться  до  значения,
кратного параграфу (16 байт).

	     COM-файл		         EXE-файл
           ┌────┬────┐                 ┌─────────┐
        ┌──│JMP │    │            ┌────│Заголовок│
        │  ├────┘    │            │    ├─────────┤
        │  │Программа│            │    │Программа│
        │  │         │            │    │         │
        │  ├─────────┤            V    │         │
        │  │Вирус    │       Стартовый ├─────────┤
        └─>│         │       адрес     │Вирус    │
           │         │       ─────────>│         │
           └─────────┘                 │         │
                                       └─────────┘

	СТАНДАРТНЫМ  СПОСОБОМ  ЗАРАЖЕНИЯ  далее  будет  называться такой
способ,  при  котором  вирус  дописывается  в  конец  файла и изменяет у
COM-файла первые 3 байта (JMP  Loc_Virus), у EXE-файла - увеличивает  до
параграфа его длину и изменяет заголовок.

	Вирус,  после  передачи  ему  управления,  совершает   следующие
действия  (приведен  список  наиболее  общих  действий  вируса  при  его
выполнении; для  конкретного вируса  cписок может  быть дополнен, пункты
могут поменяться местами и значительно расшириться) :

	а) восстанавливает  программу (но  не файл)  в исходном  виде (у
	   COM-программы   восстанавливаются   первые    3   байта,    у
	   EXE-программы вычисляется истинный стартовый адрес);
	б) если вирус резидентный, то он проверяет оперативную память на
	   наличие  своей  копии  и  инфицирует  память компьютера, если
	   копия вируса не найдена;
           если  вирус нерезидентный,  то он  ищет незараженные  файлы в
	   текущем  и   (или)  корневом   оглавлении,  в    оглавлениях,
	   отмеченных   командой   PATH   и   т.д.,   а  затем  заражает
	   обнаруженные файлы;
        в) выполняет,   если   они   есть,   дополнительные    функции :
           деструктивные действия,  графические или  звуковые эффекты  и
           т.д.;  дополнительные  функции   резидентного  вируса   могут
           вызываться  спустя  некоторое   время  после  активизации   в
           зависимости  от  текущего   времени,  конфигурации   системы,
           внутренних счетчиков вируса или других условий, в этом случае
           вирус при активизации обрабатывает состояние системных часов,
           устанавливает свои счетчики и т.д.;
        г) возвращает управление основной программе.

        Действия а)-г) далее будут упоминаться как СТАНДАРТНЫЕ.

	При  восстановлении  программы   в  первоначальном  виде   вирус
использует  информацию  о  программе,  сохраненную  в  теле  вируса  при
инфицировании файла. Это может быть длина файла, первые три байта  файла
в случае COM-файла или несколько  байтов заголовка в случае EXE-файла  и
др.

	Известны два способа проверки резидентным вирусом наличия  своей
копии в памяти компьютера.   Первый заключается в том, что  вирус вводит
новую  функцию  некоторого  прерывания,  действие  которой заключается в
возврате значения "я здесь". При  старте вирус обращается к ней  и, если
возвращенное  значение  совпадает  со  значением  "я  здесь",  то память
компьютера  уже  заражена  и  повторное  заражение  не производится. При
проверке вторым способом вирус просто сканирует память компьютера.   Оба
способа  могут  в  той  или  иной  мере  сочетаться  друг  с другом. При
инфицировании оперативной памяти  вирус ищет свободное  место в памяти и
записывает  туда  свою  копию.   Затем  вирус  переопределяет  одно  или
несколько прерываний, необходимых ему для поиска заражаемых файлов,  для
выполнения деструктивных действий или звуковых и видеоэффектов.

	При инфицировании  файла вирус  может производить  ряд действий,
маскирующих и ускоряющих его распространение. К подобным действиям можно
отнести  обработку  атрибута  read-only,  снятие  его перед заражением и
восстановление после.  Многие файловые  вирусы считывают  дату последней
модификации файла и восстанавливают  ее после заражения. Для  маскировки
своего распространения  некоторые вирусы  перехватывают прерывание  DOS,
возникающее при  обращении к  защищенному от  записи диску  (int 24h), и
самостоятельно обрабатывают его.

	DOS  предусматривает  единственный  способ  создания резидентных
модулей  (помимо  драйверов,  указываемых  в  CONFIG.SYS)  -  при помощи
функции KEEP (int  21h, ah=31 или  int 27h). Многие  файловые вирусы для
маскировки своего распространения используют другой способ:  обрабатывая
системные области, управляющие распределением памяти (MCB), выделяют для
себя свободный участок памяти,  помечают его как занятый  и переписывают
туда свою копию.


			2.2. Загрузочные вирусы
                        ═══════════════════════

	Загрузочные   вирусы   заражают   загрузочный   (BOOT)    сектор
флоппи-диска и загрузочный сектор или Master Boot Record винчестера. При
инфицировании диска вирус переносит оригинальный BOOT-сектор (или Master
Boot  Record)  в  какой-либо  другой  сектор  диска  (например, в первый
свободный)  и  копирует  себя  в  загрузочный  сектор (или в Master Boot
Record).  Если длина вируса больше длины сектора, то в заражаемый сектор
помещается первая  часть вируса,  остальные части  размещаются в  других
секторах  (например,  в  первых  свободных).  Если  продолжение   вируса
размещается  в  первых  свободных  секторах  диска, то они, как правило,
помечаются как сбойные (точнее,  сектора образуют кластер или  кластеры,
которые и помечаются как сбойные, т.н. псевдосбойные кластеры).

						Незараженный диск
	Номер сектора:
            0     1     2      . . .
	┌─────┬─────┬─────┬───   ──┬─────┬─────┬─────┬─────┬─────┬───
        │░░░░░│     │     │        │     │     │     │     │     │
	└─────┴─────┴─────┴───   ──┴─────┴─────┴─────┴─────┴─────┴───
	   │
	   └──  BOOT-сектор  или  Master Boot Record

						Зараженный диск
	    0     1     2      . . .
        ┌─────┬─────┬─────┬───   ──┬─────┬─────┬─────┬─────┬─────┬───
        │▓▓▓▓▓│     │     │        │     │░░░░░│▓▓▓▓▓│▓▓▓▓▓│▓▓▓▓▓│ 
        └─────┴─────┴─────┴───   ──┴─────┴─────┴─────┴─────┴─────┴───
           │                                │     │     │ ... │
           └──  Начало вируса               │ ┌───┴─────┴─────┘
                                            │ └──  Продолжение вируса
                                            │
					    └── Сохраненный BOOT-сектор
						или Master Boot Record

	СТАНДАРТНЫМ  СПОСОБОМ  далее   будет  называться  такой   способ
РАЗМЕЩЕНИЯ загрузочного вируса на диске, при котором продолжение  вируса
размещается в последовательных секторах диска, образующих  псевдосбойные
кластеры.

	Известные  мне  загрузочные   вирусы  всегда  резидентны.    Они
внедряются в память компьютера при загрузке с инфицированного диска. При
этом системный загрузчик считывает  содержимое первого сектора диска,  с
которого производится загрузка, помещает считанную информацию в память и
передает  на  нее  (т.е.  на  вирус)  управление.  После  этого начинают
выполняться инструкции вируса, который :

	а) уменьшает обьем свободной памяти (слово по адресу 0040:0013);
	б) считывает с диска свое продолжение (если оно есть);
	в) переносит  себя в  другую область  памяти (например,  в самые
	   старшие адреса памяти);
	г) устанавливает необходимые вектора прерываний;
	д) совершает, если они есть, дополнительные действия;
	е) копирует в память оригинальный BOOT-сектор и передает на него
	   управление.

	Действия а)-е) далее будут упоминаться как СТАНДАРТНЫЕ.

	В  дальнейшем  загрузочный  вирус  ведет  себя  так  же,  как  и
резидентный файловый вирус: перехватывает обращения операционной системы
к дискам и инфицирует их,  в зависимости от некоторых условий  совершает
деструктивные действия или вызывает звуковые или видеоэффекты.


			  3. Описание вирусов
			  ═══════════════════

	Ниже приводятся результаты анализа алгоритма работы имеющихся  у
меня файловых  и загрузочных  вирусов. Наиболее  общие свойства  вирусов
представлены в таблицах каталога (см. файл -VIRUSES.TBL), дополнительная 
информация о каждом вирусе содержится в пунктах 3.2 и 3.3.

	Если свойство вируса  отмечено в таблице,  то в описании  вируса
оно может не упоминаться. Если файловый или загрузочный вирус  совершают
стандартные действия (см.  2.1 и 2.2),  то описание этих  действий может
быть опущено.


			  3.1 Каталог вирусов
                          ═══════════════════

	В предлагаемом каталоге для каждого вируса приведена  информация
по свойствам, описанным в пунктах  1 и 2. Символьное представление  этих
свойств во многом повторяет классификационный код Н.Н.Безрукова.

	В качестве основных  опознавателей вируса будет  указываться его
имя и длина. Если вирус имеет несколько имен, то указываться будет  одно
из них, остальные известные мне имена приведены таблице 3 каталога.

	Длиной  файлового  вируса  считается  длина  тела вируса (коды +
данные) без всяких добавок. В большинстве случаев она равна минимальному
приращению  длин  файлов  при  их  заражении.  Для загрузочных вирусов в
качестве  длины  принимается  полная  длина  тела  вируса,  т.е.   число
занимаемых вирусом секторов, умноженное на число байт в секторе.


	В таблицах каталога встречаются следующие символы:

	+ 		- наличие свойства;
	-		- отсутствие свойства;
	*		- в пунктах 3.2 и 3.3 имеется дополнительная
			  информация;
	&		- одновременное выполнение свойств.

	V		- вызывает видеоэффекты (Video);
	M		- вызывает звуковые эффекты (Music);
	H		- имеет деструктивную функцию (Harm);
	Er		- содержит ошибку, которая может проявляться как
			  деструктивная функция (Error);
        Ch              - изменяет служебную информацию: на диске - имя
                          диска, в DOS - возвращает неверную версию DOS
                          и т.п. (Change).

	Для файловых вирусов (табл. 1):

	C		- COM-файлы;
	.C		- .COM-файлы;
	E		- EXE-файлы;
	.E		- .EXE-файлы;
	O		- прочие файлы (Other).

        Для загрузочных вирусов (табл. 2):

	B		- Boot-сектор винчестера;
	M		- MBR винчестера;
	F		- Boot-сектор флоппи-дисков.

	Например,  если  для  файлового  вируса в графе, соответствующей
поражаемым  объектам,  указано  "E  C&.C",  то  это  означает, что вирус
поражает  только  файлы,  имеющие  либо  формат  EXE,  либо формат COM и
одновременно расширение имени ".COM" (т.е. не поражаются файлы,  которые
имеют формат COM и расширение имени ".EXE").

        При описании свойств файловых вирусов (табл. 1) используются
специальные знаки.

Место внедрения в файл:	s    - начало (start);
			e    - конец (end);
                        i    - середина (insert).
Метод заражения:	FIND - используя функции FindFirst и FindNext;
                        INT  - перехватывая обращения DOS к файлам;
                        INFI - используя оба способа.
Способ внедрения в оперативную память (только для резидентных вирусов):
			MCB  - оперируя с MCB;
			KEEP - используя прерывания DOS (int 21h f.31
			       или int 27h);
                        IntTable - записывается в таблицу векторов;
                        Buffer   - записывается в дисковый буфер.
Длина:                  L    - длина вируса;
                        $    - длина заражаемого файла увеличивается до
			       значения, кратного параграфу;
                        ++   - повторное заражение файлов.


════════════════════════════════════════════════════
═══════ Таблицы приведены в файле -VIRUSES.TBL. ════
════════════════════════════════════════════════════


			 3.2. Файловые вирусы
                         ════════════════════

		    3.2.1. Вирусы "Falling letters"
		    ───────────────────────────────

	Тело вируса, за исключением его начала (32 байта),  зашифровано.
В  качестве  ключа  используется  длина  зараженного  файла, поэтому два
"штамма" вируса в большинстве  случаев будут совпадать только  на первых
32-х байтах.

	При  выполнении  зараженной  программы  управление  командой JMP
передается на  начало вируса.  Первыми командами  вирус определяет длину
исходного файла и расшифровывает свое тело.

	При cоздании своей резидентной копии вирус :

	а) копирует свое тело в старшие адреса памяти;
	б) перемещает в старшие адреса тело основной программы;
	в) перемещает  тело  вируса  в  освободившееся  пространство над
	   телом основной программы;
	г) устанавливает  вектора  прерываний  1Ch,  21h  и  28h на свою
	   копию.

		     а)               б)               в)
        │ ...     │      │ ...     │      │ ...     │      │ ...     │
        ├─────────┤      ├─────────┤      ├─────────┤      ├─────────┤
        │Программа│      │Программа│──┐   │Свободная│  ┌──>│Вирус    │
        │         │      │         │  │   │память   │  │   │         │
        │         │      │         │  │   ├─────────┤  │   ├─────────┤
        ├─────────┤      ├─────────┤  └──>│Программа│  │   │Программа│
        │Вирус    │──┐   │Вирус    │      │         │  │   │         │
        │         │  │   │         │      │         │  │   │         │
        ├─────────┤  │   ├─────────┤      ├─────────┤  │   ├─────────┤
        │ ...     │  └──>│Вирус    │      │Вирус    │──┘   │ ...     │
			 │(копия)  │      │         │
			 ├─────────┤      ├─────────┤
			 │ ...     │      │ ...     │


	Вирус заражает  только COM-файлы  при загрузке  их в  память для
выполнения (int 21h,  ax=4B00h). Инфицирование производится  стандартным
способом. Наиболее  распространенные версии  этого вируса  не производят
повторного заражения файла.

	Изменяет вектора прерываний 1Ch, 21h и 28h.

	Вызывает характерный видеоэффект: осыпание букв на экране. Не
имеет деструктивной функции.


			3.2.2. Вирус "Yanshort"
			───────────────────────

	Стандартным  образом  заражает  EXE-файлы  во  всех  оглавлениях
текущего  диска.  Зараженный  файл  одержит  строку  "motherfucker",  по
которой вирус различает зараженные и незараженные файлы.

	Проявляется  проигрыванием  мелодии  "Yankee  Doodle  Dandy" при
запуске зараженной программы.


	 3.2.3. Семейство вирусов "VACSINA" и "Yankee Doodle"
	 ────────────────────────────────────────────────────

	Семейство вирусов  "VACSINA" (не  "VACCINA"!) и  "Yankee Doodle"
насчитывает  более  десятка  файловых  резидентных  безвредных  вирусов.
Каждый из них содержит в своем теле метку, состоящую из трех байт:  F4h,
7Ah, NNh.  Третий байт NNh рассматривается как номер вируса в  семействе
(номер  версии  вируса)  и  в  дальнейшем  будет  фигурировать  в именах
вирусов ("VACSINA-NN" и  "Yankee Doodle -  NN"). При активизации  вирусы
данного семейства записывают в  память по адресам 0000:00C5,  0000:00C6,
0000:00C7 байты 7Fh, 39h, NNh.  Характерной особенностью вирусов данного
семейства  является  то,  что  они  восстанавливают  файлы,   зараженные
предыдущими версиями вирусов семейства, и затем инфицируют их.

	Вирусы "VACSINA-NN" содержат в своем теле слово "VACSINA".

		      3.2.3.1. Вирус "VACSINA-04"
		      ───────────────────────────

	Заражает COM и EXE-файлы при загрузке их в память для выполнения
(int 21h, ax=4B00h).

	У заражаемого COM-файла вирус  проверяет первый байт. Если  этот
байт не  равен E9h  (JMP), то  файл не  заражается. При  заражении длина
файла увеличивается до значения,  кратного параграфу (16 байт),  к файлу
добавляются 1212 байт вируса и  изменяются первые 3 байта файла  (JMP на
тело вируса).

	Вирус инфицирует и EXE-файлы. Для этого они переводятся в формат
COM-файлов:  к файлу дописывается небольшой фрагмент вируса (132 байта),
настраивающий адреса по таблице адресов при загрузке файла в память  для
выполнения,  и  изменяются  первые  три  байта  файла (JMP на фрагмент).
Дописанные  к  файлу  132  байта  не  распространяют вируса. Их действие
заключается  только  в  настройке  адресов  программы  при  ее  запуске.
Обработанный таким образом файл будет выполняться операционной  системой
и   заражаться   многими   вирусами   как   COM-файл.   При   выполнении
EXE-программы, содержащейся в  подобном файле, управление  передается на
фрагмент  настройки  адресов,  который  анализирует  таблицу  адресов  в
заголовке  файла  и  соответствующим  образом  корректирует  загруженную
программу. Затем управление передается  на стартовый адрес, указанный  в
заголовке файла.

	Вирус изменяет вектор прерывания  21h.

	Вирус вызывает следующий  эффект: при заражении  файла раздается
звуковой сигнал (BELL).

		      3.2.3.2. Вирус "VACSINA-05"
		      ───────────────────────────

	Вирус почти полностью совпадает со своей предыдущей версией.

		      3.2.3.3. Вирус "VACSINA-10"
		      ───────────────────────────

	Вирус почти полностью совпадает со своей предыдущей версией.
Отличия от вируса "VACSINA-05":

	1) Вирус  заражает COM-файлы  вне зависимости  от первого  байта
	   файла (вирус "VACSINA-05" заражает только файлы, первый  байт
	   которых равен E9h).

	2) Звуковой  сигнал  (BELL)  раздается  при  внедрении вируса  в
	   память компьютера.

		  3.2.3.4. Вирус "Yankee Doodle - 18"
                  ───────────────────────────────────

	При заражении  файла вирус  увеличивает его  длину до  значения,
кратного  параграфу,  и   дописывает  свою  копию.  У  EXE- и COM-файлов
изменяются  первые  3  байта  (JMP  на  тело вируса). При этом EXE-файлы
преобразуются в  формат COM-файла  так же,  как и  при заражении вирусом
"VACSINA-04".

	Вирус   определяет   первоначальное   значение   вектора  21h-го
прерывания  и  при  внедрении  в  файлы  вызывает  прерывание  по  этому
значению.  Таким  образом  вирус  обходит  резидентные  антивирусы.  При
определении значения прерывания вирус использует следующий алгоритм:

	а) установка   прерывания  01h   (точка   входа   при   отладке;
	   это прерывание вызывается  в режиме отладки  после выполнения
	   процессором  каждой  команды)  на  подпрограмму   определения
	   истинного значения вектора прерывания;

	б) включение режима отладки;

	в) вызов  "безопасной"  с  точки зрения  резидентных антивирусов
	   функции прерывания 21h.

	При   выполнении   "безопасной"   функции   21h-го    прерывания
последовательно  выполняются  команды  всех  программ,  которые изменяли
вектор прерывания 21h,  затем выполняются команды  операционной системы,
обрабатывающие  данное  прерывание.  При  этом  после каждой выполненной
команды   управление   получает   подпрограмма   вируса,    определяющая
первоначальное  значение  вектора  прерывания.  Она  анализирует   адрес
последней выполненной команды  и, если этот  адрес указывает на  область
памяти, принадлежащую операционной  системе, выключает режим  отладки, а
адрес данной команды  рассматривает как первоначальное  значение вектора
прерывания 21h.

			    │ ...            │
			    ├────────────────┤
			    │Операционная    │
        ┌──────────────────>│cистема         │
        │                   ├────────────────┤
        │                   │COMMAND.COM     │
        │           int 21h ├────────────────┤
        └───────────────────│Пользовательская│───┬─── Программы,
        ┌──────────────────>│программа       │   │    изменявшие
        │                   ├────────────────┤   │    вектор прерывания
        │                   │ ...            │   │    21h.
        │           int 21h ├────────────────┤   │
        └───────────────────│Пользовательская│───┘
        ┌──────────────────>│программа       │
        │                   ├────────────────┤
        │                   │ ...            │
        │                   ├────────────────┤
        │                   │Вирус           │
        │           int 21h │   ─────────────┤
        └───────────────────│команда вызова  │
                            │прерывания 21h  │
           ^  │             │   ─────────────┤
           │  └────────────>│подпрограмма    │
           │                │определения     │
           └────────────────│вектора         │
                            ├────────────────┤
                            │ ...            │


	Вирус изменяет вектора прерываний  1, 9, 21h.

	Вирус  вызывает  следующий  эффект:  при  одновременном  нажатии
клавиш Alt-Ctrl-Del (теплая  перезагрузка) вирус играет  мелодию "Yankee
Doodle Dandy" и лишь затем происходит перезагрузка компьютера.

		  3.2.3.5. Вирус "Yankee Doodle - 19"
                  ───────────────────────────────────

	Отличается  от  своей  предыдущей  версии организацией некоторых
подпрограмм.

		  3.2.3.6. Вирус "Yankee Doodle - 21"
                  ───────────────────────────────────

	Отличия от вируса "Yankee Doodle - 19" :

	1) Вирус перехватывает действия, совершаемые отладчиком и,  если
	   под  отладчиком  находится  тело  вируса,  блокирует  процесс
	   отладки.

	2) Вирус кодирует себя линейным блоковым кодом и хранит в  своем
	   теле  проверочные  байты.  Периодически  вирус проверяет себя
	   на наличие исправлений и по возможности восстанавливает их.

	3) Вирус исполняет мелодию "Yankee Doodle Dandy" в 17.00.

	4) Вирус изменяет вектора прерываний  1, 3, 1Ch, 21h.

		  3.2.3.7. Вирус "Yankee Doodle - 22"
                  ───────────────────────────────────

	Вирус практически полностью повторяет свою предыдущую версию.

		  3.2.3.8. Вирус "Yankee Doodle - 26"
                  ───────────────────────────────────


	Отличия от вируса "Yankee Doodle - 22" :

	1) EXE-файлы  не переводятся  в COM-формат,  у них  производится
	   стандартное изменение заголовка.   При этом заражаются  файлы
	   любой длины.
	2) Заражение файлов происходит при обращени к ним функцией 0x4Bh
	   прерывания 21h. При этом могут заражаться и оверлейные файлы.

		  3.2.3.9. Вирус "Yankee Doodle - 27"
                  ───────────────────────────────────

	Практически полностью повторяет свою предыдущую версию.

		 3.2.3.10. Вирус "Yankee Doodle - 29"
                 ────────────────────────────────────

	Практически полностью повторяет свою предыдущую версию.

		 3.2.3.11. Вирус "Yankee Doodle - 2C"
                 ────────────────────────────────────

	Отличия от вируса "Yankee Doodle - 29" :

	1) Вирус в EXE- и COM-файлах имеет различную длину: к  COM-файлу
	   помимо тела вируса  дописываются 4 байта  F4h, 7Ah, NNh,  00h
	   (NNh - версия вируса, в данном случае - 2Ch).

	2) Вирус дезактивирует резидентную часть вируса "Ping-Pong".

	3) Вирус  исполняет  мелодию  "Yankee  Doodle  Dandy"  в 17.00 с
	   вероятностью  1/8  в  зависимости   от  числа  открытых   для
	   заражения файлов.

		 3.2.3.12. Вирус "Yankee Doodle - 2D"
                 ────────────────────────────────────

	Практически полностью повторяет свою предыдущую версию.


	       3.2.4. Семейство "Иерусалимских" вирусов
	       ────────────────────────────────────────

		    3.2.4.1. "Иерусалимский" вирус
		    ──────────────────────────────

	Этот резидентный файловый вирус очень распространен, упоминается
также  как  "Черная  Дыра",  "Тринадцатая  Пятница", "Вирус Замедления",
"Израильский" вирус.

	Очень опасен 13-го числа любого месяца, если этот день  является
пятницой, и опасен во все остальные дни.

	Заражает  .COM-  и  .EXE-файлы  при  загрузке  их  в  память для
выполнения  (int  21h,  ax=4B00h),   ограничений  на  длину  файлов   не
обнаружено. Вирус анализирует имя заражаемого файла и не заражает  файлы
с именем COMMAND.COM, чем несколько затрудняет свое обнаружение.

	При заражении .COM-файла вирус функцией ALLOC (int 21h,  ah=48h)
выделяет  память,  куда  копирует  себя,  а затем зараженный файл (таким
образом, при заражении не вирус дописывается к файлу, а файл к  вирусу).
Затем уже  зараженный файл  сохраняется на  диск и  к нему добавляется 5
байтов (в наиболее распространенной версии  вируса - "MsDos").  По  этим
байтам вирус отличает зараженные  файлы от незараженных и  не производит
повторного инфицирования.

        Инфицирование  .EXE-файлов  производит  стандартным  образом   и
изменяет значение контрольной суммы  на 1984h). Проверочные 5  байтов не
дописываются, т.е.  .EXE-файлы могут  инфицироваться повторно.  Возможно
внедрение вируса  в середину  файлов (в  результате ошибки  вируса), что
может привести к их потере.

	При выполнении инфицированной программы вирус проверяет  наличие
своей копии  в памяти  компьютера.   Затем вирус  остается резидентным в
памяти, при этом он выполняет следующие действия:

	а) сохраняет   в  своем  теле  значения байтов памяти с адресами
	   003FCh-003FEh;
	б) по   этим  адресам  вирус  помещает  программу  копирования и
	   передает ей управление;
	в) при  копировании  тело  вируса  перемещается в самые  младшие
	   адреса, выделенные для основной  программы (при этом вирус  в
	   COM-программе  копируется  сам  в  себя,  а  в  EXE-программе
	   стирает часть кода основной программы), возврат из  программы
	   копирования происходит в копию вируса;
	г) восстанавливает  старое содержимое  байтов памяти  с адресами
	   003FCh-003FEh;
	д) уменьшает размер выделенной под основную программу памяти;
	е) определяет имя основной  программы и функцией EXEC  (int 21h,
	   ax=4B00h)  запускает  ее   на  выполнение  (т.е.   происходит
	   повторный запуск основной программы);
	ж) по  окончании  работы  программы  вирус остается  резидентным
           (int 21h, ah=31h).

            а) б) в)        г) д)           е)            ж)

   │ ...     │    │ ...     │   │ ...     │   │ ...     │   │ ...     │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │EXE-     │ ┌─>│Вирус    │   │Вирус    │   │Вирус    │   │Вирус    │
   │программа│ │  ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │         │ │  │         │   │ ...     │   │EXE-     │   │ ...     │
   ├─────────┤ │  ├─────────┤                 │программа│
   │Вирус    │─┘  │Вирус    │                 │         │
   ├─────────┤    ├─────────┤                 ├─────────┤
   │ ...     │    │ ...     │                 │Вирус    │
                                              ├─────────┤
                                              │ ...     │

   │ ...     │    │ ...     │   │ ...     │   │ ...     │   │ ...     │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │Вирус    │───>│Вирус    │   │Вирус    │   │Вирус    │   │Вирус    │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │COM-     │    │COM-     │   │ ...     │   │Вирус    │   │ ...     │
   │программа│    │программа│                 ├─────────┤
   ├─────────┤    ├─────────┤                 │COM-     │
   │ ...     │    │ ...     │                 │программа│
                                              ├─────────┤
                                              │ ...     │


	Вирус изменяет вектора прерываний  8, 21h.

	При активизации вируса в любой день, кроме "13-й пятницы", вирус
перехватывает  прерывание  8  (TIMER  TICKS).  Через  некоторое время на
экране  появляется  черный  прямоугольник  и,  начиная  с этого момента,
работа  компьютера  существенно  замедляется  (при  каждом прерывании 8h
компьютер совершает холостой цикл). При активизации вируса 13-го числа в
пятницу происходит следующее:  при попытке запустить любую программу  на
выполнение файл,  содержащий эту  программу, уничтожается,  и DOS выдает
сообщение о том, что файл не найден.  В результате будут уничтожены  все
файлы, к которым произойдет обращение функции EXEC (int 21h, ax=4B00h).

	Содержит текстовую строку "COMMAND.COM".


			3.2.4.2. Вирус "SunDay"
			───────────────────────

	Модификация "Иерусалимского" вируса.

	Очень опасен: уничтожает файлы  при запуске их на  выполнение. В
воскресенье выдает сообщение: "Today is SunDay! Why do you work so hard?
All work and no play make you a dull boy! Come on! Let's go out and have
some fun!".

	Помимо   указанной   содержит   еще   одну   текстовую   строку:
"COMMAND.COM".

                        3.2.4.3. Вирус "Kylie"
                        ──────────────────────

	Модификация "Иерусалимского" вируса.

        Поражает .COM и .EXE-файлы начиная с 20 января 1990 г. по  схеме
"Иерусалимского" вируса.  С 13  июля 1990  г. проявляется  проигрыванием
мелодии.

        Перехватывает прерывания 1Ch и 21h. Содержит текстовые строки: 
"Kylie Minogue" и "COMMAND.COM".


		   3.2.5. Семейство вирусов "Reset"
		   ────────────────────────────────

		      3.2.5.1. Вирус "Reset-648"
		      ──────────────────────────

	Нерезидентный вирус. Очень опасен:  с вероятностью  примерно 1/8
необратимо портит файлы.

	Заражает .COM-файлы в текущем каталоге и в каталогах, отмеченных
системной   переменной   PATH.    Заражение   происходит   при   запуске
инфицированной программы, при этом заражается не более одного файла.

	При  попытке  заражения  у  файла  проверяется  значение  секунд
последней модификации файла, если оно равно 1Fh (62 секунды), то файл не
заражается. При  заражении файла  вирус проверяет  системное время, если
значения последних трех  бит шестнадцатеричного разложения  секунд равны
0, то вирус "убивает" файл, записывая в его начало 5 байтов перехода  на
перезагрузку (JMP F000:FFF0).  Восстановить в первоначальном виде  такой
файл  невозможно.   Если  cреди  значений  последних трех бит разложения
секунд есть хоть одна единица, то вирус дописывает себя к файлу и меняет
первые  3  байта  файла.   Затем  вирус  устанавливает  значение  секунд
последней модификации файла в 1fh.

		      3.2.5.2. Вирус "Reset-627"
		      ──────────────────────────

	Безвредный   вирус.    Отличается   от   Reset-648"  несколькими
командами  и  тем,  что  не  "убивает"  файлы  (обойдены соответствующие
команды).

		      3.2.5.3. Вирус "Reset-623"
		      ──────────────────────────

	Очень опасный  вирус, практически  полностью овпадает  с вирусом
"Reset-648".   При порче  файла в  его начало  записывается команда  JMP
C800:0000.

		     3.2.5.4. Вирус "Microsoft 88"
		     ─────────────────────────────

	Безвреден.  Заражает .COM-файлы в текущем и корневом  каталогах.
Заражение  происходит  при  запуске  инфицированной  программы, при этом
заражается не более одного файла.

	При  попытке  заражения  у  файла  проверяется  значение  месяца
последней его модификации и, если оно равно 0Dh (13-й месяц), то файл не
заражается.   Заражение производится  стандартным способом.  Затем вирус
устанавливает значение месяца последней модификации файла в 0Dh.

	Содержит текстовую строку "Microsoftyright Microsoft 1988".


		    3.2.5.5. Вирус "Kemerovo-Reset"
		    ───────────────────────────────

	Опасный вирус,  длина -  256 байт.  Заражает .COM-файлы текущего
оглавления при запуске инфицированной программы, повторного заражения не
производит.  Копирует себя в конец  файла и изменяет его первые 4  байта
( XCHG AX,DX; JMP  Loc_Virus ).  Длина  файлов перед дописыванием к  ним
вируса  увеличивается   на  1   байт  (т.е.   длина  заражаемых   файлов
увеличивается на 256+1 байт).

	В  зависимости  от  текущего  времени может вызвать перезагрузку
компьютера.  Содержит  строку  ".COM".  При  попытке заражения открывает
файлы и может оставить их незакрытыми.

		      3.2.5.6. Вирус "Reset-644"
		      ──────────────────────────

	Модификация  вируса  "Reset-648".   Поражает  файлы  только если
значение  минут  системного  времени  меньше  20. Изменяет 5 байт начала
файла (PUSH CS; POP DS;  CALL Loc_Virus).  Устанавливает некоторые  биты
времени последней модификации файла ( OR 1234h).


		      3.2.5.7. Вирус "Big Piter"
		      ──────────────────────────

	Модификация  вируса  "Reset-648".  Поражает  файлы   стандартным
образом, устанавливает время последней модификации файла - 62 секунды.

	Состоит  из  двух  блоков.  Первый  блок  ("голова") практически
полностью повторяет вирус "Reset-648"; он осуществляет заражение  файлов
и  вызов  второго  блока.  Второй  блок  (основной)  получен  при помощи
компилятора Microsoft C (об этом говорят тексты в теле вируса). Основной
блок  выводит  на  экран   изображение  компьютера  и  текст   "regional
engeneering centre LENINFORMATIKA ...", после чего может (в  зависимости
от некоторых условий) оставить резидентную программу, блокирующую запись
на винчестер.

	Очень опасен - может уничтожить COM-файлы длиной более 40K.

	Помимо указанного текста содержит все строки, которые  вставляет
в тела программ компилятор Microsoft C.

	Изменяет прерывание 60h - использует для вызова основного блока.


		      3.2.5.8. Вирус "Reset-507"
		      ──────────────────────────

	Модификация  вируса  "Microsoft  88",  практически полностью его
повторяет. Текстовых строк не содержит.



		   3.2.6. Семейство вирусов "Eddie"
		   ────────────────────────────────

			3.2.6.1. Вирус "Eddie"
			──────────────────────

	Очень опасный резидентный  файловый вирус. Быстро  размножается:
инфицирует COM- и EXE-файлы при загрузке их в память для выполнения, при
создании, переименовании, открытии и  закрытии файла (int 21h,  ax=4B00h
или ah=3Ch, 5Bh, 56h, 3Dh, 2Eh).

	При создании своей копии  в оперативной памяти компьютера  вирус
пытается  занять  область  памяти  с  самыми старшими адресами, разрушая
временную  часть  командного  интерпретатора  COMMAND.COM.  По окончании
работы  программы  командный  интерпретатор  COMMAND.COM восстанавливает
свою временную часть, при этом происходит открытие файла COMMAND.COM  и,
соответственно,  его  заражение.   Таким  образом, наиболее подверженным
заражению файлом является COMMAND.COM.

	Вирус предпринимает ряд эффективных мер для того, чтобы остаться
незамеченным:

	1) При старте любой программы вирус помечает программный сегмент
	   как последний и становится  невидимым для этой программы,  по
	   окончании работы программы вирус помечает программный сегмент
	   как не последний.
        2) Аналогично  вирус  поступает  с  вектором прерывания 21h  при
	   старте  программы:  он  восстанавливает  его   первоначальное
	   значение.
        3) Вирус не позволяет программам изменять вектор прерывания  21h
	   и  защищается  таким  образом  от  резидентных   антивирусов,
	   установленных после того как активизировался вирус .
        4) Вирус пытается обойти программы, следящие за прерыванием 13h,
	   и  установить  вектор  этого  прерывания в его первоначальное
	   значение.

	Вирус  очень  опасен:  периодически  стирает сектор со случайным
номером  ("оплевывает"  диск),  при  этом  он  может  уничтожить   часть
информации на диске. Вирус анализирует 2 байта (8-й и 10-й) BOOT-сектора
диска, с которого была запущена зараженная программа.  Вирус увеличивает
на 1 значение 10-го  байта и сохраняет его  в BOOT-секторе.  Если  новое
значение 10-го  байта кратно  16, то  вирус стирает  на диске  сектор со
случайно выбранным номером, зависящим от значения 8-го байта.

	Изменяет вектора прерываний 13h, 21h, 27h.

	Содержит  текстовые  строки  "Eddie  lives...somewhere in time",
"Diana P.", "This program was written  in the city of Sofia (C)  1988-89
Dark Avenger".


			3.2.6.2. Вирус "V-2000"
			───────────────────────

	Очень опасный резидентный  файловый вирус. Быстро  размножается:
инфицирует файлы при загрузке их в память для выполнения, при  создании,
переименовании, открытии и закрытии файла, при чтении или изменении  его
атрибутов (int 21h, ax=4B00h или ah=3Ch, 3Dh, 3Eh, 43h, 56h, 5Bh).

	Вирус следит за тем, чтобы длины заражаемых файлов увеличивались
ровно  на  2000  байт  (к  EXE-файлам,  помимо  выравнивания  на границу
параграфа, дописывается соответствующее число байт). У заражаемых файлов
(как и  при поражении  вирусом "Reset")  устанавливается новое  значение
секунд даты последней модификации - 62 секунды.

	Вирус предпринимает ряд эффективных мер для того, чтобы остаться
незамеченным, многие из них  повторяют аналогичные меры вируса  "Eddie".
Маскирующую  функцию  играет  длина  вируса:  достаточно трудно заметить
приращение длины, кратное 1000 байтам. Введена и другая функция  защиты:
вирус перехватывает функции DOS  FindFirst и FindNext (int  21h, ah=11h,
12h) и  "уменьшает" длины  зараженных файлов  на 2000  байт, т.е.  вирус
невозможно  определить  по  изменению  длин  файлов  (если,  конечно, он
резидентно находится в памяти). Утилиты, которые не используют указанные
функции  DOS  (например,  Norton   Commander),  а  напрямую   используют
содержимое  секторов,  хранящих  каталог,  показывают  правильную  длину
зараженных  файлов.  При  "уменьшении"  длин  файлов вирус определяет их
зараженность по значению секунд даты последней модификации (62  секунды)
и  не  проверяет  истинных  длин  файлов.  Если  такое  значение  секунд
встретится у файла  небольшой длины (меньше  2000 байт), то  команда DIR
выдаст несколько странную длину файла - около 4 гигабайт.

	Вирус очень опасен: аналогично вирусы "Eddie" стирает cектор  со
случайным  номером.  При  этом  вирус  обращается  напрямую  к драйверу,
обслуживающему диск, и обходит многие резидентные блокировщики.

	Содержит текстовые строки: "Zopy me - I want to trawel",  "Диана
П.", "(c) 1989 by Vesselin Bontchev".

	Если в  теле запускаемой  программы содержится  строка "Vesselin
Bontchev" (Весселин Бончев - автор известных болгарских антивирусов), то
вирус зацикливается и система зависает.

	Изменяет вектора прерываний 13h, 21h, 27h.


			  3.2.7. "Peterburg"
			  ──────────────────

	Файловый  резидентный  вирус,  не  опасен. Инфицирует .COM-файлы
при  загрузке  их  в  память  для  выполнения (int 21h, ax=4B00h). Вирус
внедряется в файл по следующей схеме:

	а) переписывает первые 529 байт файла в его конец;
	б) записывает в начало файла свое тело.

	     ┌────────┐  а)   ┌────────┐  б)   ┌────────┐
             │Файл    │───┐   │Свободно│       │Вирус   │
             │--------│   │   ├────────┤       ├────────┤
             │        │   │   │Файл    │       │Файл    │
             │        │   │   │        │       │        │
             └────────┘   │   │--------│       │--------│
                          └──>│        │       │        │
		              └────────┘       └────────┘

	При   выполнении   инфицированной   программы   вирус   остается
резидентным в памяти, совершая следующие действия:

	а) изменяет  размер  выделенной  под основную программу  памяти,
	   резервируя дополнительную память для своих нужд;
	б) определяет имя основной  программы и функцией EXEC  (int 21h,
	   ax=4B00h)  запускает  ее   на  выполнение  (т.е.   происходит
	   повторный запуск основной программы);
	в) по  окончании  работы  программы  вирус остается  резидентным
	   (int 21h, ah=31h).

		     а)              б)              в)
	│ ...     │     │ ...     │     │ ...     │     │ ...     │
	├─────────┤     ├─────────┤     ├─────────┤     ├─────────┤
	│Вирус    │────>│Вирус    │     │Вирус    │     │Вирус    │
	├─────────┤     │- - - - -│     │- - - - -│     │- - - - -│
	│Программа│     │         │     │         │     │         │
        │         │     ├─────────┤     ├─────────┤     ├─────────┤
	├─────────┤     │ ...     │     │Вирус    │     │ ...     │
	│ ...     │                     ├─────────┤
			                │Программа│
			                │         │
			                ├─────────┤
			                │ ...     │

	Вирус никак не проявляется и не имеет деструктивной функции.


               3.2.8. Семейство вирусов "IV" ("Cancer")
	       ────────────────────────────────────────

			3.2.8.1. Вирус "IV-345"
			───────────────────────

	Нерезидентный  очень  опасный  вирус.  Заражает все .COM-файлы в
текущем оглавлении, дописывая себя в начало файла.

	Быстро  проявляется:  начиная  с  пятого  "поколения" вируса при
старте  зараженной  программы  с  вероятностью  1/2 на экране появляется
сообщение :  "Programm  sick  error:  Call doctor or buy PIXEL for  cure
description".

	Вирус  не  имеет  деструктивной  функции,  но  очень опасен: при
инфицировании  файла  не  проверяет  его  длину.  Это  может  привести к
уничтожению файла.


			3.2.8.2. Вирус "IV-740"
			───────────────────────

	Нерезидентный очень опасный вирус. Заражает .COM-файлы в текущем
оглавлении, дописываясь  в начало  файла. Является  мутацией предыдущего
вируса данного семейства.  Отличия:

	а) возможно   повторное   заражение   файлов,  что   увеличивает
	   опасность вируса;
	б) не выдаются сообщения на экран.


			3.2.8.3. Вирус "IV-847"
			───────────────────────

	Нерезидентный очень опасный вирус. Заражает .COM-файлы в текущем
оглавлении, дописываясь  в начало  файла. Является  мутацией предыдущего
вируса данного семейства.


			 3.2.9. Вирус "Murphy"
			 ─────────────────────

	Неопасный  резидентный  файловый  вирус.  Быстро   размножается:
стандартным способом  инфицирует файлы  при загрузке  их в  память и при
открытии файлов (int 21h, ah=3D, 4Bh, 6Ch).

	Процедура копирования вируса в память во многом повторяет  вирус
"Eddie", после чего вирус "Murphy",  как и вирус "Eddie", поражает  файл
COMMAND.COM.

	Через некоторое время после активизации вирус начинает  издавать
мерзкий свист очень высокого тона.

	Изменяет вектор прерывания  21h.

	Содержит  текст:  "I'm  Murphy.  Nice  to  meet  you friend. I'm
written since  Nov/Dec.   Copywrite (c)1989  by Lubo  & Ian,  Sofia, USM
Laboratory."

		      3.2.10. Вирусы С.Олейникова
                      ───────────────────────────

			3.2.10.1. Вирус "V-600"
			───────────────────────

	Файловый резидентный  вирус, безобиден.  Часть вируса  (50 байт)
зашифрована (XOR DDh).

	Инфицирует .COM-файлы  при загрузке  их в  память для выполнения
(int  21h,  ax=4B00h).  Вирус  внедряется  в файл по схеме, напоминающей
вирус "Peterburg":  переписывает начало  заражаемого файла  (600 байт) в
его конец  и записывает  свою копию  в освободившийся  участок. При этом
переписываемая часть файла шифруется (XOR BBh).

	Изменяет вектор прерывания  21h.

	Вирус никак не проявляется  и не имеет деструктивной  функции. В
теле    вируса    содержится    зашифрованный    (XOR    1Ah)     текст:
"Oleynikoz S.,1990".

		      3.2.10.2. Вирус "Voronezh"
		      ──────────────────────────

	Резидентный  файловый  опасный  вирус.  Поражает  файлы  при  их
выполнении  или  открытии  (int  21h,  ax=4B00h  или  3D00h).  COM-файлы
заражаются по схеме вируса V-600.

	EXE-файлы инфицируются по сложному алгоритму:  у них  изменяется
5 байт точки входа  в программу на код  команды CALL FAR Loc_Virus,  при
этом изменение адреса точки входа в заголовке файла не требуется.  Вирус
корректирует  таблицу  настройки  адресов  (ТНА):   добавляет в нее один
элемент, соответствующий команде CALL FAR Loc_Virus; необходимым образом
изменяет 1  элемент ТНА,  указывающий на  измененные 5  байт (если такой
элемент существует). Затем вирус дописывает  к  файлу свою копию  (длина
файла  при этом НЕ увеличивается до параграфа).

	Перехватывает прерывание 21h.

	Вирус содержит ошибки: анализируются не более 640 элементов ТНА;
не анализируется случай, когда  модифицируемый элемент ТНА указывает  на
5-й байт от точки входа (т.е. слово, которое настраивается при  загрузке
файла, лежит  на границе  изменяемых 5  байт). При  запуске такого файла
возможно зависание компьютера.

	Судя по информации, предоставленной Д.Н.Лозинским, вирус написан
неким  "мелким   пакостником"  Стасом   Олейниковым  специально   против
антивируса   AIDSTEST.EXE.  Механизм  прикрепления  вируса  к EXE-файлам
разработан таким  образом, что  AIDSTEST.EXE не обнаруживает изменений в
своем  теле.  Вероятно,  С.Олейников  не  остановится  на  достигнутом и
принесет  немало  неприятностей  организациям,  в  которых ему предстоит
работать.

			3.2.11. Вирус "RC-492"
			──────────────────────

	Очень опасный файловый резидентный вирус. Заражает COM-файлы при
запуске их на выполнение (int 21h, ax=4B00h), длин файлов не  проверяет.
Копирует  себя   в  конец   файла  и   изменяет  его   первые  6    байт
(JMP xx xx zz zz zz).

	При активизации ищет файл C:\COMMAND.COM и инфицирует его. Затем
остается резидентным  в памяти.  Для этого  он копирует  себя в  область
памяти,  содержащую  таблицу  векторов  прерываний, по адресу 0000:0200.
Если в памяти компьютера находятся программы, использующие  уничтоженные
таким образом вектора прерываний, то произойдет зависание системы.

	Имеет  деструктивную  функцию:  периодически  стирает  несколько
секторов со случайными номерами.

	Изменяет вектора прерываний  1Сh и 21h.

	Содержит  команду  `push  100h',  поэтому не распространяется на
компьютерах с процессором 8086/88 (кроме Olivetti).


		       3.2.12. Вирус "LoveChild"
		       ─────────────────────────

	Очень опасный  файловый резидентный  вирус. Заражает  .COM-файлы
при их загрузке в память, при открытии и создании (int 21h, ah=3Ch, 3Dh,
4Bh и 5Bh),  длин файлов не  проверяет.  Копирует  себя в конец  файла и
изменяет его первые 4 байта ( STI; JMP Loc_Virus ).

	При создании своей резидентной копии переписывает себя в область
памяти, содержащую таблицу векторов прерываний, по адресу 0000:01E0.

	Если на компьютере установлена DOS 3.30, то вирус  предпринимает
маскирующие действия - вирус "знает" адрес обработчика прерывания 21h  и
адрес, по которому хранится исходное значение прерывания 13h.  Используя
это,  вирус  модифицирует  память,  занятую операционной системой, таким
образом, что обрабатывает вызов прерывания 21h непосредственно перед DOS
(записывает вместо первых пяти  байт обработчика прерывания 21h  команду
перехода  на  вирус  -  JMP  FAR  Loc_Virus).  С  прерыванием  13h вирус
поступает проще - восстанавливает его первоначальное значение.

	Имеет деструктивные функции:  в зависимости от  счетчика времени
может уничтожать файлы или создавать вместо файла подкаталог с таким  же
именем. Вирус периодически модифицирует EXE-файлы таким образом, что  их
запуск вызовет стирание секторов винчестера (стирается часть информации,
расположенной на секторах, соответствующих 0-3 головкам записи/чтения).

	Перехватывает вектор прерывания 21h.

	Содержит текстовые строки: "v2 (c) Flu Systems (R)" и "LoveChild
in reward for software sealing".


		       3.2.13. Вирус "ATTENTION"
		       ─────────────────────────

	Опасный файловый резидентный  вирус. Заражает .COM-файлы  при их
загрузке в  память (int  21h, ah=4Bh).   Копирует себя  в конец  файла и
изменяет его первые 16 байт :

        ┌───┬────┬────┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬───┬───────────
        │JMP Loc_Virus│A T T E N T I O N     !│1Ah│   файл
        └───┴────┴────┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴───┴───────────
	    3 байта            12 байт        1 байт

	При создании  своей резидентной  копии использует  самые старшие
адреса доступной  памяти (как  и вирусы  семейства Eddie). Перехватывает
прерывание 24h, но не восстанавливает его первоначальное значение -  это
может  привести  к  зависанию  системы.  Снимает атрибут  read-only и не
восстанавливает его.

	Перехватывает вектор прерывания 21h.

	Проявляется при заражении файлов на защищенном от записи диске -
у дисковода A:  включается мотор (вне  зависимости от диска,  к которому
идет обращение). Зараженные файлы, начиная с 4-го байта, содержат строку
"ATTENTION !".

			 3.2.14. Вирус "Bebe"
			 ────────────────────

        Опасный  файловый  нерезидентный   вирус.  Заражает   .COM-файлы
текущего оглавления. Увеличивает размер заражаемого файла до  параграфа,
копирует себя в  конец файла и  изменяет его первые  14 байт (  PUSH AX;
... ; JMP FAR Loc_Virus ).

        Нерезидентен,  но  создает  резидентную  программу.   Для  этого
копирует  часть  своего  тела  в  таблицу  векторов прерываний по адресу
0000:01CE  и  устанавливает  на  нее  прерывание  1Ch  (таймер).   Через
некоторое время на экране появляется сообщение:

			╔════════ VIRUS ! ══════╗
			║  Skagi "bebe" >       ║
			╚═══════════════════════╝

	После того, как с  клавиатуры вводится "bebe", вирус  добавляет:
"Fig Tebe !". По словарному запасу вируса можно вполне точно  определить
его происхождение.

	Содержит ошибку - не  восстанавливает DTA. Это может  привести к
зависанию компьютера.

	Помимо перечисленного текста содержит строку "*.COM".


			 3.2.15. Вирус "4096"
			 ────────────────────

	Файловый резидентный вирус, длина 4096 (1000h) байт.

	Поражает файлы при  их запуске или  закрытии (int 21h,  ax=4B00h
или ah=3Eh).  Возможно  поражение файлов данных. Перед  заражением файлы
дополняются до параграфа.  Дописывает свою копию так, чтобы размер файла
увеличился  ровно  на  4096  байт  (см.   3.2.6.2).  У пораженных файлов
увеличивает  значение  времени  последней  модификации  на  100  лет.  У
COM-файлов изменяются первые 6 байт, у EXE - заголовок.

	При внедрении в  файлы пользуется истинными  значениями векторов
прерываний  13h  и  21h,  которые  получает по алгоритму "Yankee Doodle"
(3.2.3.4).   Дополнительно  к  этому,  как  и  "LoveChild", модифицирует
первые 5 байт обработчика прерывания 21h.

	При создании резидентной копии располагается в старших  адресах,
что приводит к  заражению файла COMMAND.COM.  Устанавливает в своем  MCB
адрес владельца (owner),  совпадающий с адресом  владельца первой MCB  в
системе,  маскируясь   под  DOS.   В  дальнейшем   копия  вируса   может
перемещаться  по  памяти  в  направлении  младших  адресов, выделяя себе
новые участки памяти и освобождая старые.

	Перехватывает прерывание  21h, обрабатывает  20 (!)  его функций
(FindFirst, FindNext, Read,  Write, Lseek, Open,  Create, Close, Exec  и
т.д.) и хорошо маскируется. При обращении DOS к зараженному файлу  вирус
подставляет его  первоначальную длину  и время  модификации. При  чтении
файла  или  загрузке  его  в  память  модифицирует  считанную  с   диска
информацию таким образом, что файл  предстает в незараженном виде.   При
открытии файла  для записи  вирус лечит  его (т.к.  запись в  файл может
уничтожить часть вируса) и снова заражает при закрытии.

	Вирус  проявляется  с  22  сентября  по  31  декабря   ежегодно.
Проявления  вируса  мне  неизвестны,  поскольку  соответствующий участок
программы  оказался  уничтоженным.   Но  можно  предположить,  что вирус
"подвешивает" DOS и что-то выводит на экран.


			  3.2.16. Вирус "512"
			  ───────────────────

	Очень  опасен.  Поражает  .COM-файлы,  записываясь  в их начало.
Заражение происходит при запуске  или закрытии файла (int  21h, ax=4B00h
или  ah=3Eh).  Начало  файла  сохраняет  в первом неиспользуемом секторе
последнего кластера файла.

    │ <─────────── Файл ──────────────────────────> │
    ┌───────────┬───────────┬─  ──┬───────────┬───────────┐
    │ кластер   │ кластер   │ ... │ кластер   │ кластер   │
    └──┴──┴──┴──┴──┴──┴──┴──┴─  ──┴──┴──┴──┴──┴──┴──┴──┴──┘
     ^                                               ^  ^
     └─ Начало вируса.  Сохраненное начало файла  ───┘  │
                        Неиспользуемый сектор     ──────┘

	Длина заражаемого файла  не изменяется. У  файла устанавливается
время  последней  модификации  -  62  секунды.  При заражении в качестве
рабочей    области    используется    таблица    векторов     прерываний
(0000:0200 - 0000:03FF).

	При активизации вирус располагает свою резидентную копию в одном
из  системных   буферов.  При   заражении  файлов   активно   использует
недокументированную область DOS -  System File Table. При  чтении начала
зараженного  файла  подставляет  его  истинное  начало. Этими действиями
вирус очень хорошо маскирует свое присутствие в системе.

	Очень  опасен:  может  поражать  файлы, которые имеют расширение
имени  .CO?  (?  -  любой  знак).  Может  произойти  утеря файла при его
копировании (последний кластер файла копируется не целиком).  Произойдет
потеря файла на диске, имеющем один сектор на кластере.

	Изменяет прерывание 21h, содержит строку "666".



			 3.2.17. Вирус "1049"
			 ────────────────────

	Файловый резидентный безобидный вирус. Поражает COM- и EXE-файлы
при их  запуске на  выполнение (int  21h, ax=4B00h).  Изменяет первые 32
байта файла и дописывается в его конец.

	Во  многом  совпадает  с  вирусами  "Yankee  Doodle". Использует
вектор 21h.

			  3.2.18. Вирус "707"
			  ───────────────────

	Файловый резидентный неопасный вирус. Поражает .COM-файлы при их
запуске на выполнение (int 21h,  ah=4Bh).  Изменяет первые 5  байт файла
(MOV AX,Start_Virus; PUSH AX; RET near) и дописывается в его конец.

	Активизируется  только  в  DOS  3.30,  определяет (сканированием
памяти)  точки  входа  обработчиков  13-го  и  21h-го прерывания в DOS и
активно  их  использует  при  заражении  файлов.   Располагается в самых
старших  адресах  памяти,  корректируя  последний  MCB и уменьшая размер
доступной памяти (слово по адресу [0000:0413]).

	При заражении ведет подсчет уже зараженных файлов, и, как только
встречается  30-й  зараженный  файл,  устанавливает  прерывание  8h   на
подпрограмму генерации звукового сигнала.

	Перехватывает прерывания 8 и 21h. Текстовых строк не содержит.


                          3.2.19. Вирус "905"
			  ───────────────────

        Файловый резидентный неопасный вирус. Поражает EXE-файлы при  их
запуске на выполнение (int  21h, ah=4B00h). Изменяет заголовок  файла и,
НЕ дополняя файл до параграфа, дописывается в его конец.

        При  активизации  уменьшает  последний  блок  (Z-блок)  памяти и
копируется в освободившееся место.

        Проявляется  в  зависимости  от  своих  внутренних  счетчиков  и
текущего года, месяца, дня и  только при наличии адаптера EGA.  При этом
наблюдается достаточно интересный видео-эффект: приблизительно через  20
минут  после  активизации  вируса  все  знаки,  отображенные  на экране,
"перевернутся вверх  ногами", т.е.  'P' ->  'Ь', 'U'  -> 'П' (начертание
приблизительно).  Знаки  остаются  на  своих  местах, изменяется лишь их
изображение. Через приблизительно 10 секунд восстановится первоначальное
состояние экрана, еще через 10 секунд - знаки перевернутся и т.д.

	Перехватывает прерывания 8 и 21h. Текстовых строк не содержит.


                         3.2.20. Вирус "MGTU"
                         ────────────────────

        Файловый  нерезидентный  опасный  вирус.  Крайне примитивен. При
старте поражает все .COM-файлы текущего оглавления используя FCB из PSP.
Изменяет первые  4 байта  файла (JMP  Loc_Virus; DB  EBh -  опознаватель
зараженного файла) и дописывается в его конец. Опасен, т.к. не проверяет
длин файлов при их заражении.

        Никак не проявляется. Содержит текст "Эта пpогpамма написанна  в
МГТУ студентом гpуппы ИУ4".


                          3.2.21. Вирус "516"
			  ───────────────────

        Файловый резидентный опасный вирус.

        Поражает  COM-файлы  при  их  запуске  на  выполнение  (int 21h,
ax=4B00h).  При  этом  заражаются  только  те файлы, первый байт которых
равен E9h (т.е. файл начинается с команды JMP Loc_Progr). Вирус заменяет
4 байта по адресу Loc_Progr на код команды JMP Loc_Virus и  байт-иденти-
фикатор зараженности (см. рис.). Таким образом, при заражении файла  его
заголовок не изменяется.

             Незараженный файл          Зараженный файл

             ┌─────────────┐            ┌─────────────┐
          ┌──│JMP Loc_Progr│         ┌──│JMP Loc_Progr│
          │  │             │         │  │             │
          │  │             │         │  │             │
          └─>│             │         └─>│JMP Loc_Virus│──┐ ─┐ 4 байта
             │             │            │DB  Infected │  │ ─┘
             │             │            │             │  │
             └─────────────┘            ├─────────────┤  │
                                        │             │<─┘
                                        │             │
                                        └─────────────┘

        При  активизации  обрабатывает  DOS  2.x,  3.x,  4.0.  Уменьшает
количество дисковых  буферов на  1 и  записывает свою  копию в последний
буфер.

        Периодически при опросе версии  DOS (int 21h, f.30h)  возвращает
ноль (т.е. версия DOS 0.0). Помимо этого никак не проявляется.

        Перехватывает прерывание 21h. Текстовых строк не содержит.


                        3.2.22. Вирус "Alabama"
                        ───────────────────────

        Файловый резидентный опасный вирус. Поражает .EXE-файлы текущего
оглавления диска, с которого  запускается на выполнение какой-либо  файл
или на котором открывается файл (int 21h, ah=4Bh, 3Eh). Поражаемый  файл
ищется  при  помощи  функций  FindFirst  и  FindNext  и  не  обязательно
совпадает с открываемым или запускаемым файлом. При заражении использует
FCB-функции  работы  с  файлами,  дописывается  в  конец файла, возможно
некорректное  заражение.   У  зараженного  файла  устанавливается  время
последней модификации - 62 секунды.

        "Выживает" при перезагрузке - для этого устанавливает прерывание
9h (клавиатура), перехватывает  нажатие клавиш Alt-Ctrl-Del,  после чего
гасит  экран  и  вызывает  процедуру  загрузки  (int 19h). При этом коды
вируса не стираются.

        В  зависимости  от  текущего  времени  может  выдать  на   экран
сообщение типа:

        ╔═════════════════════════════════════════════════════╗
        ║ SOFTWARE COPIES ARE PROHIBITED BY INTERNATIONAL LAW ║
        ║                                                     ║
        ║          Box 1055 Tuscambia ALABAMA                 ║
        ╚═════════════════════════════════════════════════════╝

        Перехватывает  прерывания  9  и  21h.  Cодержит текстовую строку
"????????EXE".  Не  содержит   деструктивных  функций,  но   некорректно
работает с файлами и памятью - может завешивать систему.


            3.2.23. Вирусы семейсива "April 1st" ("SURIV")
            ──────────────────────────────────────────────

                    3.2.23.1. Вирус "April 1st COM"
                    ───────────────────────────────

        Файловый резидентный опасный вирус.

        Поражает  .COM-файлы  (кроме  COMMAND.COM)  при  их  запуске  на
выполнение  (int  21h,  ax=4B00h).  Опасен  -  не проверяет длин файлов.
Записывается в начало файла. При заражении:

        а) создает файл TMP$$TMP.COM;
        б) записывает в него свою копию;
        в) дописывает в него заражаемый файл;
        г) уничтожает заражаемый файл;
        д) переименовывает TMP$$TMP.COM в имя заражаемого файла.

        При  создании  своей  резидентной  копии  использует функцию 31h
прерывания 21h (по схеме "Иерусалимского" вируса).

        Проявляется начиная с 1  апреля 1988 года при  заражении файлов:
1 апреля  выводит сообщение  "APRIL 1ST  HA HA  HA YOU  HAVE A  VIRUS" и
завешивает  систему;  в  последующие  дни  выводит сообщение "YOU HAVE A
VIRUS !!!".

        Перехватывает  прерывание  21h.  Помимо  перечисленных  содержит
текстовые строки  "sURIV" (в  начале зараженного  файла), "COMMAND.COM",
"TMP$$TMP.COM".


                    3.2.23.2. Вирус "April 1st EXE"
                    ───────────────────────────────

        Файловый резидентный опасный вирус.

        Поражает  .EXE-файлы  при  их  запуске  на  выполнение (int 21h,
ax=4B00h).  Опасен  - не вполне  корректно работает с  длиной файла. При
заражении внедряется в  середину файла между  заголовком (EXE header)  и
загружаемым модулем, при этом вирус:

        а) создает файл TMP$$TMP.EXE;
        б) считывает  из  заражаемого   файла   первые  1Bh   заголовка,
           модифицирует  в  них  байты,  соответствующие  длине  модуля,
           стартовым значениям CS, IP,  SS, SP, контрольной сумме  файла
           (устанавливается   значение    1984h);    затем    записывает
           модифицированный заголовок в файл TMP$$TMP.EXE;
        в) копирует  из  заражаемого   файла   в  TMP$$TMP.EXE   таблицу
           настройки  адресов  (ТНА),  модифицируя  ее  описанным   ниже
           способом;
        г) дописывает в файл TMP$$TMP.EXE копию вируса;
        д) дописывает в файл TMP$$TMP.EXE загружаемый модуль
           инфицируемого файла.
        е) уничтожает заражаемый файл;
        ж) переименовывает TMP$$TMP.EXE в имя заражаемого файла.

               Незараженный файл        Зараженный файл
                 ┌───────────┐          ┌───────────┐
                 │EXE header │ ───────> │EXE header │
                 ├───────────┤          ├───────────┤
                 │Загружаемый│ ───┐     │Вирус      │
                 │модуль     │    │     │           │
                 │           │    │     ├───────────┤
                 │           │ ─┐ └───> │Загружаемый│
                 └───────────┘  │       │модуль     │
                                │       │           │
                                └─────> │           │
                                        └───────────┘

        Так  как  загружаемый  модуль  файла  при заражении смещается на
расстояние,  равное  длине  вируса,  то  вирусу  приходится  производить
соответствующие  изменения  в  ТНА:  у  каждого  элемента ТНА содержимое
байтов, соответствующих  смещению сегмента,  увеличивается на  значение,
равное длине вируса в параграфах.

        При  создании  своей  резидентной  копии  использует функцию 31h
прерывания 21h (по схеме "Иерусалимского" вируса).

        Проявляется  начиная  с  1  апреля  1988  года  при активизации:
первого апреля расшифровывает (XOR  FFh) и выводит сообщение  "APRIL 1ST
HA HA  HA YOU  HAVE A  VIRUS" и  завешивает систему;  в последующие  дни
сообщение не выводит, систему  завешивает через приблизительно 55  минут
после активизации.

        Перехватывает прерывание 21h и,  в зависимости от текущего  дня,
может  перехватывать   прерывание  1Ch.   Содержит  строки   "sURIV"   и
"TMP$$TMP.EXE".


                       3.2.24. Вирус "Joker-01"
                       ────────────────────────

        Файловый резидентный  неопасный вирус.  Синтез вирусов  "Falling
Letters" (создание резидентной копии), "VACSINA" (заражение EXE-файлов),
"Yankee Doodle" (обработка прерывания 21h) и программы-шутки  "FACE.COM"
(видео-эффекты). Имеет значительный размер - около 30 Кб.

        Поражает файлы при их запуске на выполнение (int 21h, ax=4B00h).
COM-файлы  поражаются  стандартным  способом,  EXE-файлы  переводятся  в
COM-формат по алгоритму вируса "VASCINA-04".

        При активизации  определяет в  DOS адрес  обработчика прерывания
21h.   Для   этого   используется   алгоритм   "Yankee   Doodle".  Затем
устанавливает  прерывание  1Ch,  которое  используется  для   реализации
процедуры "всплытия" обработчика 21h-го прерывания.

        При успешном  поражении файла  вирус устанавливает  прерывание 9
(клавиатура)  и  запускает  внутренний  счетчик.  Счетчик уменьшает свое
значение на 1  при каждом нажатии  на клавишу. При  достижении счетчиком
ноля на экране появляется изображение рожицы.

        Перехватывает прерывания 9, 1Ch и 21h. В конце зараженного файла
содержится строка "JOKER-01".


                        3.2.25. Вирус "Mirror"
                        ──────────────────────

        Файловый резидентный очень  опасный вирус. Стандартным  способом
поражает каждый 3-й запускаемый (int 21h, ah=4Bh) .COM-файл. Меняет  при
этом  4  байта  заголовка  (JMP   Loc_Virus,  DB  17h  -   идентификатор
зараженности).

        Достаточно  странно  манипулирует  с  памятью при создании своей
резидентной  копии  -  не  исключено,  что у меня немного "подпорченный"
образец вируса.

        При 1000-м вызове прерывания 21h экран "переворачивается"  (верх
<-> низ, право  <-> лево), а  в нулевой сектор  (содержащий MBR) первого
винчестера записываются  коды вируса,  при этом  первые 5  байт кодов  -
команда перехода на перезагрузку (JMP FAR F000:FFF0).

        Перехватывает прерывание 21h. Текстовых строк не содержит.




			3.3. Загрузочные вирусы
			═══════════════════════

		3.3.1. Семейство "Итальянских" вирусов
		──────────────────────────────────────

		      3.3.1.1. Вирус "Ping-Pong"
		      ──────────────────────────

	Не  опасен.  Заражает  BOOT-секторы  дисков  при обращении к ним
(int 13h). На диске располагается стандартным способом.

	Заражает  диски,   имеющие  следующие   характеристики:   размер
сектора - 200h байт, число секторов в кластере - 2.

	"Ping-Pong"  имеет  байт,  содержащий  номер версии вируса. Если
вирус  обнаруживает  диск,  зараженный  своей  предыдущей версией, то он
"обновляет" ее.

	Вирус изменяет вектора прерываний  8 и 13h.

	Вызывает видеоэффект скачущего шарика (знак 07h ASCII),  который
перемещается по экрану, отражаясь от знаков и границ экрана.

		   3.3.1.2. Вирус "Hacked Ping-Pong"
		   ─────────────────────────────────

	Очень опасен: стирает первые 8 секторов флоппи-диска.

	Является модификацией вируса  "Ping-Pong" и почти  полностью его
повторяет. Отличие: вместо запуска скачущего шарика происходит установка
прерывания 13h на подпрограмму уничтожения секторов флоппи-диска.

	 3.3.1.3. Вирус "Ping-Pong modified by Yankee Doodle"
	 ────────────────────────────────────────────────────

	Является модификацией вируса  "Ping-Pong" и почти  полностью его
повторяет.   Изменен  вирусом  "Yankee  Doodle"  таким  образом, что при
каждой  загрузке  вируса  "Ping-Pong"  его  версия  (байт, содержащий ее
значение) увеличивается на 1.  При достижении версией нулевого  значения
(255+1), вирус дезактивируется.


		   3.3.2. Семейство вирусов "Stone"
		   ────────────────────────────────

			3.3.2.1. Вирус "Stone"
			──────────────────────

	Очень опасный вирус, длина 512 (200h) байт (1 сектор).  Заражает
первые физические  сектора дисков:   BOOT-сектор флоппи-диска  и  Master
Boot Record винчестера.

	Состоит  из  двух  частей:  первая  часть содержит тело вируса и
хранится   в   первом   физическом   секторе   диска,   вторая  содержит
первоначальный сектор  зараженного диска  и хранится  на флоппи-диске по
адресу 1/0/3 (головка/трек/сектор), на винчестере - по адресу 0/0/7.  На
флоппи-диске вторая часть вируса  занимает один из секторов,  отведенных
под корневое оглавление. Местоположение вируса среди секторов  корневого
оглавления зависит  от объема  диска. Для  диска, отформатированного  на
360K,  это,  как  правило,  последний  сектор  корневого  оглавления. На
винчестере вторая  часть вируса  занимает либо  неиспользуемый (скрытый)
сектор, либо один из секторов в FAT (File Allocation Table).

	Флоппи-диски инфицируются  при чтении  с них  (int 13h,  ah=02).
Винчестер   -   при   загрузке   операционной   системы   с  зараженного
флоппи-диска. Повторного заражения не происходит. При сохранении на диск
второй  части  вируса  никаких  проверок  не производится, поэтому вирус
может уничтожить часть информации  на диске (на флоппи-диске  может быть
уничтожен один из секторов корневого оглавления, на винчестере - один из
секторов FAT).

	Вирус изменяет вектор прерывания 13h.

	При загрузке  с зараженного  флоппи-диска с  вероятностью 1/8 на
экране появлается сообщение: "Your PC is now Stoned!".

	Помимо указанной содержит строку "LEGALISE MARIJUANA!".


		     3.3.2.2. Вирус "Stone Rostov"
		     ─────────────────────────────

	Почти полностью повторяет вирус "Stone". Отличия:

	- не содержит текстовых строк и не выводит текст на экран;
	- при  загрузке с  зараженного флоппи-диска  с вероятностью 1/32
	  стирает на винчестере 8 секторов.



		      3.3.3. Вирус "Disk Killer"
		      ──────────────────────────

	Очень опасный вирус, длина 3072 (C00h) байта (5 секторов).

	Состоит из двух  частей:  первая  часть вируса, оформленная  как
BOOT-сектор,  располагается  в  BOOT-секторе  диска  и  содержит  начало
вируса; вторая  часть располагается  в пяти  последовательных секторах и
содержит продолжение вируса (4 сектора) и оригинальный BOOT-сектор диска
(5-й сектор).

	Заражает  BOOT-секторы  дисков  при  обращении  к  ним (int 13h,
ah=02).   Расположение вируса  на флоппи-диске  - стандартное. Винчестер
заражается  только  в  том  случае,  если  число  скрытых секторов (т.е.
расположенных  между  BOOT-сектором  и  первым  сектором FAT) больше или
равно 5. Вторая часть вируса при этом записывается в последние 5 скрытых
секторов.

	Изменяет вектора прерываний  8, 9, 13h.

	Вирус может  уничтожить всю  информацию на  диске. При  чтении с
диска (int 13h, ah=02) вирус опрашивает свой внутренний счетчик времени,
и, если значение счетчика удовлетворяет некоторым условиям,  совершаются
следующие действия:

	а) на экране появляется сообщение:

	   "Disk Killer -- Version 1.00 by COMPUTER OGRE 04/01/1989
	    Warning !!
	    Don't turn off the power or remove the diskette
	    while Disk Killer is Processing!
	    PROCESSING";

	б) уничтожается  информация  на  всех  треках  диска:  все байты
	   информации  на  нечетных  треках  двоично суммируются (XOR) с
	   байтом 55h, все байты на четных секторах - с байтом AAh;

	в) на экране появляется сообщение:

	   "Now you can turn off the power
	    I wish you luck !";

	г) компьютер "зависает" (совершает холостой цикл).


		      3.3.4. Вирус "Brain/Ashar"
		      ──────────────────────────

	Безобиден (?), длина - 3072 (C00h) байта (5 секторов).

	Заражает  BOOT-секторы  флоппи-дисков  при  обращении к ним (int
13h, ah=02). Расположение  на диске -  стандартное. У зараженного  диска
устанавливается новая метка тома:  "(C) Brain".

	Вирус  трудно  обнаружить:  при  попытке  просмотра BOOT-сектора
зараженного диска вирус "подставляет" истинный BOOT-сектор.



			3.3.5. Вирус "Den Zuk"
			──────────────────────

	Очень  опасный  вирус,  длина  4086  (1400h)  байт (9 секторов).
Заражает BOOT-сектор флоппи-дисков.

	Диски инфицируются  при обращении  к ним  (int 13h, ah=2,3,4,5).
Повторного заражения не происходит. При сохранении на диск второй  части
вируса никаких проверок не производится, поэтому вирус может  уничтожить
часть информации на диске (расположенной на 40-м треке).

	Вирус изменяет вектора прерываний 9 и 13h.

	При "теплой" перезагрузке крупными буквами выводит на экран свое
имя: "Den Zuk". Изменяет метку заражаемого диска на "Y■C■1■E■R■P".

	Вирус не  имеет деструктивной  функции, но  очень опасен:  может
уничтожить информацию на 40-м треке заражаемого диска.


			 3.3.6. Вирус "Joshi"
			 ────────────────────

	Очень  опасный  вирус,  длина  4086  (1400h)  байт (9 секторов).
Заражает BOOT-сектор флоппи-дисков и MBR винчестера.

	Диски инфицируются при обращении  к ним (int 13h,  ah=2,3,4,0Ah,
0Bh).  Повторного заражения не происходит.

	Состоит из  двух частей:   первая часть  содержит тело  вируса и
хранится в BOOT-секторе (или MBR) диска, вторая содержит  первоначальный
сектор зараженного  диска и  остальные 8  секторов вируса  и хранится на
флоппи-диске  на  40-м  или  80-м  треке  в зависимости от формата диска
(используется нестандартное форматирование);  на винчестере - начиная со
2-го сектора 0-го трека. При  сохранении своей копии на винчестер  может
уничтожить FAT.

	Вирус  перехватывает  прерывание  DOS  21h.  Для  этого он после
активизации  (загрузки  системы)  постоянно  опрашивает значение вектора
прерывания 21h и, как только оно изменяется, считывает его.

	Перехватывает прерывание  9h (клавиатура).  Обрабатывает нажатие
клавиш Alt-Ctrl-Del (перезагрузка)  и эмулирует ее:  гасит экран и  т.д.
При этом вирус  остается резидентным даже  при загрузке с  незараженного
защищенного от записи диска.

	Проявляется  5-го   января:  выводит   сообщение  "Type   `Happy
Birthday,  Joshi'!"  и  ждет  ввода  с клавиатуры фразы "Happy Birthday,
Joshi!".

	Помимо  указанной  содержит  строки  "Your  PC  is now Stoned!",
"LEGALISE".

	Изменяет вектора прерываний  8, 9, 13h, 21h.


		      3.3.7. Вирус "PrintScreen"
		      ──────────────────────────

	Очень опасный вирус, длина 512 (200h) байт (1 сектор).  Заражает
BOOT-сектор флоппи-дисков и винчестера.

	Диски инфицирует при  чтении с них  (int 13h, ah=2).  Повторного
заражения не производит. Старый Boot-сектор сохраняет на флоппи-диске по
адресу 0/1/3  (трек/сторона/сектор), на  винчестере -  по адресу 1/3/13.
При этом  может уничтожить  один из  секторов FAT  или сектор  данных (в
зависимости от объема диска). При заражении винчестера предполагает, что
Boot-сектор  расположен   по  адресу   0/1/1  (это   говорит  о   низкой
квалификации автора вируса.

	Судя по листингу вируса, при инфицировании диска с  вероятностью
1/256  (в  зависимости  от  значения  своего внутреннего счетчика) вирус
должен  вызывать  прерывание  5  (печать  экрана), но допущена ошибка, в
результате которой новое значение счетчика не сохраняется.

	Перехватывает вектор 13h.

  ═════════════════════════════════════════════════════════════════════

	Заранее благодарю всех, кто пришлет свои замечания,  предложения
или сообщит об обнаруженных в тексте неточностях.


			'Доктор'  Е. Касперский.
			 125183, Москва, ул. Б.Академическая, 73-3-11.
			 Телефон (095) 482-60-05   (21.30-23.00).

                         5 ноября 1990 г.

