








                          Вирусный Локатор.
                        ( Virus Locator 2.1 )







                              Содержание.

1.  Введение.
2.  Полная поставка Локатора.
3.  Пакетный режим работы.
4.  Диалоговый (основной) режим работы.
5.  Использование Локатора с VGA-дисплеем.
6.  Формат файлов из полной поставки.
7.  Поиск вирусов в режиме Turbo Search.
8.  История создания и развития Вирусного Локатора.
9.  Самоконтроль на заражаемость.
10. Разное.
11. Вопросы и ответы.




                        1. Введение.

  Программа VL ( Virus Locator ) предназначена для поиска вирусов, размножаю-
щихся через файлы, по маскам вирусов. Под маской вируса понимается та часть
кодов вируса, которая не изменяется при его размножении.
  VL ищет в файле все маски вирусов одновременно, а также может работать без
остановки при обнаружении вируса, выводя информацию о зараженных файлах на
принтер и/или в файл. Кроме того, VL удалит инфицированный файл (если Вы
выберете режим удаления), избавив Вас от этой нудной на большом винчестере
работы.

  По сравнению с другими детекторами Локатор обладает исключительным свойством:
способностью накапливать новые маски вирусов и информацию о них. Следовательно,
Вирусный Локатор не просто очередной детектор, а записная книжка и
информационно-справочная система по вирусам.
  Отличие VL от аналогичных программ в том, что он- открытая система. Вы полу-
чаете полную информацию о его работе, управляете Локатором.

  Вирусный Локатор может использоваться в двух вариантах, которые можно условно
назвать пассивным и активным.
  Пассивный вариант - это если Вы не разбираетесь и не хотите разбираться в
вирусных проблемах, ассемблерных кодах и прочей дребедени, и не желаете
обременять себя поиском новых вирусов и их масок. В этом случае Вы используете
VL с тем набором масок, который Вы получили. В таком варианте VL не лучше и не
хуже других вирусных детекторов.
  Активный вариант - это тот случай, когда Вы знаете PC-TOOLS, QED или что-либо
подобное, понимаете (пусть в общих чертах) механизм работы вируса и можете
определить маску вируса (не обязательно с первой попытки, я тоже ошибаюсь
иногда). Тогда Вы сможете пополнять список вирусов в Локаторе, надежно защищаясь
от компьютерной заразы.
  И действительно, даже сколь угодно мощный вирусный детектор с нерасширяемым
набором масок вирусов станет бессильным при появлении нового вируса (а новой
версии этого детектора придется ждать неделями или месяцами). Ну а если у Вас
есть VL, то через полчаса (время, потраченное на выделение маски вируса) Ваш
компьютер снова будет защищен.




                        2. Полная поставка Локатора.


  Полная поставка VL включает следующие файлы:


   VL.DOC        - файл, который Вы сейчас читаете
   VL.EXE        - собственно Вирусный Локатор (называемый далее VL)
   VL.MSK        - файл, в котором VL хранит маски и имена вирусов, а также
                   техническую информацию
   VL.HLP        - слегка сжатый (на 10%) файл с текстами Help, используемый
                   Локатором
   VL*.DSC       - обычные текстовые файлы с подробной информацией о вирусах,
                   тоже используются Локатором и носят название файлов
                   дескрипторов
   ML.EXE        - Mask Looker (маскоискатель), вспомогательная утилита для
                   облегчения выделения масок из новых вирусов
   ML.DOC        - описание утилиты Mask Looker

   RVL.EXE       - Resident Virus Locator, резидентная утилита для защиты
                   компьютера от файловых вирусов
   RVL.DOC       - описание утилиты Resident Virus Locator.


 Формат файлов будет описан в 6-м разделе.

 В VL.MSK уже установлены несколько масок вирусов: те, с которыми я столкнулся
при работе на компьютере или получил от пользователей Вирусного Локатора и от
вирусологов.
  VL ищет все необходимые ему файлы в том каталоге, в котором находится
VL.EXE. Если нужный файл не будет найден, Локатор сообщит об этом.
  Если Вы переименуете VL.EXE, например, в LOCATOR.EXE, то им будут искаться
файлы с именем LOCATOR.*.  Минимальный набор файлов для работы Вирусного
Локатора: VL.EXE и VL.MSK.



                        3. Пакетный режим работы.


  Пакетный режим работы Локатора практически ничем не отличается от работы
других антивирусов. Вы указываете опции поиска, Локатор ищет вирусы, по
окончании поиска Вы снова оказываетесь в DOS.
  Запуск Локатора :

                 VL [<опции>] [<имя каталога>] [<опции>]

   Опции :
                /F - Полный поиск вирусов в файле (файлах) - поиск с первого
                     по последний байт файла
                /N - Отключить звук
                /A - Поиск во всех файлах (не только .COM и .EXE)
                /W - Поиск по всем дискам начиная с C:
                /D - Удалять без подтверждения зараженные файлы
                /P - Вывод списка зараженных файлов на принтер
                /L - Вывод списка зараженных файлов в файл *.LST
                /O - Не останавливаться при обнаружении зараженного файла
                /B - Вывод на экран в черно-белой палитре
                /H - Help
                /2 - работа в видеорежиме 25x80 (25 строк по 80 символов
                     в строке)
                /4 - работа в видеорежиме 43x80 (EGA) или 50x80 (VGA)
                /- - отключить контроль "снега" при выводе на экран. Имеет
                     смысл только для CGA-дисплеев.


    <имя каталога> - каталог, в котором Локатор будет искать зараженные
                     файлы. Все его подкаталоги также будут просканированы

   По умолчанию :
                1) Быстрый поиск вирусов в файле (описан в 7-м разделе)
                2) Звук включен
                3) Поиск вирусов только в .COM и .EXE файлах
                4) Не удалять зараженные файлы
                5) Останавливаться при обнаружении зараженного файла
                6) Поиск по всем дискам начиная с C:
                7) Работа в текущем текстовом видеорежиме (см. раздел 5)
                8) Автоматический контроль снега при выводе на экран :
                   включен для CGA-дисплеев, выключен для всех остальных.

  Если указана хоть одна из опций (за исключением /B, /2, /4 или /-) или имя
каталога, то Локатор начнет работать в пакетном режиме.

  После завершения поиска вирусов VL возвратит один из следующих кодов :

                        0 - Нормальное завершение, вирусы не обнаружены
                        1 - Обнаружены один или несколько вирусов
                        2 - Аварийное завершение (Ошибка)




                        4. Диалоговый (основной) режим работы.


  При запуске VL без опций или только с опциями /B, /2, /4, /- Локатор будет
работать в диалоговом режиме, при котором возможно редактирование масок
вирусов, их добавление и удаление, а также доступны более многообразные режимы
поиска вирусов.
  Достаточно полный русскоязычный Help и механизм дескрипторов вирусов,
позволяющий получить обширную информацию о вирусе, также становятся доступными.
  Диалог осуществляется с помощью меню, выбором его элементов движением по меню
и затем нажатием клавиши Enter.


  В самом начале работы VL выводит на экран головное меню:

                     ┌─── Main menu ───┐
                     │                 │
                     │   Full search   │
                     │  Turbo search   │
                     │  Select options │
                     │  Show options   │
                     │  Mask editing   │
                     │  Save changes   │
                     │      Info       │
                     │      Quit       │
                     └─────────────────┘
Его элементы:

             Full search          - поиск вирусов по всему файлу.

            Turbo search          - быстрый поиск, описан в 7-м разделе

            Select options        - выбор опций поиска, ниже будет
                                    описан подробнее

            Show options          - вывод на экран текущих опций поиска
                                    вирусов

            Mask editing          - работа с масками : удаление и
                                    добавление масок, печать масок и
                                    вывод их на экран

            Save changes          - сохранение измененных опций и
                                    отредактированных масок, а также
                                    запись их в программу RVL

            Info                  - краткая информация о VL

            Quit                  - выход из VL



  Если Вы войдете в подменю Select options, то получите возможность выбора:


        Sound is                  - включения/выключения звукового
                                    сигнала, подаваемого при обнаружении
                                    вируса


        File extensions           - расширения файла, по которому будут
                                    выбираться файлы для поиска в них
                                    вирусов

        Search virus at           - поиска вируса: в каталоге, в
                                    файловой системе (системах), в
                                    конкретном файле. При поиске по
                                    каталогам происходит поиск и по
                                    подкаталогам

       Output sent to             - вывода краткой информации о
                                    найденном вирусе : на дисплей,
                                    на принтер и/или в файл
                                    с расширением .LST.

       File with virus            - реакции на зараженный файл: удаление
                                    без подтверждения, с подтверждением
                                    или не удаление


  При работе с меню пользуйтесь клавишами "стрелка вверх", "стрелка вниз",
"cтрелка вправо", "стрелка влево", Home, End, Enter, Esc.
  В каждом элементе меню имеется подсвеченная буква. Нажатие клавиши с этой
буквой равнозначно выбору данного элемента меню с нажатием клавиши Enter.
  Вы можете также использовать мышь. Движение мыши соответствует нажатию клавиш
со стрелками.  Клавиши мыши интерпретируются следующим образом :


                MicroSoft Mouse           PC Mouse

               ┌────────────┐             ┌───────────────┐
               │┌────┐┌────┐│             │┌───┐┌───┐┌───┐│
               ││    ││    ││             ││   ││   ││   ││
               ││    ││    ││             ││   ││   ││   ││
                Enter   Esc                Enter  F1  Esc




  В любой момент Вы можете вызвать Help по текущей команде. Для этого достаточно
нажать клавишу F1. Чтобы получить информацию о том, как пользоваться самим Help,
нажмите клавишу F1 дважды.


  Некоторые ограничения : VL хранит не более 500 масок, длина маски вируса не
менее 2 и не более 15 символов. Алгоритм поиска вирусов таков, что чем длиннее
маска, тем быстрее поиск. Кроме того, поиск ускоряется, если маска содержит
одинаковые символы.



  Локатор для каждой маски вируса может хранить его имя, длиной не более 31
символа.
  При именовании вирусов я придерживаюсь следующей системы: имя начинается с
типа размножения вируса, затем идет приращение файла при записи в него вируса.
  Например:  RCE1234 означает, что вирус размножается через .COM и .EXE файлы,
увеличивая их на 1234 байта и становясь резидентным.  Применяется следующая
типизация:

               C - размножение через .COM файлы
               E - размножение через .EXE файлы
               R - вирус становится резидентным


  Кроме того, для каждого вируса может быть указан его дескриптор размером до
7 символов. По дескриптору вируса на экран выводится информация о вирусе из
файла VL.DSC.

  Версия Локатора 2.1 позволяет исследовать дамп куска файла, содержащего
вирусную маску. Размер куска файла не будет превышать 4096+15 байт. Если вирус
расположен в конце файла, то дамп может иметь меньший размер, причем на экран
выводятся только те байты, которые принадлежат файлу.
  Локатор запрашивает разрешение на вывод дампа во время остановки при обнару-
жении вируса.
  При выводе дампа на экране появится та его часть, где находится обнаруженная
маска, причем коды маски будут выделены ярко-белым цветом. Это выделение
сохранится при любом листании по дампу.
  Благодаря дампу Вы можете не выходя из Локатора убедиться, действительно ли
обнаружен вирус или произошло случайное совпадение кодов в файле с маской
вируса. Как показала практика, ложная тревога чаще всего возникает при
поиске в других антивирусах, если они содержат в себе те же маски вирусов, что
и Локатор, но в незакодированном виде.




                         5.  Использование Локатора с VGA-дисплеем.


  В версии Локатора 2.1, о которой Вы сейчас читаете, большое внимание уделено
интерфейсу программы с пользователем, а также тем возможностям, которые
предоставляет новый (для СССР) тип видеоадаптера VGA.
  Вообще видеоработа Локатора организована просто : при запуске без опций /2 и
/4 он анализирует текущий видеорежим дисплея и по возможности пытается
продолжить работу в нем. Если текущий видеорежим является одним из стандартных
IBM-режимов (с номерами от 0 до 19), то Локатору подходят из них режимы 2, 3
и 7. Для всех остальных Вирусный Локатор переустановит режим в 25 строк по
80 символов и по окончании работы восстановит исходный видеорежим.
  Однако, если у Вас дисплей VGA, то на нем можно установить так называемые
расширенные текстовые видеорежимы с размером экрана 60 строк по 80 символов,
44 строки по 132 символа и другие. Эти режимы не стандартизованы и их номера
отличаются у разных производителей дисплеев. Поэтому Локатор их не знает и
работает на принципах доверия, полагая, что если текущим является видеорежим
с номером больше 19, то этот режим :

            - текстовый;
            - цветной с началом видеопамяти по адресу B800.

  Внимательно прочитайте Users Guide или Users Manual, прилагаемые к дисплею, и
выберите те видеорежимы, которые удовлетворяют этим двум требованиям.
  Для установки желаемого видеорежима используйте программу с дискеты, которая
должна прилагаться к дисплею фирмой-изготовителем.
  При работе в расширенном видеорежиме Локатор автоматически настроится на
текущие размеры экрана и будет их эффективно использовать. Ниже приводится
таблица изменения возможностей VL в зависимости от площади экрана.


                                  Видеорежим
                 (NxM означает N строк по M символов в строке)
╔═══════╦═══════╤═══════╤═══════╤═══════╤════════╤════════╤════════╤════════╗
║       ║       │      *│       │       │        │        │        │        ║
║       ║ 25x80 │ 43x80 │ 50x80 │ 60x80 │ 25x132 │ 28x132 │ 44x132 │ 60x132 ║
╠═══════╬═══════╪═══════╪═══════╪═══════╪════════╪════════╪════════╪════════╣
║       ║       │       │       │       │        │        │        │        ║
║   I   ║   8   │  17   │  20   │  25   │   8    │   9    │   17   │  25    ║
╟───────╫───────┼───────┼───────┼───────┼────────┼────────┼────────┼────────╢
║       ║       │       │       │       │        │        │        │        ║
║   II  ║  256  │  544  │  640  │  790  │  406   │  458   │  874   │  1280  ║
╟───────╫───────┼───────┼───────┼───────┼────────┼────────┼────────┼────────╢
║       ║       │       │       │       │        │        │        │        ║
║   III ║  18   │  36   │  43   │  53   │   18   │   20   │   36   │  53    ║
╟───────╫───────┼───────┼───────┼───────┼────────┼────────┼────────┼────────╢
║       ║       │       │       │       │        │        │        │        ║
║   IV  ║   5   │   9   │  11   │  13   │   5    │   5    │   9    │  13    ║
╚═══════╩═══════╧═══════╧═══════╧═══════╧════════╧════════╧════════╧════════╝

   *   - видеорежим доступен и на адаптере EGA


   I   - количество масок вирусов, одновременно выводимых на экран
         в режиме Masks showing & Editing

   II  - размер куска дампа вируса (в байтах), показываемого на экране
         в режиме Show dump

   III - число строк в окне описания вируса в режиме Open descriptor

   IV  - число строк в окне текущих проверяемых файлов в режиме
         поиска вирусов



                         6.  Формат файлов из полной поставки.

                         6.1 Файл VL.MSK.


  Информация о вирусах хранится в файле VL.MSK (кроме текстов описания вирусов в
файле VL.DSC). Эта информация для каждого вируса выглядит так:


          номер по         маска вируса  :
          порядку
            │      в 16-тиричных кодах   в символьном виде
            │              │                   │
            │              │                   │
          ┌─┴─┐ ┌──────────┴─────────┐   ┌─────┴──────┐
           13.   <240000004D73446773>     <$    MsDos>

             Name : [MicroII]     Virus RC1313 : Microsoft II
                   └────┬────┘   └─────────────┬─────────────┘
                        │                      │
                        │                      │
                 дескриптор вируса         имя вируса

  По историческим причинам в файле VL.MSK сначала идут все маски, затем все их
имена, а в самом конце - все дескрипторы.
  Маски вирусов хранятся в закодированном виде для того, чтобы не сбивать
с толку другие антивирусы или сам Локатор при поиске вирусов по всем файлам.
  В этом же файле хранятся текущие установки режимов Локатора а также номер
версии Локатора для контроля совместимости Локатора и VL.MSK.


                         6.2 Файл VL.HLP.

  Файл VL.HLP содержит все тексты Help Вирусного Локатора в альтернативной
кодировке. Поскольку тексты хранятся вместе с рабочей информацией, они не
годятся для чтения через текстовый редактор. Из Локатора Help доступен по
нажатию клавиши F1.
  При обнаружении каких-либо ошибок или неточностей в Help Вы скорее всего не
сможете исправить их самостоятельно. Лучше всего связаться со мной (адрес
указан ниже) и высказать свои замечания.


                         6.3 Файлы VL*.DSC.

  Файлы VL*.DSC, называемые дескрипторными файлами, хранят обычные тексты -
описания вирусов в альтернативной кодировке.
  Строка файла, которая начинается с символа "."(точка) в первой позиции,
считается содержащей дескриптор. Если находясь в Локаторе Вы захотите посмотреть
описание какого-либо вируса (командой Open descriptor), то VL будет искать
данный дескриптор во всех файлах, начало имен которых совпадает с именем
исполняемого файла Локатора и с расширением .DSC. Например, если Локатор
назван VLOCK.EXE, и в его каталоге хранятся файлы VLOCK.DSC, VLOCK1.DSC,
VLOCKUFR.DSC и т.д., то во всех этих файлах будет искаться дескриптор.
При обнаружении в файле искомого дескриптора Локатор выводит на экран весь
текст после него и до очередного дескриптора или конца файла.  Исключение
составляют лишь комментарии, которые начинаются с символа ":" (двоеточие).
Комментарии на экран не выводятся.



  Пример части дескрипторного файла :


.Murphy                        <- это   - дескриптор
:  Вирус из Софии              <- а это - комментарий
:

                         Вирус RCE1277 "Murphy".

    Файловый резидентный вирус, заражает .COM и .EXE - файлы ...
                          ...

.Reboot                        <- следующий дескриптор



  Вы можете изменять файлы VL*.DSC с помощью любого текстового редактора. При
обнаружении нового вируса и занесении его маски в Локатор придумайте этому
вирусу дескриптор. Затем введите информацию об этом вирусе в файл VL*.DSC и
Локатор снова будет в полной боевой готовности.



                         6.4 Файлы ML.EXE и ML.DOC

  Эти файлы представляют собой вспомогательную утилиту и ее описание. С помощью
программы ML (маскоискатель) выделение масок для большинства вирусов
становится чисто рутинной работой.
  Для получения более подробной информации об ML обратитесь к файлу ML.DOC.



                         6.5 Файлы RVL.EXE и RVL.DOC

  RVL - Resident Virus Locator, является резидентной программой, которая
проверяет все запускаемые на выполнение программы на наличие в них вирусов по
тем же маскам вирусов, что и Локатор.
  Использование RVL имеет смысл при работе в сильном вирусном окружении и
особенно в таких случаях:

  1) Вам принесли большое количество программного обеспечения, из которого
   Вы выбираете себе нужное. Конечно, можно проверить все дискеты с помощью
   Вирусного Локатора, но быстрее и удобнее будет загрузить в память RVL,
   который проверит не все дискеты целиком, а только те программы на них,
   которыми Вы заинтересуетесь и запустите на выполнение.

  2) Вы имеете персональный компьютер общего пользования и являетесь его
   основным хозяином или просто серьезно относитесь к вирусным проблемам.
   Вряд ли Вы сможете заставить всех Ваших коллег проверять программы каким-
   либо антивирусом, прежде чем исполнять их на Вашей машине. Намного проще
   загрузить в память Resident Virus Locator на время работы других
   пользователей (лучше поместить вызов RVL в файл AUTOEXEC.BAT).
   Если программа Вашего коллеги окажется зараженной, то RVL предупредит его.


  Для получения более подробной информации об RVL обратитесь к файлу RVL.DOC.




                         7. Поиск вирусов в режиме Turbo Search.


  Одним из несомненных удобств Вирусного Локатора версий 1.4 - 2.0 был поиск
вирусов в режиме Quick Search.
  Алгоритм Quick Search выглядел так : определяется точка входа (первый
исполняемый оператор программы), осуществляется переход на нее и с этого места
читается 4 Кб. Очевидно, что при быстром поиске (Quick search) обычно
обнаруживается только последний из "севших" в файл вирусов.
  Этот метод поиска давал резкое увеличение скорости поиска. Однако, вместе с
увеличением числа пользователей Локатора и его популярностью возросло и
количество вирусописателей, желающих "побороть" Локатор, тем более что это
совсем не трудно. Правда, им все равно понадобилось около года на размышление,
в то время как антивирус AIDSTEST был "поборен" в течение двух-трех месяцев,
ведь его автор Лозинский сам подсказал, что нужно делать.
  Итак, появились вирусы, не обнаруживаемые в режиме Quick Search. Распознать
такой вирус нетрудно, его дамп, сделанный для нескольких зараженных файлов с
помощью Маскоискателя ML будет состоять из сплошных символов подчеркивания
(признак несовпадающих кодов).
  Для того, чтобы остановить мутный поток вирусов подобного рода и, может быть,
в результате направить деятельность вирусописателей в полезное для общества
русло, в Локатор версии 2.1 введен режим поиска Turbo Search :

        1) Файлы размером до 4096 байт исследуются целиком;
        2) Файлы, не вызывающие подозрения, исследуются в режиме
           Quick Search;
        3) В подозрительных на вирус файлах исследуются места
           возможного нахождения конкретного вируса, примерно так,
           как это делают прочие антивирусные программы.

  Следовательно алгоритм Turbo Search выглядит сложнее и нетривиальнее чем у
Quick Search. В некоторых файлах будет сканироваться в поисках вируса не 4 Кб
кодов, а больше. Кроме того, Turbo Search гарантирует нахождение только тех
вирусов, обманывавших Quick Search, которые мне знакомы.
  Значит, если Вам попадется новый вирус из этой серии, то лучше всего
связаться со мной (адрес указан ниже), выслать мне несколько зараженных файлов
и временно перейти на режим поиска Full Search и/или использование RVL
(Resident Virus Locator).
  Дискета будет в кратчайшие сроки возвращена Вам с новой версией Локатора,
способного обнаруживать вирус в режиме Turbo Search.



                         8. История создания и развития Локатора.


  Первая версия Вирусного Локатора была создана в ноябре 1989 г. У меня к тому
времени была готова библиотека оконных процедур, которую следовало обкатать,
регулярно появлялись вирусы в компьютере и полностью отсутствовали полифаги и
полидетекторы (я даже не знал об их существовании!).
  Когда я накопил 4 вирусные маски и искал вирусы сканированием всего диска с
помощью PC-TOOLS по разу на каждую маску, стало ясно, что так дальше
продолжаться не может. И вот однажды мой коллега Лизенко Сергей, увидев такие
мучения, сказал : "А почему бы тебе самому не написать программу поиска масок?".
Эти слова, наложившись на все остальное, дали тот импульс, в результате
которого возник Вирусный Локатор.


  Вы работаете с VL версии 2.1.

  Эволюция Локатора в версиях 1.0 - 2.0 выглядела так (в скобках - версия, в
которой появилось указанное свойство):

(1.1)  Для поиска масок вирусов использован высокоскоростной алгоритм
текстового поиска Боуера и Мура.

(1.2)  Введено именование вирусов.

(1.4)  Локатор производит самоконтроль на заражаемость.

(1.5)  Реализован алгоритм быстрого поиска Quick Search.

(1.6) Появилась возможность вывода на экран дампа части файла с вирусной
маской.

(2.0) Максимальное количество хранимых в Локаторе масок возросло до 500.
  В Локатор введен интегрированный Help.
  Реализована работа с мышью.
  Поддерживается механизм дескрипторов, который позволяет для вируса выводить
на экран его описание из текстового файла.


  Версия 2.1 : Добавлена возможность вывода информации об обнаруженных вирусах
в файл с расширением .LST.
  Удалена команда Print options из главного меню.
  Локатор ищет описание вируса в нескольких текстовых файлах.
  Введено взаимодействие с программой RVL для занесения в нее масок вирусов.
  Локатор может работать в расширенных текстовых видеорежимах дисплеев VGA.
  Режим поиска вирусов Quick Search модифицирован и переименован
в Turbo Search.
  Изменен внешний вид Локатора.



                       9. Самоконтроль на заражаемость.


  Для антивирусной программы хорошим тоном является какое-либо самотестирование
на зараженность, поскольку вирус в антивирусе штука довольно опасная.
  Естественно, Вирусный Локатор соблюдает правила хорошего тона и предлагает
программный метод контроля :

   При запуске Вирусный Локатор контролирует свой размер и точку входа
   (первый исполняемый оператор). Если обнаружено изменение любой из
   этих величин, то Локатор откажется продолжать работу и сообщит о
   причине отказа. Обычно в случае заражения Вы будете получать
   сообщения об изменении обеих величин. Если изменилась только точка
   входа, значит в памяти Вашего компьютера сидит вирус, который
   подсовывает зараженным программам их размер до заражения (посмотрите,
   например, описание вируса RCE2000 в файле VL1.DSC). В любом случае
   советую прекратить работу, загрузиться с заклеенной незараженной
   дискеты и исследовать VL.EXE маскоискателем (ML).  Поскольку
   зараженный Локатор работать не будет, рекомендую сделать заранее
   копию полной поставки VL и хранить ее на заклеенной дискете.  Этот
   совет подходит и для любых других программных продуктов, используемых
   Вами.



                        10. Разное.


  Вирусный Локатор и все его утилиты являются некоммерческими продуктами и
распространяются бесплатно.
  Я буду Вам благодарен, если при распространении Вирусного Локатора Вы не
забудете скопировать все его файлы.

╔════════════════════════════════════════════════════════════════════════════╗
║                                                                            ║
║  Любое распространение Локатора, преследующее коммерческую выгоду, а также ║
║его включение в другие пакеты, неважно, бесплатные или продаваемые, возможно║
║только после получения на то моего письменного разрешения.                  ║
║                                                                            ║
╚════════════════════════════════════════════════════════════════════════════╝

  Все претензии, советы и предложения я принимаю с благодарностью и постараюсь
с Вашей помощью улучшать Локатор. В свою очередь готов предоставлять Вам
информацию о новых вирусах, их масках и о новых версиях моей программы.
  Если же Вам удастся обнаружить новый вирус, то я буду очень признателен,
если Вы сообщите мне о нем. Желательно, чтобы информация о вирусе включала
его дамп (сделанный с помощью ML не менее чем для 3-х зараженных файлов),
а лучше всего - сам вирус на дискете. Возврат дискеты гарантирую и постараюсь
ее заполнить либо новой версией Локатора, либо свежей вирусной информацией.


  VL написан на языке Turbo-Pascal 5.5 с использованием оконного модуля WindTS.
  Для ускорения поиска маски в файле используются (с версии 1.5) две
ассемблерные процедуры из TURBO-Professional for PASCAL 4.0.
  Начиная с веpсии 1.7 вся файловая pабота в Локатоpе пеpеписана на ассемблеpе.
  Оконный модуль (unit) WindTS (Windows from TechnoSoft) избавил меня от всех
хлопот по созданию окон и меню на экране. Этот модуль является моей адаптацией
пакета Windows из TopSpeedModula под Turbo-Pascal (начиная с версии 4.0). Для
многих программ модуль WindTS куда удобнее, чем стандартный модуль CRT из
Turbo-Pascal или громоздкий TPCRT из TURBO-Professional.
  В версиях начиная с 2.0 использован пакет интегрированного Help, написанного
программистом Технософта Виктором Романюковым на языке C. Монитор Help
переписан на Turbo-Pascal с применением модуля WindTS.

  По всем вопросам, связанным с VL, обращайтесь ко мне по адресу:


       252207 Киев-207, проспект академика Глушкова, 20-а , Технософт,
              отдел Ковалева, комната 13, Шеховцов Александр.


    и / или по телефону (044) 266-00-97 (Киев,с 10.00 до 18.00 Моск. время
                                   по рабочим дням).



 Вы можете стать зарегистрированным пользователем Вирусного Локатора.
 Для этого достаточно выслать сумму в 25 руб. по адресу:

  252142 Киев-142, ул. Семашко, д.10, кв 16, Шеховцову Александру Людвиговичу

 и указать свой полный адрес.

  Получив эти деньги, я вышлю Вам подтверждение и зарегистрирую Вас в списке
пользователей.
  Все пользователи из этого списка получают от меня информацию (в письменном
виде) о новых вирусах, которые стали мне известны (маска вируса, его название
и проявления).  Таким образом, зарегистрированный пользователь всегда имеет в
Локаторе свежий список вирусов, что достаточно надежно защищает компьютер.
  При появлении особо коварных вирусов, требующих программной модификации
Вирусного Локатора, зарегистрированным пользователям высылается новая версия
VL.



                       ноябрь 1990 г.         Шеховцов Александр




------------------------------ Вопросы и ответы ------------------------------

1. Почему длина вирусной маски только 15 символов ?

   Эта величина была выбрана случайно. Но в дальнейшем, при исследовании разли-
 чных антивирусов я обнаружил, что ни один из них не ищет вирус по маске
 большей длины. Кроме того, при увеличении длины вводимой маски возрастает риск
 допустить опечатку при вводе. Честно говоря, я попробовал увеличить длину
 маски вдвое, но ничего путного из этого не вышло.


2. Локатор сообщает о зараженности некоторых программ, а другие антивирусы
   молчат. В чем тут дело?

   Конечно, это может оказаться и вирус, особенно если Вы регулярно вносите в
 Локатор маски новых вирусов. Но иногда Локатор обманывается на некоторых
 программах, ведь в его основе : простой текстовый поиск, и совпадение
 цепочек кодов вполне возможно. Часто это бывает при поиске в антивирусах,
 если они содержат в себе те же маски вирусов, что и Локатор. Простейший выход:
 поместить эти антивирусы на отдельную дискету и удалить их с винчестера.


3. Почему на моем компьютере все меню имеют красивые тени, а на других ПЭВМ
   они пропадают. Это ошибка?

   Нет, просто у Вас хорошая IBM PC с цветным EGA или VGA дисплеем. Для таких
 дисплеев рисование теней под окнами не замедляет работу Локатора, а для
 дисплеев похуже подобные украшения использовать неразумно.


4. Почему при установке поиска по "All hard disks" Локатор исследует файлы и
   на электронном диске ?

   Дело в том, что стратегия поиска по "All hard disks" - это поиск по всем
устройствам, начиная с C:. В список этих устройств попадет и электронный диск.


5. Файл заражен одним вирусом дважды, а Локатор сообщил о вирусе только один
   раз. Это "прокол" Локатора?

   Нет, все дело в алгоритме поиска. Файл читается блоками по 4 Кб и в каждом
блоке каждая маска ищется только один раз. Я полагаю, что VL используется для
поиска вирусов, а не общего числа вхождений в файл текстовой цепочки. При таком
алгоритме поиска если в один блок уложатся две и более маски одного вируса, то
будет выдано только одно сообщение о вирусе.


6. Если файл читается блоками, то что будет, когда маска вируса начнется в
   одном блоке, а закончится в другом?

   Для быстрого поиска (Turbo Search) такой вопрос не стоит, поскольку из файла
будет читаться только один блок в 4Кб, а при полном поиске (Full Search)
подобный случай учтен и корректно обработается (Вы получите сообщение о вирусе).


7. Почему весь Локатор англоязычный, а его Help и дескрипторный файл
   русскоязычные?

   Я хотел написать программу, подходящую для любого IBM-совместимого
компьютера, даже с зашитой неизменяемой болгарской, основной или стандартной
IBM-кодировкой. Для этого пришлось писать все меню на английском языке. Ну а
Help и описания вирусов - это удобства, а за удобства нужно платить. Для
Локатора такая плата:  загрузка в знакогенератор альтернативной кодировки.


8. Почему Локатор не ищет BOOT - вирусы?

   Вирусы в BOOT - это совсем другое, чем вирусы в файлах. Нужны другие
алгоритмы их поиска, отдельный список масок бутовых вирусов. Скажите, к чему
такие усложнения, если достаточно не загружаться с первой попавшейся дискеты,
чтобы сохранить незараженным винчестерский диск?


9. Как заставить Локатор тестировать оперативную память на вирусы?

   Да никак, он этого не делает из принципа. Стандартом начала поиска
вирусов на компьютере служит загрузка с заклеенной незараженной дискеты.
Следуйте этому совету, а также проверяйте все новопринесенные программные
продукты и тестирование памяти станет ненужным.
  К тому же все на сегодня известные особо опасные резидентные вирусы
(такие как Eddie, RCE2000 и Murphy) инфицируют .EXE файлы, так что если
в памяти сидит подобный вирус, то Локатор при запуске заразится, сообщит
об этом и прекратит работу.


10. Собираюсь стать зарегистрированным пользователем, но на что пойдут
    высланные мною 25 руб.?

   Эти деньги будут потрачены на бумагу, конверты, почтовые расходы по
пересылке новых версий Вирусного Локатора и, возможно, других антивирусов.
Сегодня стоимость одного письма = 10 коп., если не считать затрат на поиск
и обработку информации, стоимость отправки дискеты = 1 руб.
  Я готов переписываться со всеми, кто интересуется вирусной проблематикой,
но зарегистрированным пользователям гарантирую приоритетность и регулярность
корреспонденции.


11. Какие требования к "железу" пред'являет Вирусный Локатор?

   Локатор работает на всех IBM-совместимых компьютерах, в том числе из
отечественных : на ПЭВМ серии ЕС-1840.
  Но лучшие результаты VL покажет на компьютерах типа IBM PC AT и IBM PS/2
с большим винчестерским диском и "ветвящимся" файловым деревом, и с дисплеем
EGA или VGA.
  Для использования всех возможностей Локатора желательно иметь принтер и мышь.