FROM:    Vesselin Bontchev             Area # 42 (      VIRUS       )
TO:      Alan Dawson                   MSG # 479, Sep-24-90 1:38am
SUBJECT: Universal Virus Scanner

In a message to Vesselin Bontchev <11 Sep 90 19:30:00> Alan Dawson wrote:

 AD>   But we're out here in the real world, Vess, with people trying to
 AD> mess with our puters and, no doubt soon, our minds and our personal
 AD> possessions. We're fairly lucky here in the real world with viruses
 AD> because, unlike biological or even other computer O/S "viruses," a
 AD> DOS virus has a finite number of ways in which it can affect a
 AD> maximum amount of people.

Oh, that's right, I completely forgot about it (the real world, that is :-)). 
You're absolutely right that my proof sounds only for a Turing machine and the 
real computers are not Turing machines. Since the amount of memory of any real 
computer is finite, the amount of possible programs for it is also finite. In 
this case the Universal Virus Detector can be build - just enlist all possible 
programs and mark those of them that are viruses. Of course, this will take 
zillions of years of machine time, but let's not be distracted by such minor 
problems. :-)

 > VB> In other words, if A says that P1 is a virus, then P1 does not
 > VB> perform any infections and, therefore, is not a virus. If A

 AD> why would A WANT to say necessarily that P1 is a virus, or to know
 AD> that it is a virus? Why would A have the slightest interest in
 AD> whether or not P1 infects, doesn't infect, or absolutely refuses to
 AD> work in rainy weather?

Because (as we supposed in the beginning) A is the algorithm that is able to 
decide whether a program (ANY program) is a virus or not.

 AD> however, because they're extremely handy and understandable.) Try an
 AD> entirely different AXIOM for your algorithm. Try this: what if A
 AD> doesn't even care what P1 is -- a program, a virus, a Rolls Royce or

If A doesn't care what P1 is, then any implementation of A is NOT able to decide 
whether a given program is a virus or not. Therefore, the proof is true again.

 AD>   Here's another hint. My word processor doesn't care a hoot what my
 AD> database does to the ASCII import files it creates, for example.
 AD> Until, of course, I try to call a .DBF file into word processor, at
 AD> which point it says, "whoops, I can't read that garbage." But there
 AD> is NO interaction between the word processor and database at all.

Aha, another good point. You suggest that each program must have some 
"capabilities" in order to perform some things (e.g., to write over an 
executable file). Before the virus era, the security specialists had only to 
care about whether SOMEONE has rights to perform something. Now they have also 
to care about whether thir own programs have the appropriate rights. In other 
words, without viruses we must protect our files from other people (or their 
programs). With viruses, we have to protect them even from our own programs. 
Anyway, the idea is good, but it's not easy to implement it in a safe way - you 
have to make sure that the virus won't be able to fool you and to mess with 
these "capabilities" itself. And this is really very difficult if you have no 
memory protection mechanisms.

 AD> AHA! Real-world talk from a mathematician! We think check-summing is

I'm not a mathematician! I'm only a humble computer science engineer.

 AD> a fine idea, and even offer this (along with some drivers to "speed
 AD> it up" a bit). But you are absolutely right here. That's why we're
 AD> pretty confident about the appeal of the program. Takes a few seconds
 AD> (say 3-4 on a standard AT) to check out your current status re

So, in fact your program computes checksums? This is the safest way, indeed, if 
you can guarantee that there are no viruses in memory (i.e., if you boot from a 
write-protected non-infected diskette). But why your program is so incredibly 
fast? Maybe you don't checksum the whole file? It's true that most viruses 
change the file entry point, but this is not strictly nesessary. For instance, 
if the file begins with a JMP, the virus may modify not this JMP, but the piece 
of code it points to. Another trick: if the file being infected has a well-known 
structure (e.g., COMMAND.COM), then the virus can insert a jump to its own code 
in (almost) any place.

 AD> viruses. Of course, if you've got a virus on board, the time factor
 AD> increases. Not counting the user panic time, it could take us, as it

Why does the time increase if you find a virus?

 AD> stands today, up to five or even 10 minutes to "cure" it if it's a

You mean that your program is even able to cure an unknown virus?! How that?

 AD> particularly nasty virus of the type we feel confident in predicting
 AD> that people are going to write. Right now, with the "common" viruses,

"Common", hmm? One of the Dark Avenger viruses (it's a COM file infector) 
infects files by writing its body in a random place of the file and appending 
the overwritten part after the end of the file. How can your program cure such 
file?

 AD> it takes nothing like that. On my computer, the Dark Avenger consumed
 AD> about 60 seconds of my time and I never left my anti-virus program to

You just had the chance that in these 60 seconds you didn't execute an infected 
file more than 16 times. If you do that, the virus overwrites a random sector of 
the disk, eventually destroying a file (or even a subdirectory!) beyond repair 
(FUBAR, you know :-)).

 AD> handle it AND the four variants of it in which I hacked out the SCAN

Four variants of the Dark Avenger virus? What do you mean?

 AD> search string for fun. I assume others would take longer, perhaps
 AD> much longer, but they would never leave the program and they would
 AD> have full help along the way by hitting the H key. Of course, our
 AD> program has no idea it's the Dark Avenger. It has no idea if the Dark
 AD> Avenger is a virus, while it's working.

Sorry, but I was unable to understand this. Could you explain it in a simpler 
language? Please, don't forget that English is not my first language (and even 
not my second one).

 AD> Daniel SHOULD have my NetMail to you/him by now and if not please let
 AD> me know. My address was included. I can tell you, Vesselin, that I DO

Daniel told me that you called his BBS but I still don't have NetMail from you. 
I sent you NetMail using the address of your origin line; did you recive it?

 AD> look forward to continuing this here as well. Imagine! Two people
 AD> absolutely disagreeing and not a flame. How boring, huh? :-}

Well, I'm a polite man and try to remain such even when my opponent disagrees 
with me. :-) I get bored only if my opponent is extremely stupid, which 
fortunately is not your case :-).

 AD>     - From Thailand, a warm country in more ways than one.

Lucky you... With the economical and energetic crisys in my country I'm really 
afraid of the comming winter... :-(((

Regards,
Vesselin

--- XRS 3.30
 * Origin: A Bulgarian antivirus researcher (RAX 2:359/1.12)
SEEN-BY: 2/225 241/1 2 242/20 244/1 310/11 490/1 10 20 40 60 
SEEN-BY: 504/156 310 507/1 13 430 440 642 7000 9001 512/0 515/1 
SEEN-BY: 515/801 821 841 871 
