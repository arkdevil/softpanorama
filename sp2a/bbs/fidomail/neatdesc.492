FROM:    Vesselin Bontchev             Area # 42 (      VIRUS       )
TO:      All                           MSG # 492, Sep-26-90 11:59pm
SUBJECT: A virus description scheme

<continued from the previous message>

     2. Boot sector infectors.
     The description of each boot sector infector consists also of four parts - 
the name of the virus, its descriptor, its signature and its text strings.

     2.1. The virus name.
     It has the form
          <prefix>[x<number>]-{<hex_byte>}...

     The prefix consists of one or more of the following upper case letters:

     C - the virus marks its second part as bad clusters;
     D - the virus infects the partition boot sector;
     F - the virus infects only floppy disks;
     M - the virus infects the disk boot sector;
     P - the virus creates its own partition;
     W - the virus survives a warm reboot.

     If the virus marks its second part as bad clusters, then a x<number> is 
appended to the prefix, where <number> is the maximal number of bad clusters 
created.

     {<hex_byte>} is a sequence of one to five bytes in hexadecimal notation. 
These are the first few bytes of the boot sector.

     2.2. The descriptor.
     The descriptor of a boot sector virus also consists of sequences of groups. 
Their meaning is as follows:

     I<number> - the amount of memory (in K) that the virus allocates;
     L<number> - full length of the virus code (in bytes);
     M - "stealth" techniques used (y - when a read is performed on the infected 
boot sector, the virus supplies the original one; n - no stealth techniques 
used);
     N<number> - number of the first byte that is different when the infected 
boot sector and an original one are compared;
     S - infection strategy - where the original boot sector (possibly with more 
virus code) resides (x<number> - in <number> clusters, marked as bad; t - on the 
last track; n - on a supplementary formatted track; p - on a new partition; 
<number1>.<number2>.<number3> - on absolute address head <number1>, cylinder 
<number2>, sector <number3>);
     W - whether the virus allows the original boot sector to be overwritten (y 
- the virus blocks write attempts over the sector where the original boot sector 
resides; n - no blocking is performed).
     X - caused effects (v - video effects; m - displays messages; p - plays 
music or has sound effects; b - causes keyboard problems; s - overwrites 
sectors; e - intentionally causes errors, e.g., divide by zero, parity check, 
etc.; w - scrambles or encrypts the contents of the disk; z - wipes
out the information on the disk; f - formats the disk; l - low-level formats the 
disk; a - destroys or scrambles the FAT);

     2.3. The signature.
     The signature consists of sequences of one or more triplets. Each triplet 
consists of a hex string (possibly containing wildcards), the number of the 
virus sector where the signature resides, and a hexadecimal offset from the 
beginning of the sector, where this signature resides.

     2.4. The text strings.
     They are similar to the signature and also consist of triplets (text 
string, sector and offset). However ALL meaningful text strings that appear in 
the virus body are given.

<end of description>
--- XRS 3.30
 * Origin: A Bulgarian antivirus researcher (RAX 2:359/1.12)
SEEN-BY: 2/225 241/1 2 242/20 244/1 310/11 490/1 10 20 40 60 
SEEN-BY: 504/156 310 507/1 13 430 440 642 7000 9001 512/0 515/1 
SEEN-BY: 515/801 821 841 871 
