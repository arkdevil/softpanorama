FROM:    Vesselin Bontchev             Area # 42 (      VIRUS       )
TO:      Simon Muth                    MSG # 488, Sep-24-90 3:53am
SUBJECT: Stoned Throws A Rock!

In a message to All <13 Sep 90 14:17:00> Simon Muth wrote:

 SM> As most people will know, Stoned-B infects the partion table on hard

Argh, these virus names... What exactly is Stoned-B? What's the difference 
between it and the original Stoned virus?

 SM> drives and results in a daft message coming up every so often when
 SM> the system is rebooted. Most of their machines are `fairley normal'

With the version I know about, the message never comes up if the boot is 
performed from a hard disk. Only if you boot from an infected floppy, there is 
an 1-in-8 chance to see the message.

 SM> clones with things like Phoenix BIOS and, although those machines
 SM> became infected, no nasties occurred.

The BIOS type has nothing to do with this. I'll explain this later.

 SM> BUT, one of their machines was a weird American clone running the
 SM> AMI Megatrends BIOS (never heard of it but no doubt someone out
 SM> there knows something about it). On this machine, Stoned-B TOTALLY

Sure, we have several such machines in Bulgaria. :-)

 SM> trashed the hard disc. There were still entries in the root
 SM> directory but all names (file and subdirectory) had been totally
 SM> corrupted with extended ASCII chars and the contents were totally
 SM> scrambled. In fact, the hard disk structure was so knackered that

I do not agree. "TOTALLY trashed the hard disc" is not the correct phrase. The 
Stoned virus is a partition table infector. On a hard disk, it stores the 
original partiion table on track 0, head 0, sector 7 (some variants of the virus 
use sector 2). In fact, on most hard disks only the first sector of the first 
track is used (for the partition table). The first disk partition starts from 
the next track. Therefore, using any of the other sectors of the first track can 
be considered as safe. Unfortunately, on some hard disks (this depends on the 
particular version of FDISK the partiitons were created with) the first 
partition begins IMMEDIATELY after the sector that contains the partition table. 
If the first partition is a PC-DOS one, the Stoned virus will place the original 
copy of the partition table over the first copy of the file allocation table 
(FAT). Of course, this is nasty, but can be easily recovered. Because there are 
TWO FAT copies. One has only to copy the second over the first one. Sure, this 
should be done by a qualified person, but it's easy enough. No data will be 
lost.

 SM> BIOS just doesnt get on with Stoned. Low-level format etc solved the
 SM> problem but it took them a while to get their data back (plus 950
 SM> floppies to check - they're an information distrubution company. So
 SM> be warned all you people with weirdo BIOS, being Stoned can be
 SM> injurious to your promotion prospects

Oh God! A low-level format in order to remove such a minor problem! Your company 
really needs to hire a good security consultant (e.g., me for instance :-)).

Regards,
Vesselin
--- XRS 3.30
 * Origin: A Bulgarian antivirus researcher (RAX 2:359/1.12)
SEEN-BY: 2/225 241/1 2 242/20 244/1 310/11 490/1 10 20 40 60 
SEEN-BY: 504/156 310 507/1 13 430 440 642 7000 9001 512/0 515/1 
SEEN-BY: 515/801 821 841 871 
