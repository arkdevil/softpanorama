
                 ИНТЕРФЕЙС BORLAND/TURBO C++
    С HELP-ФАЙЛАМИ В ФОРМАТЕ MICROSOFT QUICK C/QUICK HELP,
                         и не только

     Интегрированная среда Turbo C++ 1.0 (и Borland  C++  2.0)
имеет один (и не только) недостаток:  ее help-система не явля-
ется открытой.  Это значит, что к ней нельзя подключать допол-
нительные справочные  файлы  и создавать (и корректировать) их
самому. (Поэтому часто делают резидентную  справку  на  основе
Norton Guides.) С другой стороны, некоторые библиотеки (напр.,
C TOOLS фирмы Blaise)  поставляются  с  готовыми  help-файлами
именно в формате Microsoft. Поэтому естественно поискать здесь
какой-нибудь выход, особенно если учесть, что для работы с та-
кими help-файлами существует утилита QuickHelp, входящая в па-
кет Microsoft C 6.00.

     Предлагаемая программа  TRWORD предназначена для извлече-
ния из текстового файла слова, находящегося в указанной строке
и указанном  столбце,  передаче этого слова в командную строку
указанной программе (в нашем случае QH.EXE,  но можно и GREP и
т.п.) и  запуска  этой программы.  Это все делается по нажатию
одной клавиши из интегрированной среды Borland C++.

     Командная строка:

  TRWORD  [ключи] <имя файла> <строка> <столбец> <команда ДОС>

     Имя файла,  строка и столбец передаются автоматически при
соответствующих  установках в меню Options|Transfer (см.ниже).
Это - файл в текущем окне и строка и позиция в нем, на которых
стоит  курсор.  TRWORD читает соответствующую строку из файла,
выделяет в ней слово,  на которое указывает заданная  позиция,
формирует  командную  строку согласно параметру <команда ДОС>,
куда в качестве первого параметра передается выбранное  слово,
и  запускает  программу,  указанную в команде.  Если командная
строка задана без ошибок,  то никакие сообщения не выдаются, и
экран  не  "портится".  Ну,  а  запускаемая  программа  (у нас
QH.EXE) должна сама сохранить экран.
     Под "словом", передаваемым запускаемой программе, понима-
ется цепочка символов,  содержащая латинские  буквы,  цифры  и
знаки #$_@ . Если курсор стоит не на слове, то в строке ищется
ближайшее слово слева от курсора.  Если слева  слова  нет,  то
дочерняя программа (QH) не запускается.
      Ключи:
      /t<n>     Размер табуляции. Должен совпадать со значением,
                    установленным в редакторе через меню
                    Options|Environment|Editor.
      /a        Добавлять слово в конец, а не в начало командной
                  строки. Если же нужно ставить его в середину,
                  то создайте batch-файл и манипулируйте его
                  параметрами, как вам захочется.
      /e        Не передавать запускаемой команде окружение.
                     Программе QH можно через окружение передавать
                имена и путь hlp-файлов. Если нежелательно застав-
                лять QH при запуске из Borland C++ искать все эти
                файлы, то можно задать ключ /e и в командной стро-
                ке задать один-два нужных файла.

     КОРОЧЕ:

     Рекомендую через  меню  Options|Transfer  добавить  пункт
QHelp, например, следующим образом (как это сделал я):
     Program Title:
     ~QHelp
     Program Path:
     TRWORD
     Command Line:
     /e $EDNAME $LINE $COL $SAVE CUR $NOSWAP $MEM(160K)
                     c:\qc25\bin\qh -u -l18 -d c:\qc25\hlp\ct6.hlp
                (в одну строку)
     (Опции программы QH здесь используются, но не описываются.)

     Затем определить   одну   из   свободных  клавиш  (напр.,
Shift-F8) под вызов этой программы, или вызывать ее всякий раз
нажатием клавиш Alt-пробел + Q .
     В РЕЗУЛЬТАТЕ:  при нажатии Shift-F8 на слове, по которому
Вы  хотите  получить  справку  (имя  функции и т.п.) на экране
(после шевеления на диске)  появится  окно  с  хелпом!  Причем
программа  QH  позволяет записывать текущую тему помощи в файл
(по умолчанию PASTE.QH),  который можно читать  в  окно  среды
Borland C++ и т.д.
                                    

      Юцис Михаил Сухарович, г.Черновцы
      тел. (037-22) 2-55-51 (д.)
