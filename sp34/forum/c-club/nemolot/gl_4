Глава 4.
Структура программы.
     
4.1 Структура программы.
     
Программа в языке Си состоит из одной и более подпрограмм,на-
зываемых функциями,расположенных в любом порядке в одном и
более текстовых файлов.Вне функции могут быть описаны внешние
переменные,а также другие функции.В программу обязательно
должна быть включена функция main,с которой начинается выпол-
нение программы.Также функция main связывает программу с опе-
рационной системой,т.к. ей передается командная строка аргу-
ментов или по другому - параметры начинающейся выполняться
программы.Выход из функции main возвращает управление OC.
     
4.1.1 Функции.
     
Функция - это замкнутый блок кода,вызываемый из любой точки
программы с передачей ему от нуля и более параметров и возв-
ращающий в данную точку при необходимости итоговое значение.
     
Общее описание функции:
     
[класс_памяти] тип_результата имя_функции([формальные_параметры])
[описание_параметров]
составной_оператор

Примечание:
класс_памяти функции либо static,если она локальная по отно-
шению к файлу,либо extern (по умолчанию),если функция гло-
бальная для всех файлов.
имя_функции - идентификатор описываемого блока кода.
формальные_параметры - это список имен параметров,которые бу-
дут переданы функции.
описание_параметров - этот список описаний параметров указан-
ных в списке формальных параметров.

Примечание:
Если функции будет передано имя массива s,то на самом деле ей будет
передан адрес его нулевого элемента.Исходя из этого ,описа-
ние_параметра,либо как char s[],либо как char *s,будет эквива-
лентным.
     
Функция не может быть описана внутри других функций.
     
Ссылки: 1.1 Идентификаторы.
     
4.1.1.1 Вызов функции.
     
Функция вызывается посредством операции ().
     
Общий вид операции:
     
имя_функции (...);
     
Примечание:
В скобках должно быть расположено от нуля и более передавае-
мых аргументов,в зависимости от количества формальных_пара-
метров в описании функции.
     
Передавая аргументы вызываемой функции,если они нужны,функция
в результате своей работы либо не может изменить их,либо мо-
жет изменить их.В первом случае вызов функции называется вы-
зовом по значению,во втором - вызовом по ссылке.
     
4.1.1.1.1 Вызов функции по значению.
     
Вызов функции по значению осуществляется в том случае,если в
качестве аргументов функции переданы значения переменных,а не
их адреса.
     
Пример:

INC(p)      /* Описание функции INC */
int p;
{ p=p+1; }  /* Переменная p увеличивает
               свое значение на единицу */
     
INC(k);     /* Вызов функции INC */
            /* k не меняет свое значение */

/* В данном случае функция получает значение k в виде времен-
ной копии,которая увеличивает свое значение ,но после выхода
из функции копия уничтожается */

4.1.1.1.2 Вызов функции по ссылке.
     
Вызов функции по ссылке осуществляется в том случае,если в
качестве аргументов функции переданы адреса переменных (либо с
помощью операции унарного &,либо используя имя массива).
     
Пример:
     
INC(p)
int *p;
{*p=*p+1;} /* Значение переменной на которую указывает указа-
тель p увеличилось на единицу */
     
INC(&k);   /* Вызов функции INC */
           /* В качестве аргумента функции передается адрес
переменной k и она увеличивает свое значение на единицу */
     
Примечание:
В Си описанном в K&R передача функции в качестве аргументов
структур и об'единений была запрещена.

Ссылки: 2.2.1.3.4.3 Указатели и переменные различных типов,
2.2.1.3.4.3.2 Указатели и массивы.
     
4.1.1.2 Окончание выполнения функции.
     
Выполнение функции завершается по достижению,либо конечной
правой фигурной скобки,либо при выполнении оператора возврата
return.
             
4.1.1.3 Рекурсивность функции.
     
Функция в языке Си рекурсивна,т.е. неограниченно может вызы-
вать сама себя.
     
Пример:
/* 1 */
main()
{
int k;
scanf("%d",&k);
if (k>=0)
main();        /* Выполнение программы продолжается */
}              /* пока не будет введено отрицательное */
               /* значение.                           */
4.1.1.4 Передача одной функции в качестве аргумента другой функции.
     
Можно извлечь адрес функции,если ее имя входит в выражение
,где нет ее вызова.Используя это можно передавать одну функцию
в качестве аргумента другой функции.
     
Пример:
int p();     /* В качестве аргумента функции t передана */
...          /* функция p,которая затем внутри функции  */
t(p);        /* будет вызвана.                          */
...

t(func)      /* Описание функции t */
int (*func)();
{
...
(*func)();
...
}
     
Примечание:
Вызываемая функция должна быть описана явно.

4.1.2 Передача командной строки параметров функции main.
     
При вызове функции main ей передается два параметра:ARGC -
означающий число аргументов в командной строке и ARGV - ука-
затель на символьный массив,содержащий эти аргументы по одно-
му в строке.В формальных описаниях эти параметры можно не
описывать,если они не используются в теле функции.
     
Пример:
/* 1 */
main(ARGC,ARGV)
int ARGC;
char *ARGV[];
{
char p;
...
if (ARGC>1)  /* Если параметров больше,чем один,то */
p=ARGV[1][0];/* p присвоить 0-ой символ 1-ого
                элемета массива.0-вым элементом
                массива является само название
                программы                       */
}
/* 2 */
main(ARGC,ARGV) /* Программа выдает командную    */
int ARGC;       /* строку параметров по одному   */
char *ARGV[];   /* на строку ,в обратном порядке */
main()
{
while (ARGC-->0)
     printf("%s\n",ARGV[ARGC]);
}
/* Пример: Допустим программа называется obrab_1,тогда если
ее вызвать со следующими параметрами из подкаталога TC на
диске C :
C:\TC>obrab_1 one two
программ выдаст на дисплей следующую информацию

two
one
obrab_1                                                  */
