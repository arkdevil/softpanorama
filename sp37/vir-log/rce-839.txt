Cофтпанорама 1991, No. 7 (21) *** VIRLOG ***  Составитель: Н.Н. БЕЗРУКОВ
************************************************************************

                             Вирус RCE-839

                  Характеристика и особенности вируса

                              Проявления:

    1. Периодическое (через каждые 22 минуты) проигрывание мелодии.  Ус-
ловия возникновения музыки:
    - должна быть установлена дата: 7-ое число любого месяца и года;
    - должно состояться заражение (или попытка к заражению) хотя бы один
раз.
    - прерывание 1Ch не должно быть заблокировано более поздними  прог-
раммами.
    2. В процессе работы вирус применяет в качестве буфера  неиспользуе-
мую часть  видеопамяти адаптера CGA и поэтому в момент попытки к зараже-
нию файлов на мониторе CGA появляется "снег".
    3. Вирус не контролирует длину заражаемых COM-файлов и возможно  по-
явление файлов длиной более 64K.

       Инсталляция в память:

    Вирус уменьшает  в  PSP  своей программы параметр "Вершина доступной
памяти" на 848 байт и переписывает в выделенный кусок свое тело.  Анали-
зируя обработчик прерывания 20h он находит путь к системному обработчику
int 21h и на найденную точку устанавливает  вектор  недокументированного
прерывания int 50h. Далее в процессе работы вирус вместо вызовов int 21h
использует int 50h. Для подключения музыкальной части используется поль-
зовательское прерывание по таймеру int 1Ch.

       Заражение:

    Заражает файлы любой длины с расширениями .COM и .EXE запускаемые на
выполнение. Для заражения COM-файлов в начало файла вписывается структу-
ра:
    E9 XXXX  - JMP <точка старта>
    4B       - опознавательный байт
Вирус дописывает свое тело в конец файла.
    Для заражения EXE-файлов происходит перенастройка параметров CS:IP в
заголовке EXE на точку старта вируса.

                                                           В.Пономаренко
