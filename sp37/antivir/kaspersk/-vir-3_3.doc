
                        3.3. Загрузочные вирусы
                        ═══════════════════════

                           Семейство "Brain"
                           ═════════════════
        Состоит  из  двух  практически  совпадающих  безобидных вирусов:
"Brain-Ashar"  и  "Brain-Singapore".  Они  заражают Boot-секторы флоппи-
дисков при обращении к  ним (int 13h, ah=02).   Расположение на диске  -
стандартное.  У  зараженного  диска  устанавливается  новая  метка тома:
"(C) Brain".  Вирусы используют "стелс"-механизм: при попытке  просмотра
Boot-сектора зараженного диска "подставляют" истинный Boot-сектор.

                         Семейство "Ping-Pong"
                         ═════════════════════
        Вирусы семейства  заражают Boot-секторы  дисков при  обращении к
ним (int 13h).  На диске располагаются стандартным способом.

                              "Ping-Pong"
                              ───────────
        Не  опасен,  имеет  байт,  содержащий  номер версии вируса. Если
обнаруживает диск, зараженный своей предыдущей версией,то "обновляет" ее.
Изменяет вектора int 8 и int 13h. Вызывает видеоэффект скачущего  шарика
(знак 07h ASCII), который перемещается по экрану, отражаясь от знаков  и
границ экрана.

                          "Hacked Ping-Pong"
                          ──────────────────
        Почти полностью повторяет "Ping-Pong". Отличие - вместо  запуска
скачущего  шарика  происходит  установка  прерывания 13h на подпрограмму
уничтожения первых восьми секторов флоппи-диска.

                    "Ping-Pong modified by Yankee"
                    ──────────────────────────────
        Является  результатом  модификации  вируса  "Ping-Pong"  вирусом
"Yankee". Изменения произведены таким образом, что при каждой  очередной
загрузке вируса его версия (байт, содержащий ее значение)  увеличивается
на  1.  При   достижении  версией  нулевого   значения  (255+1),   вирус
дезактивируется.

                           Семейство "Stone"
                           ═════════════════
        Вирусы  семейства  очень  опасны,  заражают  первые   физические
сектора дисков: Boot- сектор  флоппи-диска и MBR винчестера.  Состоят из
двух частей:   первая часть  содержит тело  вируса и  хранится в  первом
физическом  секторе   диска,  вторая   содержит  первоначальный   сектор
зараженного диска и хранится  на флоппи-диске по адресу  1/0/3 (головка/
трек/сектор),на винчестере по адресу 0/0/7. На флоппи-диске вторая часть
вируса занимает  один из  секторов, отведенных  под корневое оглавление.
Местоположение  вируса  среди  секторов  корневого оглавления зависит от
объема диска.  Для диска, отформатированного на 360K, это, как  правило,
последний  сектор   корневого  оглавления.   На  винчестере   это   либо
неиспользуемый (скрытый) сектор, либо один из секторов FAT.

        Флоппи-диски инфицируются  при чтении  с них  (int 13h,  ah=02),
винчестер - при загрузке DOS с зараженного флоппи-диска. При  сохранении
на диск второй  части вируса никаких  проверок не производится,  поэтому
вирус может уничтожить часть информации на диске (на флоппи-диске - один
из секторов корневого оглавления, на винчестере - один из секторов FAT).

        Перехватывают int 13h.

                                "Stone"
                                ───────
        При загрузке  с зараженного  флоппи-диска с  вероятностью 1/8 на
экране  появляется  сообщение:   "Your   PC  is  now  Stoned!".   Помимо
указанной, содержит строку "LEGALISE MARIJUANA!".

                           "Stone-LoveChild"
                           ─────────────────
        В зависимости  от своего  внутреннего счетчика  может уничтожить
всю информацию  на винчестере.  Содержит текст  "LoveChild b3  in reward
for software stealing." Использует "стелс"-механизм.

                           "Stone-NearDark"
                           ────────────────
        С вероятностью 1/16 выводит на  экран текст "Near Dark", а затем
стирает MBR. Использует "стелс"-механизм.

                            "Stone-Rostov"
                            ──────────────
        Прислан из  г. Ростов-на-Дону.  Почти полностью  повторяет вирус
"Stone". Отличия:
        - не содержит текстовых строк и не выводит текст на экран;
        - при  загрузке с  зараженного флоппи-диска  с вероятностью 1/32
          стирает на винчестере 8 секторов.

                              "Stone-Sex"
                              ───────────
        Поражает диски при обращении к ним (int 13h, ah=2,3).  Сохраняет
старое содержимое изменяемых секторов (Boot-сектор   у  флоппи-диска   и
MBR   у   винчестера)   по   адресу   1/0/3  (головка/трек/сектор)   для
флоппи-диска   и   0/0/8   для   винчестера. При  загрузке с зараженного
флоппи-диска  с  вероятностью  1/8  сообщает:  "EXPORT OF SEX REVOLUTION
ver. 2.0"


         Загрузочные вирусы, не входящие ни в какое семейство
         ════════════════════════════════════════════════════

                               "Den Zuk"
                               ─────────
        Очень  опасный  вирус,  длина  4086  (1400h)  байт (9 секторов).
Заражает Boot-сектор флоппи-дисков при обращении к ним (int 13h,ah=2, 3,
4, 5). При  сохранении на диск  второй части вируса  никаких проверок не
производится, поэтому вирус может  уничтожить часть информации на  диске
(расположенной на 40-м треке).

        Перехватывает  int  9  и  int  13h.  При  "теплой"  перезагрузке
крупными буквами выводит на экран  свое имя: "Den Zuk".   Изменяет метку
заражаемого диска на "Y■C■1■E■R■P".  Не имеет деструктивной функции,  но
очень  опасен,  ткт  как  может  уничтожить  информацию  на  40-м  треке
заражаемого диска. Содержит тексты:
        "Welcome to the C l u b --The HackerS-- Hackin' All The Time",
        "The HackerS".

                             "Disk Filler"
                             ─────────────
        Очень опасный "стелс"-вирус, поражает Boot-сектор  флоппи-дисков
и  MBR  винчестера  при  обращении  к  диску. При заражении Boot-сектора
дискеты форматирует  на ней  дополнительный трек  (40-й у  360К и 80-й у
1.2М) и записывает туда свой  код. Затем вирус встраивает свою  головную
часть  в  Boot-сектор  дискеты  таким  образом, что коды первоначального
Boot-сектора  практически  не   изменяются.  При  заражении   винчестера
располагает свое  тело сразу  за MBR.  В самой  MBR вирус  изменяет лишь
адрес активного Boot-сектора и  устанавливает его на сектор,  содержащий
начало вируса.

        При  запуске  COMMAND.COM  перемещает  себя  в  область памяти с
меньшими адресами. В зависимости от системного времени расшифровывает  и
выводит на экран фразу

       "Haha,vбrus van a gВpben!!
        Ez egy eddig mВg nem kФzismert vбrus. De hamarosan az lesz.
        A neve egyszerБen tФltФgetФ
        Ezt a nevВt onnan kapta, hogy feltФltФgeti a FAT-tаblаt
        kФlФnbФzФ alakzatokkal.
        Ez mаr meg is tФrtВnt !!!",

а затем "рисует" в секторах FAT картинку

         ******  ******
        *      **      *
        * *  * ** *  * *
        *      **      *
        * **** ** **** *
         *    *  *    *
          ****    ****

        Также содержит текст  "command.com". Перехватывает int  13h, int
1Ch, int 21h.

                             "Disk Killer"
                             ─────────────
        Очень  опасный  вирус,  длина  3072  (C00h)  байта (5 секторов).
Состоит из  двух частей:   первая часть  вируса, оформленная  как  Boot-
сектор, располагается  в Boot-секторе  диска и  содержит начало  вируса;
вторая часть располагается в  пяти последовательных секторах и  содержит
продолжение вируса  (4 сектора)  и оригинальный  Boot-сектор диска  (5-й
сектор).

        Заражает Boot-секторы дисков при обращении к ним (int 13h,ah=02).
Расположение вируса  на флоппи-диске  стандартное. Винчестер  заражается
только в том  случае, если число  скрытых секторов (т.е.   расположенных
между Boot-сектором и  первым сектором FAT)  больше или равно  5. Вторая
часть  вируса  при  этом  записывается  в  последние 5 скрытых секторов.
Изменяет int 8, 9, 13h.

        Вирус может  уничтожить всю  информацию на  диске. При  чтении с
диска (int 13h, ah=02) вирус опрашивает свой внутренний счетчик времени,
и, если значение счетчика удовлетворяет некоторым условиям,  совершаются
следующие действия:

        - на экране появляется сообщение:

          "Disk Killer -- Version 1.00 by COMPUTER OGRE 04/01/1989
           Warning !!
           Don't turn off the power or remove the diskette
           while Disk Killer is Processing!
           PROCESSING";

        - уничтожается  информация  на  всех  треках  диска:  все байты
          информации  на  нечетных  треках  двоично суммируются (XOR) с
          байтом 55h, все байты на четных секторах - с байтом AAh;

        - на экране появляется сообщение:

          "Now you can turn off the power
           I wish you luck !";

        - компьютер "зависает" (совершает холостой цикл).

                                "Form"
                                ──────
        Очень  опасный  вирус,  поражает  Boot-сектор  флоппи-дисков при
обращении к ним и Boot-сектор винчестера при загрузке с флоппи-диска. На
винчестере  располагается  в  последних  секторах  диска,  на  дискете -
стандартно. Проявляется 24-го числа ежемесячно - при нажатии на  клавиши
вирус совершает холостой цикл. При работе с винчестером может  произойти
потеря  данных.   Перехватывает  int  9  и  int 13h. Содержит текст "The
FORM-Virus  sends  greetings  to  everyone  who's reading this text.FORM
doesn't destroy data! Don't panic! Fuckings go to Corinne."

                                "Joshi"
                                ───────
        Очень  опасный  "стелс"-вирус,  длина  4086  байт  (9 секторов).
Заражает Boot-сектор флоппи-дисков и MBR винчестера при обращении к  ним
(int 13h, ah=2,3,4,0Ah, 0Bh).

        Состоит из  двух частей:   первая часть  содержит тело  вируса и
хранится в Boot-секторе (или MBR) диска, вторая содержит  первоначальный
сектор зараженного  диска и  остальные 8  секторов вируса  и хранится на
флоппи-диске  на  40-м  или  80-м  треке  в зависимости от формата диска
(используется нестандартное форматирование);  на винчестере - начиная со
2-го сектора 0-го трека. При  сохранении своей копии на винчестер  может
уничтожить FAT.

        Вирус  перехватывает  int  21h.  Для  этого он после активизации
(загрузки системы) постоянно опрашивает значение вектора прерывания  21h
и,  как  только  оно  изменяется,  считывает  его.  Перехватывает int 9h
(клавиатура). Обрабатывает нажатие клавиш Alt-Ctrl-Del (перезагрузка)  и
эмулирует ее:  гасит экран  и т.д.  При этом  вирус остается резидентным
даже при загрузке с незараженного защищенного от записи диска.

        Проявляется  5-го   января:  выводит   сообщение  "Type   `Happy
Birthday,  Joshi'!"  и  ждет  ввода  с клавиатуры фразы "Happy Birthday,
Joshi!". Изменяет вектора прерываний  8, 9, 13h, 21h.

                               "Keydrop"
                               ─────────
        Неопасный вирус,  стандартно поражает  Boot-сектора  дискет  при
обращении к  ним и  MBR винчестера  при загрузке  с зараженной  дискеты.
Проявляется  эффектом  "падающих  букв"  (коды этого алгоритма полностью
скопированы из вируса "Cascade"). Перехватывает int 13h.  Содержит текст
"(c) Copyright 1990  Keydrop inc.".

                              "Pentagon"
                              ──────────
        Опасный вирус, стандартно поражает Boot-сектор флоппи-дисков при
обращении к ним. Если при этом дискета уже была поражена вирусом "Brain",
то "Pentagon" лечит Boot-сектор этого диска, изменяет его метку и  затем
заражает своей копией. На заражаемом  диске создается файл PENTAGON.TXT.
Вирус  "выживает"  при  теплой  перезагрузке.  Часть вируса зашифрована.
Перехватывает int 9 и int  13h. Содержит тексты: "(c) 1987 The Pentagon,
Zorell Group", "first sector in segment".

                             "PrintScreen"
                             ─────────────
        Очень опасный вирус, длина 512 (200h) байт (1 сектор).  Заражает
Boot-сектор флоппи-дисков и винчестера при чтении с них (int 13h, ah=2).
Старый  Boot-сектор  сохраняет  на  флоппи-диске  по адресу 0/1/3 (трек/
сторона/сектор),  на  винчестере  -  по  адресу  1/3/13.  При этом может
уничтожить один  из секторов  FAT или  данных (в  зависимости от  объема
диска).   При  заражении  винчестера  предполагает,  что его Boot-сектор
расположен по  адресу 0/1/1  (это говорит  о низкой  квалификации автора
вируса).

        Перехватывает int 13h. Судя по листингу вируса при инфицировании
диска с вероятностью 1/256 (в зависимости от значения своего внутреннего
счетчика)  вирус  должен  вызывать  int  5  (печать экрана), но допущена
ошибка, в результате которой новое значение счетчика не сохраняется.

                                "Yale"
                                ──────
        Очень  опасный  вирус.  Инфицирует  диски  только  при  "теплой"
перезагрузке,  записывая  себя  в  Boot-сектор  диска A:. Первоначальный
Boot-сектор сохраняет  в секторе  0/39/8 (сторона/трек/сектор).  Никаких
проверок при этом не делает. Перехватывает int 9 и int 13h.


                    3.4. Файлово-загрузочные вирусы
                    ═══════════════════════════════

                               "Anthrax"
                               ─────────
        Резидентен,  поражает  COM- и  EXE-файлы,  MBR винчестера. Файлы
поражаются стандартно.  MBR инфицируется  при старте  зараженного файла,
продолжение  вируса  и  MBR-сектор  сохраняются  начиная  с адреса 0/0/2
(трек/головка/сектор).

        Память заражается  при загрузке  с инфицированного  диска. Затем
вирус поражает  только файлы.   Перехватывает int  21h, содержит  строки
"ANTHRAX" и "(c) Damage, Inc".

                                "Flip"
                                ──────
        При запуске зараженного файла поражает MBR винчестера (уменьшает
размер  логического  диска  и  в  освободившееся пространство записывает
старый MBR-сектор и продолжение вируса).  Файлы (COM и EXE)   стандартно
инфицируются при запуске. В файлах "Flip" является  вирусом-"призраком":
зашифрован,  а  расшифровщик  не  имеет  постоянного участка (сигнатуры)
длиннее, чем 2 байта.

        Проявляется  видео-эффектами  (с  ними  не разобрался). Зачем-то
заменяет в файлах набор команд          MOV DX,Data_1
                                        MOV Data_2,DX
                                        MOV DX,Data_3
                                        MOV Data_4,DX

на вызов   INT 9Fh    (вирус содержит   обработчик этого    прерывания).
Содержит текст  "OMICRON by  PsychoBlast". Перехватывает  int 10h,  1Ch,
21h, 9Fh.

                               "Invader"
                               ─────────
        Резидентный  очень  опасный  вирус.  Поражает .COM- и .EXE-файлы
(кроме  COMMAND.COM)  по  алгоритму  вируса  "Jerusalem"  и Boot-секторы
флоппи-дисков и винчестера.  У дискеты форматирует  дополнительный трек,
при поражении винчестера записывается сразу после MBR. В зависимости  от
своих счетчиков может стирать  информацию на дисках, исполнять  мелодию,
расшифровывать  и  выводить  текст  "by  Invader, Feng Chia U., Warning:
Don't run ACAD.EXE!", совершать  холостой цикл при каждом прерывании  по
таймеру  (int  8).  Также  содержит текст "ACAD.EXECOMMAND.COM.COM.EXE".
Перехватывает прерывания 8, 9, 13h, 21h.

                               "Liberty"
                               ─────────
        Резидентный  опасный  вирус.  Поражает  COM-  и EXE-файлы при их
выполнении.  EXE-файлы  поражает  стандартно.  При  поражении  COM-файла
записывается  в  его  конец,  а  в  начало  записывает  78h  байт   кода
(расшифрование  тела  вируса  и  переход  на  него), старое начало файла
шифрует   и   сохраняет   внутри   своего   тела.   Если  при  заражении
расположенного  на  дискете  файла  не  хватило  свободного места, вирус
инфицирует  Boot-сектор  дискеты.   Старый  Boot-сектор  и  тело  вируса
записывает   на   40-й   трек   дискеты   (используется    нестандартное
форматирование),  при  этом  может  уничтожить  информацию  на  дискетах
размера 1М.

        Память заражается либо при старте инфицированного COM-файла,либо
при загрузке с инфицированного флоппи-диска.

        Через  некоторое  время  после  загрузки  с  флоппи-диска  вирус
расшифровывает  и  выдает  на  экран,  принтер  и последовательные порты
строку  "MAGIC  MAGIC  MAGIC  MAGIC   ......".   При  10-й  загрузке   с
флоппи-диска лечит его. Перехватывает прерывания 8, 10h, 13h, 14h,  17h,
1Ch,21h. Содержит строки: "Liberty", "DRKAVGRCOM", "- MYSTIC - COPYRIGHT
(C) 1989-2000, by SsAsMsUsEsL".

                              "Starship"
                              ──────────
        Резидентный неопасный (?) "стелс"-"призрак"-вирус. Поражает COM-
и EXE-файлы только на дисках A: и B: при создании файла, MBR  винчестера
при  запуске  зараженного  файла.  В  результате вирус обеспечивает свое
присутствие в  оперативной памяти  компьютера и  переносимость на другие
компьютеры  при  минимальном  числе  пораженных  объектов, что несколько
затрудняет его обнаружение. Эта идеология имеет и еще одно "достоинство"
- при заражении заново создаваемого файла нет необходимости  отслеживать
критическую ошибку DOS (int 24h).

        Файлы  поражает  стандартно,  используя  "призрак"-алгоритм. При
заражении  диска  записывается  в   самые  последние  сектора  диска   и
устанавливает в Partition Table адрес активного загрузочного сектора  на
свое  начало.  При  обращении  к  исправленной  MBR и последним секторам
диска использует "стелс"-механизм.

        Инфицирует память при загрузке с зараженного диска. Часть  своей
TSR-копии  располагает  в  таблице  векторов (0000:02С0), области данных
BIOS (0000:04B0), а основной  участок кода - в  видеопамяти (BB00:0050).
Затем,  после  загрузки  операционной  системы,  следит  за  запуском  и
завершением программ  и, если  программа при  завершении выгружается  из
памяти (Exit - int 20h, int 21h и ah=0 или 4Ch), то перемещает свой  код
из  видеопамяти  в  область,  занятую  выгружаемой  программой,  а  если
программа остается  резидентно (Keep  - int  27h, int  21 и  ah=31h), то
"прикрепляет" свой код к этой программе. Если часть вируса,  размещенная
в видеопамяти, испорчена,  то вирус заново  считывает испорченный код  с
диска (самовосстановление вируса).

        Проявляется   какими-то    видеоэффектами.    Содержит    строку
"STARSHIP_1".  Перехватывает int 13h, 20h, 21h, 27h.

