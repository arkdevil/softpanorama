                         Приложение 2
                         ════════════

                Дамп сектора, содержащего MBR
                ═════════════════════════════

С адреса 0000 по адрес 00E1 - программа загрузки активного Boot-сектора.
С адреса 01C0 по адрес 01FD - таблица разбиения диска (Disk Partition Table).


0000  FA2BC08E D08EC08E D8B8007C 8BE0FB8B  F0BF007E FCB90001 F3A5E900 02B91000   "·+└О╨О└О╪╕.|Лр√ЛЁ┐.~№╣..єещ..╣.."
0020  8B36857E F6048075 0883EE10 E2F6EB37  90BFBE07 57B90800 F3A55EBB 007C8B14   "Л6Е~Ў.Аu.Гю.тЎы7Р┐╛.W╣..єе^╗.|Л."
0040  8B4C02BD 0500B801 02CD1373 092BC0CD  134D7419 EBF0BEFE 7DAD3D55 AA7514BE   "ЛL.╜..╕..═.s.+└═.Mt.ыЁ╛■}н=Uкu.╛"
0060  BE07EA00 7C00008B 36877EEB 0A8B3689  7EEB048B 368B7EAC 0AC074FE BB0700B4   "╛.ъ.|..Л6З~ы.Л6Й~ы.Л6Л~м.└t■╗..┤"
0080  0ECD10EB F2EE7F8D 7EA77EC8 7E0D0A49  6E76616C 69642050 61727469 74696F6E   ".═.ыЄюН~з~╚~..Invalid Partition"
00A0  20546162 6C65000D 0A457272 6F72204C  6F616469 6E67204F 70657261 74696E67   " Table...Error Loading Operating"
00C0  20537973 74656D00 0D0A4D69 7373696E  67204F70 65726174 696E6720 53797374   " System...Missing Operating Syst"
00E0  656D0000 00000000 00000000 00000000  00000000 00000000 00000000 AA550000   "em..........................кU.."
0100  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
0120  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
0140  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
0160  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
0180  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
01A0  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
01C0  01010405 22C8CC00 0000609F 00000000  01C90505 E22B2CA0 0000E4E6 01000000   "...."╚╠...`Я.....╔..т+,а..фц...."
01E0  00000000 00000000 00000000 00000000  00000000 00000000 00000000 000055AA   "..............................Uк"


                Дамп сектора, содержащего нормальный Boot-сектор
                ════════════════════════════════════════════════

0000  EB34904D 53444F53 332E3300 02040100  02000260 9FF82800 22000600 CC000000   "ы4РMSDOS3.3........`Я°(."...╠..."
0020  00000000 00000000 00000000 00000012  00000000 0100FA33 C08ED0BC 007C1607   "......................·3└О╨╝.|.."
0040  BB780036 C5371E56 1653BF2B 7CB90B00  FCAC2680 3D007403 268A05AA 8AC4E2F1   "╗x.6┼7.V.S┐+|╣..№м&А=.t.&К.кК─тё"
0060  061F8947 02C7072B 7CFBCD13 7267A010  7C98F726 167C0306 1C7C0306 0E7CA33F   "..ЙG.╟.+|√═.rgа.|Шў&.|...|...|г?"
0080  7CA3377C B82000F7 26117C8B 1E0B7C03  C348F7F3 0106377C BB0005A1 3F7CE89F   "|г7|╕ .ў&.|Л..|.├Hўє..7|╗..б?|шЯ"
00A0  00B80102 E8B30072 198BFBB9 0B00BED6  7DF3A675 0D8D7F20 BEE17DB9 0B00F3A6   ".╕..ш│.r.Л√╣..╛╓}єжu.Н ╛с}╣..єж"
00C0  7418BE77 7DE86A00 32E4CD16 5E1F8F04  8F4402CD 19BEC07D EBEBA11C 0533D2F7   "t.╛w}шj.2ф═.^.П.ПD.═.╛└}ыыб..3╥ў"
00E0  360B7CFE C0A23C7C A1377CA3 3D7CBB00  07A1377C E84900A1 187C2A06 3B7C4038   "6.|■└в<|б7|г=|╗..б7|шI.б.|*.;|@8"
0100  063C7C73 03A03C7C 50E84E00 5872C628  063C7C74 0C010637 7CF7260B 7C03D8EB   ".<|s.а<|PшN.Xr╞(.<|t...7|ў&.|.╪ы"
0120  D08A2E15 7C8A16FD 7D8B1E3D 7CEA0000  7000AC0A C07422B4 0EBB0700 CD10EBF2   "╨К..|К.¤}Л.=|ъ..p.м.└t"┤.╗..═.ыЄ"
0140  33D2F736 187CFEC2 88163B7C 33D2F736  1A7C8816 2A7CA339 7CC3B402 8B16397C   "3╥ў6.|■┬И.;|3╥ў6.|И.*|г9|├┤.Л.9|"
0160  B106D2E6 0A363B7C 8BCA86E9 8A16FD7D  8A362A7C CD13C30D 0A4E6F6E 2D537973   "▒.╥ц.6;|Л╩ЖщК.¤}К6*|═.├..Non-Sys"
0180  74656D20 6469736B 206F7220 6469736B  20657272 6F720D0A 5265706C 61636520   "tem disk or disk error..Replace "
01A0  616E6420 73747269 6B652061 6E79206B  65792077 68656E20 72656164 790D0A00   "and strike any key when ready..."
01C0  0D0A4469 736B2042 6F6F7420 6661696C  7572650D 0A00494F 20202020 20205359   "..Disk Boot failure...IO      SY"
01E0  534D5344 4F532020 20535953 00000000  00000000 00000000 00000000 000055AA   "SMSDOS   SYS..................Uк"


                Дамп сектора, содержащего усеченный Boot-сектор
                ═══════════════════════════════════════════════

0000  EB289049 424D2050 4E434900 02040100  0200023E 9FF82800 22000600 22000000   "ы(РIBM PNCI........>Я°(."..."..."
0020  00000000 00000000 0000FA33 C08ED0BC  F07BFBB8 C0078ED8 BE5B0090 FCAC0AC0   "..........·3└О╨╝Ё{√╕└.О╪╛[.Р№м.└"
0040  740B56B4 0EBB0700 CD105EEB F032E4CD  16B40FCD 1032E4CD 10CD190D 0A0D0A0D   "t.V┤.╗..═.^ыЁ2ф═.┤.═.2ф═.═......"
0060  0A0D0A0D 0A0D0A0D 0A0D0A20 20202054  68697320 6469736B 20697320 6E6F7420   "...........    This disk is not "
0080  626F6F74 61626C65 0D0A0D0A 20496620  796F7520 77697368 20746F20 6D616B65   "bootable.... If you wish to make"
00A0  20697420 626F6F74 61626C65 2C0D0A72  756E2074 68652044 4F532070 726F6772   " it bootable,..run the DOS progr"
00C0  616D2053 59532061 66746572 20746865  0D0A2020 20202073 79737465 6D206861   "am SYS after the..     system ha"
00E0  73206265 656E206C 6F616465 640D0A0D  0A506C65 61736520 696E7365 72742061   "s been loaded....Please insert a"
0100  20444F53 20646973 6B657474 6520696E  746F0D0A 20746865 20647269 76652061   " DOS diskette into.. the drive a"
0120  6E642073 7472696B 6520616E 79206B65  792E2E2E 00000000 00000000 00000000   "nd strike any key..............."
0140  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
0160  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
0180  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
01A0  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
01C0  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
01E0  00000000 00000000 00000000 00000000  00000000 00000000 00000000 000055AA   "..............................Uк"


                Дамп сектора, зараженный вирусом "Stone"
                ════════════════════════════════════════

0000  EA0500C0 07E99900 0043A300 F0E40040  9F007C00 001E5080 FC027217 80FC0473   "ъ..└.щЩ..Cг.Ёф.@Я.|...PА№.r.А№.s"
0020  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX   "..╥u.3└О╪а?.и.u.ш..X......SQR.VW"
0040  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX   "╛..╕....╗..3╔Л╤AЬ....s.3└Ь......"
0060  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX   "Nuры5Р3Ў┐..№..н;.u.н;E.t!╕..╗..▒"
0080  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX   ".╢.Ь....r.╕..3█▒.3╥Ь......_^.ZY["
00A0  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX   "├3└О╪·О╨╝.|√бL.г.|бN.г.|б..HHг.."
00C0  B106D3E0 8EC0A30F 7CB81500 A34C008C  064E00B9 B8010E1F 33F68BFE FCF3A42E   "▒.╙рО└г.|╕..гL.М.N.╣╕...3ЎЛ■№єд."
00E0  FF2E0D00 B80000CD 1333C08E C0B80102  BB007C2E 803E0800 00740BB9 0700BA80   "...╕..═.3└О└╕..╗.|.А>....t.╣..║А"
0100  00CD13EB 4990B903 00BA0001 CD13723E  26F6066C 04077512 BE89010E 1FAC0AC0   ".═.ыIР╣..║..═.r>&Ў.l..u.╛Й...м.└"
0120  7408B40E B700CD10 EBF30E07 B80102BB  0002B101 BA8000CD 1372130E 1FBE0002   "t.┤.╖.═.ыє..╕..╗..▒.║А.═.r...╛.."
0140  BF0000AD 3B057511 AD3B4502 750B2EC6  06080000 2EFF2E11 002EC606 080002B8   "┐..н;.u.н;E.u..╞..........╞....╕"
0160  0103BB00 02B90700 BA8000CD 1372DF0E  1F0E07BE BE03BFBE 01B94202 F3A4B801   "..╗..╣..║А.═.r▀....╛╛.┐╛.╣B.єд╕."
0180  0333DBFE C1CD13EB C507596F 75722050  43206973 206E6F77 2053746F 6E656421   ".3█■┴═.ы┼.Your PC is now Stoned!"
01A0  070D0A0A 004C4547 414C4953 45204D41  52494A55 414E4121 00000000 00000000   ".....LEGALISE MARIJUANA!........"
01C0  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"
01E0  00000000 00000000 00000000 00000000  00000000 00000000 00000000 00000000   "................................"


                Дамп файла, пораженного вирусом "Vienna-648"
                ════════════════════════════════════════════

С адреса 0000 по адрес 0002 (3 байта)   - команда перехода на тело вируса
С адреса 0003 по адрес 0CA9             - файл
С адреса 0CAA по адрес 0F31             - вирус


0000  E9A70C89 160D03B4 30CD218B 2E02008B  1E2C008E DAA3B70B 8C06B50B 891EB10B   "щз.Й...┤0═!Л...Л.,.О┌г╖.М.╡.Й.▒."
....  ........ ........ ........ ........  ........ ........ ........ ........   ..................................
09E0  0A0BC074 370BDB74 2D83EB04 8B0F498B  D083C205 83E2FE83 FA087303 BA08003B   "..└t7.█t-Гы.Л.IЛ╨Г┬.Гт■Г·.s.║..;"
0A00  CA720C77 0583C304 EB08E887 FFEB03E8  4FFF8BC3 EB0D50E8 65FEEB06 53E890FD   "╩r.w.Г├...ы.шЗы.шOЛ├ы.Pшe■ы.SшР¤"
0A20  33C05B5D 5F5EC300 00000000 00000000  00021F05 00000000 00000000 00000000   "3└[]_^├........................."
0A40  00000000 54757262 6F20432B 2B202D20  436F7079 72696768 74203139 39302042   "....Turbo C++ - Copyright 1990 B"
0A60  6F726C61 6E642049 6E746C2E 00446976  69646520 6572726F 720D0A41 626E6F72   "orland Intl..Divide error..Abnor"
0A80  6D616C20 70726F67 72616D20 7465726D  696E6174 696F6E0D 0A000000 00000000   "mal program termination........."
0AA0  00000000 00000000 00000000 00000000  00000000 00000000 00000000 000000EA   "...............................ъ"
0AC0  0DEA0D00 00000000 00000000 00000000  00003A03 3A033A03 00000902 00000000   ".ъ................:.:.:........."
0AE0  00000000 0000D80B 00000A02 01000000  00000000 0000E80B 00000202 02000000   "......╪...............ш........."
0B00  00000000 0000F80B 00004302 03000000  00000000 0000080C 00004202 04000000   "......°...C...............B....."
0B20  00000000 0000180C 00000000 FF000000  00000000 0000280C 00000000 FF000000   ".....................(.........."
0B40  00000000 0000380C 00000000 FF000000  00000000 0000480C 00000000 FF000000   "......8..............H.........."
0B60  00000000 0000580C 00000000 FF000000  00000000 0000680C 00000000 FF000000   "......X..............h.........."
0B80  00000000 0000780C 00000000 FF000000  00000000 0000880C 00000000 FF000000   "......x..............И.........."
0BA0  00000000 0000980C 00000000 FF000000  00000000 0000A80C 00000000 FF000000   "......Ш..............и.........."
0BC0  00000000 0000B80C 00000000 FF000000  00000000 0000C80C 00000000 FF000000   "......╕..............╚.........."
0BE0  00000000 0000D80C 00000000 FF000000  00000000 0000E80C 00000000 FF000000   "......╪..............ш.........."
0C00  00000000 0000F80C 00000000 FF000000  00000000 0000080D 01200220 022004A0   "......°.................. . . .а"
0C20  02A0FFFF FFFFFFFF FFFFFFFF FFFFFFFF  FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF   ".а.............................."
0C40  00000000 00000010 00000013 02020405  06080808 14150513 FF160511 02FFFFFF   "................................"
0C60  FFFFFFFF FFFFFFFF FFFF0505 FFFFFFFF  FFFFFFFF FFFFFFFF FFFFFFFF 0FFF2302   "...#............................"
0C80  FF0FFFFF FFFF13FF FF020205 0F02FFFF  FF13FFFF FFFFFFFF FFFF23FF FFFFFF23   "..........................#....#"
0CA0  FF13FF00 00000000 000051BA A30FFC8B  F281C60A 00BF0001 B90300F3 A48BF2B4   "..........Q║г.№ЛЄБ╞..┐..╣..єдЛЄ┤"
0CC0  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX   "0═!<.u.щ╟..┤/═!ЙЬ..МД...║_.Р.╓┤."
0CE0  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX   "═!.VО.,.┐..^VБ╞..м╣.АЄо╣..моuэт·"
0D00  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX   "^.Й╝..Л■Б╟..Л▐Б╞..Л■ы:Г╝...u.щc."
0D20  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX   ".V&О.,.Л■&Л╡..Б╟..м<;t.<.t.кыЇ╛."
0D40  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX  XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX   ".[.Й╖..А}\t..░\кЙ┐..ЛєБ╞..╣..єдЛ"
0D60  F3B44EBA 1F009003 D6B90300 CD21EB04  B44FCD21 7302EB9E 8B847500 241F3C1F   "є┤N║..Р.╓╣..═!ы.┤O═!s.ыЮЛДu.$.<."
0D80  74EE81BC 790000FA 77E683BC 79000A72  DF8BBC18 005681C6 7D00ACAA 3C0075FA   "tюБ╝y..·wцГ╝y..r▀Л╝..VБ╞}.мк<.u·"
0DA0  5EB80043 BA1F0090 03D6CD21 898C0800  B8014381 E1FEFFBA 1F009003 D6CD21B8   "^╕.C║..Р.╓═!ЙМ...╕.CБс■║..Р.╓═!╕"
0DC0  023DBA1F 009003D6 CD217303 E9A5008B  D8B80057 CD21898C 04008994 0600B42C   ".=║..Р.╓═!s.ще.Л╪╕.W═!ЙМ..ЙФ..┤,"
0DE0  CD2180E6 077510B4 40B90500 8BD681C2  8A00CD21 EB6590B4 3FB90300 BA0A0090   "═!Ац.u.┤@╣..Л╓Б┬К.═!ыeР┤?╣..║..Р"
0E00  03D6CD21 72553D03 007550B8 0242B900  00BA0000 CD217243 8BC82D03 0089840E   ".╓═!rU=..uP╕.B╣..║..═!rCЛ╚-..ЙД."
0E20  0081C1F9 028BFE81 EFF70189 0DB440B9  88028BD6 81EAF901 CD21721F 3D880275   ".Б┴∙.Л■Бяў.Й.┤@╣И.Л╓Бъ∙.═!r.=И.u"
0E40  1AB80042 B90000BA 0000CD21 720DB440  B903008B D681C20D 00CD218B 9406008B   ".╕.B╣..║..═!r.┤@╣..Л╓Б┬..═!ЛФ..Л"
0E60  8C040081 E1E0FF81 C91F00B8 0157CD21  B43ECD21 B801438B BC0800BA 1F009003   "М..БсрБ╔..╕.W═!.┤>═!╕.CЛ╝..║..Р."
0E80  D6CD211E B41A8B94 00008E9C 0200CD21  1F5933C0 33DB33D2 33F6BF00 015733FF   "╓═!.┤.ЛФ..ОЬ..═!..Y3└3█3╥3Ў┐..W3"
0EA0  C2FFFF80 004018D1 54B81620 008CCA2E  E9A70C2A 2E434F4D 00280018 04504154   "┬.А.@.╤T╕.. .М╩.щз.*.COM.(...PAT"
0EC0  483D5445 4D50322E 434F4D00 4D00454D  2E434F4D 0000434F 4D002020 20202020   "H=TEMP2.COM.M.EM.COM..COM.      "
0EE0  20202020 20202020 20202020 20202020  20202020 20202020 20202020 20202020   "                                "
0F00  2020043F 3F3F3F3F 3F3F3F43 4F4D0302  00E71300 00000020 D154B816 AA0C0000   "  .????????COM...ч..... ╤T╕.к..."
0F20  54454D50 322E434F 4D004D00 00EA0B02  1358                                  "TEMP2.COM.M..ъ...X"


        Программа-доктор для файла, пораженного вирусом "Vienna-648"
        ════════════════════════════════════════════════════════════

                Offset_3_Bytes=206h

SEGA            SEGMENT BYTE PUBLIC
                ASSUME  CS:SEGA, DS:SEGA

                ORG     100h

CURE            PROC
START:
                PUSH    CS                      ;Код и данные в одном сегменте
                POP     DS

                MOV     DX, OFFSET File_Name    ;Открыть файл
                MOV     AX,3D02h
                INT     21h
                JC      Error

                MOV     Handle,AX

                MOV     CX,3                    ;Прочитать первые 3 байта файла
                MOV     DX, OFFSET Buffer
                MOV     BX,Handle
                MOV     AH,3Fh
                INT     21h
                JC      Error

                XOR     CX,CX                   ;Вычислить адрес первоначального
                MOV     AX, WORD PTR Buffer+1   ;начала файла (старые 3 байта)
                ADD     AX, Offset_3_Bytes
                ADC     CX,0

                MOV     DX,AX                   ;Установить указатель на старые
                MOV     BX,Handle               ;3 байта
                MOV     AX,4200h
                INT     21h
                JC      Error

                MOV     CX,3                    ;Прочитать старое начало файла
                MOV     DX, OFFSET Buffer+3
                MOV     BX,Handle
                MOV     AH,3Fh
                INT     21h
                JC      Error

                XOR     CX,CX                   ;Переместить указатель на начало
                XOR     DX,DX                   ;файла
                MOV     BX,Handle
                MOV     AX,4200h
                INT     21h
                JC      Error

                MOV     CX,3                    ;Восстановить начало файла
                MOV     DX, OFFSET Buffer+3
                MOV     BX,Handle
                MOV     AH,40h
                INT     21h
                JC      Error

                XOR     CX,CX                   ;Переместить указатель на начало
                MOV     DX, WORD PTR Buffer+1   ;вируса
                ADD     DX,3
                ADC     CX,0
                MOV     BX,Handle
                MOV     AX,4200h
                INT     21h
                JC      Error

                MOV     CX,0                    ;Укоротить файл
                MOV     BX,Handle
                MOV     AH,40h
                INT     21h

Error:
                MOV     BX,Handle               ;Закрыть файл
                MOV     AH,3Eh

                MOV     AX,4C00h                ;Выход в DOS
                INT     21h

Handle          DW      ?
File_Name       DB      "INFECT.COM"
Buffer          DB      6 DUP (?)

CURE            ENDP
SEGA            ENDS
                END     START


