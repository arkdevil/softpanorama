
                          3. Описание вирусов
                          ═══════════════════

        Ниже приводятся результаты  анализа алгоритма работы  файловых и
загрузочных  вирусов.  Наиболее  общие  свойства  вирусов представлены в
таблицах каталога (см. Приложение 1), дополнительная информация о каждом
вирусе содержится в п.3.2 и 3.3. Если свойство вируса отмечено в таблице,
то в  описании вируса  оно может  не упоминаться.  Если вирус  совершает
стандартные действия (см. п. 2.1 и 2.2), то описание этих действий может
быть опущено.

                          3.1 Каталог вирусов
                          ═══════════════════

        В предлагаемом каталоге для каждого вируса приведена  информация
по свойствам, описанным  в п. 3.1  и 3.2. Символьное  представление этих
свойств  во  многом  повторяет  классификационный код, предложенный Н.Н.
Безруковым. В качестве  основных опознавателей вируса  будет указываться
его имя и длина. Если  вирус имеет несколько имен, то  будет указываться
одно из них, остальные известные  мне имена приведены в таб.  4 каталога
(см. Приложение 1).

        Длиной  файлового  вируса  считается  длина  тела вируса (коды +
данные  +  стек  вируса,  если  есть) безо всяких добавок. В большинстве
случаев она равна минимальному приращению длин файлов при их  заражении.
Для загрузочных вирусов в  качестве длины принимается полная  длина тела
вируса, т.е. число занимаемых вирусом секторов, умноженное на число байт
в секторе. Файлово-загрузочные вирусы  могут иметь два значения  длины -
длина вируса при заражении файла и длина вируса при заражении сектора.

        В таблицах каталога встречаются следующие символы:

        +       - наличие свойства;
        -       - отсутствие свойства;
        *       - в п. 3.2 и 3.3 имеется дополнительная информация;
        &       - одновременное выполнение свойств.
        V       - вызывает видеоэффекты (Video);
        M       - вызывает звуковые эффекты (Music);
        H       - имеет деструктивную функцию (Harm);
        Er      - содержит ошибку, которая может проявляться как
                  деструктивная функция (Error);
        Ch      - изменяет служебную информацию: метку диска,
                  возвращает неверную версию DOS и т.п. (Change).

        Для файловых вирусов (табл. 1):

        C       - COM-файлы;
        .C      - .COM-файлы (файлы с расширением ".COM");
        E       - EXE-файлы;
        .E      - .EXE-файлы (файлы с расширением ".EXE");
        S       - SYS-файлы;
        O       - прочие файлы (Other).

        Для загрузочных вирусов (табл. 2):

        B       - Boot-сектор винчестера;
        M       - MBR винчестера;
        F       - Boot-сектор флоппи-дисков.

        Для  файлово-загрузочных  вирусов  употребляется  полный   набор
символики.

        Например,  если  для  файлового  вируса в графе, соответствующей
поражаемым  объектам,  указано  "E  C&.C",  то  это  означает, что вирус
поражает  только  файлы,  имеющие  либо  формат  EXE,  либо формат COM и
одновременно расширение имени ".COM" (т.е. не поражаются файлы,  которые
имеют формат COM и расширение имени ".EXE").

        При описании свойств файловых вирусов (табл. 1) используются
специальные знаки.

Место внедрения в файл: s    - начало (start);
                        e    - конец (end);
                        i    - середина (insert).
Метод заражения:        FIND - используя функции FindFirst и FindNext;
                        INT  - перехватывая обращения DOS к файлам;
                        INFI - используя оба способа.
Способ внедрения в оперативную память (только для резидентных вирусов):
                        MCB  - оперируя с MCB;
                        KEEP - используя прерывания DOS (int 21h f.31
                               или int 27h);
                        IntTable - записывается в таблицу векторов;
                        Buffer   - записывается в дисковый буфер.
Длина:                  L    - длина вируса;
                        $    - длина заражаемого файла увеличивается до
                               значения, кратного параграфу;
                        ++   - возможно повторное заражение файлов.



                         3.2. Файловые вирусы
                         ════════════════════

                          Семейство "Amstrad"
                          ═══════════════════
        Семейство из шести нерезидентных опасных вирусов. Общие черты:

                - заражаются все .COM-файлы в текущем оглавлении;
                - вирус записывает себя в начало файла;
                - возможно повторное заражение;
                - файлы большой длины могут быть уничтожены.

        Некоторые версии  вируса быстро  проявляются:   начиная с пятого
"поколения" вируса при старте зараженной программы с вероятностью 1/2 на
экране появляется сообщение:  "Program sick error:   Call doctor or  buy
PIXEL for cure description". Одна из версий выдает на экран политический
лозунг на болгарском языке.

                        Семейство "Anti-Pascal"
                        ═══════════════════════
        Семейство из пяти очень опасных нерезидентных вирусов.  Заражают
или портят  не более двух файлов  во всех  каталогах на  текущем диске и
диске C:. При поиске незараженных файлов используется рекурсивный  обход
дерева каталогов. Заражают .COM-,.BAK- и .PAS файлы. В случае .COM-файла
вирус записывается в его конец (версии  вируса длин 400, 440 и 480)  или
начало  (оставшиеся  версии  вируса).  При  заражении .BAK и .PAS-файлов
записывается в начало файла, при этом старое начало не сохраняется, т.е.
файл  оказывается   безвозвратно  потерян.   Некоторые  версии    вируса
переименовывают .BAK и .PAS файлы в .EXE.

                    Семейство "April 1st" ("SURIV")
                    ═══════════════════════════════
                            "April 1st COM"
                            ───────────────
        Файловый резидентный опасный  вирус. Поражает .COM-файлы  (кроме
COMMAND.COM) при их  запуске на выполнение.  Опасен - не  проверяет длин
файлов. Записывается в начало файла. При заражении:

        - создает файл TMP$$TMP.COM;
        - записывает в него свою копию;
        - дописывает в него заражаемый файл;
        - уничтожает заражаемый файл;
        - переименовывает TMP$$TMP.COM в имя заражаемого файла.

        При  создании  своей  резидентной  копии  использует часть схемы
вируса "Jerusalem". Проявляется начиная с 1 апреля 1988 г. при заражении
файлов.  Выводит  на  экран  "APRIL  1ST  HA  HA  HA YOU HAVE A VIRUS" и
завешивает систему; в  последующие дни сообщает  "YOU HAVE A  VIRUS !!".
Перехватывает int 21h.   Помимо перечисленных, содержит строки:  "sURIV"
(в начале зараженного файла), "COMMAND.COM", "TMP$$TMP.COM".

                            "April 1st EXE"
                            ───────────────
        Файловый резидентный опасный  вирус. Поражает .EXE-файлы  при их
запуске на выполнение.  Опасен - не  вполне корректно работает  с длиной
файла. При заражении внедряется  в середину файла между  заголовком (EXE
header) и загружаемым модулем, при этом вирус:

        - создает файл TMP$$TMP.EXE;
        - считывает  из  заражаемого  файла  первые 1Bh байт  заголовка,
          модифицирует  в  них  байты,  соответствующие  длине   модуля,
          стартовым значениям  CS, IP,  SS, SP,  контрольной сумме файла
          (устанавливается    значение    1984h);    затем    записывает
          модифицированный заголовок в файл TMP$$TMP.EXE;
        - копирует из заражаемого файла в TMP$$TMP.EXE таблицу настройки
          адресов (ТНА), модифицируя ее описанным ниже способом;
        - дописывает  к файлу  TMP$$TMP.EXE копию  вируса и  загружаемый
          модуль инфицируемого файла;
        - уничтожает заражаемый файл;
        - переименовывает TMP$$TMP.EXE в имя заражаемого файла.

               Незараженный файл        Зараженный файл
                 ┌───────────┐          ┌───────────┐
                 │EXE header │ ───────> │EXE header │
                 ├───────────┤          ├───────────┤
                 │Загружаемый│ ───┐     │Вирус      │
                 │модуль     │    │     │           │
                 │           │    │     ├───────────┤
                 │           │ ─┐ └───> │Загружаемый│
                 └───────────┘  │       │модуль     │
                                │       │           │
                                └─────> │           │
                                        └───────────┘

        Поскольку загружаемый  модуль  файла  при заражении смещается на
расстояние,  равное  длине  вируса,  то  вирусу  приходится  производить
соответствующие  изменения  в  ТНА:  у  каждого  элемента ТНА содержимое
байтов, соответствующих  смещению сегмента,  увеличивается на  значение,
равное длине вируса в параграфах.

        При  создании  своей  резидентной  копии  использует часть схемы
вируса  "Jerusalem".  Начиная  с  1  апреля  1988  г.  при   активизации
расшифровывает (XOR FFh) и выводит текст "APRIL 1ST HA HA HA YOU HAVE  A
VIRUS" и завешивает  систему; в последующие  дни текст не  появляется, а
система  зависает  приблизительно  через  55  минут  после  активизации.
Перехватывает  int  21h  и,  в   зависимости  от  текущего  дня,   может
перехватывать int 1Ch.  Содержит строки: "sURIV" и "TMP$$TMP.EXE".

                          Семейство "Cascade"
                          ═══════════════════
        Мне  известны  два  представителя  семейства:  "Cascade-1701"  и
"Cascade-1704". Их тела, за исключением начала (32 байта),  зашифрованы.
В  качестве  ключа  используется  длина  зараженного  файла, поэтому два
"штамма" одного вируса в  большинстве случаев будут совпадать  только на
первых 32-х байтах.

        При  выполнении  зараженной  программы  управление  командой JMP
передается на  начало вируса.  Первыми командами  вирус определяет длину
исходного файла и расшифровывает свое тело.

        При создании своей резидентной копии вирус :

        - копирует свое тело в старшие адреса памяти;
        - перемещает в старшие адреса тело основной программы;
        - перемещает тело вируса в освободившееся пространство над
          телом основной программы;
        - устанавливает int 1Ch, int 21h и int 28h на свою копию.

        │ ...     │      │ ...     │      │ ...     │      │ ...     │
        ├─────────┤      ├─────────┤      ├─────────┤      ├─────────┤
        │Программа│      │Программа│──┐   │Свободная│  ┌──>│Вирус    │
        │         │      │         │  │   │память   │  │   │         │
        │         │      │         │  │   ├─────────┤  │   ├─────────┤
        ├─────────┤      ├─────────┤  └──>│Программа│  │   │Программа│
        │Вирус    │──┐   │Вирус    │      │         │  │   │         │
        │         │  │   │         │      │         │  │   │         │
        ├─────────┤  │   ├─────────┤      ├─────────┤  │   ├─────────┤
        │ ...     │  └──>│Вирус    │      │Вирус    │──┘   │ ...     │
                         │(копия)  │      │         │
                         ├─────────┤      ├─────────┤
                         │ ...     │      │ ...     │

        Вирусы заражают только COM-файлы  при загрузке  их в  память для
выполнения.  Инфицирование  производится  стандартным способом. Наиболее
распространенные версии этих вирусов не производят повторного  заражения
файлов.

        Изменяют векторы прерываний 1Ch, 21h и 28h. Вызывают характерный
видеоэффект: осыпание букв на экране. Не имеют деструктивных функций.

                           Семейство "Eddie"
                           ═════════════════
                              "Eddie-651"
                              ───────────
        Инфицирует  COM-  и  EXE-файлы  при  загрузке  их  в  память для
выполнения. У  заражаемого файла  устанавливает значение  секунд в  1Fh.
Никак не  проявляется. Содержит  строку "Eddie  lives". Изменяет  вектор
прерывания 21h.

        Перехватывает функции DOS FindFirst и FindNext FCB и "уменьшает"
длины зараженных файлов. При  "уменьшении" длин файлов вирус  определяет
их  зараженность  по  значению  секунд  даты  последней  модификации (62
сек.) и не  проверяет истинных длин  файлов. Если такое  значение секунд
встретится у  файла небольшой  длины (меньше  651 байт),  то команда DIR
выдаст странную длину файла - около 4 гигабайт.

                             "Eddie-1800"
                             ────────────
        Резидентный очень опасный вирус. Быстро размножается: инфицирует 
COM- и EXE-файлы при загрузке их в память для выполнения, при  создании,
переименовании, открытии и закрытии файла.

        Вирус предпринимает ряд эффективных мер для того, чтобы остаться
незамеченным.

        1. При старте любой  программы помечает программный сегмент  как
           последний  и  становится  невидимым  для  этой  программы, по
           окончании работы программы вирус помечает программный сегмент
           как не последний.
        2. Аналогично  поступает с  вектором прерывания  21h при  старте
           программы - восстанавливает его первоначальное значение.
        3. Не  позволяет  программам  изменять  вектор прерывания  21h и
           защищается   таким   образом   от   резидентных  антивирусов,
           установленных после того как активизировался вирус.
        4. Пытается  обойти программы,  следящие за  прерыванием 13h,  и
           установить  вектор  этого  прерывания  в  его  первоначальное
           значение.

        Очень опасен - периодически стирает сектор со случайным  номером
("оплевывает" диск), при этом может уничтожить часть информации на диске.
Анализирует 2  байта (8-й  и 10-й)  Boot-сектора диска,  с которого была
запущена зараженная программа. Увеличивает  на 1 значение 10-го  байта и
сохраняет его в  Boot-секторе.  Если  новое значение 10-го  байта кратно
16, то стирает на диске сектор со случайно выбранным номером,  зависящим
от значения 8-го байта.

        Изменяет векторы  прерываний 13h,  21h, 27h.  Содержит текстовые
строки: "Eddie lives...somewhere in time", "Diana P.", "This program was
written in the city of Sofia (C) 1988-89 Dark Avenger".

                      "Eddie-2000", "Eddie-2100"
                      ──────────────────────────
        Резидентные очень опасные вирусы.Быстро размножаются: инфицируют 
файл при загрузке его в память для выполнения, при создании, закрытии  и
переименовании файла, при чтении или изменении его атрибутов.

        Вирусы следят за тем,чтобы длины заражаемых файлов увеличивались
ровно на  2000 (или  2100) байт  (к EXE-файлам,  помимо выравнивания  на
границу параграфа, дописывается необходимое  число байт).  У  заражаемых
файлов устанавливается новое значение секунд даты последней  модификации
файла - 62 секунды.

        "Eddie-2000" предпринимает ряд  эффективных мер для  того, чтобы
остаться незамеченным, многие из  них повторяют аналогичные меры  вируса
"Eddie-1800". Маскирующую функцию играет длина вируса: достаточно трудно
заметить приращение длины, кратное 1000 байтам. Введена и другая функция
защиты:  вирус  перехватывает  функции  DOS  FindFirst  и FindNext FCB и
"уменьшает" длины зараженных файлов на 2000 байт.

        "Eddie-2100" дополнительно к этому обрабатывает функции FindNext
и FindFirst ASCII; исправлена ошибка, из-за которой команда DIR сообщала,
что длина  файла около  4 гигабайт  (см.   описание вируса "Eddie-651").
Непонятным образом манипулирует с секторами винчестера - видимо,пытается
либо активизировать, либо вылечить неизвестный мне загрузочный вирус.

        Вирусы  "Eddie-2000"  и  "Eddie-2100"  очень опасны - аналогично
вирусу "Eddie-1800"  стирают секторы  со случайными  номерами. При  этом
вирусы обращаются  напрямую к  драйверу, обслуживающему  диск, и обходят
многие резидентные блокировщики.

        Изменяют int 13h, int  21h, int 27h. Содержат  текстовые строки:
"Диана П.", "(c) 1989 by Vesselin Bontchev"; вирус "Eddie-2000" -  "Zopy
me - I want to trawel", вирус "Eddie-2100" - "Eddie lives". Если в  теле
запускаемой программы  содержится строка  "Vesselin Bontchev"  (Весселин
Бончев - автор известных болгарских антивирусов), то вирус зацикливается
и система зависает.

                           Семейство "Hero"
                           ════════════════
        Семейство ("Hero-394","Hero-506") резидентных вирусов."Hero-394"
стандартно поражает  EXE-файлы при  их загрузке  в память,  "Hero-506" -
дополнительно и COM-файлы.  Записывают свою TSR-копию в таблицу векторов
по адресу 0000:0200.  При установке вектора прерывания (int 21h, ah=25h)
с номером больше  7Fh "Hero-506" самоизлечивается  в памяти. В  качестве
рабочего буфера используют адреса видео-памяти. Первого числа ежемесячно
сообщают "С Л А В А   Г Е Р О Я М!"  ( в другой версии - "АВТОР ВИРУСА -
КРЕТИН").  Тексты зашифрованы.  Перехватывают int 21h.

                         Семейство "Jerusalem"
                         ═════════════════════
        Известны пять представителей семейства "Иерусалимских"  вирусов:
"Jerusalem", "Sunday", "Kylie", "Fumanchu", "Taiwan". Их общие свойства.

        Заражают  .COM-  и  .EXE-файлы  при  загрузке  их  в  память для
выполнения. Вирусы анализируют имя заражаемого файла и не заражают файлы
с именем COMMAND.COM, чем несколько затрудняют свое обнаружение.

        При  заражении  .COM-файла  функцией  ALLOC  (int  21h,  ah=48h)
выделяют  память,  куда  копируют  себя,  а затем зараженный файл (таким
образом, при заражении не вирус дописывается к файлу, а файл к  вирусу).
Затем уже зараженный файл сохраняется на диск.

        Инфицирование  .EXE-файлов  производится  стандартным   образом,
большинство вирусов семейства изменяют значение контрольной суммы файла.
Возможно  внедрение  вируса  в  середину  файлов  (в  результате  ошибки
вируса), что может привести к их потере.

        При выполнении инфицированной программы вирус проверяет  наличие
своей копии  в памяти  компьютера.   Затем вирус  остается резидентным в
памяти, при этом он выполняет следующие действия:

        - сохраняет в своем теле значения байтов памяти с адресами
          [0000:03FC] - [0000:03FE];
        - по этим адресам вирус помещает программу копирования и
          передает ей управление;
        - при копировании тело вируса перемещается в самые младшие
          адреса, выделенные для основной программы (при этом вирус в 
          COM-программе копируется сам в себя, а в EXE-программе стирает 
          часть кода основной программы), возврат из программы
          копирования происходит в копию вируса;
        - восстанавливает старое содержимое байтов памяти с адресами
          003FCh-003FEh;
        - уменьшает размер выделенной под основную программу памяти;
        - определяет имя основной программы запускает ее на выполнение
          (т.е. происходит повторный запуск основной программы);
        - по окончании работы программы вирус остается резидентным (int 
          21h, ah=31h).

   │ ...     │    │ ...     │   │ ...     │   │ ...     │   │ ...     │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │EXE-     │ ┌─>│Вирус    │   │Вирус    │   │Вирус    │   │Вирус    │
   │программа│ │  ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │         │ │  │         │   │ ...     │   │EXE-     │   │ ...     │
   ├─────────┤ │  ├─────────┤                 │программа│
   │Вирус    │─┘  │Вирус    │                 │         │
   ├─────────┤    ├─────────┤                 ├─────────┤
   │ ...     │    │ ...     │                 │Вирус    │
                                              ├─────────┤
                                              │ ...     │

   │ ...     │    │ ...     │   │ ...     │   │ ...     │   │ ...     │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │Вирус    │───>│Вирус    │   │Вирус    │   │Вирус    │   │Вирус    │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │COM-     │    │COM-     │   │ ...     │   │Вирус    │   │ ...     │
   │программа│    │программа│                 ├─────────┤
   ├─────────┤    ├─────────┤                 │COM-     │
   │ ...     │    │ ...     │                 │программа│
                                              ├─────────┤
                                              │ ...     │

        Вирусы семейства содержат текстовую строку "COMMAND.COM".

                              "Jerusalem"
                              ───────────
        Этот резидентный файловый вирус очень распространен, упоминается
также  как  "Черная  Дыра",  "Тринадцатая  Пятница", "Вирус Замедления",
"Израильский" вирус. Очень опасен  13-го числа любого месяца,  если этот
день является пятницей, и опасен во все остальные дни. Изменяет  векторы
прерываний 8, 21h.

        После инфицирования  .COM-файла к  нему добавляется  5 байтов (в
наиболее распространенной версии вируса "MsDos").  По этим байтам  вирус
отличает зараженные  файлы от  незараженных и  не производит  повторного
инфицирования. Значение контрольной суммы .EXE-файлов изменяет на 1984h.
Проверочные 5 байтов не  дописываются, т.е. .EXE-файлы могут  заражаться
повторно.

        При активизации вируса в любой день, кроме "13-й пятницы", вирус
перехватывает  прерывание  8  (TIMER  TICKS).  Через  некоторое время на
экране  появляется  черный  прямоугольник  и,  начиная  с этого момента,
работа  компьютера  существенно  замедляется  (при  каждом прерывании 8h
компьютер совершает холостой цикл). При активизации вируса 13-го числа в
пятницу происходит следующее:  при попытке запустить любую программу  на
выполнение файл,  содержащий эту  программу, уничтожается,  и DOS выдает
сообщение о том, что файл не найден.  В результате будут уничтожены  все
файлы, к которым произойдет обращение функцией EXEC.

                             "SunDay-1631"
                             ─────────────
        Очень опасен - уничтожает файлы при их запуске на выполнение.  В
воскресенье выдает сообщение: "Today is SunDay! Why do you work so hard?
All work and no play make you a dull boy! Come on! Let's go out and have
some fun!".

                             "Kylie-2272"
                             ────────────
        Поражает файлы, начиная с 20 января  1990 г. С  13 июля 1990  г.
проявляется  проигрыванием  мелодии.  Перехватывает  int  1Ch и int 21h.
Содержит текст "Kylie Minogue".

                            "Fumanchu-2080"
                            ───────────────
        Перехватывает int 9, 16h,  21h. При "теплой" перезагрузке  (Alt-
Ctrl-Del) или в зависимости от текущего времени расшифровывает (XOR AFh)
и  выдает  на  экран  текст  "The  world  will  hear  from me again!". В
зависимости от даты корректирует вводимый с клавиатуры текст.Если ввести
"fu manchu", "thatcher", "reagan", "botha" или "waldheim", вирус добавит:

        fu manchu  virus 3/10/88 - latest in the new fun line!;
        thatcher   is a cunt
        reagan     is an arsehole
        botha      is a bastard
        waldheim   is a Nazi

Если ввести слова "fuck" или "cunt", вирус сотрет их с экрана.

                             "Taiwan-2900"
                             ─────────────
        Заражает  файлы  не  только  при  выполнении, но и при открытии.
Очень опасен  - при  запуске файла  ACAD.EXE стирает  информацию на всех
доступных дисках.   Примерно раз в  месяц приблизительно через  10 часов
непрерывной работы проигрывает довольно  тоскливую мелодию.  Если  в это
время  нажать  Alt-Ctrl-Del,  то  произойдет  то  же,  что и при запуске
ACAD.EXE.

        Перехватывает int  8, 9,  13h, 16h,  21h. Содержит  в своем теле
зашифрованные  строки:  "ACAD.EXE",  "COMMAND.COM.COM.EXE",   "Copyright
(C) 1988, 1989 by ABT Group".

                           Семейство "Hymn"
                           ════════════════
        Семейство резидентных очень опасных вирусов. Стандартно поражают
COM- и EXE-файлы при их запуске, закрытии, переименовании или  изменении
их атрибутов. Если номер текущего месяца совпадает с числом (1 января, 2
февраля,...) уничтожают  часть системной  информации Boot-сектора  диска
C:, затем расшифровывают и выводят на экран картинку:

▐▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▌        ▐▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▌
▐ USSR  ViruSoft (c)  v1. 1990 ▌        ▐ USSR  ViruSoft (c)  v1. 1990 ▌
▐▄▐▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▌    ▐▀▐▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▌
  ▐ USSR  ViruSoft (c)  v1. 1990 ▌    ▐ USSR  ViruSoft (c)  v1. 1990 ▌
  ▐▄▐▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▌▐▀▐▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▌
    ▐ USSR  ViruSoft (c)  v1. 1990 ▌▐ USSR  ViruSoft (c)  v1. 1990 ▌
    ▐▄▐▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▐▀▐▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▌
      ▐ USSR  ViruSoft (c)  v1. 19▐ USSR  ViruSoft (c)  v1. 1990 ▌
      ▐▄▐▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▐▀▐▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▌
        ▐ USSR  ViruSoft (c)  v1▐ USSR  ViruSoft (c)  v1. 1990 ▌
        ▐▄▐▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▐▀▐▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▌
          ▐ USSR  ViruSoft (c)▐ USSR  ViruSoft (c)  v1. 1990 ▌
          ▐▄▐▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▐▀▐▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▌
            ▐ USSR  ViruSoft▐ USSR  ViruSoft (c)  v1. 1990 ▌
            ▐▄▐▀▀▀▀▀▀▀▀▀▀▀▐▀▐▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▌
              ▐ USSR  Viru▐ USSR  ViruSoft (c)  v1. 1990 ▌
              ▐▄▐▀▀▀▀▀▀▀▐▀▐▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▌
                ▐ USSR  ▐ USSR  ViruSoft (c)  v1. 1990 ▌
                ▐▄▐▀▀▀▐▀▐▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▌
                  ▐ US▐ USSR  ViruSoft (c)  v1. 1990 ▌
                  ▐▄▐▀▐▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▌
                    ▐ USSR  ViruSoft (c)  v1. 1990 ▌
                    ▐▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▌

и исполняют Государственный Гимн СССР.  При этом вирус обнуляет в  Boot-
секторе  диска  байты,  в  которых  указываются  число байтов на сектор,
секторов  на  кластер,  число  копий  FAT  и  т.д.  (всего 9 байт). Если
проделать подобные  изменения в  Boot-секторе компьютера,  работающего в
среде MS-DOS,  он (компьютер)  перестанет загружаться  как с винчестера,
так и с флоппи-диска. Для того, чтобы восстановить информацию необходимо
написать  собственный  мини-загрузчик  или  воспользоваться специальными
утилитами. "Hymn-1962" и "Hymn-2144" шифруют свое тело.

                            Семейство "Loz"
                            ═══════════════
        Два  практически  полностью   совпадающих  резидентных   опасных
вируса, зашифрованы.   Стандартно поражают  COM-файлы при  выполнении  и
открытии.  Изменяют  первые  4  байта  файла (JMP Loc_Virus; DB '+').При
создании  резидентной  копии   уменьшают  значение  слова   [0000:0413].
Корректируют системную информацию в Boot-секторах дискет (обнуляют слово,
соответствующее  числу  головок  дисковода).  При  запуске  AIDSTEST.EXE
сообщают "Welcom to demo  version (C) Zherkov. Лозинский-ДУБ,  AIDSTEST-
горбуха". "Loz-1018" уничтожает программу AIDSTEST.

                            Семейство "MG"
                            ══════════════
        Три  практически  совпадающих  резидентных  безобидных   вируса.
Стандартно  поражают  .COM-файлы  (используя  FindFirst,  FindNext)  при
обращении к функциям DOS 36h,39h,47h,4Bh. Перехватывают int 13h и 21h.

                            Семейство "Mgn"
                            ══════════════
        Два  ("Mgn-2048",  "Mgn-2560")  резидентных  неопасных   вируса.
Присланы из  г. Магнитогорска.  Зашифрованы. Стандартно  заражают COM- и
EXE-файлы при их запуске и закрытии, COMMAND.COM заражается по алгоритму
вируса  "Lehigh".  Восстанавливают  файлы  при  их открытии, не заражают
файлы, если одновременно нажаты клавиши Num+Ins+Ctrl. Поэтому простейший
способ лечения  зараженного такими  вирусами компьютера  - пройти  любым
антивирусом все  COM и  EXE-файлы во  всех каталогах  на всех дисках при
нажатых клавишах Num+Ins+Ctrl, а затем перезагрузить компьютер.

        Каким-то  образом  фокусничают  с  экраном. Перехватывают int 8,
int 13h,  int 21h.  Содержат строку  "COMMAND". "Mgn-2560"  периодически
сообщает:
               ╔══════════════════════════════════════╗
               ║           Mr. Lozinsky !             ║
               ║ Just  read  documentation  on   your ║
               ║ AIDSTEST   (1-Oct-90   version)   we ║
               ║ release new  virus. Create  improved ║
               ║ versions of AIDSTEST, please !       ║
               ║(C) TinySoft&Electronics,Inc. 3-Nov-90║
               ╚══════════════════════════════════════╝

                          Семейство "Murphy"
                          ══════════════════
        Резидентные неопасные  вирусы. Быстро размножаются - стандартным
способом инфицируют файлы при загрузке их в память и при открытии файлов.
Перехватывают int 21h.

        "Murphy-1277" через некоторое  время после активизации  начинает
издавать мерзкий свист очень высокого тона. Содержит текст: "I'm Murphy.
Nice to meet you friend. I'm written since Nov/Dec. Copywrite (c)1989 by
Lubo & Ian, Sofia, USM Laboratory."

        "Murphy-1521"  проявляется  так  же,  как  и  вирус "Ping-Pong":
запускает  "шарик",  который  перемещается  по  экрану, отражаясь от его
границ. Содержит текст  "It's me -  Murphy. Copywrite (c)1990  by Lubo &
Ian, Sofia, USM Laboratory".

                          Семейство "Phoenix"
                          ═══════════════════
        Семейство ("Phoenix", "Evil", "Proud", "Live-800",  "Live-1226")
резидентных очень опасных вирусов-"призраков".   Инфицируют COM- и  EXE-
файлы при закрытии и выполнении ("Proud", "Live" - только COM, "Live-800"
не заражает COMMAND.COM). Пораженные EXE-файлы не распространяют вируса -
к ним стандартным образом приписывается небольшой участок кодов  вируса,
стирающий при  некоторых условиях  всю информацию  на всех установленных
винчестерах. Записывается в середину COM-файлов, сохраняя стираемую  при
этом часть файла в его  конец (кроме COMMAND.COM - вирус  записывается в
область  стека  COMMAND.COM  и  не  изменяет  его  длины). Затем у файла
изменяются первые 3 байта (JMP Loc_Virus).

      Заражение COM-файла                 Заражение файла COMMAND.COM
┌───────────┐      ┌───────────┐       ┌───────────┐      ┌───────────┐
│  Файл     │      │  Файл     │       │COMMAND.COM│      │COMMAND.COM│
│           │      │           │       │           │      │           │
│           │      │           │       │           │      │           │
├ - - - - - ┤      ├───────────┤       ├ - - - - - ┤      ├───────────┤
│           │──┐   │  Вирус    │       │           │      │  Вирус    │
├ - - - - - ┤  │   ├───────────┤       ├ - - - - - ┤      ├───────────┤
└───────────┘  │   │- - - - - -│       └───────────┘      └───────────┘
               └──>│           │
                   └───────────┘

        При активизации вирусы семейства перехватывают прерывание 13h  и
затем в зависимости от некоторых условий случайным образом  переставляют
байты в считываемых или записываемых на диск блоках информации.

        Вирусы семейства впервые использовали два новых для компьютерной
микробиологии  приема.  Во-первых,  вирусы  отслеживают  обращение DOS к
файлам, используя  сетевое  прерывание  DOS.  Во-вторых,  вирусы  (кроме
"Live-800") являются вирусами-"призраками"  и не имеют  постоянной маски
(сигнатуры):  основная часть вируса зашифрована, а программа расшифровки
(длиной 32 байта) выбирается из 204 возможных вариантов (следует учесть,
что вирусы семейства имеют длины:  "Phoenix" - 1704 байт, "Evil"  - 1701
байт, "Proud"  - 1102  байта).   Используемые при  этом алгоритмы еще не
стали  общеизвестными.  Поэтому  лучше  воздержаться  от  их  подробного
изложения, дабы несколько отдалить момент появления аналогичных  вирусов
советского производства.

        Содержат в себе следующие текстовые строки (зашифрованные вместе
с остальной частью вируса):
        "Phoenix" - "PHOENIX";
        "Evil"    - "The evil that men do lives on and on and on...";
        "Proud"   - "Proudly made in Sofia";
        "Live-800" и "Live-1226" - "Live after Death".

                         Семейство "Saratoga"
                         ════════════════════
        Семейство  резидентных  опасных  вирусов.  Стандартным   образом
поражают  каждый  второй  или  десятый  (в зависимости от версии вируса)
.EXE-файл  при  его  выполнении  или  загрузке  в  память. После каждого
удачного заражения файла объявляют один из свободных кластеров  текущего
диска сбойным (так называемый псевдосбойный кластер).

                           Семейство "Self"
                           ════════════════
        Два  ("Self-457",  "Self-550")  нерезидентных  опасных   вируса.
Поражают .COM-файлы  в текущем  оглавлении, записываясь  в начало файла.
Первые  8  байт  вируса  состоят   из  четырех  пар,  которые   случайно
выбираются из PUSH  CX - POP  CX, PUSH DX  - POP DX,  PUSH DS -  POP DS,
PUSH ES - POP ES.  Периодически выдает на экран случайные данные.

        "Self-550" в зависимости от времени может уничтожать .EXE-файлы.
Снимает атрибут read-only и не восстанавливает его.

                           Семейство "Small"
                           ═════════════════
        Резидентные вирусы, стандартно  записываются в конец  COM-файлов
при их загрузке  в память. Используют  команды POPA и  PUSHA процессоров
80x86. "Small-132" некорректно заражает некоторые файлы.

                            Семейство "SVC"
                            ═══════════════
                  "SVC-1064", "SVC-1689", "SVC-1700"
                  ──────────────────────────────────
        Резидентные  безобидные  вирусы,  стандартно  поражают  COM-   и
EXE-файлы при запуске их на выполнение. Не заражают файлы AI*.*, SC*.*
(AIDSTEST.EXE,   SCAN.EXE).   Устанавливают   секунды   даты   последней
модификации файла в  1Eh (60 сек).   Перехватывают int 21h.   "SVC-1064"
содержит строку "(c) 1990 by SVC, Vers. 3.1".

        Более сложные "SVC-1689"  и "SVC-1700" обрабатывают  функции DOS
FindNext и  FindFirst и  подставляют старую  длину файла,  а при запуске
под  отладчиком  самоизлечиваются.  Содержат  строку  "(c)  1990 by SVC,
Vers. 4.0".

                              "SVC-3103"
                              ──────────
        Резидентный безобидный  вирус, стандартно  поражает COM-  и EXE-
файлы  при  запуске   на  выполнение,  открытии   или  закрытии   файла.
Незначительная часть  вируса зашифрована.  Как и  "SVC-1689" подставляет
старую длину  файла.   При попытке  установить отладчик  на коды  вируса
перезагружает компьютер.  Содержит строку  "(c) 1990 by SVC, Vers  5.0".
Перехватывает int 21h.  Штамм вируса передан  мне сотрудниками МВД.  Они
же сообщили, что автор вируса проживает в г. Нижний Новгород.

                           Семейство "Tiny"
                           ════════════════
        Состоит  из  11-ти  резидентных  вирусов.  Стандартным   образом
поражают  COM-файлы  при  их  загрузке.  Вирусы  семейства копируют свою
резидентную  часть  в  область  памяти  по  адресу 0000:0600. Отличаются
небольшими размерами - от 133 до 198 байт.

                           Семейство "Tumen"
                           ═════════════════
        Два  резидентных  вируса.  Стандартно  поражают COM-файлы при их
выполнении.  При   создании  TSR-копии   уменьшают  слово   [0000:0413].
Перехватывают int 8, int 9 и int 21h.

        "Tumen-1092" очень опасен -  создает счетчик в 10-м  байте Boot-
сектора диска C:, когда значение счетчика достигает 70h ('p' латинское),
стирает нулевую  сторону нулевого  трека винчестера.  Некорректно правит
зараженные  программы  после  инициализации  вируса  -  программы  могут
зависать. Блокирует работу функций DOS 41h и 56h. Содержит текст:

 "Be carefull... Hackers time tonight...
  This present was created in Tumen at 1990. v 2.0.
  (c) Max Soft corporation
  Hackers of the world, Unite !"

        "Tumen-1663"  не  опасен,  проявляется  мелодией  Паганини   при
нажатии Alt-Ctrl-что-нибудь. Весьма многословен:

 "Full moon tonight...  The time of Wolfbacks... U...U...U...
  This is only demonstration version, but you hear some howl.
  (C) Copyright MMA Company   All rights reserved. USSR Tumen 1990-v0.5
  This program was created in Tumen by group of three Wolfbacks
  at April,1990
  General  System_&_Files affecting effects by Max
  Main consultant -- Tall Lazy Micle
  General  Music_&_Video  harmless  effects by Alex
  BACKWOLFS OF THE WORLD, UNITE ! ! !"

                           Семейство "V-512"
                           ═════════════════
        Семейство  насчитывает  шесть   практически  совпадающих   очень
опасных "стелс"-вирусов. Поражают  .COM-файлы, записываясь в  их начало.
Заражение  происходит  при  запуске  или  закрытии  файла.  Начало файла
сохраняется в первом неиспользуемом секторе последнего кластера файла.

    │ <─────────── Файл ──────────────────────────> │
    ┌───────────┬───────────┬─  ──┬───────────┬───────────┐
    │ кластер   │ кластер   │ ... │ кластер   │ кластер   │
    └──┴──┴──┴──┴──┴──┴──┴──┴─  ──┴──┴──┴──┴──┴──┴──┴──┴──┘
     ^                                               ^  ^
     └─ Начало вируса.  Сохраненное начало файла  ───┘  │
                        Неиспользуемый сектор     ──────┘

        Длина заражаемого файла  не изменяется. У  файла устанавливается
время последней модификации - 62  сек. При заражении в качестве  рабочей
области используется таблица векторов прерываний (0000:0200 - 0000:03FF).

        При активизации вирусы "512" располагаются в одном из  системных
буферов.  При  заражении  файлов  активно используют недокументированную
область DOS  - System  File Table.  При чтении  начала зараженного файла
подставляют его  истинное начало.  Этими действиями  вирусы "512"  очень
хорошо маскируют свое присутствие в системе.

        Очень  опасны.  Поражают  файлы,  которые имеют расширение имени
.CO? (? - любой знак).  Может произойти утеря файла при  его копировании
(последний  кластер  файла  копируется  не  целиком).  Произойдет потеря
файла  на  диске,  имеющем  один  сектор  на кластере. Изменяют int 21h,
некоторые вирусы содержат строку "666".

                           Семейство "V-560"
                           ═════════════════
        Два практически совпадающих нерезидентных очень опасных  вируса.
При запуске поражают один .COM-файл корневого оглавления. Если  такового
нет, то  переименовывают все  *.EXE-файлы в  *.COM и  повторяют попытку,
если опять не обнаружено  ни одного неинфицированного файла,  то стирают
на диске 2 сектора со случайными номерами. Записываются в начало  файла,
не сохраняя  старое содержимое  его начала.   Поэтому файлы,  зараженные
вирусами  семейства  "V-560",  не  восстанавливаются.   Снимают  атрибут
read-only.

                           Семейство "V-600"
                           ═════════════════
                           "V-370", "V-600"
                           ────────────────
        Резидентные вирусы,  безобидны. Часть  вируса "V-600"  (50 байт)
зашифрована (XOR DDh). Инфицируют .COM-файлы ("V-370" кроме COMMAND.COM)
при  загрузке  их  в  память  для  выполнения.  При  внедрении  в   файл
переписывают  его  начало  в  конец  файла  и  записывает  свою  копию в
освободившийся участок.  При этом  переписываемая часть  файла шифруется
(XOR BBh).

        Изменяют int 21h. Никак не проявляются и не имеют  деструктивных
функций.  "V-600"  содержит  зашифрованный  (XOR  1Ah) текст: "Oleynikoz
S.,1990".  Видимо   проба  пера   начинающего  программиста,   так   как
невооруженным глазом заметно достаточно узкое знание возможностей  языка
ассемблера.

                            "Voronezh-1600"
                            ───────────────
        Резидентный опасный вирус. Поражает файлы при их выполнении  или
открытии. COM-файлы заражаются по схеме вируса "V-600".

        EXE-файлы инфицируются по сложному алгоритму:  у них  изменяется
пять байт точки входа в программу на код команды CALL FAR Loc_Virus, при
этом изменение адреса точки входа в заголовке файла не требуется.  Вирус
корректирует  таблицу  настройки  адресов  (ТНА):   добавляет в нее один
элемент, соответствующий команде CALL FAR Loc_Virus; необходимым образом
изменяет 1  элемент ТНА,  указывающий на  измененные 5  байт (если такой
элемент существует). Затем  вирус дописывает к  файлу свою копию  (длина
файла при этом не увеличивается до параграфа).

        Вирус содержит ошибки: анализируются не более 640 элементов ТНА;
не анализируется случай, когда  модифицируемый элемент ТНА указывает  на
5-й байт от точки входа (т.е. слово, которое настраивается при  загрузке
файла, лежит  на границе  изменяемых 5  байт). При  запуске такого файла
возможно зависание компьютера. Перехватывает прерывание 21h.

                          Семейство "V-1024"
                          ══════════════════
        Семейство  резидентных  неопасных  вирусов.  Стандартно поражают
COM- и  EXE- файлы  при их  загрузке в  память.  Указывают "уменьшенную"
длину файла при вызове функций FindNext и FindFirst FCB. Через некоторое
время после  активизации "запускают"  несколько разноцветных  шариков, в
беспорядке перемещающихся по экрану (эффект напоминает движение шарика у
вируса "Ping-Pong").

                          Семейство "Vienna"
                          ══════════════════
        Моя коллекция содержит около двух десятков вирусов семейства.
Их общие черты.

        Стандартным образом заражают .COM-файлы  в текущем каталоге и  в
зависимости  от  версии  вируса  в  корневом каталоге, либо в каталогах,
отмеченных системной переменной PATH.  Заражение происходит при  запуске
инфицированной программы, при этом заражается не более одного файла.

         Вирусы  семейства  (кроме  "Vienna-217")  при попытке заражения
проверяют у файла  значение секунд (или  месяца в зависимости  от версии
вируса)  последней  модификации  файла.   Если  оно  равно 1Fh (62 сек.,
соответственно  0Dh  -  13-й  месяц),  то  файл не заражается. Некоторые
представители семейства в зависимости от таймера могут "убивать"  файлы,
записывая в их начало 5 байтов либо команды перехода на перезагрузку JMP
F000:FFF0,  либо  JMP  C800:0005,  JMP  C800:0000  или  JMP  C800:0006 в
зависимости от версии вируса. Вирус "Vienna-648-b" ("Lisbon") записывает
в начало файла текст  "@AIDS". Восстановить в первоначальном  виде такие
файлы невозможно.

        Содержат строку "*.COM" или:

"Vienna-483":           "Kiev 1990";
"Vienna-534":           "Microsoftyright Microsoft 1988";
"Vienna-547":           "IBM";
"Vienna-648-b":         "@AIDS".

        Некоторые версии периодически выводят на экран текст:

"Vienna-776":          "Я, кажется, подхватила какую-то заразу...
                        Срочно звоните Дмитрию Николаевичу Лозинскому
                        по телефону 292-40-76 (Москва) и приобретите
                               ПРОГРАММУ AIDSTEST !!!";
"Vienna-757":          "Безвредный вирус:
                        Долой Кузьмичей !!!".

"Vienna-1881" с 19 декабря по 1 января рисует елочку:
                                   *
                                   *
                                 **░**
                              *****░*****
                                 **░**
                               ****░****
                            *******░*******
                        ***********░***********
                               ****░****
                            ******░░░******
                         *********░░░*********
                      ************░░░************
                  ****************░░░****************
              ********************░░░********************
          ************************░░░************************
                    ▒       Merry Christmas       ▒
       *            ▒              &              ▒            *
      *▓*           ▒      a  Happy New Year      ▒           *▓*
     **▓**          ▒  for all my lovely friends  ▒          **▓**
   ****▓****        ▒            from             ▒        ****▓****
 ******▓******      ▒      FATHER  CHRISTMAS      ▒      ******▓******
                    ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒


        "Vienna-757" изменяет  первые 4  байта файла,  не поражает  файл
"COMMAND.COM".

        "Vienna-644" поражает файлы, только если значение минут  таймера
меньше 20. Изменяет 5 байт начала файла (PUSH CS; POP DS; CALL Loc_Virus).
Устанавливает некоторые биты времени файла (OR 1234h).

        Вирус "Big Piter" состоит из двух блоков. Первый блок ("голова")
практически  полностью  повторяет  вирус  "Vienna-648";  он осуществляет
заражение файлов и вызов второго блока.  Второй блок (основной)  получен
при  помощи  компилятора  Microsoft  C  (об  этом  говорят тексты в теле
вируса).  Основной блок выводит на экран изображение компьютера и  текст
"regional engeneering  centre LENINFORMATIKA  ...", после  чего может (в
зависимости  от  некоторых  условий)  оставить  резидентную   программу,
блокирующую  запись  на  винчестер.  Очень  опасен  -  может  уничтожить
COM-файлы  длиной  более  40K.   Помимо  указанного  текста содержит все
строки,  которые  вставляет  в  тела  программ  компилятор  Microsoft C.
Изменяет прерывание 60h - использует для вызова основного блока.

                    Семейство "VACSINA" и "Yankee"
                    ══════════════════════════════
        Семейство вирусов  "VACSINA" (не  "VACCINA"!) и  "Yankee"
насчитывает более 40 файловых  резидентных неопасных вирусов. Каждый  из
них содержит в своем теле метку, состоящую из трех байт:  F4h, 7Ah, NNh.
Третий  байт  NNh  рассматривается  как  номер вируса в семействе (номер
версии  вируса)  и  в  дальнейшем  будет  фигурировать  в именах вирусов
("VACSINA-NN" и "Yankee-NN").  При активизации вирусы  данного
семейства записывают в память по адресам 0000:00C5, 0000:00C6, 0000:00C7
байты 7Fh, 39h, NNh.  Характерной особенностью вирусов данного семейства
является  то,  что  они  восстанавливают  файлы,  зараженные предыдущими
версиями вирусов семейства, и затем инфицируют их.

        Вирусы "VACSINA-NN" содержат в своем теле слово "VACSINA".

        Заражают COM- и EXE-файлы  при их  выполнении (вирусы  версий до
26h) или загрузке в память (вирусы версий 26h и выше).

        Стандартно заражают COM-файлы. Вирусы версий до 9-й включительно
проверяют у заражаемого COM-файла первый  байт. Если этот байт не  равен
E9h (JMP), то  файл не заражается.  Вирусы старших версий  заражают COM-
файлы вне зависимости от их первого байта. Кроме этого вирусы  "VACSINA"
увеличивают длину заражаемого файла до параграфа.  Начиная с версии 2Ah,
к файлу после заражения дописываются дополнительные 4 байта.

        Вирусы младших версий (до 23h) инфицируют EXE-файлы  специальным
образом -  файлы переводятся  в формат  COM-файлов.   Для этого  к файлу
дописывается небольшой фрагмент вируса (132 байта), настраивающий адреса
по  таблице  адресов  при  загрузке  файла  в  память  для выполнения, и
изменяются первые три байта файла (JMP на фрагмент).  Дописанные к файлу
132 байта  не распространяют  вируса. Их  действие заключается  только в
настройке адресов программы при ее запуске.  Обработанный таким  образом
файл  будет  выполняться  операционной  системой  и  заражаться  многими
вирусами как  COM-файл.   При выполнении  EXE-программы, содержащейся  в
подобном  файле,  управление  передается  на фрагмент настройки адресов,
который анализирует таблицу адресов в заголовке файла и  соответствующим
образом корректирует загруженную программу. Затем управление  передается
на стартовый адрес, указанный в заголовке файла.

        Вирусы  перехватывают   вектор  прерывания   21h,  а   некоторые
представители семейства "Yankee" - int 1, 3, 9, 1Ch.

        Вирусы вызывают  звуковые эффекты:  при заражении  файла вирусом
"VACSINA"  раздается   звуковой  сигнал   (BELL),  вирусы   "Yankee"   в
зависимости  от  некоторых  условий  (при  одновременном  нажатии клавиш
Alt-Ctrl-Del либо в 17.00) исполняют мелодию "Yankee Doodle Dandy".  При
некоторых условиях вирус "VACSINA-06"  расшифровывает и выдает на  экран
строку "Az sum vasta lelja."

        Вирусы семейства содержат  несколько "изюминок". Так,  начиная с
версии  18h,  вирусы  определяют  первоначальное значение вектора 21h-го
прерывания (адрес обработчика прерывания в DOS) и при внедрении в  файлы
вызывают  прерывание  по  этому  значению.  Таким образом вирусы обходят
резидентные антивирусные  мониторы. При  определении адреса  обработчика
прерывания используется следующий алгоритм:

        а) установка   прерывания  01h   (точка   входа   при   отладке;
           это прерывание вызывается  в режиме отладки  после выполнения
           процессором  каждой  команды)  на  подпрограмму   определения
           истинного значения вектора прерывания;

        б) включение режима отладки;

        в) вызов  "безопасной"  с  точки зрения  резидентных антивирусов
           функции прерывания 21h.

        При   выполнении   "безопасной"   функции   21h-го    прерывания
последовательно  выполняются  команды  всех  программ,  которые изменяли
вектор прерывания 21h,  затем выполняются команды  операционной системы,
обрабатывающие  данное  прерывание.  При  этом  после каждой выполненной
команды   управление   получает   подпрограмма   вируса,    определяющая
первоначальное  значение  вектора  прерывания.  Она  анализирует   адрес
последней выполненной команды  и, если этот  адрес указывает на  область
памяти, принадлежащую операционной  системе, выключает режим  отладки, а
адрес данной команды  рассматривает как первоначальное  значение вектора
прерывания 21h.

                     00000  │ ...            │
                            ├────────────────┤
                            │Операционная    │
        ┌──────────────────>│система         │
        │                   ├----------------┤
        │                   │COMMAND.COM     │
        │           int 21h ├────────────────┤
        └───────────────────│Пользовательская│───┬─── Программы,
        ┌──────────────────>│программа       │   │    изменявшие
        │                   ├────────────────┤   │    вектор прерывания
        │                   │ ...            │   │    21h
        │           int 21h ├────────────────┤   │
        └───────────────────│Пользовательская│───┘
        ┌──────────────────>│программа       │
        │                   ├────────────────┤
        │                   │ ...            │
        │                   ├────────────────┤
        │                   │Вирус           │
        │           int 21h │   ─────────────┤
        └───────────────────│Команда вызова  │
                            │прерывания 21h  │
           ^  │             │   ─────────────┤
           │  └────────────>│Подпрограмма    │
           │                │определения     │
           └────────────────│вектора         │
                            ├────────────────┤
                     FFFFF  │ ...            │

        Начиная с версии 21h вирусы перехватывают действия,  совершаемые
отладчиком  и,  если  под  отладчиком  находится  тело вируса, блокируют
процесс отладки. При  этом при попытке  просмотреть зараженный файл  под
отладчиком файл "самоизлечивается".

        Начиная с  версии 21h  вирусы семейства  кодируют себя  линейным
блоковым кодом  и хранят  в своем  теле проверочные  байты. Периодически
вирусы  проверяют  себя   на  наличие  исправлений   и  по   возможности
восстанавливают их.

        Начиная  с  версии  2Сh  дезактивируют  резидентную часть вируса
"Ping-Pong", а начиная с  2Eh, принимают некоторые меры  противодействия
вирусам семейства "Cascade".

                   Модификации "VACSINA" и "Yankee"
                   ────────────────────────────────
        Семейство  вирусов  "VACSINA"  и  "Yankee"  в  достаточной  мере
"популярно": помимо нескольких десятков "оригинальных" вирусов, начинают
появляться их мутации, иногда довольно точно скопированные с  оригинала.
Так в г. Иркутске  обнаружен вирус ("Yankee'-1905"), который  претендует
на то, чтобы  называться вирусом "Yankee-53h". Однако, несмотря на  свой
номер (53h), использует всего  одну "изюминку"  - трассировку прерывания
21h.

        Вирусы "Yankee'-1049"  и "Yankee'-1150"  - файловые  резидентные
безобидные вирусы.Поражают COM- и EXE-файлы при их запуске на выполнение
(int 21h, "Yankee'-1049" - ax=4B00h, "Yankee'-1049" - ah=4Bh).  Изменяют
первые 32 байта файла и дописываются в его конец. Во многом совпадают  с
вирусами "Yankee". Используют вектор 21h.

                           Семейство "Wish"
                           ════════════════
        Резидентные очень  опасные вирусы.  Стандартно поражают  .COM- и
.EXE-файлы  при  их  открытии  или  запуске.  При каждом пятом заражении
модифицируют BPB Boot-сектора текущего диска: уменьшают на единицу (если
при этом  текущий день  -"тринадцатая пятница",  то обнуляют) содержимое
слова, указывающего число  кластеров на диске.   "Wish-970" очень  грубо
работает с памятью и файлами  и в результате может завешивать  систему и
портить файлы.

                           Семейство "Word"
                           ════════════════
        Резидентные  опасные  вирусы,  поражают  COM  и EXE-файлы при их
выполнении. При  инфицировании EXE-файлы  переводятся в  COM формат (см.
описание  вирусов  "VACSINA").  При  записи  в  файлы  (int   21h,f.40h)
переставляют местами слова:

"ОШИБКА ПРИ ЗАПИСИ НА ДИСК" -> "ПРИ ОШИБКА НА ЗАПИСИ ДИСК"

Перехватывают int  21h.   "Word-1387" и  "Word-1503" зашифрованы, причем
"Word-1503" использует "призрак"-алгоритм. Содержат тексты:  "Word-1387"
- "COPYRIGHTKievVirus", "Word-1503" - "Kiev V1.1COPYRIGHT".

                         Семейство "Yanshort"
                         ════════════════════
        Вирусы семейства стандартным образом заражают EXE-файлы во  всех
оглавлениях текущего диска. Не опасны. Зараженные файлы содержат  строку
"motherfucker",  по  которой  вирус  различает зараженные и незараженные
файлы. Вирус "Yanshort-1961"  проявляется проигрыванием мелодии  "Yankee
Doodle Dandy" при запуске  зараженной программы. При некоторых  условиях
программы, пораженные вирусом "Yanshort-1624", зависают при запуске.


           Файловые вирусы, не входящие ни в какое семейство
           ═════════════════════════════════════════════════

                               "Advent"
                               ────────
        Нерезидентный  неопасный  вирус,  при  запуске  поражает .COM- и
.EXE-файлы.   EXE-файлы  поражаются  стандартно,  у  COM-файлов изменяет
первые 23h байт начала на коды перехода на тело вируса.

        Большая  часть  вируса  зашифрована.  Не  активизируется, если в
ENVIRONMENT присутствует строка  "VIRUS=OFF". Начиная с  середины ноября
проявляется поздравлением "MERRY CHRISTMAS!" в комплекте с  простенькими
картинками,  появляющимися  под   аккомпанемент  не  менее   простенькой
музыки.

                             "Aids-13847"
                             ────────────
        Нерезидентный очень опасный вирус, поражает .COM-файлы в текущем
оглавлении, записывая свой  код в начало  файлов, не сохраняя  их старое
содержимое.   Написан на  языке высокого  уровня (видимо, Turbo-Pascal).
Содержит текст:

"This File Has Been Infected By AIDS! HaHa!",

*********************************************************************
*                            ATTENTION:                             *
* I have been elected to inform you that throughout your process of *
* collecting and executing files, you have accidentally ******      *
* yourself over; again, that's PHUCKED yourself over. No, it cannot *
* be; YES, it CAN be, a ***** has infected your system. Now what do *
* you have to say about that? HAHAHAHA. Have **** with this one and *
*                  remember, there is NO cure for                   *
*                                                                   *
*    ██████████     ████████████    ███████████      ██████████     *
*   ███▒▒▒▒▒▒███     ▒▒▒▒██▒▒▒▒▒▒   ██▒▒▒▒▒▒▒███    ███▒▒▒▒▒▒▒██    *
*   ██▒▒      ██▒        ██▒        ██▒       ██▒   ██▒▒       ▒▒   *
*   ██▒       ██▒        ██▒        ██▒       ██▒   ██▒             *
*   ████████████▒        ██▒        ██▒       ██▒   ████████████    *
*   ██▒▒▒▒▒▒▒▒██▒        ██▒        ██▒       ██▒    ▒▒▒▒▒▒▒▒▒██▒   *
*   ██▒       ██▒        ██▒        ██▒       ██▒             ██▒   *
*   ██▒       ██▒        ██▒        ██▒      ███▒   ██       ███▒   *
*   ██▒       ██▒   ████████████    ███████████▒▒    ██████████▒▒   *
*    ▒▒        ▒▒    ▒▒▒▒▒▒▒▒▒▒▒▒    ▒▒▒▒▒▒▒▒▒▒▒      ▒▒▒▒▒▒▒▒▒▒    *
*                                                                   *
*********************************************************************

и все текстовые строки, которые вставляет компилятор Turbo-Pascal.

                               "Alabama"
                               ─────────
        Резидентный   опасный   вирус.   Поражает   .EXE-файлы  текущего
оглавления диска, с которого  запускается на выполнение какой-либо  файл
или  на  котором  открывается  файл.  Поражаемый  файл ищется при помощи
функций FindFirst и  FindNext и не  обязательно совпадает с  открываемым
или запускаемым  файлом. При  заражении использует  FCB-функции работы с
файлами, дописывается  в конец  файла, возможно  некорректное заражение.
У зараженного  файла устанавливается  время последней  модификации -  62
сек.

        "Выживает" при перезагрузке - для этого устанавливает прерывание
9h (клавиатура), перехватывает  нажатие клавиш Alt-Ctrl-Del,  после чего
гасит  экран  и  вызывает  процедуру  загрузки  (int 19h). При этом коды
вируса не стираются.

        В  зависимости  от  текущего  времени  может  выдать  на   экран
сообщение типа:
        ╔═════════════════════════════════════════════════════╗
        ║ SOFTWARE COPIES ARE PROHIBITED BY INTERNATIONAL LAW ║
        ║                                                     ║
        ║          Box 1055 Tuscambia ALABAMA                 ║
        ╚═════════════════════════════════════════════════════╝

        Перехватывает  прерывания  9  и  21h.  Cодержит текстовую строку
"????????EXE".  Не  содержит   деструктивных  функций,  но   некорректно
работает с файлами и памятью - может завешивать систему.

                              "Armagedon"
                              ───────────
        Резидентный опасный вирус.  Поражает .COM-файлы (кроме  COMMAND)
при их запуске. Записывается в начало файла. С 5.00 до 6.00 утра активно
работает с параллельным портом,  видимо, пытается позвонить через  модем
по какому-то телефону. Содержит текст "Armagedon the GREEK".  Использует
int 21h и int 8.

                              "Attention"
                              ───────────
        Резидентный опасный вирус. Заражает .COM-файлы при их загрузке в
память. Копирует себя в конец файла и изменяет его первые 16 байт :

        ┌───┬────┬────┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬───┬───────────
        │JMP Loc_Virus│A T T E N T I O N     !│1Ah│   файл
        └───┴────┴────┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴───┴───────────
            3 байта            12 байт        1 байт

        При создании  своей резидентной  копии использует  самые старшие
адреса доступной  памяти. Перехватывает  int 24h,  но не восстанавливает
его первоначальное значение  - это может  привести к зависанию  системы.
Снимает атрибут read-only и не восстанавливает его.

        Проявляется при заражении файлов на защищенном от записи диске -
у дисковода A:  включается  мотор (вне зависимости от диска,  к которому
идет обращение). Зараженные файлы, начиная с 4-го байта, содержат строку
"ATTENTION !". Перехватывает int 21h.

                                "Bebe"
                                ──────
        Нерезидентный  опасный  вирус.   Заражает  .COM-файлы   текущего
оглавления. Увеличивает размер заражаемого файла до параграфа,  копирует
себя в конец файла и  изменяет его первые 14 байт  ( PUSH AX; ... ;  JMP
FAR Loc_Virus ).

        Нерезидентен,  но  создает  резидентную  программу.   Для  этого
копирует  часть  своего  тела  в  таблицу  векторов прерываний по адресу
0000:01CE  и  устанавливает  на  нее  прерывание  1Ch  (таймер).   Через
некоторое время на экране появляется сообщение:

                        ╔════════ VIRUS ! ══════╗
                        ║  Skagi "bebe" >       ║
                        ╚═══════════════════════╝

        После того,  как с  клавиатуры вводится  "bebe", вирус отвечает:
"Fig Tebe !". По словарному запасу вируса можно вполне точно  определить
его происхождение.

        Содержит ошибку - не  восстанавливает DTA. Это может  привести к
зависанию  компьютера.  Еще  одна  тонкая  ошибка - не учитывает наличие
конвейера у процессоров Intel 80x86 и модифицирует следующую за  текущей
выполняемую команду, в результате чего работает только на старых моделях
IBM PC. Помимо перечисленного текста содержит строку "*.COM".

                              "Datacrime"
                              ───────────
        Нерезидентный очень опасный вирус. При запуске зараженного файла
стандартно инфицирует не более  одного COM-файла (кроме COMMAND.COM)  во
всех текущих оглавлениях всех доступных дисков. В зависимости от таймера
и  своих  внутренних  счетчиков  выдает  на экран текст "DATACRIME VIRUS
RELEASED:  1  MARCH  1989"  и  после  этого  форматирует первые 9 треков
винчестера.

                              "Datalock"
                              ──────────
        Резидентный опасный вирус. Стандартно поражает COM- и  EXE-файлы
при  их  запуске.  С  августа  1990  г.  блокирует открытие .DBF-файлов.
Содержит текст "DataLock version 1.00". Перехватывает int 21h.

                             "Destructor"
                             ────────────
        Резидентный безобидный  вирус,  стандартно  поражает COM- и EXE-
файлы при обращении к ним функциями DOS 3Dh, 41h, 43h, 4B00h, 56h,  57h.
Перехватывает int 21h.  Содержит строки: "DESTRUCTOR  V4.00 (c) 1990  by
ATA", "The Time is my!".

                              "Dir-Virus"
                              ───────────
        Резидентный очень опасный вирус. Поражает .COM-файлы при  вызове
функций FindFirst и  FindNext FCB (эти  функции использует команда  DIR,
что и дало название вирусу). Записывается в конец файлов, изменяя 6 байт
их начала (PUSH Loc_Virus; RET).   Снимает и не восстанавливает  атрибут
read-only, устанавливает  время создания  файла -  60 сек.  Периодически
стирает FAT.  Перехватывает int 21h.

                               "DM-400"
                               ────────
        Резидентный очень опасный  вирус. Стандартно поражает  COM-файлы
при их загрузке  в память. Свою  резидентную копию записывает  в таблицу
векторов по адресу 0000:0200.  При каждом 25-м заражении файла  пытается
форматировать диск. Содержит текст "DM 1990 (c)".

                               "Fish#6"
                               ────────
        Резидентный опасный вирус, зашифрован, стандартно поражает  COM-
и EXE-файлы при их выполнении и закрытии.У заражаемых файлов увеличивает
на  100   значение  года   последней  модификации   файла.  Поддерживает
практически  все  функции  стелс-вируса  (см.   описание вируса "4096").
Шифрует свое тело не только в файлах, но и в своей TSR-копии (при  входе
в  вирус  по  цепочке  int  21h  вирус расшифровывает себя, при выходе -
зашифровывает).

        Начиная  с  1991  г.  завешивает систему, предварительно сообщив
"FISH VIRUS #6 -  EACH DIFF - BONN  2/90". Помимо этой содержит  строки:
"COD",  "SHARK",  "CARP",  "BASS",  "TROUT",  "MUSKYZ",  "SOLE", "PIKE",
"MACKEREL", "FISH", "TUNA", "FISH FI". Перехватывает int 13 и int 21h.

                              "Hallochen"
                              ───────────
        Резидентный опасный вирус, стандартно поражает COM- и  EXE-файлы
(у COM-файлов изменяет  первые 6 байт  начала JMP Loc_Virus,  DB (?), DW
5555h).  В  зависимости  от  "поколения"  вируса  периодически "шутит" с
клавиатурой: при обработке  клавиатурного прерывания подставляет  другой
символ. Замедляет работу компьютера  - задержка на int  8. Перехватывает
int 8, 16h,  21h. Содержит текст  "HallФchen !!!!!!, Here  I'm  Acrivate
Level 1".

                                "Incom"
                                ───────
        Нерезидентный  опасный  вирус,   поражает  .COM-файлы   текущего
оглавления. Записывается в их конец, изменяя первые 6 байт (MOV DX,xxxx;
JMP Loc_Virus). Тело вируса зашифровано. Содержит текст "INCOM".

                               "Int-13"
                               ────────
        Резидентный очень опасный "стелс"-вирус, поражает COM-файлы  при
вызове функции FindNext.  При  поражении переписывает первые 512 байт  в
конец файла и  запоминает физический адрес  сектора (трек/сторона/сектор
в формате int 13h), в который они записываются. Длина файла при этом  не
увеличивается. В  дальнейшем при  чтении с  диска прерыванием  13h вирус
подставляет вместо зараженных секторов истинные (стелс-функция на уровне
int 13h). При записи в файл вирус использует прерывание 13h, поэтому ему
не  нужно  обрабатывать  атрибуты  файла,  время файла и прерывание 24h.
Вирусом  используются  достаточно  экзотические  приемы,  которые  могут
привести к сбою в работе компьютера и к потере файлов.  Содержит  строку
"Int 13", перехватывает int 13h и int 21h.

                             "Jocker-1371"
                             ────────────
        Резидентный очень опасный вирус, стандартно поражает запускаемые
COM-  и  EXE-файлы.  Портит  .BAS-файлы:  записывает  в их начало строку
"JOCKER".  Код вируса во многом повторяет код вирусов семейства "Yankee",
использует некоторые алгоритмы "Yankee", например, трассировку int  21h.
Перехватывает int 21h, содержит текст: либо "COMJOCKER", либо "EXEJOCKER".

                                "Joker"
                                ───────
        Нерезидентный  очень опасный вирус. При старте  обходит каталоги
дисков A: и C: и поражает в них не более 10 .EXE-файлов.  Записывается в
начало файла,  не сохраняя  его старое  содержимое (зараженные  файлы не
восстанавливаются). Имеет значительный объем. Написан на языке  высокого
уровня (возможно, Pascal). Первый встретившийся мне вирус, коды которого
состоят из нескольких сегментов (исходный текст вируса откомпилирован  в
соответствующей модели памяти). После заражения файлов ищет .DBF-файлы и
что-то  записывает  в  них (укорачивает  их?). Содержит строки: "C:\*.",
"C:\", "C:\*.EXE",  "\*.EXE", "C:\*.DBF",  "\*.DBF", "A:\*.EXE",  "A:\",
"Runtime error at". Вместо запуска файла выдает одну из фраз:

"Error in EXE file",
"File cannot be copied onto itself",
"Compare OK",
"Invalid Volume ID Format failure",
"Incorrect DOS version",
"Please put a new disk into drive A:",
"End of input file",
"END OF WORKTIME. TURN SYSTEM OFF!",
"Divide Overflow",
"Water detect in Co-processor",
"I am hungry! Insert HAMBURGER into drive A:",
"NO SMOKING, PLEASE! Thanks.",
"Don't beat me !!",
"Don't drink and drive.",
"Another cup of cofee ? OH, YES!",
"Can you fuck me ? Maybe ...",
"Coca-Cola is it !",
"What about ? Oh, yes. O.K. TODAY",
"Missing VGA! Call (209) 683-6858 !",
"Attention! Hard Disk is RADIOACTIVE!",
"I'm so much dirty! CLEAN ME!",
"Kiss my ...  keyboard!",
"Hard Disk's head has been destroyed. Can you borow me your one?",
"Missing light magenta ribbon in printer!",
"In case mistake, call GHOST BUSTERS",
"Insert tractor toilet paper into printer.",
"Are you funny?",
"Keep smiling!",
"Warning! In drive A: are two diskettes.",
"Warning! Your mouse has some virus!",
"Disconnect your mouse, there are some cats!",
"I don't understand you. Can you repeat it?",
"West Lake Software and Data Research, WA 0108077, New Orleans, 
 (c) 1986".

                              "Joker-01"
                              ──────────
        Резидентный неопасный вирус. Является синтезом вирусов "Cascade"
(создание резидентной копии), "VACSINA" (заражение EXE-файлов), "Yankee"
(обработка прерывания 21h) и программы-шутки "FACE.COM"  (видеоэффекты).
Имеет значительный размер - около 30 Кб.

        Поражает файлы при их запуске. COM-файлы поражаются  стандартным
способом,  EXE-файлы  переводятся  в  COM-формат  по  алгоритму   вируса
"VASCINA".

        При активизации определяет в DOS адрес обработчика int 21h.  Для
этого применяет алгоритм "Yankee". Затем устанавливает int  1Ch, которое
используется  для   реализации  процедуры "всплытия"  обработчика 21h-го
прерывания.

        При успешном  поражении файла  вирус устанавливает  прерывание 9
(клавиатура)  и  запускает  внутренний  счетчик.  Счетчик уменьшает свое
значение на 1  при каждом нажатии  на клавишу. При  достижении счетчиком
нуля на экране  появляется изображение рожицы.  Перехватывает прерывания
9, 1Ch и 21h. В конце зараженного файла содержится строка "JOKER-01".

                               "Justice"
                               ─────────
        Очень опасен, поражает COM-файлы  при обращении к ним  функциями
DOS 43h, 4Bh, 3Dh, 56h. Записывается в конец файлов и изменяет 5 байт их
начала (NOP;  NOP; JMP  Loc_Virus). COMMAND.COM  заражается по алгоритму
вируса "lehigh". Периодически направляет записываемую на диск информацию
в  сектор  с  другим  номером.  Содержит  текст  "AND  JUSTICE FOR ALL".
Перехватывает int 13h и int 21h.

                            "Kemerovo-256"
                            ──────────────
        Опасный  вирус,  заражает  .COM-файлы  текущего  оглавления  при
запуске инфицированной программы. Копирует себя в конец файла и изменяет
его первые 4  байта ( XCHG  AX,DX; JMP Loc_Virus  ). Длина файлов  перед
дописыванием к ним вируса увеличивается на 1 байт (т.е. длина заражаемых
файлов увеличивается  на 256+1  байт).   В зависимости  от таймера может
вызвать перезагрузку компьютера.   Содержит строку ".COM".   При попытке
заражения открывает файлы и может оставить их незакрытыми.

                              "Kuku-448"
                              ──────────
        Нерезидентный  очень  опасный  вирус,  поражает  .COM-файлы  при
запуске инфицированного файла, записываясь в их начало. В зависимости от
времени (с вероятностью 1/8)  "убивает" файлы. "Убитый" файл  при старте
расшифровывает  и  в  большом  количестве  выводит на экран разноцветные
надписи "Kuku!", при этом компьютер не реагирует на клавиатуру.

                               "Lehigh"
                               ────────
        Резидентный очень опасный вирус. Достаточно примитивен, несмотря
на  знаменитость.  Записывается  в  середину  файла  COMMAND.COM при его
запуске  или  просмотре  оглавления,  содержащего  COMMAND.COM, функцией
FindFirst (4Eh).   Вирус размещается  в области  стека COMMAND.COM  и не
увеличивает его длину. Изменяет 2-й и 3-й байты файла (JMP Loc_Virus).

        В теле вируса хранится счетчик, увеличивающийся на 1 при  каждом
успешном поражении очередного  COMMAND.COM. Счетчик сохраняется  на диск
только  в  том  случае,  если  зараженный  COMMAND.COM  был  запущен   с
винчестера. Иначе состояние счетчика обнуляется при каждой  перезагрузке
DOS.  При  достижении  счетчиком  значения  4  вирус  стирает  первые 32
логических сектора диска, с которого был запущен.

                            "LoveChild-488"
                            ───────────────
        Резидентный  очень  опасный  вирус.  Заражает  .COM-файлы при их
загрузке в память,  при открытии и  создании. Длин файлов  не проверяет.
Копирует себя в  конец файла и  изменяет его первые  4 байта (  STI; JMP
Loc_Virus ). При  создании своей резидентной  копии переписывает себя  в
область  памяти,  содержащую  таблицу  векторов  прерываний,  по  адресу
0000:01E0.

        Если на компьютере установлена DOS 3.30, то вирус  предпринимает
маскирующие действия - вирус "знает" адрес обработчика прерывания 21h  и
адрес, по которому хранится исходное значение прерывания 13h.  Используя
это,  вирус  модифицирует  память,  занятую операционной системой, таким
образом, что обрабатывает вызов прерывания 21h непосредственно перед DOS
(записывает вместо первых пяти  байт обработчика прерывания 21h  команду
перехода  на  вирус  -  JMP  FAR  Loc_Virus).  С  прерыванием  13h вирус
поступает проще - восстанавливает его первоначальное значение.

        Имеет деструктивные функции:  в зависимости от  счетчика времени
может уничтожать файлы или создавать вместо файла подкаталог с таким  же
именем. Вирус периодически модифицирует EXE-файлы таким образом, что  их
запуск вызовет стирание секторов винчестера (стирается часть информации,
расположенной на секторах, соответствующих 0-3 головкам записи/чтения).

        Перехватывает int 21h. Содержит текст: "v2 (c) Flu Systems (R)",
"LoveChild in reward for software sealing".

                              "MGTU-273"
                              ──────────
        Нерезидентный  опасный  вирус.  Крайне  примитивен.  При  старте
поражает  все  .COM-файлы  текущего  оглавления,  используя  FCB из PSP.
Изменяет первые  4 байта  файла (JMP  Loc_Virus; DB  EBh -  опознаватель
зараженного  файла)  и  дописывается  в  его  конец.  Опасен, так как не
проверяет длин файлов при  их заражении. Никак не  проявляется. Содержит
текст "Эта программа написана в МГТУ студентом группы ИУ4".

                             "Minsk-1075"
                             ────────────
        Резидентный  опасный  вирус.  Прислан  из  г. Минска. Стандартно
поражает .COM и  .EXE-файлы при их  открытии. При каждом  20-м чтении из
.DBF-файла вместо  считанной информации  подставляет пробелы.   Содержит
опасную ошибку  - если  вирус создает  резидентную копию  при запуске из
.EXE-файла, то вместо естественного обращения к функциям прерывания 21h,
вызывает прерывание 15h.

                             "Mirror-482"
                             ────────────
        Файловый резидентный очень  опасный вирус. Стандартным  способом
поражает каждый третий запускаемый .COM-файл.   Меняет при этом 4  байта
заголовка (JMP Loc_Virus, DB 17h - идентификатор зараженности).

        При 1000-м вызове прерывания 21h экран "переворачивается"  (верх
<-> низ, право  <-> лево), а  в нулевой сектор  (содержащий MBR) первого
винчестера записываются  коды вируса,  при этом  первые 5  байт кодов  -
команда перехода на перезагрузку (JMP FAR F000:FFF0).

        Достаточно  странно  манипулирует  с  памятью при создании своей
TSR-копии  (не  исключено,  что  у  меня  немного "подпорченный" образец
вируса). Перехватывает прерывание 21h. Текстовых строк не содержит.

                              "MLTI-830"
                              ──────────
        Резидентный очень опасный вирус. Стандартно поражает  .COM-файлы
при их запуске. В пятницу  через некоторое время после запуска  начинает
уничтожать  файлы  вместо  их  запуска.  Содержит текст: "Hello! MLTI!",
"Eddie die somewhere in time! This  programm was written in the city  of
Prostokwashino (C) 1990 RED DIAVOLYATA".

                              "MSTU-513"
                              ──────────
        Нерезидентный  очень  опасный  вирус.  При  запуске   стандартно
поражает .COM и .EXE-файлы текущего оглавления. Может необратимо портить
файлы при  их заражении.   Содержит текст  "This program  was written in
MSTU,1990", "*.exe *.com".

                             "Mutant-1744"
                             ─────────────
        Резидентный неопасный вирус-"призрак", поражает выполняемые COM-
и EXE-файлы. Через некоторое время после активизации исполняет  мелодию.
Трассирует прерывание 21h. Использует два достаточно сложных  алгоритма.
Первый   обеспечивает   "призрачность"   вируса   (длина   расшифровщика
колеблется от 65 до 149 байт).Второй алгоритм используется при заражении
файлов:
        - в заражаемом файле определяются адреса постоянных участков
          кода (т.е. таких участков, все байты которых равны одному и
          тому же значению), причем если суммарная длина этих участков
          меньше 1744 (длины вируса), то файл не заражается;
        - постоянные участки компрессируются, их адреса, длины и
          содержимое сохраняются в вирусе;
        - в файле выбирается участок длиной 1744 байта, коды которого
          копируются в освобожденные (скомпрессированные) постоянные
          участки файла;
        - в освободившееся место записывается вирус.

В  результате   при  заражении   файла  его   длина  не   увеличивается.
Перехватывает int 1Ch и 21h, содержит текст "mutant".

                              "Nina-256"
                              ──────────
        Крайне  примитивный  резидентный   безобидный  вирус,   поражает
COM-файлы, записываясь в их начало. Содержит текст "Nina". Перехватывает 
int 21h.

                             "Pascal-7808"
                             ─────────────
        Нерезидентный  безобидный  вирус.  Поражает  .COM  и  .EXE-файлы
кроме COMMAND.COM в текущем каталоге, записывается в начало файлов.  При
запуске зараженного файла (файла-носителя вируса):

        - заражает неинфицированные файлы текущего каталога;
        - лечит файл-носитель;
        - запускает вылеченный файл-носитель;
        - и снова заражает его.

        Вирус написан на языке высокого уровня, возможно Pascal.

                               "Perfume"
                               ─────────
        Резидентный очень опасный вирус, стандартно поражает  .COM-файлы
(COMMAND.COM  поражается  при  старте  вируса).  Создает свою TSR-копию,
ничего не  изменяя в  блоках MCB,  чем может  вызвать зависание системы.
Периодически стирает  случайные секторы  на диске  A:. При  80-й попытке
заражения  уже   инфицированного  файла   начинает  какой-то   диалог  с
оператором (в моем образце вируса текст стерт). Перехватывает int 21h.

                            "Peterburg-529"
                            ───────────────
        Резидентный вирус, не опасен. Инфицирует .COM-файлы при загрузке
их в память  для выполнения, внедряется  в начало файла.  При выполнении
инфицированной  программы  остается   резидентным  в  памяти,   совершая
следующие действия:

        - изменяет размер выделенной под основную программу памяти,
          резервируя дополнительную память для своих нужд;
        - определяет имя основной программы и выполняет ее (т. е.
          происходит повторный запуск основной программы);
        - по окончании работы программы вирус остается резидентным
          (int 21h, ah=31h).

        │ ...     │     │ ...     │     │ ...     │     │ ...     │
        ├─────────┤     ├─────────┤     ├─────────┤     ├─────────┤
        │Вирус    │────>│Вирус    │     │Вирус    │     │Вирус    │
        ├─────────┤     │- - - - -│     │- - - - -│     │- - - - -│
        │Программа│     │         │     │         │     │         │
        │         │     ├─────────┤     ├─────────┤     ├─────────┤
        ├─────────┤     │ ...     │     │Вирус    │     │ ...     │
        │ ...     │                     ├─────────┤
                                        │Программа│
                                        │         │
                                        ├─────────┤
                                        │ ...     │

        Вирус никак не проявляется и не имеет деструктивной функции.

                                "Shake"
                                ───────
        Резидентный очень опасный вирус. Стандартно поражает  .COM-файлы
текущего каталога при  вызове функции GetDiskSpace  (int 21, ah=36h).  У
зараженных файлов  устанавливает   время 60   сек. Перехватывает   и  не
восстанавливает int 24h.При  старте зараженной программы с  вероятностью
1/16  сообщает "Shake well before use". Перехватывает int 21h.

                              "Socha-497"
                              ───────────
        Резидентный очень опасный вирус, стандартно поражает  .COM-файлы
при их открытии. При запуске файлов (кроме ME$.OVL и NCMAIN.EXE) к файлу
C:\M_EDIT\ME$.OVL  дописывается  командная  строка.   Размножается, если
системный таймер указывает 1981 г. Перехватывает int 21h,содержит строки:
"Socha", "C:\m_edit\me$.ovl", "comCOM".

                            "Something-658"
                            ───────────────
        Резидентный  очень   опасный  вирус,   записывается  в    начало
запускаемых COM-файлов. 11 числа ежемесячно стирает файл C:\AUTOEXEC.BAT,
записывает в него команды
                @DEL *.COM
                @DEL *.EXE,
затем создает файл SOME  нулевой длины. Перехватывает int  21h, Содержит
тексты: "Something v1.1", "some c:\autoexec.bat @del *.com @del *.exe".

                               "Sylvia"
                               ────────
        Нерезидентный  безобидный  вирус.  Записывается  в  начало .COM-
файлов при запуске зараженной  программы. Файлы ищет в  текущем каталоге
текущего диска  и диска  C:, при  этом заражает  не более  5 файлов.  Не
инфицирует  файлы  COMMAND.COM,  IBMIO.COM  и IBMDOS.COM. Если исправить
содержимое текста, содержащегося в вирусе (см.  ниже), расшифровывает  и
выводит  на  экран  "FUCK  YOU  LAMER  !!  system halted...", после чего
система действительно зависает.

        В начале вируса содержится текст:
      ┌────────────────────────────────────────────────────────┐
      │ This program is infected by a HARMLESS Text-Virus V2.1 │
      │ Send a FUNNY postcard to : Sylvia Verkade,             │
      │                            Duinzoom 36b,               │
      │                            3235 CD Rockanje            │
      │                            The Netherlands.            │
      │ You might get an ANTIVIRUS program.....                │
      └────────────────────────────────────────────────────────┘

        Пишите письма!

                               "Terror"
                               ────────
        Резидентный безвредный вирус. При закрытии или выполнении COM- и
EXE-файлов поражает их, при  вызове функции FindFirst пытается  поразить
COMMAND.COM (EXE - стандартно, у COM изменяет первые 11 байт  заголовка,
COMMAND.COM - в середину). Содержит текст "Terror". Перехватывает int 21h.

                               "The-Rat"
                               ─────────
        Резидентный безобидный вирус. Поражает EXE-файлы при их открытии
и  выполнении.  Записывается  в  заголовок  EXE-файла. При инициализации
копируется в область стека  DOS. Перехватывает int 21h,  содержит строку
"The Rat, Sofia".

                              "TraceBack"
                              ───────────
        Резидентный неопасный  вирус. Стандартно  поражает COM-,  EXE- и
OVL-файлы при  старте вируса  (обходит подкаталоги)  и из  TSR-копии при
загрузке файлов в память.  Отличается тем, что, создавая свою TSR-копию,
оставляет в памяти вместе  с собой программу-носитель. Каким-то  образом
фокусничает с  клавиатурой и  экраном. Перехватывает  int 20h,  int 21h,
int 1Ch.

                              "Tula-419"
                              ──────────
        Резидентный  очень  опасный   вирус,   записывается  в    начало
запускаемых на  выполнение COM-файлов.  В субботу  14-го числа  пытается
форматировать  диски.  Перехватывает  прерывание  21h, уменьшает  размер
памяти DOS (слово [0000:0413]), содержит текст "Tula 1990.Sat".

                                "V-405"
                                ───────
        Нерезидентный  очень  опасный  вирус.  Поражает  .COM-файлы  при
запуске инфицированного файла.  Записывается в начало файла, не сохраняя
старое содержимое его начала. Поэтому файлы, зараженные вирусом "V-405",
не восстанавливаются. Снимает атрибут read-only.

                                "V-417"
                                ───────
        Резидентный  неопасный  вирус,  стандартно  поражает запускаемые
COM-файлы. Периодически сообщает "Fuck You!". Перехватывает int 8 и 21h.

                                "V-492"
                                ───────
        Резидентный  очень  опасный  вирус.  Заражает  COM-файлы  при их
запуске на выполнение. Длин файлов не  проверяет. Копирует себя в  конец
файла и изменяет его первые 6 байт (JMP xx xx zz zz zz).

        При активизации ищет файл C:\COMMAND.COM и инфицирует его. Затем
остается резидентным в памяти.  Для этого вирус копирует себя в  таблицу
векторов прерываний по адресу 0000:0200. Периодически стирает  несколько
секторов со случайными номерами.  Изменяет int 1Сh и int 21h.   Содержит
команду  `PUSH  100h',  поэтому  не  распространяется  на  компьютерах с
процессором 8086/88.

                                "V-516"
                                ───────
        Резидентный опасный вирус. Поражает COM-файлы при их запуске  на
выполнение. Заражаются только  те файлы, первый  байт которых равен  E9h
(т.е. файл начинается с команды JMP Loc_Progr).  Вирус заменяет 4  байта
по адресу Loc_Progr  на код команды  JMP Loc_Virus и  байт-идентификатор
зараженности.  Таким  образом,  при  заражении  файла  его  заголовок не
изменяется.

             Незараженный файл          Зараженный файл
             ┌─────────────┐            ┌─────────────┐
          ┌──│JMP Loc_Progr│         ┌──│JMP Loc_Progr│
          │  │             │         │  │             │
          └─>│             │         └─>│JMP Loc_Virus│──┐ ─┐ 4 байта
             │             │            │DB  Infected │  │ ─┘
             │             │            │             │  │
             └─────────────┘            ├─────────────┤  │
                                        │ Вирус       │<─┘
                                        │             │
                                        └─────────────┘

        При  активизации  обрабатывает  DOS  2.x,  3.x,  4.0.  Уменьшает
количество дисковых  буферов на  1 и  записывает свою  копию в последний
буфер. Периодически при  опросе версии DOS  (int 21h, f.30h)  возвращает
нуль  (т.е.  версия  DOS  0.0).  Помимо  этого  никак  не   проявляется.
Перехватывает int 21h. Текстовых строк не содержит.

                                "V-696"
                                ───────
        Нерезидентный очень  опасный вирус.  При запуске  обходит дерево
подкаталогов и поражает .COM-файлы кроме COMMAND.COM. Изменяет первые 11
байт файла  (PUSH DS;  POP AX;  ADD [109],AX;  CALL Far  DWord [109])  и
дописывается в его конец.  При 64-м заражении уничтожает сначала файл, а
затем часть нулевого цилиндра винчестера.

                                "V-699"
                                ───────
        Резидентный опасный вирус. Стандартно поражает .COM-файлы  кроме
COMMAND.COM  при  их  загрузке  в  память.  Через  некоторое время после
активизации периодически  блокирует запись  на винчестер.  Перехватывает
прерывания 8, 13h, 21h.

                                "V-707"
                                ───────
        Резидентный неопасный вирус. Поражает .COM-файлы при их загрузке
в память. Изменяет  первые 5 байт  файла (MOV AX,  Start_Virus; PUSH AX;
RET near) и дописывается в его конец.

        Активизируется  только  в  DOS  3.30,  определяет (сканированием
памяти)  точки  входа  обработчиков  13-го  и  21h-го прерывания в DOS и
активно  их  использует  при  заражении  файлов.   Располагается в самых
старших  адресах  памяти,  корректируя  последний  MCB и уменьшая размер
доступной памяти (слово по адресу [0000:0413]).

        При заражении ведет подсчет уже зараженных файлов, и  как только
встречается  30-й  зараженный  файл,  устанавливает  прерывание  8h   на
подпрограмму генерации звукового сигнала. Перехватывает int 8 и int 21h.

                                "V-765"
                                ───────
        Резидентный очень опасный вирус,  стандартно поражает EXE-файлы
при их выполнении. При каждом вызове функции DOS ChDir (int 21h, ah=0Eh)
делает один псевдосбойный кластер на диске A:. Перехватывает int 21h.

                                "V-905"
                                ───────
        Резидентный неопасный вирус.  Стандартно поражает EXE-файлы  при
их запуске на выполнение. Перехватывает int 8 и int 21h. Текстовых строк 
не содержит.

        Проявляется  в  зависимости  от  своих  внутренних  счетчиков  и
текущего года, месяца, дня и  только при наличии адаптера EGA.  При этом
наблюдается достаточно интересный видеоэффект: приблизительно через   20
мин.  после  активизации  вируса  все  знаки,  отображенные  на  экране,
"перевернутся вверх ногами", т.е. 'P'->'Ь', 'U'->'П' и т.д.  (начертание
приблизительно).   Знаки остаются  на своих  местах, изменяется  лишь их
изображение.Приблизительно через 10 сек. первоначальное состояние экрана 
восстановится, еще через 10 сек. знаки опять перевернутся и т.д.


                                "V-944"
                                ───────
        Нерезидентный  опасный  вирус.  Стандартно  поражает  .COM-файлы
текущего оглавления и оглавлений, отмеченных в COMSPEC.Перехватывает int
16h (клавиатура)  и в   зависимости от  вводимых с  клавиатуры  символов
запускает по 25-й  строке экрана справа  налево и обратно  символ рожицы
(ASCII 1).  Движение рожицы  сопровождается жужжанием. Достаточно жестко
обходится с int 16h, может завесить систему. Снимает атрибут  read-only,
значение времени файла устанавливает в 62 сек.

                                "V-948"
                                ───────
        Резидентный неопасный вирус. Стандартно поражает COM и EXE-файлы
при  их  запуске  или  открытии.  У  файла  COMMAND.COM  не   происходит
увеличения длины (заражение по алгоритму "Lehigh").  Примерно раз в  час
изменяет   один   символ   на   экране.   Содержит   строку   "command".
Перехватывает прерывания 1Сh и 21h.

                               "V-1193"
                               ────────
        Резидентный неопасный вирус.  Записывается в конец  .COM-файлов,
изменяя  их  первые  14  байт  (...  PUSH  Segm_Virus;  PUSH 0; RETF). В
зависимости  от  памяти  BIOS  и  текущей  даты (23 февраля, 7 марта, 22
апреля, 30 апреля и 6 ноября) выдает "экран в полосочку" (вертикальную).
Перехватывает int 21h. Содержит тексты:

   "(C)1987 American Megatrends Inc.286-BIOS",
   "(C)1989 American Megatrends Inc",
   "(c) COPYRIGHT 1984,1987 Award Software Inc.ALL RIGHTS RESERVED".

                               "V-1216"
                               ────────
        Резидентный опасный вирус,  стандартно поражает COM- и EXE-файлы
при их  запуске или  открытии (у  COM-файлов изменяются  первые 16  байт
начала). Периодически вызывает int 9. Перехватывает int 1Ch и int 21h.

                               "V-1260"
                               ────────
        Нерезидентный  безобидный  вирус-"призрак".  Поражает .COM-файлы
по  алгоритму  вирусов  "Vienna".   Зашифрован,  при этом использует два
интересных алгоритма.   Первый алгоритм  реализует свойство  "призрака",
благодаря чему два штамма этого  вируса с большой вероятностью не  будут
совпадать ни на одном байте.Основное тело вируса шифруется в зависимости
от таймера - 1000000h=16777216  вариантов, а расшифровщик выбирается  из
более чем 3,000,000,000,000,000,000,000 вариантов (длина расшифровщика -
39 байт). Второй алгоритм достаточно успешно мешает трассировке вируса -
используется динамическое рас/зашифрование кодов вируса при помощи int 1
и int  3. Более  подробно останавливаться  на этих  алгоритмах не  буду,
поскольку опасаюсь творчества отечественных умельцев.

                               "V-1514"
                               ────────
        Резидентный очень опасный вирус. Поражает .COM- и .EXE-файлы при
их загрузке  в память.  Стандартно поражаются  .EXE-файлы, у .COM-файлов
вирус изменяет первые 32 байта (JMP Far Loc_Virus; ...) и записывается в
их конец. В  пораженных EXE-файлах возможны  два варианта точки  входа в
вирус.

        Активизируется только в  том случае, если  обработчик прерывания
содержит  слово  FC80h  (это  условие  всегда  выполняется,  если вектор
прерывания 21h указывает в DOS на системный обработчик). Изменяет первые
5 байт  обработчика (JMP  Far Loc_Virus).  Размещает резидентную  копию,
начиная с адреса 9800:0000, что может вызвать зависание компьютера.  При
этом использует прерывания 1 и 3 и блокирует работу отладчика. Начиная с
сентября при записи на диск (int 21h,ah=40h) изменяет адрес сохраняемого 
буфера.

                               "V-1876"
                               ────────
        Резидентный опасный вирус. Стандартно поражает COM- и EXE-файлы.
Активно противодействует другим вирусам:
        1. Если  на  файл,  зараженный  вирусом "V-1876", прикрепляется
           другой  вирус,  то  "V-1876"  совершает  попытку восстановить
           файл в исходном виде.  При этом на экран  выводится сообщение
           "-em".
        2. Проверяет  оперативную память  на наличие  вируса, для  этого
           создает  файл  $$.$$,  запускает  его  на выполнение, а затем
           проверяет  изменение  его  длины.  Если  длина  файла   $$.$$
           увеличилась,  то   "V-1876"  восстанавливает   первоначальное
           значение прерывания 21h и выдает сообщение "-em".

        Перехватывает int 21h.

                               "V-4096"
                               ────────
        Резидентный  "стелс"-вирус,  длина  4096  (1000h) байт. Поражает
файлы  при  запуске  или  закрытии.  Возможно  поражение  файлов данных.
Дописывает свою копию так, чтобы  размер файла увеличился ровно на  4096
байт (см. описание вируса "Eddie-2000"). У пораженных файлов увеличивает
значение времени последней модификации на 100 лет. У COM-файлов изменяет
первые 6 байт, у EXE - заголовок.

        При внедрении в  файлы пользуется истинными  значениями векторов
прерываний  13h  и   21h,  которые  получает   по  алгоритму   "Yankee".
Дополнительно к этому модифицирует первые 5 байт обработчика int 21h.

        При создании резидентной копии располагается в старших  адресах,
что приводит к  заражению файла COMMAND.COM.  Устанавливает в своем  MCB
адрес владельца (owner),  совпадающий с адресом  владельца первой MCB  в
системе,  маскируясь   под  DOS.   В  дальнейшем   копия  вируса   может
перемещаться  по  памяти  в  направлении  младших  адресов, выделяя себе
новые участки памяти и освобождая старые.

        Полноценный "стелс"-вирус:  перехватывает int  21h, обрабатывает
20  (!)  его  функций  (FindFirst,  FindNext,  Read, Write, Lseek, Open,
Create, Close, Exec  и т.д.) и  хорошо маскируется. При  обращении DOS к
зараженному файлу  вирус подставляет  его первоначальную  длину и  время
модификации.  При  чтении файла или  загрузке его в  память модифицирует
считанную  с  диска  информацию  таким  образом,  что  файл  предстает в
незараженном виде.  При открытии  файла для записи вирус лечит  его (так
как запись в  файл может уничтожить  часть вируса) и  снова заражает при
закрытии.

        Вирус  проявляется  с  22  сентября  по  31  декабря   ежегодно.
Проявления  вируса  мне  неизвестны,  поскольку  соответствующий участок
кода вируса  оказался уничтоженным.   Но можно  предположить, что  вирус
уничтожает Boot-сектор флоппи-диска и MBR-сектор винчестера, записывая в
них собственный  код.   При загрузке  с такого  диска на  экран большими
буквами (при помощи псевдографики) выдается фраза "FRODO LIVES!".

                              "VCOMM-637"
                              ───────────
        Нерезидентный опасный вирус.  При запуске инфицированного  файла
заражает не  более одного  EXE-файла в  текущем оглавлении:  выравнивает
файл на границу блока (512  байт), дописывается в его конец  и добавляет
один элемент таблицы настройки адресов в заголовке файла.  Записывает  в
видеопамять (сегментный  адрес BFFEh)  небольшую резидентную  программу,
блокирующую запись на диск.

                                "VFSI"
                                ──────
        Нерезидентный опасный вирус. Стандартно поражает .COM-файлы  при
запуске  зараженного  файла.  В  зависимости  от  текущего времени может
расшифровать и вывести  на экран фразу  "HELLO!!! HAPPY DAY  and success
from virus 1.1VFSI-Svistov".

