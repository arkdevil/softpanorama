              Небольшое описание комплекса программ
                         для печати.


      В данных версиях программ исправлены некоторые ошибки,
введено более гибкое управление печатью и поставлены исходные
тексты.



              -----------------------------------------
                P4.EXE - программа печати в 4 колонки
              -----------------------------------------


      Программа позволяет печатать на стандартном листе бумаги
размером   297*210  мм  4  страницы  текста,  расположенные  в
последовательности 4-1 на первой стороне листа и 2-3 на второй
стороне листа:

    ┌───────────────────┐           ┌───────────────────┐
    │ ┌─────┐   ┌─────┐ │           │ ┌─────┐   ┌─────┐ │
    │ │  4  │   │  1  │ │           │ │  2  │   │  3  │ │
    │ │ стр │   │ стр │ │           │ │ стр │   │ стр │ │
    │ │     │   │     │ │           │ │     │   │     │ │
    │ └─────┘   └─────┘ │           │ └─────┘   └─────┘ │
    └───────────────────┘           └───────────────────┘


        Для использования программы необходим широкий принтер.

      Программа удобна  для распечатывания больших текстов до-
кументации и исходных текстов.  При печати программа отключает
датчик конца бумаги, что позволяет допечатывать до конца лист.
Использование этой программы также  позволит  сэкономить  Ваше
время на перезарядку листов бумаги.

     Командная строка:

  P4  [опции] ИмяФайла


        Опции :

          -F"строка формата"
          -Pnn  - начальный номер страницы
          -Qn   - резервирование страницы в начале печати
          -Tnn  - замена знаков табуляции указанным количеством пробелов
          -Nnn  - количество строк на странице
          -MLnn - смещение текста вправо при печати
          -MCnn - расстояние между соседними страницами на листе
          -Cnn  - количество символов в строке
          -B    - переход к следующей странице, если встретился символ
                  разделения страниц
          -S[EC^E^CLnn]  - установка принтера



               ------------------------------------------
                 P2.EXE - программа печати в 2 колонки
               ------------------------------------------


                               ┌──────────────────┐
                               │┌───────┐┌───────┐│
                               ││       ││       ││
                               ││   1   ││   2   ││
     Программа печатает        ││       ││       ││
   на стандартном листе        ││  стр. ││  стр. ││
   бумаги 2 страницы текста.   ││       ││       ││
                               ││       ││       ││
                               ││       ││       ││
                               ││       ││       ││
                               ││       ││       ││
                               │└───────┘└───────┘│
                               └──────────────────┘

      Командная строка:

      P2 [опции] ИмяФайля

      Опции:

          -F"строка формата"
          -Pnn  - начальный номер страницы
          -Tnn  - замена знаков табуляции указанным количеством пробелов
          -Nnn  - количество строк на странице
          -MLnn - смещение текста вправо при печати
          -MCnn - расстояние между соседними страницами на листе
          -Cnn  - количество символов в строке
          -B    - переход к следующей странице, если встретился символ
                  разделения страниц
          -S[EC^E^CLnn]  - установка принтера



         ------------------------------------------------------
            P1.EXE - программа печати одной страницы на листе
         ------------------------------------------------------

      Командная строка:

      P1 [опции] ИмяФайла

      Опции:

          -F"строка формата"
          -Pnn  - начальный номер страницы
          -Tnn  - замена знаков табуляции указанным количеством пробелов
          -Nnn  - количество строк на странице
          -MLnn - смещение текста вправо при печати
          -Cnn  - количество символов в строке
          -B    - переход к следующей странице, если встретился символ
                  разделения страниц
          -S[EC^E^CLnn]  - установка принтера



                   -----------------------------------
                        Описание опций программ
                   -----------------------------------

      Опции разделяются в строке пробелами.  Им предшествует
либо дефис, либо слэш. В опциях можно использовать верхний и
нижний регистры.


-F"Строка формата"

             "Строка формата",  если она задана, определяет заголовок
       страницы, который печатается в первой строке на каждой страни-
       це. "Строка формата" состоит из последовательности любых ASCII
       символов (исключая символы '%' и '"'по техническим причинам, а
       также специальный символ $). Следующие последовательности сим-
       волов рассматриваются как специальные:
             $P   - номер текущей страницы,
             $N   - имя печатаемого файла,
             $D   - дата,
             $nnX - повторение символа X nn раз.
       После заголовка  страницы если он определен "строкой формата",
       пропускается одна чистая строка.
             Если заголовок имеет длину больше, чем количество симво-
       лов в строке, то выдается сообщение и программа прекращает ра-
       боту.

-Pnn
            Установка начального номера страницы, где nn - требуемый
       номер.


-Qn          Только P4

             При резервирования  места для титульной страницы или при
       распечатке объемной документации,  содержащейся  в  нескольких
       файлах можно продолжить печатать новый файл на последнем листе
       бумаги, если на нем  есть  место  для  одной-двух-трех  полных
       страниц. Для  этого нужно использовать опцию -Qn,  где n=1 (по
       умолчанию) - печать 4-х страниц,  n=2 - печать  трех  страниц,
       начиная со второй,  n=3,  n=4 - соответственно начало печати с
       3-ей и 4-й страницы (печатаются 2 и 1 страница на листе).  При
       закладке первого  листа  бумаги  необходимо учитывать то,  что
       первыми всегда печатаются страницы 4-1 а затем 2-3.


-Tnn
             Знаки табуляции при печати всегда заменяются на пробелы.
       Их количество устанавливается опцией -T.



-Nnn
             Установка количества строк на листе бумаги.


-MLnn               Только P2 и P4
-MCnn               Только P2 и P4
-Mnn                Только P1

             Установка расположения страниц на  листе  бумаги.  Опции
       -MLnn и  -MCnn задают соответственно количество колонок от ле-
       вого края листа бумаги до левой страницы и количество  колонок
       между правой и левой страницами. Опция -Mnn в P1 устанавливает
       расстояние от края бумаги до начала печатаемой строки.

-Cnn
             Установка количества символов в строке.


-B
             Если Вы печатаете текст, изобилующий таблицами, и не же-
        лаете  разрывать  их при печати,  либо хотите каждую следующую
        главу или раздел видеть на новой странице, то перед такой таб-
        лицей  или главой поставьте символ перевода страницы (FormFeed
        - код 12) и используйте опцию -B. Без этой опции символы пере-
        вода страницы игнорируются.


-S[EC^E^C]
            Этой опцией  устанавливаются  ширина  символов  и  размер
       межстрочного расстояния:
               E    - установка печати типа элита,
               С    - сжатая печать,
               ^E   - отмена элиты,
               ^C   - отмена сжатой печати,
               Lnn  - установка межстрочного расстояния в nn/216 дюйма.



             ------------------------------
                        Примеры
             ------------------------------


P4 /t3 FileName -f"$n$25 - $p -$25 $D" -p5 -Q2
     -печать файла FileName в 4 колонки,  устанавливая табуляцию рав-
     ной трем,  нумеруя страницы с 5-ой,  оставляя  чистым  титульный
     лист и предваряя каждую страницу следующим заголовком:  имя фай-
     ла, 25 пробелов,  номер страницы в обрамлении пары  дефисов,  25
     пробелов, текущая дата.

P2 -B -ML10 /MC14 FileName -N61 -c78 -s^e
     Печать файла в 2 колонки,  отступив слева 10 знаков,  расстояние
     между соседними  страницами  на  листе  14 знаков,  61 строка на
     листе, 78 символов в каждой строке на странице, причем разбиение
     текста на страницы происходит либо по заполнению страницы,  либо
     по FormFeed'у в тексте. Отменена элита, т.е. плотность печати 17
     символов на дюйм (condensed).

P1 -sl25c FileName -N80 /f"$60 PAGE $P"
     Печать текста в одну колонку с  межстрочным  расстоянием  25/216
     дюйма, плотность знаков 17 символов на дюйм,  80 строк на листе,
     заголовок страницы содержит в правом углу номер страницы.


             Примерные значения параметров для разных
           режимов печати для стандартного листа для P4
┌─────────────┬─────────────────────┬────────────┬────────────┐
│  Режим      │ Количество символов │ Количество │ Расстояние │
│  печати     │    на 1 дюйм        │  символов  │   между    │
│             │                     │  в строке  │ страницами │
├─────────────┼─────────────────────┼────────────┼────────────┤
│сжатая       │     17              │   76       │   26       │
│элита        │     12              │   45       │   18       │
│сжатая+элита │     20              │   90       │   30       │
└─────────────┴─────────────────────┴────────────┴────────────┘



         -------------------------------------
             Манипуляции в процессе печати
         -------------------------------------
     
     При печати игнорируются символы, управляющие принтером.
     
     При запуске программ без параметров или  с  неправильными
параметрами выдается краткая (насколько это возможно) инструк-
ция по использованию.  Также  диагностируются  ошибки  "строки
формата".
     После смены листа бумаги для продолжения печати необходи-
мо 2 раза нажать на кнопку "ON-LINE" на принтере.
     В процессе печати Вы можете ее прервать, нажав на клавишу
ESC, а  затем  после появления на экране приглашения,  либо на
клавишу Q для выхода в DOS,  либо на клавишу R для мгновенного
прекращения печати и выхода, либо на любую другую для  продол-
жения печати.
     Программы при перезарядке бумаги отслеживают смену состо-
яния принтера ON-LINE OFF-LINE, и только после этого приступа-
ют к загрузке в принтер следующей пары страниц. Но при нажатии
на кнопку "ON-LINE"  различные  принтеры  переходят  в  разные
состояния.            ВНИМАНИЕ !!! Если Вы имеете принтер типа
EPSON fx-1050,  то для нормальной работы  программ  необходимо
перекомпилировать их  текст компилятором  Turbo C++ 1.00  (ко-
мандная строка TCC p4.c), включив в нее строку
#define EPSON1050 

     Если у   Вас   возникнут   пожелания   или   вопросы   по
использованию программ,  звоните по тел.  г. Киев 266-31-03
Бабич Вадиму.
