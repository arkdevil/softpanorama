<HTML>
<HEAD><TITLE>RBckLib v1.0d Clipper Backup Library - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng2de0.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng20c.html">[^^Up^^]</A>
<A HREF="ng69ed.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>R_BckList()</B>
 Gets the contents of a backup-set into an array
───────────────────────────────────────────────────────────────────────────────

 <B>Syntax</B>
        anBckList := R_BckList ( [ cSrcDrv [, cFileName [, lEscape
                         [, lSilent [, aMsg ] ] ] ] ] )

 <B>Arguments</B>
        cSrcDrv         Source drive for backup-set : 'A:', 'B:', ....

                        Default : <B>'A:'</B>
                        ─────────────────────────────────────────────────────
        cFileName       FILE NAME of the backup file(s) (w/o extension)

                        Notes   : - Maximal string length is 8 characters.

                                  - The EXTENSION of the backup file name is
                                    a SEQUENCE NUMBER ( '.000', '.001', ...)
                                    that is generated by RBackUp().

                        Default : <B>'@RBackUp'</B>
                        ─────────────────────────────────────────────────────
        lEscape         .F.     : R_BckList() can't be interrupted
                        .T.     : R_BckList() may be interrupted by pressing
                                  the &lt;Esc&gt;-key

                        Default : <B>.F. = &lt;Esc&gt;-key DISABLED</B>
                        ─────────────────────────────────────────────────────
        lSilent         .T.     : No alert sounds
                        .F.     : Give a beep when displaying 'INSERT DISK'
                                  message

                        Default : <B>.F. = Give a beep</B>
                        ─────────────────────────────────────────────────────
        aMsg[4]         Array containing definition of the 'INSERT NEXT DISK'
                        message.
                        (The MSG_* constants are pre-defined in <B>RBckLib.ch</B>)

                        aMsg[1]         ROW for displaying the 'INSERT NEXT
                        aMsg[MSG_ROW]   DISK'-message
                                        Range   : 0 to MaxRow()
                                        Default : <B>Centered</B>

                        aMsg[2]         Screen COLUMN for displaying the
                        aMsg[MSG_COL]   'INSERT NEXT DISK'-message
                                        Range   : 0 to MaxCol()-Len(aMsg[3])
                                        Default : <B>Centered</B>

                        aMsg[3]         'INSERT NEXT DISK'-message to display
                        aMsg[MSG_TXT]   Message that will be displayed when
                                        the user has to insert the next
                                        backup disk.
                                        The DISK NUMBER is generated by
                                        R_BackUp().
                                        Insert '<B>XXX</B>' in the aMsg[3]-string
                                        on the position where the <B>DISK NUMBER</B>
                                        should be substituted.
                                        P.e. :
                                        'Please insert disk #XXX into A:'
                                        On runtime the XXX will be replaced
                                        with the current disk number.
                                        Default :
                                        If lEscape = .T.
               <B>'Insert backup disk # XXX into drive d:  &lt;─┘=Okay, Esc=Cancel'</B>
                                        If lEscape = .F.
               <B>'Insert backup disk # XXX into drive d:  Press &lt;─┘ when ready'</B>
                                        (For d:, the actual backup drive
                                        will be substituted)

                        aMsg[4]         COLOR used to display the 'INSERT
                        aMsg[MSG_CLR]   NEXT DISK'-message
                                        (Clipper color string)
                                        Default : <B>'W+*/B' = Blinking Bright</B>
                                                            <B>White on Blue</B>
                        ─────────────────────────────────────────────────────

 <B>Returns</B>
        anBckList       Array or numeric return code

                        If an error is detected anBckList contains a numeric
                        error code otherwise anBckList is an array containing
                        information on the files in the backup-set.

                        <B>anBckList</B> Subarray Structure
                        <B>───────────────────────────────────────────────────────</B>
                         Pos Symbol    Type   Description
                        <B>───────────────────────────────────────────────────────</B>
                          1  BU_FNAME  Char   Original file name
                          2  BU_FSIZE  Number Original file size
                          3  BU_FDATE  Char   Original file date
                                              The format depends on the
                                              current SET DATE format
                          4  BU_FTIME  Char   Original file time (hh:mm)
                          5  BU_ANAME  Char   Name of the backup file in
                                              which the current file starts
                        <B>───────────────────────────────────────────────────────</B>

                        Possible error codes :

                         1 = BU_INVALID_PARM   Invalid parameter(s) passed
                         2 = BU_OPEN_INPUT     Error opening  input  file
                         3 = BU_WRONG_VERSION  Wrong version of RBckLib
                         5 = BU_READ_INPUT     Error reading  input  file
                         8 = BU_USER_ABORT     Backup aborted by user
                         9 = BU_INVALID_DRIVE  Invalid backup drive/disk

                        See also the <B>ErrorCodes</B>-section in this guide.

 <B>Description</B>
        R_BckList fills an array with information on the files in a specified
        backup-set.

 <B>Example</B>
        *-- Header file of RBckLib
        #include "RBckLib.CH"

        LOCAL   anBckList := {}
        LOCAL   aBckError := BU_ERRMSG          &amp;&amp; Array with error msgs
        LOCAL   nFiles

        anBckList := <B>R_BckList</B> ( 'A:', nil, .T., .F., { 23, nil, nil, nil } )

        IF ValType ( anBckList ) = 'N'
                *-- Error detected : display error message

                Alert ( 'R_BckList error : ' + aBckError [ anBckList ] )

        ELSE
                *-- NO error detected : anBckList contains the info
                DevPos ( 3, 5 )
                *-- Header line
                DevOut ( '    Filespec                       Size ' + ;
                        'Date       Time  BackUp-file  ' )
                nFiles := 0

                *-- Display contents of the file-info array
                AEval ( anBckList, ;
                        { |x| DevPos ( Row()+1, 5 ), ;
                                DevOut ( ;
                                Str ( ++nFiles, 3 ) + ' ' + ;
                                PadR ( x [BU_FNAME], 26) + ' ' + ;
                                Str ( x [BU_FSIZE], 8 ) + ' ' + ;
                                x [BU_FDATE] + ' ' + ;
                                x [BU_FTIME] + ' ' + ;
                                PadR ( x [BU_ANAME], 12 ) + ' ' ) } )
        ENDIF

        More examples can be found in the demo program <B>RBckDemo.PRG</B>.

 <B>Caution</B>

        ┌────────────────────────────────────────────────────────────────╖
        │                         -+- CAUTION -+-                        ║
        │                                                                ║
        │     IN THE UN-REGISTERED  VERSION OF RBCKLIB THE FOLLOWING     ║
        │     REGISTRATION MESSAGE WILL BE DISPLAYED AT RANDOM TIMES     ║
        │          (WHILE EXECUTING THE R_BckList() FUNCTION) :          ║
        │                                                                ║
        │ <B>UN-Registered version of RBckLib -+- Please wait for 9 seconds</B> ║
        │                                                                ║
        │       AFTER A 9 SECONDS DELAY THE PROGRAM WILL CONTINUE.       ║
        ╘════════════════════════════════════════════════════════════════╝

 <B>о</B>
</PRE>
<HR>
<B>See Also:</B>
<A HREF="ngbb1.html">R_BackUp()</A>
<A HREF="ng2de0.html">R_Restore()</A>
<A HREF="nge7bd.html">ErrorCodes</A>
<A HREF="ngfe70.html">Registration</A>

</BODY>
</HTML>
