<HTML>
<HEAD><TITLE>RBckLib v1.0d Clipper Backup Library - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng953b.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng69ed.html">[^^Up^^]</A>
<A HREF="ngdce4.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>R_BckList()</B>
 Gets the contents of a backup-set into arrays
───────────────────────────────────────────────────────────────────────────────

 <B>Syntax</B>
        nRetCode = R_BckList ( [ cSrcDrv [, cFileName
                        [, lEscape [, lSilent
                        [, nMsgRow [, nMsgCol [, cInsMsg [, cMsgColor
                        [, lAskDisk [,
                        [, acFileSpec [, anFSize [, acFDate [, acFTime
                        [, acFileName ] ] ] ] ] ] ] ] ] ] ] ] ] ] ] )

 <B>Arguments</B>
        cSrcDrv         Source drive for backup-set : 'A:', 'B:', ....

                        Default : <B>'A:'</B>
                        ─────────────────────────────────────────────────────
        cFileName       File name of the backup file(s) (w/o extension)

                        Notes   : - Maximal string length is 8 characters.

                                  - The extension of the backup file name is
                                    a sequence number ( '.000', '.001', ...)
                                    that is generated by RBackUp().

                        Default : <B>'@RBackUp'</B>
                        ─────────────────────────────────────────────────────
        lEscape         .F.     : R_BckList() can't be interrupted
                        .T.     : R_BckList() may be interrupted by pressing
                                  the &lt;Esc&gt;-key

                        Default : <B>.F. = &lt;Esc&gt;-key DISABLED</B>
                        ─────────────────────────────────────────────────────
        lSilent         .T.     : No alert sounds
                        .F.     : Give a beep when displaying 'INSERT DISK'
                                  message

                        Default : <B>.F. = Give a beep</B>
                        ─────────────────────────────────────────────────────
        nMsgRow         Row for displaying the 'INSERT NEXT DISK' message

                        Range   : 0 to 24

                        Default : <B>CENTERED on the screen</B>
                        ─────────────────────────────────────────────────────
        nMsgCol         Column for displaying the 'INSERT NEXT DISK' message

                        Range   : 0 to ( 79 - Len ( cInsMsg ) )

                        Default : <B>CENTERED on the screen</B>
                        ─────────────────────────────────────────────────────
        cInsMsg         'INSERT NEXT DISK' message to display
                        Message that will be displayed when the user has
                        to insert the next backup disk.
                        The DISK NUMBER is generated by R_BackUp().
                        Insert '<B>XXX</B>' in the cInsMsg-string on the position
                        where the DISK NUMBER should be substituted.
                        P.e. : 'Please insert disk # XXX into drive A:'
                        On runtime the XXX will be replaced with the current
                        disk number.

                        Default :
                        If lEscape = .T.
               <B>'Insert backup disk # XXX into drive d:  &lt;─┘=Okay, Esc=Cancel'</B>
                        If lEscape = .F.
               <B>'Insert backup disk # XXX into drive d:  Press &lt;─┘ when ready'</B>
                        (For d:, the actual backup drive will be substituted)
                        ─────────────────────────────────────────────────────
        cMsgColor       Color, used to display the 'INSERT NEXT DISK' message
                        (Clipper Color String)

                        Default : <B>'W+*/B' = Blinking Bright White on Blue</B>
                        ─────────────────────────────────────────────────────
        lAskDisk        Flag that indicates if the user should be asked
                        to insert the first backup disk.

                        .T.     : Ask to insert the first BACKUP DISK
                        .F.     : Don't ask for first disk (if already
                                  inserted)

                        Default : <B>.T. = Ask for first disk</B>

                        Usage   : After you examined the number of files in a
                                  backup-set (= using the R_BckList()
                                  function without passing the arrays) the
                                  correct disk (first disk of the set) will
                                  already be available in the disk drive.
                                  In that case, this flag can be used to
                                  suppress the 'INSERT FIRST DISK' message.
                        ─────────────────────────────────────────────────────
        acFileSpec      Array to fill with the file specs of the files
                        in the backup-set.
                        ─────────────────────────────────────────────────────
        anFSize         Array to fill with the file sizes of the files
                        in the backup-set.
                        ─────────────────────────────────────────────────────
        acFDate         Array to fill with the file dates of the files
                        in the backup-set.
                        ─────────────────────────────────────────────────────
        acFTime         Array to fill with the file times of the files
                        in the backup-set.
                        ─────────────────────────────────────────────────────
        acFileName      Array to fill with the names of the backup files
                        containing the current file (p.e. '@RBackUp.003'
                        means that the current file starts on disk 3 of a
                        backup-set with the name @RBackUp).
                        ─────────────────────────────────────────────────────

 <B>Returns</B>
        nRetCode        The return code, nRetCode, depends on the use
                        of the RBckList() function :

                        1) Determine the number of files in a backup-set :
                           Don't pass the array parameters (so the number
                           of parameters should be less than 8)
                           (Note: only backup disk 001 is needed to determine
                                  the number of files in the set)

                           IF nRetCode &gt; 0
                                nRetCode contains the number of files in the
                                backup-set

                           IF nRetCode &lt; 0
                                There is an error detected ....
                                Possible values are :
                                -1 = Invalid parameter(s) passed
                                -2 = Error opening input file
                                -3 = Wrong version of RBckLib
                                -5 = Error reading input file
                                -8 = Function aborted by user
                                -9 = Invalid backup drive and/or disk

                        2) Gather the information of the files in a
                           backup-set :
                           Pass at least one array parameter (so the number
                           of parameters should be greater than 7)

                           IF nRetCode = 0
                                Arrays are filled with the requested file
                                information

                           IF nRetCode &lt; 0
                                There is an error detected ....
                                Possible values are :
                                -1 = Invalid parameter(s) passed
                                -2 = Error opening input file
                                -3 = Wrong version of RBckLib
                                -5 = Error reading input file
                                -8 = Function aborted by user
                                -9 = Invalid backup drive and/or disk

 <B>Description</B>
        R_BckList fills one or more arrays with information on the files in
        a specified backup-set.

        If less than 8 parameters are passed, the number of files in the
        specified backup-set is returned. This value must be used to
        dimension the arrays that will receive the file info.

 <B>Example</B>
        *-- Error text
        PUBLIC  aErrTxt [ 10 ]
        aErrTxt [ 1] = 'Invalid parameter(s) passed'
        aErrTxt [ 2] = 'Error OPENING input file'
        aErrTxt [ 3] = 'Wrong version of RBckLib'
        aErrTxt [ 4] = 'Error CREATING output file'
        aErrTxt [ 5] = 'Error READING input file'
        aErrTxt [ 6] = 'Error WRITING output file'
        aErrTxt [ 7] = 'No files found to backup'
        aErrTxt [ 8] = 'Function aborted by user'
        aErrTxt [ 9] = 'Invalid backup drive/disk'
        aErrTxt [10] = 'Invalid restore directory'

        PRIVATE nFiles
        PRIVATE nFile
        PRIVATE cOldCol

        @23,20 SAY 'Just a moment, examining backup-set ....'

        *-- Determine the number of files in the backup-set A:\@RBACKUP
        nFiles = R_BckList ( 'A:', '', .T., .F., 23, -1, '' )

        IF nFiles &lt; 0
                *-- Error detected : Display error message
                ? 'Error detected : ' + aErrTxt [ -(nFiles) ]
                Inkey ( 0 )

        ELSE
                *-- No error : nRetCode contains number of files in the
                *--     backup-set

                *-- Dimension arrays to hold file info
                DECLARE acFileSpec [ nFiles ]
                DECLARE anFSize    [ nFiles ]
                DECLARE acFDate    [ nFiles ]
                DECLARE acFTime    [ nFiles ]
                DECLARE acFileName [ nFiles ]

                nRetCode = R_BckList ( 'A:', '', .T., .F., 23, -1, '', '', ;
                        .F., acFileSpec, anFSize, acFDate, ;
                        acFTime, acFileName )

                IF nRetCode &lt; 0
                        *-- Error detected : Display error message
                        ? 'Error detected : ' + aErrTxt [ -(nFiles) ]
                ELSE
                        *-- No error detected : Display file info
                        @2,0 Clear

                        cOldCol = SetColor ( 'W+/RB' )

                        @3,5 SAY '    Filespec                       ' + ;
                                        'Size Date       Time  BackUp-file  '

                        SetColor ( 'W+/BG' )

                        FOR nFile = 1 to nFiles

                                @ nFile + 3, 5 SAY Str ( nFile, 3 ) + ;
                                        ' ' + ;
                                        acFileSpec [ nFile ] + ' ' + ;
                                        Str ( anFSize [ nFile ], 8 ) + ;
                                        ' ' + ;
                                        acFDate [ nFile ] + ' ' + ;
                                        acFTime [ nFile ] + ' ' + ;
                                        acFileName [ nFile ] + ' '

                        NEXT

                        *-- Wait for a key to be pressed
                        SetColor ( cOldCol )

                        @ 24, 32 SAY 'Hit any key ....'

                        InKey ( 0 )

                ENDIF

        ENDIF

        More examples can be found in the demo program <B>RBckDemS.PRG</B>.

 <B>Caution</B>

        ┌────────────────────────────────────────────────────────────────╖
        │                         -+- CAUTION -+-                        ║
        │                                                                ║
        │     IN THE UN-REGISTERED  VERSION OF RBCKLIB THE FOLLOWING     ║
        │     REGISTRATION MESSAGE WILL BE DISPLAYED AT RANDOM TIMES     ║
        │          (WHILE EXECUTING THE R_BckList() FUNCTION) :          ║
        │                                                                ║
        │ <B>UN-Registered version of RBckLib -+- Please wait for 9 seconds</B> ║
        │                                                                ║
        │       AFTER A 9 SECONDS DELAY THE PROGRAM WILL CONTINUE.       ║
        ╘════════════════════════════════════════════════════════════════╝

 <B>о</B>
</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng72b6.html">R_BackUp()</A>
<A HREF="ng953b.html">R_Restore()</A>
<A HREF="nge7bd.html">ErrorCodes</A>
<A HREF="ngfe70.html">Registration</A>

</BODY>
</HTML>
