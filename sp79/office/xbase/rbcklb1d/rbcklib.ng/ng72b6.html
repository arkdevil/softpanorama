<HTML>
<HEAD><TITLE>RBckLib v1.0d Clipper Backup Library - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng70fe.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng69ed.html">[^^Up^^]</A>
<A HREF="ng953b.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>R_BackUp()</B>
 Creates a COMPRESSED BACKUP on one or more diskettes
───────────────────────────────────────────────────────────────────────────────

 <B>Syntax</B>
        nRetCode = R_Backup ( [ cSkeleton [, cDestDrv [, cFileName
                        [, nBarLen [, nBarRow [, nBarCol [, cBarChr
                        [, cBarColor
                        [, lEscape [, lSilent [, cRBckFnc
                        [, nMsgRow [, nMsgCol [, cInsMsg [, cMsgColor
                        ] ] ] ] ] ] ] ] ] ] ] ] ] ] ] )

 <B>Using default values</B>
        Argument not passed -or-
        To force the default value for a CHARACTER argument just pass an
        EMPTY STRING ('').
        To force the default value for a NUMERIC argument just pass a
        value of -1.

 <B>Arguments</B>
        cSkeleton       STRING with file skeletons of files to backup
                                p.e. 'C:\SYSTEM\*.DBF'
                        Multiple skeletons have to be separated by a
                        semi-colon (;)
                        p.e. 'C:\SYSTEM\*.DBF;C:\DBASE\R*.NTX'

                        A skeleton may contain a DRIVE and/or a PATH and
                        the DOS WILDCARDS '*' and '?'.

                        If no drive is included the default drive will be
                        assumed; if no path is included the default path
                        will be assumed.

                        Default : <B>'*.*' (= ALL files on the current DRIVE</B>
                                  <B>         and DIRECTORY)</B>
                        ─────────────────────────────────────────────────────
        cDestDrv        Destination drive for backup : 'A:', 'B:', ....

                        Default : <B>'A:'</B>
                        ─────────────────────────────────────────────────────
        cFileName       File name of the backup file(s) (w/o extension)

                        Notes   : - Maximal string length is 8 characters.

                                  - The extension of the backup file name is
                                    a sequence number ( '.000', '.001', ...)
                                    that is generated by RBackUp().

                        Default : <B>'@RBackUp'</B>
                        ─────────────────────────────────────────────────────
        nBarLen         Length of the progression bar

                        Range   : 0 to 79

                        Default : <B>0 = NO progression bar</B>
                        ─────────────────────────────────────────────────────
        nBarRow         Screen row for the progression bar

                        Range   : 0 to 24

                        Default : <B>CENTERED on the screen</B>
                        ─────────────────────────────────────────────────────
        nBarCol         Screen column for the progression bar

                        Range   : 0 to ( 79 - nBarLen )

                        Default : <B>CENTERED on the screen</B>
                        ─────────────────────────────────────────────────────
        cBarChr         Character used for displaying progression bar

                        Default : <B>█ = Chr ( 219 )</B>
                        ─────────────────────────────────────────────────────
        cBarColor       Color of the progression bar (Clipper Color String)

                        Default : <B>'GR+/G' = Yellow on Green</B>
                        ─────────────────────────────────────────────────────
        lEscape         .F.     : R_BackUp() can't be interrupted by the user
                        .T.     : R_BackUp() may be interrupted by pressing
                                  the &lt;Esc&gt;-key

                        Default : <B>.F. = &lt;Esc&gt;-key DISABLED</B>
                        ─────────────────────────────────────────────────────
        lSilent         .T.     : No alert sounds
                        .F.     : Give a beep when displaying 'INSERT DISK'
                                  message

                        Default : <B>.F. = Give a beep</B>
                        ─────────────────────────────────────────────────────
        cRBckFnc        User-defined function that is evaluated once for each
                                file, just before it is added to the backup.

                        Notes   : - The CURRENT FILE NAME is passed to
                                    cRBckFnc (Format : d:\path\filename.ext)

                                  - cRBckFnc, when used, should return one of
                                    the following values :

                                    <B>0 (= BU_ABORT)</B>
                                        Backup process will be ABORTED.
                                        In this case, R_Backup() returns
                                        the <B>8 (= BU_USER_ABORT)</B> return code

                                    <B>1 (= BU_CONT)</B>
                                        Backup process will CONTINUE.

                        Default : <B>No cRBckFnc-function</B>
                        ─────────────────────────────────────────────────────
        nMsgRow         Row for displaying the 'INSERT NEXT DISK' message

                        Range   : 0 to 24

                        Default : <B>CENTERED on the screen</B>
                        ─────────────────────────────────────────────────────
        nMsgCol         Column for displaying the 'INSERT NEXT DISK' message

                        Range   : 0 to ( 79 - Len ( cInsMsg ) )

                        Default : <B>CENTERED on the screen</B>
                        ─────────────────────────────────────────────────────
        cInsMsg         'INSERT NEXT DISK' message to display
                        Message that will be displayed when the user has
                        to insert the next backup disk.
                        The DISK NUMBER is generated by R_BackUp().
                        Insert '<B>XXX</B>' in the cInsMsg-string on the position
                        where the DISK NUMBER should be substituted.
                        P.e. : 'Please insert disk # XXX into drive A:'
                        On runtime the XXX will be replaced with the current
                        disk number.

                        Default :
                        If lEscape = .T.
               <B>'Insert backup disk # XXX into drive d:  &lt;─┘=Okay, Esc=Cancel'</B>
                        If lEscape = .F.
               <B>'Insert backup disk # XXX into drive d:  Press &lt;─┘ when ready'</B>
                        (For d:, the actual backup drive will be substituted)
                        ─────────────────────────────────────────────────────
        cMsgColor       Color, used to display the 'INSERT NEXT DISK' message
                        (Clipper Color String)

                        Default : <B>'W+*/B' = Blinking Bright White on Blue</B>
                        ─────────────────────────────────────────────────────

 <B>Returns</B>
        nRetCode        Return code

                        Possible return codes :

                         0 = BU_OKAY           No errors detected
                         1 = BU_INVALID_PARM   Invalid parameter(s) passed
                         2 = BU_OPEN_INPUT     Error opening  input  file
                         4 = BU_CREATE_OUTPUT  Error creating output file
                         5 = BU_READ_INPUT     Error reading  input  file
                         6 = BU_WRITE_OUTPUT   Error writing  output file
                         7 = BU_NO_FILES_FOUND No files found to backup
                         8 = BU_USER_ABORT     Function aborted by user
                         9 = BU_INVALID_DRIVE  Invalid backup drive/disk

                        See also the <B>ErrorCodes</B>-section in this guide.

 <B>Description</B>
        Creates a COMPRESSED backup of the specified files.

        ┌────────────────────────────────────────────────────────────────╖
        │                        -+- <B> CAUTION </B> -+-                       ║
        │                                                                ║
        │   <B> ALL FILES IN THE ROOT DIRECTORY OF THE DESTINATION DISK </B>    ║
        │   <B>                     WILL BE DELETED !!                  </B>    ║
        │                                                                ║
        ╘════════════════════════════════════════════════════════════════╝

        Features :
        - Compression of the files that are backed up
        - (Optional) progression bar display
        - Multiple disk backup
        - User-definable messages

        Notes :
        - Make sure that the files to be backed up are closed
        - Empty files ( = files with filesize = 0) are not backed up !

 <B>Example</B>
        *-- Error text
        PUBLIC  aErrTxt [ 10 ]
        aErrTxt [ 1] = 'Invalid parameter(s) passed'
        aErrTxt [ 2] = 'Error OPENING input file'
        aErrTxt [ 3] = 'Wrong version of RBckLib'
        aErrTxt [ 4] = 'Error CREATING output file'
        aErrTxt [ 5] = 'Error READING input file'
        aErrTxt [ 6] = 'Error WRITING output file'
        aErrTxt [ 7] = 'No files found to backup'
        aErrTxt [ 8] = 'Function aborted by user'
        aErrTxt [ 9] = 'Invalid backup drive/disk'
        aErrTxt [10] = 'Invalid restore directory'

        PRIVATE nRetCode                        &amp;&amp; Return code R_BackUp()

        *------------------------------------------------------------------
        * Files to be backed up : 1) 'C:\SYSTEM1\*.DBF'
        *                         2) '*.DBF' and '*.NTX' in the current
        *                            directory on the current drive
        * Destination drive     : 'B:'
        * Backup file name      : '@RBackUp' (default)
        * Progression bar       : Length    = 30
        *                         Row       = Centered (default)
        *                         Column    = Centered (default)
        *                         Character = '#'
        *                         Color     = 'GR+/R'
        * Interruptable         : lEscape   = .T.
        * Give a beep           : lSilent   = .F.
        * User-defined function : 'ShowName'
        * Insert disk message   : Row       = 24
        *                         Column    = Centered (default)
        *                         Msg Text  = Default message
        *                         Msg Color = 'W+*/B'  (default)
        *------------------------------------------------------------------
        nRetCode = <B>R_BackUp</B> ( 'C:\SYSTEM1\*.DBF;*.DBF;*.NTX', ;
                        'B:', '', 30, -1, -1, '#', 'GR+/R', ;
                        .T., .F., 'ShowName', ;
                        24, -1, '', '' )

        IF nRetCode != 0
                *-- Oops, error while backupping ...

                *-- Display the error message text
                @24,0 SAY 'Backup error : ' + aErrTxt [ nRetCode ]
        ENDIF

        *-- Continuation of the program
        [...]

        QUIT

        *------------------------------------------------------------------
        * Display the name of the file being backed up
        *------------------------------------------------------------------
        FUNCTION  ShowName
        PARAMETER cFileName

        @14, 0 SAY 'Processing : ' + cFileName

        RETURN  1                       &amp;&amp; (=BU_CONT) Continue backup

        More examples can be found in the demo program <B>RBckDemS.PRG</B>.

 <B>Caution</B>

        ┌────────────────────────────────────────────────────────────────╖
        │                         -+- CAUTION -+-                        ║
        │                                                                ║
        │     IN THE UN-REGISTERED  VERSION OF RBCKLIB THE FOLLOWING     ║
        │     REGISTRATION MESSAGE WILL BE DISPLAYED AT RANDOM TIMES     ║
        │          (WHILE EXECUTING THE R_BackUp() FUNCTION) :           ║
        │                                                                ║
        │ <B>UN-Registered version of RBckLib -+- Please wait for 9 seconds</B> ║
        │                                                                ║
        │       AFTER A 9 SECONDS DELAY THE PROGRAM WILL CONTINUE.       ║
        ╘════════════════════════════════════════════════════════════════╝

 <B>о</B>
</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng953b.html">R_Restore()</A>
<A HREF="ngbc70.html">R_BckList()</A>
<A HREF="nge7bd.html">ErrorCodes</A>
<A HREF="ngfe70.html">Registration</A>

</BODY>
</HTML>
