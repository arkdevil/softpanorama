<HTML>
<HEAD><TITLE>RBckLib v1.0d Clipper Backup Library - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng72b6.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng69ed.html">[^^Up^^]</A>
<A HREF="ngbc70.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>R_Restore()</B>
 Restores files backed up by the R_BackUp()-function
───────────────────────────────────────────────────────────────────────────────

 <B>Syntax</B>
        nRetCode = R_Restore ( [ cSrcDrv [, cMask [, cDestSpec
                        [, cFileName
                        [, nBarLen [, nBarRow [, nBarCol [, cBarChr
                        [, cBarColor
                        [, lEscape [, lSilent [, cRBckFnc
                        [, nMsgRow [, nMsgCol [, cInsMsg [, cMsgColor
                        [, cConfirm
                        ] ] ] ] ] ] ] ] ] ] ] ] ] ] ] ] ] )

 <B>Using default values</B>
        Argument not passed -or-
        To force the default value for a CHARACTER argument just pass an
        EMPTY STRING ('').
        To force the default value for a NUMERIC argument just pass a
        value of -1.

 <B>Arguments</B>
        cSrcDrv         Source drive for restore : 'A:', 'B:', ....

                        Default : <B>'A:'</B>
                        ─────────────────────────────────────────────────────
        cMask           STRING with file masks of files to restore
                                p.e. '*.DBF'
                        Multiple masks should be separated by a semi-colon (;)
                        p.e. '*.DBF;*.NTX;*.FRM'

                        A mask may contain the DOS wildcards '*' and '?';
                        DRIVES and/or DIRECTORIES are NOT allowed ...

                        Default : <B>'*.*' (= ALL files in the backup-set)</B>
                        ─────────────────────────────────────────────────────
        cDestSpec       Destination specification (DRIVE and/or DIRECTORY)
                                p.e. 'C:\TEMPDIR'

                        Notes   : - The specification may NOT contain
                                    FILE NAMES (nor extensions)

                                  - If NO (or an EMPTY) DESTINATION
                                    SPECIFICATION is passed, the files will
                                    be restored to the drive and directory
                                    from which they were backed up (the path
                                    names are stored in the backup-set)

                                  - If no DRIVE is passed, the default drive
                                    will be assumed.

                                  - If no DIRECTORY is passed, the default
                                    directory will be assumed.

                                  - If the TARGET DIRECTORY doesn't exist
                                    it will be created !

                        Default : <B>The DRIVE and DIRECTORY from which</B>
                                  <B>the files originally were backed up</B>
                        ─────────────────────────────────────────────────────
        cFileName       File name of the backup file to be used for restore
                        (w/o extension)

                        Notes   : - Maximal string length is 8 characters.
                                  - The extension of the backup file name is
                                    a sequence number ( '.000', '.001', ...)
                                    that is generated by RBackUp().

                        Default : <B>'@RBackUp'</B>
                        ─────────────────────────────────────────────────────
        nBarLen         Length of the progression bar

                        Range   : 0 to 79

                        Default : <B>0 = NO progression bar</B>
                        ─────────────────────────────────────────────────────
        nBarRow         Screen row for the progression bar

                        Range   : 0 to 24

                        Default : <B>CENTERED on the screen</B>
                        ─────────────────────────────────────────────────────
        nBarCol         Screen column for the progression bar

                        Range   : 0 to ( 79 - nBarLen )

                        Default : <B>CENTERED on the screen</B>
                        ─────────────────────────────────────────────────────
        cBarChr         Character used for displaying progression bar

                        Default : <B>█ = Chr ( 219 )</B>
                        ─────────────────────────────────────────────────────
        cBarColor       Color of the progression bar (Clipper Color String)

                        Default : <B>'GR+/G' = Yellow on Green</B>
                        ─────────────────────────────────────────────────────
        lEscape         .F.     : R_Restore() can't be interrupted
                        .T.     : R_Restore() may be interrupted by pressing
                                  the &lt;Esc&gt;-key

                        Default : <B>.F. = &lt;Esc&gt;-key DISABLED</B>
                        ─────────────────────────────────────────────────────
        lSilent         .T.     : No alert sounds
                        .F.     : Give a beep when displaying 'INSERT DISK'
                                  message

                        Default : <B>.F. = Give a beep</B>
                        ─────────────────────────────────────────────────────
        cRBckFnc        User-defined function that is evaluated once for each
                          file, just before it is extracted from the backup-set.

                        Notes   : - The CURRENT FILE NAME is passed to
                                    cRBckFnc (Format : d:\path\filename.ext)

                                  - cRBckFnc, when used, should return one of
                                    the following values :

                                    <B>0 (= BU_ABORT)</B>
                                        Restore process will be ABORTED.
                                        In this case, R_Restore() returns
                                        the <B>8 (= BU_USER_ABORT)</B> return code

                                    <B>1 (= BU_CONT)</B>
                                        Restore process will CONTINUE.

                        Default : <B>No cRBckFnc-function</B>
                        ─────────────────────────────────────────────────────
        nMsgRow         Row for displaying the 'INSERT NEXT DISK' message

                        Range   : 0 to 24

                        Default : <B>CENTERED on the screen</B>
                        ─────────────────────────────────────────────────────
        nMsgCol         Column for displaying the 'INSERT NEXT DISK' message

                        Range   : 0 to ( 79 - Len ( cInsMsg ) )

                        Default : <B>CENTERED on the screen</B>
                        ─────────────────────────────────────────────────────
        cInsMsg         'INSERT NEXT DISK' message to display
                        Message that will be displayed when the user has
                        to insert the next backup disk.
                        The DISK NUMBER is generated by R_BackUp().
                        Insert '<B>XXX</B>' in the cInsMsg-string on the position
                        where the DISK NUMBER should be substituted.
                        P.e. : 'Please insert disk # XXX into drive A:'
                        On runtime the XXX will be replaced with the current
                        disk number.

                        Default :
                        If lEscape = .T.
               <B>'Insert backup disk # XXX into drive d:  &lt;─┘=Okay, Esc=Cancel'</B>
                        If lEscape = .F.
               <B>'Insert backup disk # XXX into drive d:  Press &lt;─┘ when ready'</B>
                        (For d:, the actual backup drive will be substituted)
                        ─────────────────────────────────────────────────────
        cMsgColor       Color, used to display the 'INSERT NEXT DISK' message
                        (Clipper Color String)

                        Default : <B>'W+*/B' = Blinking Bright White on Blue</B>
                        ─────────────────────────────────────────────────────
        cConfirm        User-defined function that is evaluated if the file
                        to be extracted already exists on the restore location
                        (cDestSpec or original drive\path)

                        Notes   : - The file name of the file that might be
                                    overwritten is passed to cConfirm.

                                  - cConfirm, when used, should return one of
                                    the following values :
                                    <B>0 (= BU_ABORT)</B>
                                          R_Restore() will be aborted.
                                          In this case, R_Restore() returns
                                          the <B>BU_USER_ABORT</B> return code

                                    <B>2 (= BU_SKIPFILE)</B>
                                          File will NOT be restored.

                                    <B>3 (= BU_OVERWRITE)</B>
                                          Existing file will be OVERWRITTEN.

                        Default : <B>No cConfirm-function</B>
                        ─────────────────────────────────────────────────────

 <B>Returns</B>
        nRetCode        Return code

                        Possible return codes :

                         0 = BU_OKAY           No errors detected
                         1 = BU_INVALID_PARM   Invalid parameter(s) passed
                         2 = BU_OPEN_INPUT     Error opening  input  file
                         3 = BU_WRONG_VERSION  Wrong version of RBckLib
                         4 = BU_CREATE_OUTPUT  Error creating output file
                         5 = BU_READ_INPUT     Error reading  input  file
                         6 = BU_WRITE_OUTPUT   Error writing  output file
                         8 = BU_USER_ABORT     Backup aborted by user
                         9 = BU_INVALID_DRIVE  Invalid backup drive/disk
                        10 = BU_INVALID_DIR    Invalid restore directory

                        See also the <B>ErrorCodes</B>-section in this guide.

 <B>Description</B>
        Restores one or more files from a backup-set, created by the
        R_BackUp()-function.

        Notes :
        - Make sure that the files to be restored are closed.

        - If you included a copy of the running .EXE file in the backup-set,
          it is not possible to restore the file to it's original location
          (the running copy is opened ...).
          The only way to extract the file is to another location.
          (Use the cDestSpec parameter)

 <B>Example</B>
        *-- Error text
        PUBLIC  aErrTxt [ 10 ]
        aErrTxt [ 1] = 'Invalid parameter(s) passed'
        aErrTxt [ 2] = 'Error OPENING input file'
        aErrTxt [ 3] = 'Wrong version of RBckLib'
        aErrTxt [ 4] = 'Error CREATING output file'
        aErrTxt [ 5] = 'Error READING input file'
        aErrTxt [ 6] = 'Error WRITING output file'
        aErrTxt [ 7] = 'No files found to backup'
        aErrTxt [ 8] = 'Function aborted by user'
        aErrTxt [ 9] = 'Invalid backup drive/disk'
        aErrTxt [10] = 'Invalid restore directory'

        PRIVATE nRetCode                        &amp;&amp; Return code R_Restore()

        *------------------------------------------------------------------
        * Source drive          : 'A:'
        * Files to restore      : '*.DBF' and '*.NTX'
        * Destination           : Extract to original location (default)
        * Backup file name      : '@RBackUp' (default)
        * Progression bar       : Length    = 50
        *                         Row       = 22
        *                         Column    = Centered (default)
        *                         Character = Chr (177) (▒)
        *                         Color     = 'GR+/B'
        * Interruptable         : Not interruptable
        * User-defined function : 'ShowName'
        * Insert disk message   : Row       = 24
        *                         Column    = Centered (default)
        *                         Msg Text  = New message
        *                         Msg Color = 'GR+/B'
        * Confirmation function : None : existing files will be overwritten
        *                         See for a detailed sample of the CONFIRM
        *                         function the demo program RBckDemS.PRG !!
        *------------------------------------------------------------------
        nRetCode = <B>R_Restore</B> ( 'A:', '*.DBF;*.NTX', '',  '', ;
                        50, 22, -1, Chr (177), 'GR+/B', ;
                        .F., 'ShowName', ;
                        24, -1, 'Insert disk XXX into drive A:','GR+/B' )

        IF nRetCode != BU_OKAY
                *-- Oops, error while restoring ...

                *-- Display the error message text
                @24,0 SAY 'Restore error : ' + aErrTxt [ nRetCode ]
        ENDIF

        *-- Continuation of the program
        [...]

        QUIT

        *------------------------------------------------------------------
        * User-defined function for DISPLAYING THE CURRENT FILENAME
        *------------------------------------------------------------------
        FUNCTION  ShowName
        PARAMETER cFileName

        @14, 0 SAY 'Processing : ' + cFileName

        RETURN  1                       &amp;&amp; (=BU_CONT) Continue restore

        More examples can be found in the demo program <B>RBckDemS.PRG</B>.

 <B>Caution</B>

        ┌────────────────────────────────────────────────────────────────╖
        │                         -+- CAUTION -+-                        ║
        │                                                                ║
        │     IN THE UN-REGISTERED  VERSION OF RBCKLIB THE FOLLOWING     ║
        │     REGISTRATION MESSAGE WILL BE DISPLAYED AT RANDOM TIMES     ║
        │          (WHILE EXECUTING THE R_Restore() FUNCTION) :          ║
        │                                                                ║
        │ <B>UN-Registered version of RBckLib -+- Please wait for 9 seconds</B> ║
        │                                                                ║
        │       AFTER A 9 SECONDS DELAY THE PROGRAM WILL CONTINUE.       ║
        ╘════════════════════════════════════════════════════════════════╝

 <B>о</B>
</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng72b6.html">R_BackUp()</A>
<A HREF="ngbc70.html">R_BckList()</A>
<A HREF="nge7bd.html">ErrorCodes</A>
<A HREF="ngfe70.html">Registration</A>

</BODY>
</HTML>
