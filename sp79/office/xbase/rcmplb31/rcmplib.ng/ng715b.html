<HTML>
<HEAD><TITLE>RCmpLib 3.1 Clipper Compression Library - Long Entry</TITLE></HEAD>
<BODY>

[&lt;&lt;Previous Entry]
<A HREF="ng5e84.html">[^^Up^^]</A>
<A HREF="ng82af.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>R_CmpFile() </B>
 Compresses one or more files into a RCmpLib archive
──────────────────────────────────────────────────────────────────────────────

 <B>Syntax</B>
        nRetCode = R_CmpFile ( cSkeleton, cRcpFile [, lMove
                        [, nBarLen [, nBarRow [, nBarCol [, cBarChr
                        [, cBarColor [, cPassWord [, lEscape [, cRCmpBlk
                        ] ] ] ] ] ] ] ] ] )

 <B>Arguments</B>
        cSkeleton       Skeleton(s) of file(s) to compress.
                        Multiple skeletons must be separated by a
                        semicolon (;) :
                        P.e. : '*.DBF;C:\DB\*.NTX'

                        The skeletons may contain a drive and/or a path and
                        the DOS wildcards * and ?.

        cRcpFile        Name of the archive file to create
                        Format  : [drive:][\path\]filename[.ext]
                        Example : C:\INVOICE\INVOICE.ZIP
                        Default extension is <B>.RCP</B>

        lMove           .F.     : Don't delete the original files
                        .T.     : Delete original files after compression
                                  (if no errors are detected ...)
                        Default : .F. = no deletion of files

        nBarLen         Length of the progression bar
                        Default : 0 = no progression bar

        nBarRow         Screen row for the progression bar
                        Default : centered on the screen

        nBarCol         Screen column for the progression bar
                        Default : centered on the screen

        cBarChr         Character used for displaying progression bar
                        Default : █ = Chr ( 219 )

        cBarColor       Color of the progression bar. This is a Clipper
                        color string.
                        Default : 'GR+/G' = Yellow on Green

        cPassword       Password for encryption of the archive file.
                        The maximum length of the password is 10 characters.
                        Default : no encryption
                        NOTE    : the password is <B>case-sensitive</B> !

        lEscape         .F.     : compression can't be interrupted by
                                  the user
                        .T.     : compression may be interrupted by pressing
                                  the &lt;Esc&gt; key
                        Default : .F. = no interruption

        cRCmpBlk        User function that is called once for each file, just
                        before it is compressed.
                        The <B>current file name</B> is passed to cRCmpBlk.

 <B>Returns</B>
        nRetCode        Return code

                        Possible return codes :

                        0   No errors detected
                        1   Invalid parameter passed
                        5   Error CREATING archive file
                        6   Error READING  input  file
                        7   Error WRITING  output file
                        8   No files found to compress
                        9   Compression aborted by user

 <B>Description</B>
        Compresses one or more files into one archive file.

        Features :
        - progression bar display
        - password encryption

        About the <B>PASSWORD</B> :
        - Remember the password .... (it's impossible to decompress the
          the archive without the correct password !)
        - Maximum length is 10 characters
        - The password is case-sensitive

        About the <B>USER FUNCTION cRCmpBlk</B> :
        The function, when used, should return one of the following values :
        0       Compression will be aborted;
                R_CmpFile() will return 9 ("Aborted by user")
        1       Compression continues

 <B>Example</B>
        PRIVATE nRetCode                        &amp;&amp; Return code R_CmpFile

        *------------------------------------------------------------------
        * Files to be compressed : *.DBF, *.DBT &amp; *.NTX (current directory)
        * Output : the archive file ARCHIVE.RCP
        * The original files will be deleted ( lMove = .T. )
        * Progression bar will be shown
        *       Length of bar = 20 - Position = 10,10 - Character = '#'
        *       Color  of bar = Bright White on Red
        * Password : TESTPW
        * Non interruptable ( lEscape = .F. )
        * User function to call for each file : ShowName ()
        *------------------------------------------------------------------
        nRetCode = <B>R_CmpFile</B> ( ;
                '*.DBF;*.DBT;*.NTX', ;
                'ARCHIVE.RCP', .T., ;
                20, 10, 10, '#', 'W+/R', ;
                'TESTPW', .F., 'ShowName' )

        IF nRetCode != 0
                *-- Oops, error while compressing ...
                DO CASE
                CASE    nRetCode = 1
                        ?'Invalid parameter(s) passed'
                CASE    nRetCode = 5
                        ?'Error creating output file'
                CASE    nRetCode = 6
                        ?'Error reading input file'
                CASE    nRetCode = 7
                        ?'Error writing output file'
                CASE    nRetCode = 8
                        ?'No files found to compress'
                CASE    nRetCode = 9
                        ?'Compression aborted by user'
                ENDCASE

                InKey ( 0 )

        ENDIF

        QUIT

        *------------------------------------------------------------------
        * Display the name of the file being compressed
        *------------------------------------------------------------------
        FUNCTION ShowName
        PARAMETERS cFileName

        *-- Display text just above the progression bar
        @9,10 SAY 'Compressing : ' + cFileName + Space (12-Len(cFileName))

        RETURN  1                       &amp;&amp; Continue compression

        More examples can be found in the demo program <B>RCmpDemS.PRG</B>.

 <B>о</B>
</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng82af.html">R_CmpList()</A>
<A HREF="ng9101.html">R_DCmpFile()</A>
<A HREF="ngadc7.html">R_IsRCmp()</A>

</BODY>
</HTML>
