<HTML>
<HEAD><TITLE>RCmpLib 3.1 Clipper Compression Library - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng715b.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng5e84.html">[^^Up^^]</A>
<A HREF="ng8c70.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>R_CmpList() </B>
 Retrieves information about files in a RCmpLib archive
──────────────────────────────────────────────────────────────────────────────

 <B>Syntax</B>
        nRetCode = R_CmpList ( cRcpFile [, cPassWord
                        [, aNames [, aOSize [, aODate [, aOTime,
                        [, aCSize [, aRatio [, aVersion ] ] ] ] ] ] ] ] )

 <B>Arguments</B>
        cRcpFile        File specification of the RCmpLib archive
                        to be examined
                        Format  : [drive:][\path\]filename[.ext]
                        Example : C:\INVOICE\INVOICE.RCP
                        Default extension is <B>.RCP</B>

        cPassWord       If the file is compressed using a password, the
                        same password should be passed to this function.
                        Note : The password is case-sensitive !

        aNames          Array to fill with the filenames in the archive

        aOSize          Array to fill with the original filesizes of the
                        the files in the archive

        aODate          Array to fill with the original filedates of the
                        the files in the archive

        aOTime          Array to fill with the original filetimes of the
                        the files in the archive

        aCSize          Array to fill with the sizes of the compressed
                        files in the archive

        aRatio          Array to fill with the compression ratios (%)

        aVersion        Array to fill with the RCmpLib version
                        used to compress file(s)

 <B>Returns</B>
        nRetCode        <B>nRetCode &gt; 0</B>
                                Number of files in the archive
                        <B>nRetCode &lt; 0</B>
                                Error detected :
                                -1  = Invalid parameter(s) passed
                                -2  = Error opening input file
                                -3  = Archive not compressed by R_CmpFile()
                                      -or-
                                      Incorrect password
                                -12 = Archive is corrupt

 <B>Description</B>
        R_CmpList() retrieves information about all the files in a RCmpLib
        archive.
        It returns a number of arrays containing information about the files.

 <B>Example</B>
        PRIVATE nFiles
        PRIVATE i

        *-- Determine the number of files in the archive TEST.RCP
        nFiles = <B>R_CmpList</B> ( 'TEST.RCP' )

        IF nFiles &gt; 0
                DECLARE aNames [ nFiles ]       &amp;&amp; File names
                DECLARE aOSize [ nFiles ]       &amp;&amp; Original file size
                DECLARE aCSize [ nFiles ]       &amp;&amp; Compressed file size
                DECLARE aRatio [ nFiles ]       &amp;&amp; Compression ratio

                *-- Fetch the information about the files into the arrays
                <B>R_CmpList</B> ( 'TEST.RCP', '', aNames, aOSize, '', '', ;
                        aCSize, '', aRatio )

                FOR i = 1 TO nFiles
                        *-- Display a list
                        ?aNames [ i ] + ' ' + Str ( aOSize [ i ], 7 ) + ;
                         ' ' + Str ( aCSize [ i ], 7 ) + ;
                         ' ' + Str ( aRatio [ i ], 8, 2 ) + ' %'
                NEXT

        ENDIF

        More examples can be found in the demo program <B>RCmpDemS.PRG</B>.

 <B>о</B>
</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng715b.html">R_CmpFile()</A>
<A HREF="ng9101.html">R_DCmpFile()</A>
<A HREF="ngb25f.html">R_LastErr()</A>

</BODY>
</HTML>
