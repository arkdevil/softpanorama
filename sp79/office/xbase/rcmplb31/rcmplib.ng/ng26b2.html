<HTML>
<HEAD><TITLE>RCmpLib 3.1 Clipper Compression Library - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng14c9.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng1f2.html">[^^Up^^]</A>
<A HREF="ng3358.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>R_CmpList() </B>
 Retrieves information about files in a RCmpLib archive
──────────────────────────────────────────────────────────────────────────────

 <B>Syntax</B>
        aCmpList := R_CmpStr ( cRcpFile [, cPassWord ] )

 <B>Arguments</B>
        cRcpFile        File specification of the RCmpLib archive
                        to be examined
                        Format  : [drive:][\path\]filename[.ext]
                        Example : C:\INVOICE\INVOICE.RCP
                        Default extension is <B>.RCP</B>

        cPassWord       If the file is compressed using a password, the
                        same password should be passed to this function.
                        Note : The password is case-sensitive !

 <B>Returns</B>
        aCmpList        Array of subarrays with information about the
                        files in the archive
                        -or-
                        <B>NIL</B> if an error is detected.

                        If <B>R_LastErr()</B> returns <B>CP_ARCHIVE_CORRUPT</B>,
                        aCmpList will contain information about the
                        files in the archive that are <B>NOT CORRUPT</B> and
                        therefore can be extracted.
                        If aCmpList is NIL, no valid files have been found ...

                        <B>aCmpList</B> Subarray Structure
                        <B>───────────────────────────────────────────────────────</B>
                         Pos Symbol     Type   Description
                        <B>───────────────────────────────────────────────────────</B>
                          1  CP_FNAME   Char   Original file name
                          2  CP_ORGSIZE Number Original file size
                          3  CP_ORGDATE Char   Original file date
                                               The format depends on the
                                               current SET DATE format
                          4  CP_ORGTIME Char   Original file time (hh:mm)
                          5  CP_CMPSIZE Number Compressed file size
                          6  CP_RATIO   Number Compression ratio (%)
                          7  CP_VERSION Char   Version of RCmpLib
                        <B>───────────────────────────────────────────────────────</B>

                        If the function returns <B>NIL</B> an error is detected.
                        The errorcode can be obtained using the
                        <B>R_LastErr()</B> function. Possible errors :

                         0 = CP_OKAY            No errors detected
                         1 = CP_INVALID_PARM    Invalid parameter passed
                         2 = CP_OPEN_INPUT      Error opening input file
                         3 = CP_NOT_RCMPLIB     File is NOT compressed
                                                using R_CmpFile() -or-
                                                Incorrect password
                         4 = CP_WRONG_VERSION   File compressed with an
                                                earlier RCmpLib version
                        12 = CP_ARCHIVE_CORRUPT The archive is corrupt

                        See also the item <B>ErrorCodes</B> in this guide.

 <B>Description</B>
        R_CmpList() retrieves information about all the files in a RCmpLib
        archive.
        It returns an array of subarrays (or NIL if an error is detected).

 <B>Example</B>
        *-- Display a list of all files in the archive TEST.RCP
        LOCAL   aCmpList := {}

        *-- Load file-info into the array aCmpList
        aCmpList  := <B>R_CmpList</B> ( 'Test.RCP' )

        IF R_LastErr() != CP_OKAY
                IF aCmpList = NIL
                        Alert ( 'Error in archive Test.RCP' )
                ELSE
                        *-- Corrupted file detected in archive Test.RCP
                        *--    Although some files are okay ...
                        Alert ( 'Corrupted file(s) detected in archive !;;' + ;
                        'The following file(s) are valid ...' )
                ENDIF
        ENDIF

        IF aCmpList != NIL
                *-- Display the retrieved information
                AEval ( aCmpList, ;
                { |x| QOut ( x [CP_FNAME] + Str ( x [CP_ORGSIZE], 8 ) + ;
                  ' ' + x [CP_ORGDATE] + ' ' + x [CP_ORGTIME] + ;
                  ' ' + Str ( x [CP_CMPSIZE], 8 ) + ;
                  ' ' + Str ( x [CP_RATIO], 8, 2 ) + '% ' + ;
                  ' (' + x [CP_VERSION] + ')' ) } )
        ENDIF

        More examples can be found in the demo program <B>RCmpDemo.PRG</B>.

 <B>о</B>
</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng14c9.html">R_CmpFile()</A>
<A HREF="ng385f.html">R_DCmpFile()</A>
<A HREF="ng59d4.html">R_LastErr()</A>
<A HREF="ngc79b.html">ErrorCodes</A>

</BODY>
</HTML>
