
        ОБЩИЙ ПРИВЕТ!

        Я рад предложить  Вам небольшую библиотеку  довольно полезных,
        на мой взгляд, функций для языка Clipper 5.0.  Может, не  дож-
        давшись чего-то подобного от Nantucket, В  их уже и сами напи-
        сали, а нет - пользуйтесь на здоровье моими!

        Если, прежде чем брать  на вооружение, Вы пожелаете  проверить
        функции в действии  на чем-нибудь готовеньком,  откомпилируйте
        прилагаемый файл ZH1DEMO.PRG.  Все инструкции по  компиляции -
        в комментариях файла.


********************************************************************************

                      СОДЕРЖАНИЕ БИБЛИОТЕКИ ZH1.LIB

********************************************************************************

                                !!! В библиотеке также содержится модуль _CALC.
                                После компиляции  и линковки программы  ZH1DEMO
                                Вы можете  удалить данный модуль из библиотеки,
                                поскольку это  чисто  демонстрационный  вариант
                                Калькулятора и вряд ли он когда-либо Вам приго-
                                дится.

               ZH1  AMultiSort                ZH13 LString
               ZH2  AReversBot                ZH14 OverCirc
               ZH3  AReversTop                ZH15 OverLong
               ZH4  Blink                     ZH16 PauseWrit
               ZH5  BoxCenter                 ZH17 PressKey
               ZH6  BoxUp                     ZH18 PutBlink
               ZH7  Da                        ZH19 RecInsert
               ZH8  FieldArray                ZH20 RLimit
               ZH9  First                     ZH21 RLower
               ZH10 Insert                    ZH22 RunLine
                    SwitchInsert              ZH23 RUpper
               ZH11 IsLetter                  ZH24 SayBox
               ZH12 IsRus                     ZH25 SayCenter

                       ZH16 ОЧЕНЬ ВАЖНОЕ ПРИМЕЧАНИЕ !!!

********************************************************************************

                            ОПИСАНИЕ ФУНКЦИЙ

********************************************************************************

ZH1 AMultiSort ( aArray, nSubArray ) => aArray

       Модуль: _ASORT
       Размер: 501
       Язык: CLIPPER


              Осуществляет сортировку подмассива с индексом nSubArray масси-
              ва aArray  и соответствующую  перестановку во  всех параллель-
              ных  данному  подмассивах.  Один  из поводов для использования
              этой функции: создание массива  для функции Achoice, где  пер-
              вый подмассив будет содержать альтернативы выбора, второй, па-
              раллельный, подмассив -  логические значения, позволяющие  или
              нет выбирать данный пункт  меню, а третий -  текстовые сообще-
              ния, выдаваемые на  экран при проходе  через данный пункт  ме-
              ню. Сортировка  такого массива  с помощью  AMultiSort, скажем,
              по подмассиву альтернатив выбора приведет к одновременному пе-
              ремещению во всех остальных  подмассивах.
              ! Помните, что  длина всех подмассивов должна быть одинаковой !

**************************************

ZH2 AReversBot (aArray, nElement) => NIL

       Модуль: _AREV_B
       Размер: 278
       Язык: CLIPPER


              Перемещает элемент массива aArray  (это может быть и вложенный
              массив) из позиции nElement в хвост массива; остальные (после-
              дующие) элементы массива смещаются вперед.

**************************************

ZH3 AReversTop (aArray, nElement) => NIL

       Модуль: _AREV_T
       Размер: 277
       Язык: CLIPPER


              Перемещает элемент массива aArray  (это может быть и вложенный
              массив) из позиции nElement в голову  массива; остальные (пос-
              ледующие) элементы массива смещаются назад.

**************************************

ZH4 Blink (cScren_Variable) => cScreen_Variable

       Модуль: _BLINK
       Размер: 105
       Язык: C

              Изменяет аттрибуты цвета экрана в переменной, в которую запи-
              сан  экран  Clipper - функцией  SaveScreen  или  Zh1-функцией
              PutBlink.  При этом, при первом обращении к функции изображе-
              ние, восстановленное из этой переменной, начинает  мерцать, а
              при повторном обращении с той же переменной - перестает.
              Данная функция входит в состав функции PutBlink, поэтому пред-
              почтительнее использовать последнюю.

**************************************

ZH5 BoxCenter (nTop, nBottom, nSpace, [cBoxPict]) => nCol

       Модуль: _BOXCNT
       Размер: 221
       Язык: CLIPPER


              Размещает окно шириной nSpace по центру экрана  от строки nTop
              до nBottom. cBoxPict - стандартная строка символов для рисова-
              ния рамки окна  (по умолчанию  рамка не рисуется).  Возвращает
              номер столбца левого края рамки.

**************************************

ZH6 BoxUp (nRowTop,nColLeft,nRowBottom,nColRight,[nTime],[cBoxPicture])=> NIL

       Модуль: _BOXUP
       Размер: 628
       Язык: CLIPPER


              Расширяющиеся окна.  Расширяются от нуля до заданных размеров.
              nTime - временной интервал между шагами (по умолчанию минималь-
              ный). cBoxPicture - строка символов для рисования и заполнения
              окна (по умолчанию - рамка не рисуется).

**************************************

ZH7 Da (nRow, nCol) => Logic

       Модуль: _DA
       Размер: 427
       Язык: CLIPPER

              На  строке nRow, начиная со столбца nCol, рисует квадрат и ме-
              ню "да - нет".Если выбрано "да", возвращает .t.,  если "нет" -
              .f..  После этого меню самоудаляется, восстанавливая изображе-
              ние на экране.
              !!! Квадрат меню начинает рисоваться на строку выше, чем указа-
              но в nRow, и заканчивает на строку ниже. Длина меню - 12 столб-
              цов.

**************************************

ZH8 FieldArray (cField, [nStart], [nStop]) => aArray

       Модуль: _FARRAY
       Размер: 336
       Язык: CLIPPER


              Создает массив из неповторяющегося содержимого заданного cField
              поля  в  открытой  рабочей  области начиная с записи nStart (по
              умолчанию 1) до записи nStop (по умолчанию - посл. запись базы).

**************************************

ZH9 First(cString) => cFirstLetter

       Модуль: _FIRST
       Размер: 56
       Язык: C

              Возвращает  первый символ строки cString.  Аналогична Clipper-
              функции LEFT(cString,1), однако удобнее, т.к. требует передачи
              только одного параметра.

**************************************

ZH10 Insert => NIL
     SwitchInsert => NIL

       Модуль: _INSERT
       Размер: 326
       Язык: CLIPPER


              Функция Insert "подвешивает" к клавише <Ins> функцию SwitchInsert
              так, что последняя вызывается  при каждом нажатии данной клавиши.
              Функция SwitchInsert переключает режим Вставка/Замещение и изменя-
              ет форму курсора с подчеркивания на нижнюю половину блока соответ-
              ственно.

**************************************


ZH11 IsLetter (cString) => Logic

       Модуль: _ISLETT
       Размер: 239
       Язык: CLIPPER

              Определяет, является ли первый символ переданной строки буквой.
              Если да, возвращает .t.

**************************************

ZH12 IsRus(cString) => Logic

       Модуль: _ISRUS
       Размер:  213
       Язык: CLIPPER

              Проверяет, является ли первый символ переданной строки буквой
              русского алфавита. Если да, возвращает .t.

**************************************

ZH13 LString ( lLogic, nType ) => cMessage

       Модуль: _LSTRING
       Размер: 169
       Язык: C

              Преобразует  логическое  выражение  (.t.-.f.) в слово "да" или
              "нет" (например, для  @ ... say). Второй параметр - тип написа-
              ния слова (0 - "да"; 1 - "Да"; 2 - "ДА").

**************************************

ZH14 OverCirc (nTop, nLeft, nBottom, nRight, [cPict]) => NIL

       Модуль: _OVERCRL
       Размер: 482
       Язык: CLIPPER

              Закрашивает экран по кругу. nTop, nLeft, nBottom, nRight - ко-
              ординаты участка, который необходимо закрасить. cPict - символ
              для заполнения фона (по умолчанию - пробел " ").

**************************************

ZH15 OverLong (nTop, nLeft, nBottom, nRight, [cPict]) => NIL

       Модуль: _OVERLNG
       Размер: 255
       Язык: CLIPPER

              Закрашивает  экран  продольными мазками. nTop, nLeft, nBottom,
              nRight - координаты участка, который необходимо закрасить.
              cPict - символ, которым заполняется экран (по умолчанию -
              пробел " ").

**************************************

ZH16 PauseWrit (nRow, nCol, [nTime], cText) => NIL

       Модуль: _PAUSEWR
       Размер: 362
       Язык: CLIPPER


              Пишет предложенную в cText фразу с задержкой после каждой бук-
              вы.  Является состоянием ожидания, т.е. позволяет использовать
              команды типа SET KEY во  время прокрутки строки.  nRow, nCol -
              точка,  с которой начинается написание фразы; nTime - длитель-
              ность задержки между буквами (можно не указывать, тогда задерж-
              ка минимальная).

**************************************

ZH17 PressKey ([cLetters], [cNumKeys], [lAnyKey], [nRow], [nCol]) => nInkeyCode

       Модуль: _PRESSK
       Размер: 818
       Язык: CLIPPER


              Функция ожидает нажатия определенных клавиш. Передают строку/
              столбец для сообщения:  "Вы ошиблись клавишей"  (по умолчанию
              вместо сообщения подается только звуковой сигнал);  nAnyKey -
              следует ли вернуть код любой нажатой клавиши (.t.) или необхо-
              димо дождаться, пока не будет нажата одна из требумых  клавиш
              (по  умолчанию значение .t.); cLetters - строка букв (буквен-
              ных клавиш),  из которых  следует выбрать  (включая и русские
              буквы);  cNumKeys -  строка  кодов небуквенных клавиш (напр.,
              ENTER -  "13", ESCAPE - "27" и т.п.). В обеих строках альтер-
              нативы  должны  перечисляться  через  запятую;  любая из этих
              строк может отсутствовать (но не обе!). nRow, nCol - координа-
              ты для сообщения "Вы ошиблись клавишей" (если они не определе-
              ны,  сообщение на  экран не выдается).  Функция возвращает код
              нажатой клавиши.
              Данная  функция является состоянием ожидания,- т.е. из нее мо-
              гут вызываться процедуры, назначенные функциональным клавишам
              через команду SET KEY.

**************************************

ZH18 PutBlink (nTop, nLeft, nBottom, nRight) => NIL

       Модуль: _PUTBLNK
       Размер: 200
       Язык: CLIPPER

              Переключает аттрибут мерцания в участке экрана с указанными
              координатами. См. функцию Blink.

**************************************

ZH19 RecInsert ([nRecno]) => NIL

       Модуль: _RECINS
       Размер: 651
       Язык: CLIPPER



              Вставляет пустую запись в позицию nRecno (по умолчанию - теку-
              щая позиция), смещая все последующие записи базы данных на по-
              зицию вниз.

**************************************

ZH20 RLimit (nPosition, nRightMargin, nInterval, [lContstantly]) => NIL

       Модуль: _RLIMIT
       Размер: 211
       Язык: CLIPPER

              Звонок, предупреждающий о приближении  курсора к  правому краю
              memo-окна на расстояние nInterval. Параметры: nPosition - теку-
              щее положение курсора  (столбец).  nRightMargin -  правый  край
              memo - окна. Возвpащает .t., если достигнут пpавый кpай.
              lConstantly: если .t.- звонок подается при каждом движении кур-
              сора в пределах зоны от nInterval до nRightMargin;  в противном
              случае сигнал подается только однажды - при достижении nItnerval. Значение по умолчанию - .f.
              Удобно использовать в пользовательских функциях MemoEdit, пере-
              давая в качестве параметра текущую позицию курсора (N столбца).

**************************************

ZH21 RLower (cString) => cString

       Модуль: _RLOWER
       Размер: 140
       Язык: C

              Обращает в нижний регистр сообщение cString, включая и русские
              буквы.

**************************************

ZH22 RunLine (aSetup) => nInkeyCode

       Модуль: _RUNLINE
       Размер: 944
       Язык: CLIPPER


              Функция предназначена для "прокрутки"  в окне длинных  строк в
              цикле.  Если  во время  выполнения пользователь нажимает любую
              клавишу,  функция  прерывается  и возвращает Inkey-код нажатой
              клавиши. При следующем обращении к функции, "прокрутка" строки
              продолжается с прерванного места. Достигнув конца строки, функ-
              ция начинает "прокручивать" строку опять сначала.
              aSetup - массив, состоящий из следующих элементов: 1-текст для
              прокрутки (должен иметь начальные и концевые пробелы); 2-номер
              строки, по которой будет "бежать" текст;  3-левый столбец;  4-
              правый  столбец;   5-задержка после  появления очередной буквы
              текста  (оптимально-0.15);   6- строка настройки цвета экрана.
              Далее  в самой функции к массиву будут добавлены еще 3 вспомо-
              гательных элемента.
              Данная  функция является состоянием ожидания,- т.е. из нее мо-
              гут вызываться процедуры, назначенные функциональным  клавишам
              через команду SET KEY.

**************************************

ZH23 RUpper (cString) => cString

       Модуль: _RUPPER
       Размер: 140
       Язык: C

              Обращает  в верхний регистр сообщение cString,  включая и рус-
              ские буквы.

**************************************

ZH24 SayBox (nRow, nLeft, nRight, cMsg) => nCol

       Модуль: _SAYBOX
       Размер: 193
       Язык: CLIPPER

              Размещает заданное сообщение (cMsg) по центру окна с границами
              nLeft и nRight на строке nRow. Возвращает номер столбца начала
              сообщения.

**************************************

ZH25 SayCenter (nRow, cMsg) => cCol

       Модуль: _SAYCNT
       Размер: 187
       Язык: CLIPPER

              Размещает заданное сообщение (cMsg) по центру заданной строки
              (nRow). Возвращает номер столбца начала сообщения.

********************************************************************************

                       ZH16 ОЧЕНЬ ВАЖНОЕ ПРИМЕЧАНИЕ !!!

********************************************************************************

        Внимание: я могу предложить  Вам и еще КОЕ-ЧТО,  но, поскольку
        жить становится все тяжелее, за небольшую дополнительную плату
        (и только на Ваших дискеттах), А ИМЕННО:

        Всего за 20 рублей - исходные коды любой из функций данной би-
                        блиотеки, записанные на  дискетту (если Вы  ее
                        пришлете) или в виде распечатки;

        Всего за  100 рублей  - вариант библиотеки для  Клиппера  вер-
                        сии Summer'87;

        Всего за 150 рублей - справочный .ng-файл с подробным структу-
                        рированным описанием  всех функций  библиотеки
                        ZH1.LIB с примерами программирования плюс  бо-
                        лее обширный  DEMO-файл,  где  Вы  сможете  не
                        только посмотреть работу  функций,  но и легко
                        погонять их в разных вариантах;

        Всего за  200 рублей  - полная  макро-поддержка программирова-
                        ния на Клиппере для редактора Multi-Edit 4.00,
                        даже более  многофункциональная, чем  подобная
                        же,  предоставляемая  авторами  редактора  для
                        других языков (Си, Паскаль, dBase и т.п.);

        Всего за 250  рублей - объектный  файл и исходные  коды набора
                        функций  CLIPPER-Калькулятора  (см.  zh1demo).
                        Возможности  калькулятора:   *   Инициирование
                        как путем  прямого вызова  из текста  програм-
                        мы, так и по нажатию определенной  программис-
                        том функциональной клавиши; * Возможность  пе-
                        редачи в  калькулятор при  вызове определенно-
                        го  значения  для  вычислительной обработки; *
                        Возможность автоматического "захвата" в  каль-
                        кулятор   содержимого    текущего    активного
                        GET'а; * Три ячейки памяти с постоянной  инди-
                        кацией их содержимого; * Суммирование и  вычи-
                        тание в памяти; * Сохранение результатов вычи-
                        слений и содержимого ячеек памяти между  вызо-
                        вами калькулятора; * Помимо стандартных  мате-
                        матических функций (*,  /, +, -)  дополнитель-
                        но: возведение в степень, вычисление  квадрат-
                        ного корня, получение абсолютного значения чи-
                        сла и  остатка от  деления, округление  значе-
                        ний;  *  Полное  управление  калькулятором из-
                        вне: (локализация, цвет, используемые функцио-
                        нальные клавиши); * А также кое-что еще;
                        !!! В демо-программе ZH1DEMO Вы можете увидеть
                        Калькулятор, нажав клавишу <F2>.  После  этого
                        можно  удалить  из библиотеки  ZH1.LIB  модуль
                        _CALC, поскольку  это  чисто  демонстрационный
                        вариант;

        Всего за 250 рублей - любой из трех имеющихся комплектов, каж-
                        дый по 9 мелодий, полностью готовых для испол-
                        ьзования  в  CLIPPER-программах  (представлены
                        в  виде  .prg-файлов).  Помимо исходных кодов,
                        в  каждый  комплект  входит готовая программа,
                        позволяющая прослушать  каждую мелодию  и выб-
                        рать из  нее наиболее  понравившийся фрагмент.
                        Приобретающим одновременно более одного  комп-
                        лекта  -  скидка  за  каждый  последующий  100
                        руб. Содержание комплектов:
                        КОМПЛЕКТ 1:*  Народные американские  мелодии *
                        1.  Shipwrecked;  2.  Hold  the  Fort;  3. Red
                        River Valley;  4. Jankee  Doodle; 5.  Fighting
                        for My  Right; 6.  Good Night,  Ladies! 7. The
                        Farmer;   8.   Everybody   Sing   Freedom;  9.
                        Flighty Beloved.
                        КОМПЛЕКТ 2:* Фрагменты классических произведе-
                        ний * 1.  БЕТХОВЕН. Фрагмент симфонии N 5;  2.
                        МОЦАРТ.  "Турецкий  марш";  3. ГАЙДН. Фрагмент
                        сонаты ми-минор; 4.  БАХ. Танцы из  "Французс-
                        кой  сюиты"  до  минор:  Куранта;  5. Жига; 6.
                        БАХ.  Прелюдия  N  1;  7.  Прелюдия  N  2;  8.
                        ШУБЕРТ  "Военный  марш";  9.  ШУБЕРТ. Экспромт
                        ми-бемоль мажор.
                        КОМПЛЕКТ 3:* Мелодии  известных песен *  1. S.
                        ADAMO.  Tombe  la  neige  (Падает  снег);   2.
                        BITLES. Hey,  Jude! 3.  G. GERSHWIN.  Oh, Lady
                        Be Good! 4. G.  DE KNIGHT. Rock Around  Clock;
                        5. El Condor Pasa;  6. F. LAI. Love  Story; 7.
                        A.  PRESLEY.  Love  Me  Tender;  8.  N.  ROTA.
                        Speak  Softly   Love  (Из   фильма   "Крестный
                        отец"); 9. B. HEBB. Sunny.

        Поторопитесь, пока жизнь не подорожала еще больше! Шлите  дис-
        кетты и квитанции о переводе. Всем, кто поступит подобным  об-
        разом,  гарантированы  своевременная  информация  о новинках и
        скидки при их приобретении.

                                С глубочайшим ко всем уважением
                                Георгий ЖЕРДЕВ

                                672005. г Чита-5,
                                        ул. Рахова, 98, кв. 49.
                                        Жердеву
                                        Георгию Владимировичу.


**************************************
**************************************