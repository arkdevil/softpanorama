<HTML>
<HEAD><TITLE>Clipper ToolsKit Reference Guide - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng167d.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng1bc.html">[^^Up^^]</A>
<A HREF="ng2748.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>IndexExp()</B>
 Used in Index/Seek command for national language alphabet order
 ─────────────────────────────────────────────────────────────────────────────────────

 <B>Syntax</B>

     IndexExp (cInStr, lDictionary)  --&gt;  cOutStr

 <B>Arguments</B>

     &lt;cInStr&gt;
          Input chatacter string

     &lt;lDictionary&gt;
          Optional logical value. Specify to use dictionary order index.
          If missed then  defaulted to fail.

 <B>Returns</B>

     IndexExp() return translated character string of the same length
     as cInStr.

 <B>Description</B>

     Many languages have letter allocated in ASCII table not in
     alphabetical order. IndexExp() used to create correct indexes for
     such languages. Additionally it solve problem of dictionary order
     indexes for any not english alphabet language. Dictionary order
     is case insensitive order.

     Alphabet order and case information stored in public array xSet:

          xSet[xALPHABET_UPPER] - string for upper case letters;
          xSet[xALPHABET_LOWER] - string for lower case letters;

     Upper/lower letter of used alphabet must be in first/second string
     at the same position in both strings. Letters order in those strings
     defines needed alphabet order.

     Each letter from cInStr translated according to following algorithm:

          3. If lDictinary then xSet[xALPHABET_UPPER] assumes as
             Translation String else Translation String is concatenation
             of xSet[xALPHABET_UPPER] and xSet[xALPHABET_LOWER].

          1. If the letter not found in Translation String then exit (the
             letter not changed).

          2. If lDictinary and latter is in lower case then it converted
             to upper case.

          4. The letter replaced by character with ASCII value equal to
             position of the letter in Translation String plus ASCII
             value of first character from Translation String.

     The values of xSet[xALPHABET_UPPER] and xSet[xALPHABET_LOWER]
     initiated in <B>InitCTK()</B> if used defined language scheme.

 <B>Examples</B>

     To create russian dictinary order index III.NTX for field
     FFF of base BBB.DBF use:

          field FFF
          InitCTK (LS_RUSSIAN, K_F8)
          use BBB
          index on IndexExp (FFF, .T.)  to III

    To perform case insensetive search for VVV value in index III with
    environ of above exemple use:

          seek  IndexExp (VVV, .T.)
</PRE>
<HR>
<B>See Also:</B>
<A HREF="ngbef7.html">Translate()</A>
<A HREF="ngaee2.html">xSet()</A>
<A HREF="ng167d.html">National languge support</A>

</BODY>
</HTML>
