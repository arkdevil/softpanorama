<HTML>
<HEAD><TITLE>Clipper ToolsKit Reference Guide - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng4855.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng1bc.html">[^^Up^^]</A>
<A HREF="ng70a3.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
 <B>MsgBox()</B>
 Dispaly message with optional selectable heighlights
 ─────────────────────────────────────────────────────────────────────────────────────

 <B>Syntax</B>

     MsgBox ([cTitle], [nColor], aLine) --&gt; nChoice

 <B>Arguments</B>

     &lt;cTitle&gt;
          optional charactor string displayed on the top of window

     &lt;nColor&gt;
          optional Color Structure Index which specifies colors of all
          MsgBox() elements. See also <U>Color System</U>.

     &lt;aLine&gt;
          list of sructures. Each sructure define one line in <U>MsgBox()</U>,
          with its highlights and highlight handles.

          <B>Line structure</B>
          ────────────────────────────────────────────────────────────────
          CTK.CH         Value     Comment
          ────────────────────────────────────────────────────────────────
          B_LINE        1          char string w\marked highlights if any
          B_HANDLE      2          first handle index, second at B_HANDLE+1
          ────────────────────────────────────────────────────────────────

          Charector string representing line in prompt box can contain
          highlights marked at begin and end by special simbols.

          <B>Highlight marks</B>
          ────────────────────────────────────────────────────────────────
          CTK.CH              Value     Comment
          ────────────────────────────────────────────────────────────────
          B_HIGHLIGHT_BEGIN   "@"       Mark begin of highlight
          B_HIGHLIGHT_END     "&amp;"       Mark end of highlight
          ────────────────────────────────────────────────────────────────

          On screen this marks are made invisible by replacing with spaces.
          You can overlap end of one highlight with begin of other in
          one position, ie highlight begin mark and highlight end mark must
          be at the same position. In such cases you can miss highlight
          end mark.


 <B>Returns</B>

     Selected highlight no. Selection done by pressing Enter. If
     ESC pressed then zero returned.

 <B>Description</B>

     MsgBox() is high level interface function wich replace
     @...SAY/@...PROMPT/MENU TO commands. It display window with some
     text and optional highlights and control its behavior by interpreting
     Hihglight Handle List (if any).

     It do following actions:

     - Display framed box at coordinates defined by aLocation with width of
       maximum string legth in aLine and height equal to dimension of
       aLine list. See also <U>Setwindow()</U>) about location algorithm.

     - If there is no highlights then MsgBox() just pause until
       user press any key.

     - If there is highlights then MsgBox() activate selection
       mechanism. See also MENU TO command.

     - on selection of some highlight, if there is correspoding to this
       highlight not empty handle then this handle evaluated. if there
       isn't correspoding handle then selected highlight oder number
       is returned.

     - on exit used screen area restored

 <B>Handles</B>

     You can associate any highlight with a code block.
     When corresponding highlight is selected the code block evaluated
     with following parameters:

          - aLine list                       (by name);
          - highlight oder number            (by name);
          - title of prompt box              (by name);
          - sceeen line of highlight         (by value);
          - sceen column of highlight begin  (by value);
          - character string of highlight    (by name);

     Returned by handle block value define MsgBox() successive actions.

     <B>MsgBox() handles exit codes</B>
     ────────────────────────────────────────────────────────────────
     CTK.CH            Value     Comment
     ────────────────────────────────────────────────────────────────
     -                  NIL      Continue normal MsgBox() execution
     HE_CONTINUE         0       Continue normal MsgBox() execution
     HE_EXIT             1       Terminate MsgBox()
     ────────────────────────────────────────────────────────────────

 <B>Examples</B>

     You have standart situation when user want to quit application but
     he forgot to save some file. So we must (if it realy application,
     not student lab) display to him warning message and let him make
     choice about successive actions.

     func   ExitSavePrompt()
         local  bSaveExit := {|| SaveAccounts(), EOJ()}

          MsgBox ('Warning', xVERIFY, {;
               {"                                                        "},;
               {"                Accounts  not  saved !                  "},;
               {"                                                        "},;
               {"   @Save and exit&amp;     @Continue&amp;      @Exit to DOS&amp;    ",;
                    bSaveExit,         {||HE_CONTINUE},     {||EOJ()}     };
               {"                                                        "};
          })

     return nil


     func SaveAccounts()
          // here savings must be done
     return nil
</PRE>
<HR>
<B>See Also:</B>
<A HREF="ng86cb.html">Window System</A>
<A HREF="ng36c5.html">Color System</A>
<A HREF="ng43fa.html">InBox()</A>
<A HREF="ng5fea.html">MsgBox()</A>
<A HREF="ng4855.html">PromptBox()</A>
<A HREF="ng70a3.html">Menu()</A>

</BODY>
</HTML>
