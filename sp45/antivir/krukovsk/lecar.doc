
     Lecar v  1.07Х58 предназначен для обнаружения и искоренения
следующих вирусов : Stone, 512 (666 Virus), Sunday, Letter 1701/
1704,   Murphy,   Attention,   417  Fuck  You,  707  Zamorochka,
Tumen-1.0,  Tumen-2.0, Tumen-1.5, Yankee Shot E1961, Tiny RC144,
RC506 Hero, Incom C648 Я.Цурин, Time Bomb C648 v.A,B,C, Kiev 90,
LenInfo,  TothLess C534,  Harkov REXXXX,  Time Bomb  C644,  BEBE
C1016, Kemerovo C257, Time Bomb C623, Joker 0.1, Si RC492, C377,
Hercen RBSE 1024, BCV, Flip, March6 RB512, Jews-2 RCES2370, Live
after  death  RC800,  Phoenix RC1704 и еще пару гавриков,  общим
числом, то, что стоит в версии после буквы "Х".

                   Краткое описание ключей Lecar v1.07

   /a      - проверять все, что плохо лежит
   /c      - лечить настигнутых негодяев
   /d      - работа в сети
   /l      - разархивировать заархивированных LZEXE
   /s=path - установить рабочий каталог(использовать совместно с /l)
   /n      - раскрученнные файлы не удалять
   /b      - применять при тяжелых случаях ADMa
   /h      - попросту, без чинов
   /?      - эта пространная информация

  Несколько более подробное описание ключей :
   /d - работа в сети - на время поиска по файлам  Lecar  ставит
21-й инт в обход кучи обработчиков, т.е. туда, где по его мнению
находится досовский обработчик, это не дает возможности, не зна-
емым СДЯВам заражать по открытию.  Но во-первых Lecar может оши-
баться (дос 5.0 иногда живет в двух сегментах), а во-вторых сру-
бание 21 -го для сети может быть критична. При этой опции инт не
рубится.
   /l - разархивировать заархивированных LZEXE - этот и подобные
архиваторы очень удобная и очень опасная штука,  т.к.  очевидно,
что в случае, если заворачивать файл с вирусом, то никакой анти-
вирус вируса не найдет. При это опции Lecar разворачивает зархи-
вированный файл и проверяет его.  Без опции выдается только пре-
дупреждение.
   /b - применять при тяжелых случаях ADMa - ADM, когда защищает
диск не дает лечить, поэтому с этой опцией Lecar переставит 13-й
инт в биосовский обработчик, соответственно ADM или прочие умни-
ки расслабятся.  Но применять эту опцию рекомендуется  только  в
случае надобности, т.к. вместе с умниками будут отдыхать и драй-
вера, а это лишнее.
   /h - попросту, без чинов - Lecar не лишен чувства юмор, прав-
да иногда плосковатого, но отлаживать так скучно - верьте слову.
С этой опцией Lecar начнет давать характеристики некоторым прог-
раммам, сообщать  при  случае  однях  рождения  авторов,  находя
Release говорить,  что не вирус конечно,  но очень, очень похож,
найдя AIDSTEST почтительно снимет шляпу и  скромно поздоровается
-"Здравствуйте, коллега"  и пр.  Поскольку параллельно с болтли-
востью в нем проснуться и  некоторые  клевые  функции,  например
поучительные советы  в ряде случаев рекомендуется эту опцию при-
     менять.


              Словарь военных слов, употребленных в Lecarе

          СДЯВ - вирус
          ВПХР - средства дезактивации СДЯВа

     В свое время был добавлен :
     RC713 -  виpус  является  неpизедентным  файловым  виpусом,
поpажающим COM файлы.  Размеp виpуса 713 байт. Стpатегия заpаже-
ния  - пpи запуске заpаженной пpогpаммы заpажается COM файл сна-
чала в коpневой диpектоpии тек.  диска,  а если таковых нет  или
все  заpажены,  то  пpоизводится  попытка  заpазить  COM  файл в
тек.диpектоpии.  Виpус снимает атpибуты.  Во вpемя своей  pаботы
виpус пеpеставляет вектоp INT 21H пpямо в DOS, чем обходит пpос-
тейшие стоpожевые сpедства. В случае, если диск защищен от запи-
си, выдается стандаpтное сообщение DOS:
  Write protect error.......
т.к. виpус не обpабатывает ошибки ввода-вывода. Кpоме того,
виpус не пpовеpяет pазмеp заpажаемого файла и поpтит те COM
чей pазмеp => 65535-713 байт, напpимеp AFD.COM
     Пpи опpеделенной дате (после 1989 года и не только) пpи
запуске заpаженной пpогpаммы после 14:00 пpоизводится пеpе-
загpузка системы путем INT 19H.

     В свое время был добавлен :
     Hercen RBSE1024 - инфицирует только загрузочноый  сектор  и
EXE-файлы. Имеет  оригинальную  стратегию действия - при запуске
зараженного файла,  вирус записывается в boot-секто винчестера и
создает файл  '.SYS,  после чего прямым поиском по Root-директо-
рии, находится  запись об этом файле и на место ' записывает E5h
(признак удаленного файла). В CONFIG.SYS на диске C: дписывается
строка "device='.sys",  но после этого длина CONFIG.SYS уменьша-
ется, так,  что этой срочки вроде как и нет. Этот финт основыва-
ется на том,  что редкий пользователь создает CONFIG.SYS, разме-
ром с кластер винчестера.  После загрузки с инфицированного вин-
честера, вирус опять находит CONFIG.SYS опять-таки прямым  поис-
ком по  Root-директории и увеличивает его длину,  восстанвливает
кавычку вместо E5h и отпускает  загрузку  дальше.  Стартую,  как
честный драйвер,   вирус   перехватывает   INT   21,   уменьшает
CONFIG.SYS и псевдоудаляет '.SYS.  А по 21-му заражает как обык-
новенный файловый вирус. Вот такой вирус пробегал. ВО!

     В версию 1.07Х55 добавлен:
     Вирус Jews-2 RCES2370,  он же FEDA(Федя), размер 2370 байт.
Живет  в  файлах COM,  EXE,  SYS и BIN.  В памяти вирус не виден
(поскольку остается резидентным толь ко  в  случае  загрузки  из
драйвера).
     Обрабатывает прерывания 21h,  8h.  Восьмое  использует  для
проигрывания  мелодии  "Подмосковные вечера" (сам не слышал,  но
говорят)     Отслеживает     функции      двадцать      первого:
3CH,5BH,3DH,3H,4BH,4H,4FH.
     В памяти инсталируется один раз,  контролируя себя по функ-
ции FEDAh, ожидая при вызове этой функции получить в ответ ADEFh
в AX и адрес предыдущего обработчика int 21h в ES:BX.
     Имеет три типа инсталятора : для COM, EXE и SYS/BIN-файлов.
В COM файлах калечит первые три байта,  заменяя их на JMP  в  хв
ост файла, где и живет. Эти байты хранит в нешифрованном виде со
смещением 7D9h от точки входа в вирус.
     В файлах  драйверов  тоже  обитает в конце файла.  Заменяет
указатель на точку входа программы стратегий  и  записывая  инс-
трукцию  JMP FAR в точку входа программы прерываний.Адрес преды-
дущей точки входа программы стратегий лежит со смещением  44h от
точки входа в вирус,  пять байт из программы прерываний лежат со
смещением 93Dh от того же места.
     Файлы (COM,  EXE,BIN, SYS) заражает находясь в резиденте по
стандартному образцу,  но только на флопах.  Размер файлов и  их
содержимое (при наличии вируса в памяти) не изменяется.
     При запуске зараженной программы при содействии CONFIG.SYS,
лежащего на диске C:,  плюхается во все файлы, загружаемые через
DEVICE.
     Для борьбы  с отладчиком и в целях уменьшения кода заменяет
адрес обработчика int 3 на int 21 и в дальнейшем к int 21  обра-
щается через int 3.

     В версию 1.07Х56 добавлен:
     Скандально известный  по американским хроникам вирус March6
RB512. Разбиратся с деструктивными свойствами данного мутанта не
было ни сил, ни желания, единственное, что можно сказать - вирус
основательно пеработан, но не в принципиальном смысле, а в смыс-
ле изменения масок, большая чать кода подверглась переработке. В
соответствии с старыми стоуновскими традициями,  хранит исходный
Boot дискетты  -  в 1/0/3 при адресации головка/цилиндр/сектор и
Partition винчестера в 0/0/7 при той-же адресации.
     Кроме того  исправлена  давнешняя ляпа с Int 2A - раньше не
смотрели там маски,  а просто - iret/не iret, отныне все по мас-
кам.
     В версию 1.07Х57 добавлен:
     Live after Death RC800 - добавлено  4  модификации  данного
вируса (похоже, что их на самом деле больше, но у нас было толь-
ко шесть).  В свое время приобрел популярность своим манипулиро-
ванием Int  2Fh  - ставит на себя 13-й инт для обмана сторожеви-
ков. Авторство данного вируса судя по  всему  не  без  основания
приписывается Dark  Avenger.  Заражает файлы многократно (видать
бага вкралась). При заражении вставляет на себя JMP первыми тре-
мя байтами и на место концовки программы записывает кусок своего
инсталлятора (естественно,  что  исходные  байты  запоминаются).
Имеет довольно оригинальную стратегию перехвата  - перехватывает
INT 2A - сетевое прерывание, которое ДОС вызывает в процессе об-
работки INT 21,  при этом в стеке находится функция,  с  которой
был вызван ДОС и параметры.

     В версию 1.07Х58 добавлен:
     Phoenix RC1704 - старший брат предидущего вируса,  все опи-
санное прежде относится и к этому вируса,  основная  особенность
(что и видно в названии) - специфическая любовь к Phoenix BIOS -
автор вируса явно не раз дизассемблировал этот BIOS, поэтому ви-
рус долго  ищет маски BIOSа,  после чего выставляет INT 13 в из-
вестный ему обработчик.


     При обнаружении любых ошибок (не грамматических)  в  описа-
нии, просьба немедленно сообщить,  т.к. это может повлечь некор-
ректную работу Лекаря. Координаты указаны в Лекаре - Lecar /?

     Имеем надобность в следующих исходниках :
     - фагер на DIRa
     - разворотчики всех архиваторов типа PkLite, LzEXE, Dieta
     - шнырятель по цепочке драйверов
     - процедура на _корректное_ лечение неизвестных нам СДЯВов

                          Logo Picture
      ┌──────────────────────────────────────────────────────┐
      │Lecar Lecar Le ┌─┐ ecar Lecar Lecar Lecar Lecar Lecar │
      │ Lecar ┌─┐ r  ┌┘│└┐ ecar Lecar Lecar Lecar ┌─┐ r Lecar│
      │r Lec ┌┘│└┐  ┌┘\│/└┐ ecar Lec ┌─┐ car Le ┌─┘│└─┐  Leca│
      │ar L ┌┘\│/└┐┌┘\\│//└┐ ecar L ┌┘│└┐ car  ┌┘\\│//└┐  Lec│
      │car ┌┘\\│//└┐\\\│///└┐ ecar ┌┘\│/└┐ ca ┌┘\\\│///└┐  Le│
      │ec ┌┘\\\│///└┐\\│///┌┘ Lec ┌┘\\│//└┐ c └┐\\\│///┌┘ r L│
      │Le └┐\\\│///┌┘\\│//┌┘ r L ┌┘\\\│///└┐ c └───╥───┘ car │
      │ Le └┐\\│//┌┘└──╥──┘ car ┌┘\\\\│////└┐ car  ║ ar Lecar│
      │r Le └──╥──┘  L ║ r Lec ┌┘\\\\\│/////└┐ car Lecar Leca│
      │ar Leca ║ acar  ║ ar Le │\\\\\\│//////│ ecar Lecar Lec│
      │car Lec ║ Lecar ║ car L └┐\\\\\│/////┌┘ Lecar Lecar Le│
      │ecar Le ║  Lecar Lecar L └┐\\\\│////┌┘  ┌┬@┬@┬@┬┐ ar L│
      │Lecar Lecar Lecar Lecar L └────╥────┘ c ││▓│▓│▓│╞═╗ r │
      │ Lecar Lecar Lecar Lecar Lecar ║ car Le ││Э│▒│Ь││ ║ ar│
      │r Lecar Lecar Lecar Lecar Leca ║ ecar L ││▒│Л│▒│╞═╝ ca│
      │ar Lecar Lecar Lecar Lecar Lec ║ Lecar  └┴─┴─┴─┴┘  Lec│
      │car Lecar Lecar Lecar Lecar Lecar Lecar Lecvar Lecar L│
      └──────────────────────────────────────────────────────┘

     Кстати, четь не забыли,  Lecar любит пиво,  так,  что перед
употреблением,   просьба   покапать   на  его  место  дислокации
чуть-чуть пива - но не спаивать - Lecar  еще несовершеннолетний.
