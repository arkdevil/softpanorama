Система поддержки плотного формата файлов примечаний
        для разработки СУБД в среде CLIPPER
          версий Summer'87 и 5.0 (5.01)

                    V A L E T

    для компьютеров типа IBM PC ( XT, AT, PS/2 )
 под управлением MS DOS ( PC DOS ) версии 3.0 и выше

-----------------------------------------------------------------
     Один из недостатков СУБД типа DBASE3+ - крайне неудобный
формат файлов примечаний. В системах FOXPRO и DBASE4 уже
введен усовершенствованный, плотный формат. Популярная
система CLIPPER до сих пор нового формата не имеет.
     Нами разработана и успешно применяется система VALET,
поддерживающая плотный формат для всех последних версий
CLIPPER. В предыдущих выпусках Софтпанорамы был анонс
одной из первых версий VALET.
     Здесь Вашему вниманию предлагается некоторый материал
из пакета VALET коммерческой версии:
     - фрагменты из главы 'Общие сведения' руководства
       пользователя,
     - пример использования библиотеки функций,
     - конвертор баз данных в плотный формат и обратно.
-----------------------------------------------------------------

СПИСОК ФАЙЛОВ : VALET.TXT    7521   текст, который Вы читаете
                VLCONV.EXE  93866   конвертор баз данных
                VLCONV.DOC   3197   документация к конвертору

АВТОР :      Маслов Владислав Васильевич

АДРЕС :      141400, Химки-9 Московской обл., ул. Московская,
          д. 21, ВНПОлеспром, лаб. патентования, Маслову В.В.
ТЕЛЕФОН :    572-70-03, доб. 7-02  ( с 9.00 до 18.00 )
             или 571-82-54  ( с 21.00 до 23.00 ).

-----------------------------------------------------------------

               │ ОБЩИЕ СВЕДЕНИЯ О СИСТЕМЕ VALET
               │
               │
Назначение     │      Система VALET предназначена для поддержки
системы VALET  │ плотного формата memo-файлов в СУБД,
               │ разрабатываемых в среде CLIPPER.
               │
               │      Плотный формат .VLT полностью заменяет
               │ стандартный формат .DBT и отличается следующими
               │ достоинствами и особенностями:
               │
Достоинства    │      Значительное уменьшение размера memo-
и особенности  │ файлов, которые состоят только из полезной
               │ информации - содержимого memo- полей и служеб-
               │ ных данных длиной 8 байт (на файл).
               │      Возможность индексирования и поиска по
               │ memo- полям плотного формата.
               │      Более медленный рост размера файла .VLT при
               │ коррекции, т.к.  в отличие от стандарта .DBT в
               │ плотном формате .VLT при коррекции поля в
               │ случае, если новая длина поля не превышает
               │ прежней, содержимое поля записывается в файл на
               │ прежнее место.
               │      Наличие конвертора файлов из формата .DBT в
               │ файлы формата .VLT, что позволяет быстро перейти
               │ к применению системы VALET с сохранением всех
               │ подготовленных ранее данных.
               │      Возможность работы со стандартом .DBT
               │ полностью сохранена, так что можно использовать
               │ оба вида memo-файлов одновременно.
               │      Скоростные характеристики работы с .VLT
               │ в среднем те же, что и с .DBT.
               │
Состав системы │      Система VALET состоит из библиотеки функций
VALET          │ VALET, оформленной в объектный модуль VALET.OBJ,
               │ и двух утилит - VLCONV и DBUV.
               │
Версии системы │      Система VALET поставляется в двух вариантах
VALET          │ ( версиях ) в зависимости от версии компилятора
               │ CLIPPER .
               │      Поддерживаются две самые распространенные
               │ версии компилятора CLIPPER - Summer'87 и 5.0 (5.01).
               │
Библиотека     │      Библиотека функций VALET состоит из 12
функций VALET  │ функций:
               │
               │ VLOPEN()   -  открытие файла .VLT в текущей области.
               │               Всего может быть открыто до 15 таких
               │               файлов, по одному в каждой области.
               │ VLCLOSE()  -  закрытие файла .VLT.
               │ VLWRITE()  -  запись в файл поля переменной длины.
               │ VLREAD()   -  чтение из файла поля переменной длины.
               │ VLPACK()   -  упаковка файла .VLT.
               │ VLCOPY()   -  копирование файла .VLT.
               │ VLAPPEND() -  добавление в текущий файл .VLT
               │               memo- полей из другого файла .VLT.
               │ VLZAP()    -  очистка файла .VLT.
               │ VLSEARCH() -  поиск контекста в мемо- полях .VLT.
               │ VLCOUNT()  -  количество (непустых) полей
               │               в файле .VLT.
               │ VLDENS()   -  плотность (отношение объема полезной
               │               информации к общему объему в %)
               │               файла .VLT.
               │ VLFLEN()   -  общий объем полей (длина файла - 8)
               │               в файле .VLT.
               │
Утилиты        │ Система VALET содержит две сервисные программы
               │ для создания и обработки баз данных с примене-
               │ нием формата .VLT без программирования.
               │
               │ VLCONV.EXE - конвертирование пары файлов имя.DBF
               │             и имя.DBT в пару файлов имя.DBF и
               │             имя.VLT или обратная операция,
               │             либо проверка эффективности перевода
               │             базы в плотный формат;
               │
               │ DBUV.EXE   - модификация стандартной утилиты
               │             DBU.EXE. Кроме обычных операций
               │             с файлами, позволяет создавать,
               │             редактировать, копировать, упаковы-
               │             вать и пополнять файлы формата .VLT .
               │             Улучшен режим изменения структуры базы
               │             данных. Имена полей теперь могут изме-
               │             няться без каких-либо проблем. Типы
               │             полей C, N, D, L могут преобразовываться
               │             друг в друга с соблюдением их форматов.

-----------------------------------------------------------------

Пример         │ * Открытие базы
               │ USE BASK
               │ VLOPEN()
               │ * Задание параметров поиска
               │ NAFIL='VLTWORK'
               │ STROKA='фирма'
               │ LEST=LEN(STROKA)+10
               │ GO TOP
               │ * Повторение поиска до конца базы
               │ DO WHILE .NOT.(EOF())
               │ * Поиск следующей записи
               │   NOD=VLSEARCH(NAFIL,STROKA)
               │   IF VLTER=0
               │     IF .NOT.(EOF())
               │ * Вывод номера найденной записи и подстроки,
               │ * включающей искомую
               │       ? RECNO(),SUBSTR(VLREAD(NAFIL),NOD,LEST)
               │       SKIP
               │     ELSE
               │       EXIT
               │     ENDIF
               │   ELSE
               │     ? 'ОШИБКА ПОИСКА', VLTER
               │     EXIT
               │   ENDIF
               │ ENDDO
               │ ? 'КОНЕЦ'
               │ * Закрытие базы
               │ VLCLOSE()
               │ USE
