▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒"We make software softly"▒▒▒▒
▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒  ▒▒▒▒▒  ▒▒▒▒▒▒▒▒▒▒▒▒▒▒  ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒    ▒▒▒        ▒▒▒▒▒▒TM▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒  ░▒▒▒▒  ░▒▒▒▒▒▒▒▒▒▒▒▒▒  ░▒▒▒▒▒▒▒▒▒▒▒▒  ░░  ░▒▒  ░░░░░  ░▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒  ░▒▒▒▒  ░▒▒▒▒▒▒▒▒▒▒▒▒▒  ░▒▒▒▒▒▒▒▒▒▒  ░▒▒▒  ░▒▒  ░▒▒▒▒▒  ░▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒  ░▒▒▒▒  ░▒▒▒▒▒▒▒▒▒▒▒▒▒  ░▒▒▒▒▒▒▒▒▒  ░▒▒▒▒  ░▒▒  ░▒▒▒▒  ░▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒  ░▒▒▒▒  ░▒▒▒▒      ▒▒▒  ░▒▒▒▒▒▒▒▒▒  ░▒▒▒▒  ░▒▒         ▒▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒  ░▒▒▒▒  ░▒▒▒▒▒░░░░░░▒▒  ░▒▒▒▒▒▒▒▒▒  ░▒▒▒▒  ░▒▒  ░▒▒▒▒▒  ▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒▒  ░▒▒  ░▒▒▒▒▒▒▒▒▒▒▒▒▒▒  ░▒▒▒▒▒▒▒▒▒  ░▒▒▒▒  ░▒▒  ░▒▒▒▒▒▒  ▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒▒▒  ░  ░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒  ░▒▒▒▒▒▒▒▒▒         ░▒▒  ░▒▒▒▒▒  ░▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒▒▒▒   ░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒          ▒▒  ░▒▒▒▒  ░▒▒         ░▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒▒▒▒▒░░░▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░░░░░░░░░▒▒░░▒▒▒▒▒░░▒▒▒░░░░░░░░░▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ ( V - Lab Creative Group ) ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒
▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒
╔═════════════════════╦═════════════════╦══════════════════════╦══════════════╗
║ Name : OOPAPER .COM ║ Size :   1503 d ║ Memory Size : 01B0 h ║ CRC :  1BF1 h║
╚═════════════════════╩═════════════════╩══════════════════════╩══════════════╝
                                      
                                      Моему безвременно погибшему
                                      HYUNDAI - HDP 920 посвящается ...
                                      
 ───────────────────────────────────────────────────────────────────────────
        V-Lab Out Of Paper Emulator v.1.0
        
 ПРИМЕНЕНИЕ: Программная эмуляция конца бумаги для принтеров, у которых
             этот датчик установлен слишком далеко или его вообще нет.
 АНАЛОГИ:    Прямых аналогов авторам не известно.             
 ───────────────────────────────────────────────────────────────────────────

     
          Было время  - был у нас Хьюндай. И все было бы хорошо в
нем, если  бы он не был построен в расчете на бумажную перфориро-
ванную ленту.А так как в СНГ это достаточно большой дефицит, при-
ходилось печатать  на отдельных листах бумаги, какую сможешь дос-
тать.
     
          Так вот.  Буржуины поставили датчик конца бумаги санти-
метров за 20 от его физического конца (для перфоленты это решение
правильное!),такая же  картина наблюдается  и на принтерах других
западных моделей.
     
     Однако в  моих условиях возникали проблемы в 2 случаях -,во-
первых, при печати репортов в FoxPro, в котором невозможно преры-
вание печати по необходимому числу строк и, во-вторых, при печати
спулером печати.
     
     Оставлять по  20 сантиметров  недопечатанного листа не хоте-
лось, а  стоять цербером  у кнопки On Line, которая может прервет
печать, а может и нет,было бы по крайней мере странно.
     
          При этих  обстоятельствах контакты датчика конца бумаги
были вырваны  вместе с  микриком, а программа Out Of Paper появи-
лась на свет.
     
          Принцип работы  программы прост : она перехватывает 17h
прерывание и остается резидентом. При выводе на печать символа FF
(конец листа,12h) или заданного количества строк, программа имми-
тирует состояние конца бумаги принтера (опять же через int 17h).
     
          После перевода принтера в Off Line программа прекращает
эмуляцию состояния  Off Line и после перевода принтера снова в On
Line печать продолжается.
     
          Таким образом  программу необходимо запускать перед за-
пуском спулера, а при снятии из резидента спулер снимать первым.
     
          Те программы, которые печатают или получают байт стату-
са принтера  в обход  int 17h,  игнорируют и  Out Of Paper. Таких
программ немного  и  большинство  программ,  особенно  разработки
крупных западных фирм, прекрасно работают с Out Of Paper.
          
          К сожалению,  нам не  довелось долго  пользоваться этой
программой,поскольку не прошло и 2 недель после ее написания, как
Хьюндай задымился  и приказал долго жить. Пришлось махнуть его на
Epson - 1050, у которого проблемы с датчиком конца бумаги нет.
          
          Однако  эта   программа  продолжает  использоваться  на
других "неправильных" принтерах, и возможно кому-нибудь покажется
полезной.
          
              Параметры запуска программы:
     
      /N[nnn|-]  число строк на листе бумаги, nnn = 10-128, "-"  
                - игнорировать количество выведенных строк       
                 (полезно при печати графики).
                 По умолчанию /N-
      /[+|-]      "+" - включить, "-" выключить реакцию на символ
                 FF (12h)
                 По умолчанию /+
      /S         Оставить программу резидентной
      /R         Удалить программу из памяти ( если вектор 17h                    прерывания  был перехвачен другой программой, то
                 программа сообщает об этом)
      /?         Справка о использовании программы.
     
          При запуске  программы с параметрами, изменяющими уста-
новки запущенной  ранее и оставшейся в резиденте программы, число
выведенных строк и признак FF сбрасывается.
     
          Представляя исходный  текст программы, авторы надеются,
чтоон достаточно откомментирован, и заинтересованные программисты
смогут при  необходимости внести  в него  изменения  при  исполь-
зовании нестандартного хардвера.   
          Исходный код компилировался с помощью TurboEditAsm фир-
мы SpeedWare v.1.02C.    
     

 ───────────────────────────────────────────────────────────────────────────
                         СТАHДАPТHОЕ ОКОHЧАHИЕ:

   Автоpы не несут  ответственности  за  возможный  ущеpб,  пpичиненный  в
   pезультате неостоpожного обpащения с пpогpаммой.

   Авторам хотелось бы, чтобы при дальнейших усовершенствованиях этой прог-
   раммы ссылка на V-Lab присуствовала в заставке программы.

   Автоpы будут  pады  любому  констpуктивному  замечанию или пpедложению,
   касающихся данной пpогpаммы, а так же замеченным в ней ошибкам.
   По вопросам использования программы обращаться к Ивченко Алексею
   Вадимовичу.
   
 ════════════════════════════════ V-LAB ══════════════════════════════
   Свинолобов Сеpгей Hиколаевич             Ивченко Алексей Вадимович
            Укpаина                                 Укpаина
      г. Днепpопетpовск                       г. Днепpопетpовск
         ул. Косиоpа                          ул. Комсомольская
            д. 2                                    д. 74 a
           кв. 27                                    кв. 6
      р.т. 450369                                 p.т. 458557  
                                                  д.т. 424653

 ══════════════════════════════════════════════════════════════════════
   TurboEditAsm        is a trademark of SpeedWare, Inc
 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ The End ! ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
