        КРАТКОЕ ОПИСАНИЕ ПРОГРАММ ИЗ БИБЛИОТЕКИ FRIFOR

     В библиотеке FRIFOR.LIB (FRiendly Interface  for FORtran)
находятся  подпрограммы  для организации дружественного интер-
фейса с пользователем. Подпрограммы оттранслированы компилято-
рами  Quick-C  и Microsoft Fortran (Large Model) и могут вызы-
ваться из головной программы на одном из этих языков. Числовые
аргументы - INTEGER*4,  если не оговорено противное.  Подпрог-
раммы,  осуществляющие ввод/вывод на терминал, работают только
в текстовом режиме.

     call mkwind(x,y,dx,dy,sa,buffer)
     Содержимое прямоугольной области  сохраняется  в  массиве
buffer (2 байта на знакоместо),  область заполняется пробелами
с атрибутом sa. Нумерация столбцов и строк начинается с нуля.

     call rmwind(x,y,dx,dy,buffer)
     Восстанавливается содержимое прямоугольной области,  сох-
раненное при обращении к mkwind.

     call mkbord(x,y,dx,dy,style,sa)
     Построение прямоугольной рамки.  style=0 - рамка простая,
иначе двойная,  sa - атрибуты символов рамки (16 * цвет_фона +
цвет_символа).

     call cls(color)
     Очищает экран. color - цвет фона.

     call wrtext(string,count,x,y,dx,sa)
     Выдача текстовой строки в заданном месте экрана.  count -
количество выводимых символов в строке string, остаток области
(dx-count) заполняется пробелами. sa - атрибуты символов. Если
sa=0, сохраняются прежние атрибуты знакомест.

     call rdtext(string,count,x,y,dx)
     count символов считывается из заданного  места  экрана  в
текстовую строку string.

     call chattr(count,x,y,dx,sa)
     Атрибуты символов в заданном месте экрана принимают  зна-
чение sa.

     call getkey(scan,ascii)
     Аргументу scan присваивается  скэн-код  нажатой  клавиши.
Если нажата  текстовая клавиша,  аргументу ascii присваивается
ее ASCII-код,  если функциональная клавиша - нуль. Аргументы -
CHARACTER*1. Можно использовать INTEGER,  предварительно обну-
лив их. Если загружен драйвер манипулятора "мышь", перемещения
манипулятора воспринимаются как нажатие клавиш управления кур-
сором, левая кнопка - как "Enter", правая - как ESC.

     call disbrk
     Если подпрограмма getkey обнаруживает нажатие Ctrl-Break,
ее  стандартная  реакция  -  немедленное  завершение  задачи с
ERRORLEVEL=2. Подпрограмма disbrk устанавливает режим, при ко-
тором  Ctrl-Break перекодируется в Ctrl-C и работа продолжает-
ся.

     call enabrk
     Восстанавливает стандартную реакцию getkey на Ctrl-Break.

     call sound(hz,time)
     Подает звуковой сигнал с частотой hz и продолжительностью
time единиц таймера (1/18.2 сек)

     call beep
     То же, что call sound(1000,8)

     call movcur(x,y)
     Устанавливает курсор в заданную позицию. Установка курсо-
ра на 25-ю строку делает его невидимым.

     call getcur(x,y)
     Записывает в переменные x,y координаты курсора.

     call edtext(string,count,x,y,dx,sa)
     Текстовая строка  выдается на экран как по wrtext,  затем
пользователю предоставляется возможность отредактировать  ее с
клавиатуры.

     call scrlup(string,count,x,y,dx,dy)
     Прямоугольная область прокручивается на одну строку вверх
без изменения атрибутов знакомест. На освободившееся место вы-
даются count символов из текстовой строки string.

     call scrldn(string,count,x,y,dx,dy)
     То же самое, но прокрутка вниз.

     call scrllf(x,y,dx,dy,count)
     Прямоугольная область  прокручивается  на  count  позиций
влево. Освободившееся место заполняется пробелами.

     call scrlrg(x,y,dx,dy,count)
     То же самое, но прокрутка вправо.

     call vmenu(x,y,dx,dy,texts,txtlg,linnum,sa1,sa2,selnum)
     Формируется вертикальное меню с выбором одной  возможнос-
ти.  texts - массив текстовых строк, txtlg - количество симво-
лов в  каждой  строке,  linnum  -   количество   строк   (если
linnum>dy, обеспечивается прокрутка),  sa1 - атрибуты основной
части меню,  sa2  -  атрибуты  высвеченной  полосы.  selnum  -
выходной параметр,  ему  присваивается  номер выбранной строки
или 0 в случае нажатия ESC.

     call svmenu(x,y,dx,dy,texts,txtlg,linnum,sa1,sa2,selnum)
     Формируется вертикальное  меню  с выбором нескольких воз-
можностей.  Выходной параметр selnum - массив,  его элементам,
соответствующим помеченным строкам, присваиваются 1, остальным
- 0.  Пометка строки устанавливается и снимается нажатием кла-
виш "Ввод" и "Пробел",  выход - ESC. Строки, которым соответс-
твовали ненулевые элементы массива selnum при вызове  подпрог-
раммы, считаются помеченными.

     call comlin(fname,param)
     В текстовую переменную fname заносится полное имя  испол-
няющегося файла,  а  в  param - параметры из командной строки.
Признак конца - нулевой байт.

     call askfil(y,dy,fname)
     Формируется меню для выбора файла.  Имя выбранного  файла
заносится в текстовую переменную fname (CHARACTER*12). Для пе-
рехода на другой диск следует нажать Ctrl-буква_диска,  напри-
мер, для перехода на диск D:  - ^D.  При нажатии ESC подпрог-
рамма завершается, засылая '*' в первую позицию fname.

     call intoch(val,string)
     Перевод целого числа val в символьное представление.  Ре-
зультат записывается   в   переменную  string  (CHARACTER*12).
Используется подпрограммой askfil.

     call chtoin(string,val)
     Обратное действие. String - CHARACTER*12.

     call chdir(string,iferr)
     Переход в  другую директорию.  Имя директории в текстовой
строке string.  Имя должно заканчиваться пробелом или  нулевым
байтом. В случае успешного выполнения iferr  присваивается  0,
иначе код ошибки. Используется подпрограммой askfil

     call getdir(string)
     В текстовую переменную string записывается полное имя те-
кущей директории (с диском и путем).

     call patcat(p1,p2,p12)
     Слияние имени директории (из p1) и имени  файла  (из  p2)
для получения полного имени файла (заносится в p12).

     call fnd1st(mask,fname,attrib,size)
     Обращение к  функции DOS 0x4E для получения имени первого
файла,  подходящего под заданный шаблон. Текстовая строка mask
- шаблон имени файла (можно с путем),  должен закнчиваться ну-
левым байтом или пробелом, fname - имя найденного файла, целая
переменная attrib - его атрибуты,  size - его длина. Использу-
ется askfil.

     call fndnxt(fname,attrib,size)
     Обращение к  функции DOS 0x4F для получения имени следую-
щего подходящего файла. Текстовая строка fname - имя найденно-
го файла,  целая переменная attrib - его атрибуты,  size - его
длина. Используется askfil.

     call disa24
     Устанавливает режим  игнорирования  прерывания  int  24h,
возбуждаемого системой  при  неустранимой  ошибке ввода-вывода
(стандартно выдается запрос "Abort,  Retry, Fail?"). Можно ис-
пользовать для того, чтобы выдача этого запроса не портила со-
держимое экрана.

     call enab24
     Восстанавливает режим   обработки   прерывания  int  24h,
действовавший до обращения call disa24.

   call askval(x,y,dx,dy,sa1,sa2,linnum,val,lchar,names,namlg)
     Формирование вертикального меню  для  ввода  и  изменения
значений  вещественных  и  текстовых переменных.  Вещественный
массив val - значения переменных (часть  его  элементов  может
использоваться  под текстовые переменные с помощью предложения
EQUIVALENCE).  Целый массив lchar должен содержать длины соот-
ветствующих переменных, если они текстовые, и нули для вещест-
венных переменных.  names - массив текстовых строк  с  именами
элементов, namlg - длина имен элементов. Выход по нажатию кла-
виши ESC. Пример - см. TESTASK.FOR.

       call ivmenu(x,y,dx,dy,linnum,sa1,sa2,selnum,
     *   getlin,info,fkey)
     Формируется вертикальное меню с выбором одной  возможнос-
ти.  getlin(nlin,txtlg,line)  - пользовательская подпрограмма,
генерирующая текстовую строку длиной txtlg по номеру nlin (вы-
бором  из  массива или иным способом),  ,  linnum - количество
строк (если linnum>dy,  обеспечивается прокрутка), sa1 - атри-
буты  основной части меню,  sa2 - атрибуты высвеченной полосы.
selnum - выходной параметр,  ему присваивается номер выбранной
строки  или 0 в случае нажатия ESC.  Пользовательская подпрог-
рамма info (должна быть описана  в  вызывающей  программе  как
external)  запускается  подпрограммой spread в начале работы и
при перемещениях курсора. Аргумент подпрограммы info - коорди-
ната  курсора.  Подпрограмма  fkey  (должна  быть  описана как
external) запускается подпрограммой spread при нажатии фунцио-
нальных клавиш F1-F10.  Аргументы:  номер клавиши и координата
курсора. Пример - см. TESTASK.FOR

       call ismenu(x,y,dx,dy,linnum,sa1,sa2,selnum,
     *   getlin,info,fkey)
     Формируется вертикальное  меню  с выбором нескольких воз-
можностей.  Выходной параметр selnum - массив,  его элементам,
соответствующим помеченным строкам, присваиваются 1, остальным
- 0.  Пометка строки устанавливается и снимается нажатием кла-
виш "Ввод" и "Пробел",  выход - ESC. Строки, которым соответс-
твовали ненулевые элементы массива selnum при вызове  подпрог-
раммы, считаются помеченными.

    call spread(x,y,dx,dy,sa1,sa2,linnum,colnum,val,info,fkey)
     Формирование прямоугольного  меню  для  ввода и изменения
значений   вещественных   переменных.   Вещественный    массив
val(colnum,linnum) - значения переменных.  Аргументы пользова-
тельской подпрограммы info (вызываемой в  начале  работы,  при
перемещениях  курсора и изменении данных) - номер строки и но-
мер столбца, аргументы подпрограммы fkey - номер нажатой функ-
циональной клавиши, номер строки и номер столбца. Выход по на-
жатию клавиши ESC. Пример - см. TESTASK.FOR.

    call isprea(x,y,dx,dy,sa1,sa2,linnum,colnum,val,info,fkey)
     То же самое, но для целочисленного массива val.

     call retoch(val,string)
     Перевод вещественного числа val в символьную  форму.  Ре-
зультат записывается в текстовую строку string (CHARACTER*12).
Используется подпрограммами askval и spread.

     call chtore(string,val)
     Обратное действие. string - CHARACTER*48.


     Последние две подпрограммы требуют при линковке библиоте-
ку LLIBFORE.LIB для выполнения операций с вещественными числа-
ми.  Если это неудобно,  можно  вместо  модуля  из  библиотеки
MDAWIND  использовать эквивалентную подпрограмму на Си (исход-
ный текст CHTORE.C прилагается).
                                      Д.Мартынов (196-98-59)
