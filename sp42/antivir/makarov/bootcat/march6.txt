
КАТАЛОГ БУТОВЫХ ВИРУСОВ                            (C) Д.А.МАКАРОВ, Москва 1992
_______________________________________________________________________________

     КОД: M-AC

     ИМЯ: March 6 (BootChecker, AIDSTEST, -V)
          Mickaelangelo (SCAN)

     УСТАНОВКА: Скрывает от DOS 2 Кб памяти и  создает  там  резидентную  копию
(446 байт).  Перехватывает прерывание 13h (xxxx:000E) - операции с диском.  При
установке с дискеты пытается заразить жесткий диск.

     ЗАРАЖЕНИЕ: Записывается в сектор 0/0/1,  замещая бут на  дискете,  MBR  на
жестком диске. Хвост (1 сектор) содержит исходный бут или MBR, хранится на дис-
кете DS/DD 360 Кб в секторе 0/1/3 (конец корневого каталога),  на других диске-
тах  в секторе 0/1/14 (посдедний сектор корневого каталога для HD 5.25",  пред-
последний - для HD 3.5"),  на жестком диске в секторе 0/0/7 (как правило, неис-
пользуемая область перед первым разделом).  При заражении жесткого диска сохра-
няет в себе исходную Partition Table.
     Попытка заражения жесткого диска происходит при установке вируса с дискеты
(до загрузки DOS), дискеты - при каждом обращении к дисководу A: (если в момент
обращения мотор дисковода не был включен).  Распознает себя по первым 4-м  бай-
там: E9 AC 00 F5.

     МАСКИРОВКА: Нет.  Копирует в себя байты 01BE - 01FF (Partition  Table  или
тексты). Характерные текстовые строки отсутствуют.

     ПРОЯВЛЕНИЯ: При  загрузке  проверяет  дату,  извлекая  ее из CMOS (если он
есть). 6 марта затирает диск,  с которого загружен.  Сообщений не выдает. Собы-
тия, происходившие 6 марта (битва в Хелмском ущелье и взятие Изенгарда) подроб-
но  описаны во 2-й книге трилогии лорда Дж.Р.Р.Толкиена "Властелин колец".  Су-
ществует переделка под 1 октября.

     ПОБОЧНЫЕ ЭФФЕКТЫ: При заражении дискеты анализирует дескриптор в BPB и де-
лит дискеты на два типа:  DS/DD 360 Кб (дескриптор FD) и все остальные, состоя-
щие,  по мнению автора,  исключительно из дискет HD.  На этих дискетах исходный
бут попадает в последний или предпоследний сектор корневого каталога.  На любых
других дискетах (включая QD) исходный бут попадет в начало области данных, где,
скорее всего,  испортит какой-нибудь файл,  а потом будет затерт.  Замечу,  что
драйвер  800  A.Pasquale  и  некоторые  другие всегда ставят при форматировании
дескриптор F0 (нестандартная дискета), так что любые отформатированные под ними
дискеты,  даже на стандартные 360 Кб,  будут восприниматься вирусом как HD,  со
всеми вытекающими последствиями.
     При заражении жесткого диска никаких проверок не производится,  поэтому на
дисках,  у которых первый раздел начинается сразу за MBR,  сохраненный MBR ока-
жется в FAT.
     Последний сектор каталога дискеты используется при наличии на ней большого
количества файлов (более 96 у DS/DD). При заражении такой дискеты попавшие туда
файлы будут потеряны. На дискетах HD это маловероятно.
     Исходные бут и MBR хранит там же,  где Stoned и его потомки. При заражении
диска,  инфицированного ранее Stoned или кем-нибудь из аналогов, правильный бут
или MBR теряется и загрузка становится невозможной.
     При обработке  операции  16h  (была  ли заменена дискета) часто возвращает
неправильный результат, так как перед этим пытается ее заразить. Это может при-
водить к сбоям и ошибкам катастрофического характера (например, порче FAT).

     ИСТОРИЯ: Обнаружен в мае 1991 г.  в одной из московских школ. В конце года
(также в Москве) был обнаружен аналог,  отличающийся от оригинала двумя деталя-
ми: (1) 6 марта было перенесено на 1 октября; (2) на жестком диске для хранения
исходной MBR вместо сектора 0/0/7 используется сектор 0/0/15.
     SCAN(J.McAfee) распознает этот вирус под названием Michaelangelo. Является
ли это случайным совпадением (а если нет, то при чем здесь Микеланджело), уста-
новить не удалось.
     Внутри - бездарно переделанный Stoned.
