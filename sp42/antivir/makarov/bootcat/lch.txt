
КАТАЛОГ БУТОВЫХ ВИРУСОВ                            (C) Д.А.МАКАРОВ, Москва 1992
_______________________________________________________________________________

     КОД: M-FA

     ИМЯ: LoveChild b3 (BootChecker, -V, SCAN, ...)
          LCh (AIDSTEST)

     УСТАНОВКА: Скрывает  от  DOS  1  Кб памяти и создает там резидентную копию
(446 байт).  Перехватывает прерывание 13h (xxxx:7D38) - операции с диском.  При
установке с дискеты пытается заразить жесткий диск.  На жестком диске перезапи-
сывает MBR с новым значением счетчика.

     ЗАРАЖЕНИЕ: Записывается в сектор 0/0/1,  замещая бут на  дискете,  MBR  на
жестком диске. Хвост (1 сектор) содержит исходный бут или MBR, хранится на дис-
кете в секторе 0/1/3 (конец корневого каталога для DS/DD),  на жестком диске  в
секторе 0/0/7 (как правило,  неиспользуемая область перед первым разделом). При
заражении жесткого диска сохраняет в себе исходную Partition Table.
     Попытка заражения жесткого диска происходит при установке вируса с дискеты
(до загрузки DOS),  дискеты - при каждой операции чтения сектора 0/0/2 (это на-
чало FAT, поэтому читается часто) в любом дисководе. При попытке заразить защи-
щенную от записи дискету  зацикливается.  Распознает  себя  по  первому  байту:
[0000]=37h.

     МАСКИРОВКА: Stealth. При чтении с дискеты одного сектора 0/0/1 подставляет
сектор  с исходным бутом;  регистры сохраняет.  При чтении нескольких секторов,
начиная с 0/0/1,  не маскируется.  На жестком диске читается нормально,  однако
при попытке перезаписать его затирает диск. При заражении дискет обычно отсутс-
твует концевая метка загружаемого бута  [01FE]=AA55h.  В  теле  вируса  имеется
текстовая строка:  'LoveChild b3 in reward for software stealing.' ('Внебрачный
ребенок b3 в награду за кражу программ.').

     ПРОЯВЛЕНИЯ: Через 256 загрузок с жесткого диска затирает его.  Точнее, за-
тираются сначала секторы 0 - 5 на 0-й стороне 0-й дорожки, затем по 16 секторов
на сторонах 0 - 2 всех доржек с четными номерами.  Кроме того, жесткий диск за-
тирается  таким  же образом при записи в сектор 0/0/1 (т.е.  попытке уничтожить
вирус). В известной мне версии текст на экран никогда не выводится и предназна-
чен для тех, кто сумеет заглянуть внутрь.

     ПОБОЧНЫЕ ЭФФЕКТЫ: Последний сектор каталога дискеты DS/DD используется при
наличии на ней большого количества файлов (более 96).  При заражении такой дис-
кеты попавшие туда файлы будут потеряны. Поскольку при заражении дискеты ее тип
не проверяется,  файлы теряются на дискетах QD,  если их больше 64, на дискетах
HD 5.25" - больше 16, 3.5" - больше 32.
     При заражении жестких дисков,  у которых первый раздел начинается сразу за
MBR,  сохраненный MBR окажется в FAT и может там потеряться.  При этом для исп-
равления  FAT  можно  воспользоваться  второй  копией,  а  правильный   вариант
Partition Table позаимствовать из тела вируса.
     Не сохраняет правильный BPB, что может сделать зараженную дискету (особен-
но нестандартного формата) нечитаемой в некоторых случаях.
     Имеющийся у меня экземпляр почему-то располагает счетчик загрузок не внут-
ри себя, а внутри исходной MBR (байт со смещением 01BD). Обычно это неиспользу-
емое место перед Partition Table.  Забавно, что внутри вируса имеется аналогич-
ная ячейка,  которая даже обнуляеся при заражении, но не увеличивается при заг-
рузке.  Кроме того,  вирус зачем-то подсчитывает зараженные дискеты, хотя нигде
не проверяет этот счетчик.

     ИСТОРИЯ: Существует файловый вирус (RC-448,  Flu-2, LoveChild), содержащий
аналогичную текстовую строку без b3 и имеющий некоторые сходные черты. Так, по-
заимствовано затирание диска,  однако из-за ошибки в b3 затираются 3 стороны, а
не 4.  Это позволяет предположить скорее плагиат, нежели одного автора. Вероят-
но, оба имеют зарубежное происхождение, причем оригинал бутового вируса в Моск-
ве, видимо, живьем не появлялся. Вышеописанная переделка, по утверждению ее ав-
тора (прорезался письмом,  мерзавец) отличается от оригинала  большей  "вероят-
ностью вредительства". Возможно, им же допущена ошибка с местонахождением счет-
чика. Впрочем, может быть, автор сам скрестил Stoned с файловым LoveChild (под-
ходящие родители для такого внебрачного дитяти...)
     Внутри чувствуется влияние Stoned, однако не настолько сильное, чтобы счи-
тать этот вирус переработкой (на фоне существующих аналогов),  и я позволю себе
не согласиться с доктором Касперским, который относит LoveChild к группе Stoned
подобных вирусов.
