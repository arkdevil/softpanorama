                 Украинское производственное об'единение
                    "Энерготехнология и информатика"

              Отдел Системного Математического Обеспечения

























                 Программа приема-передачи файлов ECCOM

                       Инструкция по эксплуатации

















                                             Телефоны 2711721
                                                      2711223
                                                      2711753




                                Киев 1991

                             В В Е Д Е Н И Е


              Программа предназначена для приема-передачи файлов
         по асинхронным коммутируемым  и  выделенным  телефонным
         каналам связи с использованием модемов типа TAM1200 или
         HAYES между персональными ЭВМ типа IBM PC, ЕС-1840, ИС-
         КРА-1030 и универсальной ЭВМ, а также между универсаль-
         ными ЭВМ типа IBM 360/370. Скорость обмена определяется
         используемыми модемами и находится в пределах от 300 до
         9600 Бод.  Со стороны персональной ЭВМ партнером  прог-
         раммы ECCOM является программа EASYCOM.

              Программа обеспечивает:
              - передачу одного или нескольких файлов одному или
         нескольким абонентам;
              - автоматический прием файлов;
              - запpос одного  или  гpуппы  файлов от удаленного
                абонента;
              - поддержку режима обмена файлами с удаленным або-
         нентом аналогично функции LINK пакета  NORTON COMMANDER
         для персональных ЭВМ;
              - санкционирование доступа к файлам;
              - автоматический  набор   номера   на   любом   из
         указанных типов модемов;
              - совместимость с системой телеобработки АСВИ;
              - простую настройку программы под необходимую кон-
         фигурацию технических средств;
              - устойчивость  работы  по  отечественным  каналам
         связи;
              - достоверность принятой информации.

              Управление программой   осуществляется  с  консоли
         оператора при помощи команды MODIFY (F).

                            У С Т А Н О В К А


              Установка программы ЕССОМ заключается в размещении
         процедуры запуска программы в системной библиотеке про-
         цедур SYS1.PROCLIB и в восстановлении с  ленты поставки
         в загрузочную библиотеку компонент программы, а именно:

         модуль ECCOM  - основная функциональная компонента;
                #VTOC  - подпрограмма  формирования   оглавления
                         тома прямого доступа;
                EPILOG - подпрограмма, обеспечивающая  совмести-
                         мость по принимаемой информации с  сис-
                         темой телеобработки АСВИ.

              Процедура запуска ЕССОМ имеет вид:

         //ECCOM PROC U=Адрес_канала,V=Имя_тома,P=,BS=800,
         //           LR=80,SP='(TRK,(1,1))'
         // EXEC PGM=ECCOM,DPRTY=(14,14),TIME=1440,PARM=&T
         //STEPLIB DD DSN=...
         //TERM    DD UNIT=&U
         //DISK    DD UNIT=SYSDA,DISP=OLD,VOL=SER=&V,
         //           SPACE=&SP,DCB=(BLKSIZE=&BS,LRECL=&LR)
         //WRKVOL  DD UNIT=SYSDA,SPACE=(TRK,(1,1))
         //DATA    DD UNIT=SYSDA,VOL=REF=ASVI.CATALOG

         где Адрес_канала - адрес  обслуживаемого  канала  связи
                            (адаптера МПД);
             Имя_тома     - имя тома прямого  доступа, использу-
                            емого по умолчанию;
             Р            - имя  загрузочного  модуля  настройки
                            (его структура будет описана ниже).

              DD-оператор TERM описывает адрес канала связи.

              DD-оператор DISK описывает  том  прямого  доступа,
         используемый в процессе приема/передачи.  Если файл,  в
         который выполняется прием уже существует, то в процессе
         приема его характеристики не изменяются. Если требуемый
         файл отсутствует,  то он будет создан с характеристика-
         ми, указанными в параметрах BS и LR, и с размером, ука-
         занным в параметре SP.

              В DD-операторе WRKVOL, резервирующем память на то-
         ме прямого доступа,  параметр  SPACE  должен  описывать
         дисковое пространство,  достаточное для размещения наи-
         большего оглавления из всех установленных томов прямого
         доступа. Следует учитывать,  что оглавление формируется
         в виде  набора  данных  с  PS-организацией,   RECFM=FB,
         BLKSIZE=800, LRECL=80, причем имя каждого набора данных
         занимает одну логическую запись.

              DD-оператор DATA не является обязательным и должен
         присутствовать в процедуре,  если  требуется  совмести-
         мость по принимаемой информации с системой телеобработ-
         ки АСВИ.
              Уточнение некоторых режимов работы программы ЕССОМ
         может осуществляться через модуль настройки,  имя кото-
         рого передается  в  программу через поле PARM оператора
         EXEC. Модуль настройки формируется по усмотрению  поль-
         зователя и размещается в библиотеке шага задания.

              Структура модуля настройки следующая:

         CSECT
         DC    AL1(lng1),Clng1'TXTDOC...'
         DC    AL1(lng2),Clng2'DAT...'
         DC    AL1(lng3),Clng3'...'
         DC    AL1(lng4),Clng4'...'
         END

              Первый оператор  DC  описывает  символьную  строку
         длиной lng1,  в которой перечислены расширения имен на-
         боров данных,  передаваемых из универсальной ЭВМ в сим-
         вольном режиме (режим ТЕХТ). Другие наборы данных пере-
         даются в кодонезависимом  режиме  (режим  BINARY).  Под
         каждое расширение должно быть отведено 3 байта.
              Второй оператор описывает символьную строку длиной
         lng2, где описаны расширения файлов,  которые при нали-
         чии DD-оператора DATA принимаются на информационный том
         системы АСВИ  с  формированием соответствующей записи в
         ASVI.CATALOG. Таким образом,  при  приеме  этих  файлов
         программа ЕССОМ  выполняет  функции  обработчика канала
         системы АСВИ.
              Третий оператор описывает символьную строку длиной
         lng3, которая содержит команды инициализации  HAYES-мо-
         дема. Первым в строке указывается символ задержки выда-
         чи цифры телефонного номера (без ожидания гудка), далее
         следует пробел,  после  которого команды отключения эха
         (обычно команда Е0),  установления цифрового  кода  ре-
         зультата (обычно  команда  V0) и запрета автоматической
         выдачи автоответа (как правило команда  S0=0). Значение
         lng3 равное нулю означает работу с модемом типа ТАМ1200.
              Четвертый оператор описывает  строку  длиной  lng4
         (не более  22  байт),  которая  содержит  идентификатор
         станции. Этот оператор может содержать только латинские
         буквы, цифры и символ "пробел".  Такое ограничение свя-
         зано с особенностями протокола телекоммуникации.
              При отсутствии  в поле PARM имени модуля настройки
         программой ЕССОМ  используются  следующие  значения  по
         умолчанию:

              - в текстовом режиме передаются файлы с расширени-
         ем ТХТ;
              - в  соответствии с требованиями системы АСВИ при-
         нимаются файлы с расширением DAT;
              - работа с модемом типа ТАМ1200;
              - идентификатор станции IBM370.

                У П Р А В Л Е Н И Е   П Р О Г Р А М М О Й


              Управление программой ЕССОМ производится с консоли
         оператора при помощи команды MODIFY (F).  Общий  формат
         команды:

              F Адрес_канала,Команда_управления

         где Адрес_канала - адрес обслуживаемого канала.

              Команды_управления позволяют  задать  один из трех
         режимов работы программы ЕССОМ:

              - передать файл удаленному абоненту;
              - запросить файл (или группу файлов) от удаленного
                абонента;
              - обработать пакетный файл.

              Завершение работы программы может  быть  выполнено
         командами CANCEL CUU или STOP CUU, где CUU - адрес обс-
         луживаемого канала связи.


              1. Передать файл
              ----------------

              Команда "Передать файл" имеет вид:

         TO D=Имя_файла,N=Номер_телефона[,V=Имя_тома]

         где: Имя_файла      - имя файла, который  требуется пе-
                               редать.  Имя  должно соответство-
                               вать требованиям MS DOS. Допуска-
                               ется  передача  только  файлов  с
                               PS-организацией;
              Номер_телефона - номер телефона удаленного абонен-
                               та. Допускаются только цифры от 0
                               до 9. Задержка выдачи цифры номе-
                               ра указывается символом "/";
              Имя_тома       - имя тома прямого  доступа, на ко-
                               тором   расположен   передаваемый
                               файл. Если параметр не указан, то
                               поиск файла  выполняется  на томе
                               "по умолчанию", т.е.  указанном в
                               DD-операторе DISK.

              Результат выполнения команды отображается на  кон-
         соли оператора в виде диагностического сообщения.

              2. Принять файл
              ---------------

              Команда "Принять файл"  выдает  запрос  удаленному
         абоненту на прием от него одного или группы файлов.

              Формат команды следующий:

         IN D=Имя_файла,N=Номер_телефона[,V=Имя_тома]

         где: Имя_файла      - имя файла, запрос на который тре-
                               буется  обслужить.   Файл  должен
                               располагаться в текущей  директо-
                               рии удаленной  ПЭВМ  или  на томе
                               "по умолчанию" удаленной  ЕС ЭВМ.
                               Если удаленным абонентом  являет-
                               ся ПЭВМ, то допускается запрос на
                               группу файлов.  Например,  если в
                               команде  указать  D=*.TXT , то на
                               ЕС ЭВМ  будут  приняты все файлы,
                               расположенные в текущей  директо-
                               рии удаленной ПЭВМ, имеющие  рас-
                               ширение ТХТ;
              Номер_телефона - номер телефона удаленного абонен-
                               та;
              Имя_тома       - имя тома прямого доступа,  на ко-
                               торый  должен  выполняться  прием
                               файлов.  Если параметр не указан,
                               то прием выполняется  на  том "по
                               умолчанию".

              3. Обработать пакетный файл.
              ----------------------------

              Команда предназначена   для  реализации  групповых
         запросов на прием-передачу файлов одному или нескольким
         абонентам.
              Пакетный файл - это последовательный файл  на томе
         прямого доступа, содержащий описанные выше команды "Пе-
         редать файл" и "Принять файл".  Размер записи LRECL=80,
         формат F или FB (рекомендуется F).
              В пакетном файле команды записываются,  начиная  с
         первой позиции строки. При формировании пакетного файла
         необходимо учитывать некоторые  особенности  применения
         команд. А именно:

              - не допускается указание в команде IN  запроса на
         группу файлов;
              - в  обеих  командах  параметр "Номер_телефона" не
         является обязательным.

              Код завершения при обработке команд пакетного фай-
         ла фиксируется в последней 80-й позиции строки,  содер-
         жащей команду.

              Существует 8 кодов завершения:

         0 - успешная обработка команды.  При повторной обработ-
             ке пакетного файла эта команда не выполняется;
         1 - ошибки в параметрах команды;
         2 - отсутствуют обязательные параметры команды;
         3 - ошибки ввода/вывода в процессе приема-передачи;
         4 - удаленный абонент отказался от работы;
         5 - указанный том не установлен;
         6 - отсутствует и не может быть создан файл для приема;
         7 - ошибки ввода/вывода при чтении/записи в файл.

              Формат команды "Обработать пакетный файл"  следую-
         щий:

         BAT D=Имя_файла[,N=Номер_телефона[,V=Имя_тома]]

         где: Имя_файла      - имя  пакетного  файла. Имя должно
                               соответствовать требованиям  опе-
                               рационной системы MS DOS;
              Номер_телефона - необязательный параметр, указыва-
                               ющий  номер  телефона  удаленного
                               абонента, которому будут  направ-
                               лены в одном сеансе  (без разрыва
                               соединения) все файлы и  запросы,
                               содержащиеся  в  пакетном  файле.
                               Только в этом случае указание те-
                               лефонного номера абонента  в  ко-
                               мандах  IN  и  TO не обязательно,
                               т.к. он игнорируется.
              Имя_тома       - имя тома прямого доступа,  содер-
                               жащего пакетный файл. При  отсут-
                               ствии параметра используется  том
                               "по умолчанию".
