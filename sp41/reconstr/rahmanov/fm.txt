            Программа манипуляции шрифтом HP LaserJet   FM.EXE.

     Эта программа  может оказаться  полезной для пользователей издательской
системы  XEROX   Ventura  Publisher   и  текстового   процессора  MS   Word,
эксплуатирующих эти  системы для получения качественных печатных образцов на
лазерных принтерах  семейства HP  LaserJet или  совместимых. Конкретнее, она
Вам поможет добавить новые загружаемые шрифты в эти системы.
     Как ею  пользоваться? Просмотреть  формат запуска  и  список  возможных
ключей Вы  можете запустив  программу FM.EXE  без параметров. А здесь я хочу
показать  на   примерах  несколько  приемов  работы  с  программой.  Попутно
продемонстрирую некоторые  возможности утилиты  EXTCOM (автор  Рахманов Х.),
которая вместе с подробным описанием публикуется в этом номере журнала.
     Допустим, вы  приобрели несколько  загружаемых шрифтов  гарнитуры Times
различных начертаний и размеров в альтернативной кодировке:
   tms06n.sfp      прямой, кегель 6
   tms06i.sfp      курсив, кегель 6
   tms06b.sfp      полужирный, кегель 6
   tms08n.sfp      прямой, кегель 8
   tms08i.sfp      курсив, кегель 8
   tms08b.sfp      полужирный, кегель 8
   tms10n.sfp      прямой, кегель 10
   tms10i.sfp      курсив, кегель 10
   tms10b.sfp      полужирный, кегель 10
   и т.д.
и Вы хотите добавить их к тем шрифтам с которыми работали ранее.
     Для VP  эта работа  сведется к  нескольким простым  этапам. Вначале Вам
нужно выяснить в какой кодовой таблице работает драйвер лазерного принтера в
Вашей Вентуре  (у меня  этот драйвер называется PD_HPLH5.SYS и работает он в
очень странной  таблице), составить  таблицу перекодировки (описание формата
таблицы приводится в приложении - файл vp-main.tab) и перекодировать шрифты,
выполнив команду:

   EXTCOM "FM -t:alt_vp.tab &f" tms*.sfp -sn,
Утилита EXTCOM составит и выполнит следующий ряд команд:

   FM -t:alt_vp.tab tms06b.sfp
   FM -t:alt_vp.tab tms06i.sfp
   FM -t:alt_vp.tab tms06n.sfp
   FM -t:alt_vp.tab tms08b.sfp
        ...
   FM -t:alt_vp.tab tms10n.sfp
alt_vp.tab -  файл, содержащий  таблицу перекодировки  из альтернативной   в
таблицу драйвера принтера.
     Затем Вы должны создать файл таблицы ширин символов. Выполните команду:

   EXTCOM "FM -w:v -t:vp_main.tab -a&6 -s&4&5 -f:Times -i14 &f >&n.vfm" tms*.sfp -sn
Утилита EXTCOM выполнит команды:

   FM -w:v -t:vp_main.tab -ab -s06 -f:Times -i14 tms06b.sfp > tms06b.vfm
   FM -w:v -t:vp_main.tab -ai -s06 -f:Times -i14 tms06i.sfp > tms06i.vfm
   FM -w:v -t:vp_main.tab -an -s06 -f:Times -i14 tms06n.sfp > tms06n.vfm
      ...
   FM -w:v -t:vp_main.tab -ab -s10 -f:Times -i14 tms10b.sfp > tms10b.vfm

в результате  выполнения этих  команд для каждого шрифтового файла создается
файл описания шрифта .vfm. Необходимость перекодировки (ключ -t:vp_main.tab)
обусловлена тем,  что сама  Вентура работает  в  основной  кодовой  таблице.
Теперь осталось командой:

   DIR *.vfm /b /o:n > times.lst

создать файл  times.lst,  содержащий  список  файлов  параметров  шрифтов  и
преобразовать его  утилитой VFMTOWID.EXE,  поставляемой вместе с Вентурой, в
таблицу ширин символов:

   VFMTOWID times.lst

     После этого  вам  останется  только  позаботиться  о  экранных  шрифтах
соответствующей гарнитуры  и можно  работать с  новыми шрифтами.  Да, еще не
забудьте создать  шрифты  альбомной  ориентации.  Это  можно  сделать  одной
командой:

   EXTCOM "FM -o:l &f &n.sfl" tms*.sfp


     Как видите,  добавить новые шрифты в Вентуру с помощью моей программы и
утилиты EXTCOM  очень просто.  Куда более  нетривиальная и  муторная  работа
предстоит Вам если Вы захотите добавить новые шрифты в MS Word. Для начала я
посоветовал бы Вам ретранслировать утилитой MAKEPRD ваш .prd - файл описания
принтера  и   шрифтов,  тщательнейшим  образом  его  исследовать  в  поисках
закономерностей и  только после  этого приступать к включению новых шрифтов.
Работа сведется  к извлечению  характеристик шрифтов  и добавлению их в .prd
файл. Получить параметры шрифтов можно выполнив команду:

   EXTCOM "FM -w:w &f > &n.wid" tms*.sfp

после чего  останется каким-нибудь текстовым редактором отредактировать .prd
файл, добавив  в него  соответствующие описания шрифтов из полученных файлов
.wid и  внести соответствующие  коррективы в  файл описания шрифтовых файлов
.dat. Должен  заметить,  что  эту  работу  я  однажды  проделал  и  она  мне
показалась очень  утомительной. Поэтому  я буду  очень благодарен  тому, кто
пришлет мне  техническую документацию  по MS  Word, вернее  ту ее  часть,  в
которой идет  речь о структуре .prd файлов для различных принтеров. Обещаю в
течении месяца  после этого  написать и  выслать программу,  которая возьмет
весь этот труд на себя, оставив Вам удовольствие работы в Word.
     Последнее, поскольку многие производители шрифтов некорректно заполняют
дескриптор шрифта,  советую при запуске программы с ключом -w задавать также
ключи -f, -a и -s.

     Буду рад если эта программа окажется Вам полезной.
     Рахманов Дамир, г. Душанбе, тел. (3772)36-93-28
