
             ПРИМЕЧАНИЯ К ПРОГРАММЕ 'CRACK2.EXE'
    
    Уважаемые коллеги, автор предлагает данную  программу  с 
исходными  текстами,  надеясь, что она поможет выйти из зат- 
руднительного положения тем, кто по забывчивости или еще ка- 
кой  причине утерял пароль к своим ZIP-архивам (как это слу- 
чилось с автором, а вовсе не для того, чтобы взламывать  чу- 
жие  архивы).  Такая  надежда  основывается  на элементарных 
арифметических подсчетах типа нижеследующего. 
    Допустимый и обычно используемый набор кодов для паролей 
включает  в себя порядка 90 символов, а именно, цифры, про- 
писные и строчные буквы латиницы  и  спец-символы  (непустые 
разделители).  Если  добавить  еще кириллицу, то набор кодов
будет насчитывать порядка 150 символов, что  в  общем-то  не
типично.
    Допустив  средний размер пароля в 6 (шесть) символов по- 
лучим общую оценку количества возможных паролей.
    
    90 в степени 6 = 531.441.000.000
    
    Преположив, что для получения результата надо  перебрать 
половину  из  всех возможных комбинаций, и приняв к сведению 
результаты испытаний программы на 386 процессоре с  тактовой 
частотой  20  мегагерц при использовании специфических инст- 
рукций, около пяти тысяч паролей в секунду, вычислим  время, 
необходимое для нахождения истинного пароля. 
    
    531.441.000.000   531.441
    --------------- = ------- = 14.762 часов
    2 * 5000 * 3600     36
    
    (или около 2-х лет (!) машинного времени)
    
    Может показаться, что положение безнадежно. Отчасти  это 
действительно  так,  тем  не менее, забывчивый коллега может 
попытаться уменьшить набор допустимых  кодов  до  приемлемых 
пределов  и  оставить  лишь те символы, которые с наибольшей 
вероятностью могли войти в злополучный пароль. Помедитировав 
пару часов и призовя на помощь мышечную память своих пальцев 
вполне можно сократить допустимый набор до 10-20 символов. В 
этом  случае  расчеты  уже не выглядят такими мрачными, даже 
если уменьшить скорость программы до тысячи паролей в секун- 
ду (вполне достижимый результат на обычной PC/AT). 

    20 в степени 6 = 64.000.000, и далее по схеме
    
      64.000.000       640     320
    --------------- = ------ = ---- == 9 часов
    2 * 1000 * 3600   2 * 36    36

    Таким образом автор нашел забытые пароли в течение часа,
разумеется,  если не считать времени, потраченного на лицез-
рение файла APPNOTE.TXT и прохождения в отладчике  программы
PKUNZIP.EXE  (для  добывания недостающей информации). На все
это автор убил целую неделю, по прошествии которой он решил,
что его труд может сберечь кому-нибудь эту неделю.
    Автор приносит извинения за явную недоработку программы, 
что  объясняется простым отсутствием стимулов (пароли найде- 
ны) и времени. В данной версии предусмотрена  проверка  лишь 
первого файла в ZIP-архиве (без просмотра оглавления в конце 
архива) с обработкой лишь одного метода сжатия IMPLODE. 

    Несколько слов по поводу возможностей программы. Все они
реализуются при помощи параметров и опций. Выглядит это так: 
  
  Формат команды:
    
  CRACK2 [опция] имя_ZIP-файла [длина_стартового_пароля [стартовый_пароль]]
    
  ОПЦИИ регламентируют режим  функционирования  программы  в
целом и могут быть указаны в любой комбинации, а именно:
    
    /386 - использовать специфические команды 386-го процес-
сора (работает быстрее на 40%), по умолчанию не устанавлива-
ется.
    /v   - выводить  текущий  пароль  после 100 проходов, по
умолчанию выводится через каждый проход (один проход - пере-
бор всех символов в 1-й позиции пароля).
    /s<дескрипторы>  -  при  построении паролей использовать
набор символов, описываемый дескрипторами, которые  перечис-
лены ниже:
    :<символы> - включить в набор последовательность указан- 
ных символов (в указанном порядке), данный дескриптор,  если 
присутствует,  должен  быть последним (завершающим) в данной 
опции. 
    c        - набор спецсимволов,  допустимых  в  командной
строке:  ~@#$%^&*()_+-=[]{},.\"/?:;`'
    e        - a-z (строчная латиница)
    E        - A-Z (прописная латиница)
    0        - 0-9 (цифровые символы)
    r        - а-я (строчная кириллица)   > альтернативная
    R        - А-Я (прописная кириллица) /    кодировка
    
    По умолчанию используется набор ceE0 (т.е.опция /sceE0), 
который  содержит все допустимые в командной строке символы, 
исключая национальные алфавиты. Псевдографика  в  расчет  не 
принимается,  но, при необходимости, ее можно задействовать, 
используя дескриптор ':'. В качестве  примера  использования 
данной  опции  можно  привести  победную комбинацию автора в 
личной эпопее. Контакт с астральными силами убедил его огра- 
ничится следующим набором: 
    
    0          - цифры и
    :-+=gruGRU - указанные 9 символов
    
    Что и было оформлено в виде следующей команды:
    
    crack2 /s0:-+=gruGRU vir_lst.zip
    
    ПАРАМЕТРЫ указывают объект обработки и стартовый  пароль 
для продолжения расчетов, либо выбранный из каких-либо сооб- 
ражений. Первый параметр (не считая опций) обязателен и  яв- 
ляется  именем  архива с забытым паролем. Следующий параметр 
указывает количество символов пароля с которого следует  на- 
чинать работу, чтобы предотвратить бесполезный перебор паро- 
лей с меньшим количеством символов. По умолчанию перебор на- 
чинается  с паролей из одного символа. Следующий и последний 
параметр фиксирует пароль, с  которого  следует  производить 
дальнейший  перебор. По умолчанию начальный пароль составля- 
ется из первого символа набора, сформированного  при  помощи
опций.
    Следует  иметь  в  виду, что последовательность перебора 
является важным фактором достижения успешного  результата  и 
возможность  управления  этой  последовательностью  имеется, 
хоть и косвенная. Суть  заключается  в  следующем:  так  как 
программа  строго придерживается порядка следования символов 
в наборе и перебираются в первую очередь  символы  в  первой 
позиции,  во 2-ю очередь символы во 2-й позиции и так далее, 
то имеет смысл в формирующемся наборе в начало помещать сим- 
волы  которые наиболее вероятно могли находиться в конце па- 
роля. 
    
                                    10 декабря 1991 г.
                                       Груздев А.П.
                                г.Пермь, т.(342-2)39-58-81
