


                    П Е Ч А Т Ь    Т Е К С Т О В
                    ============================

                (Инструкция к программе PRPAGE.EXE)



                       Альперович Л. З. тел. 386-59-36
                    


     Программа предназначена для вывода на печать тексто-
    вых  файлов.  Она  позволяет просматривать содержимое
    листов на экране дисплея и производить  их выборочную
    печать.

     Возможности программы:
     - Задание размера страниц (высоты и ширины).
     - Управляемая  нумерация  страниц  (по отсчету числа
       строк и по управляющим символам в тексте).
     - Выборочная распечатка листов с просмотром текста на
       экране дисплея.
     - Многоколоночная печать.
     - Управление следованием колонок (брошюры).
     - Задание отступа от левого края листа.
     - Распечатка группы файлов в виде одного текста.
     - Вывод распечатываемой информации в файл.
     - Преобразование кодов.
     - Преобразование малых букв в большие.
     - Печать через строку.
     - Оперативная корректировка режимов печати и исправ-
       ление ошибок в параметрах.
     - Вставка управляющих ESC -  последовательностей для
       принтера.
     - Условный и безусловный переходы на новую страницу.
     - Печать нескольких экземпляров.
     - Замена символов табуляции.

     Свойства печати задаются двумя способами:
     - Параметрами вызова программы.
     - Управляющими символами в тексте файла, подлежащего
       распечатке.
$

                   ПАРАМЕТРЫ ПРОГРАММЫ
                   -------------------

     Обращение к  программе:
     PRPAGE.EXE [@]<имя_файла> [режимы]

      Имя_файла обязательный  параметр.  Если  программа
    вызвана без параметров, она выводит на экран описание
    обращения к ней и  заканчивает  работу. @  -  признак
    группы файлов (см. далее).

     Режимы задаются в произвольном наборе через пробелы.
    Каждый режим описывается словом, первая буква которо-
    го кодирует имя режима. Пробел внутри режима не допус-
    кается. Некоторые режимы задаются  одной  этой буквой
    (буквы латинские, прописные или строчные).
     Перечень кодов: H D L W U C S N Е V R F B X ) $  I J
    К Y Z P Q T A
$
                      Описание режимов
                      ----------------

     Нчисло - высота листа(задается числом строк), напри-
    мер Н72. Это число указывает физическую высоту листа.

     Dчисло - межстраничный промежуток. Указывается коли-
    чество строк листа, остающихся незаполненными текстом
    при печати. Пример, если задано Н72 D10, то заполнено
    текстом на листе будет лишь 62 строки.

     Lчисло1Wчисло2Uчисло3Cчисло4 - Параметры ширины лис-
    та печати с уточнениями. Число1 - ширина  листа. Чис-
    ло2 - ширина колонки. Число3 -  ширина межколоночного
    промежутка. Число4 - количество  колонок.  Все  числа
    означают количество позиций символов.
     Ведущие буквенные символы  показывают  смысл  числа.
    Допустима любая перестановка чисел и  любой  неполный
    набор их. Важно, чтобы все значения  определялись од-
    нозначно и непротиворечиво.
     Примеры:
     l65         лист=65  страница=65 промеж.= 0 кол. = 1
     w65         лист=65  страница=65 промеж.= 0 кол. = 1
     L200w65u10  лист=200 страница=65 промеж.=10 кол. = 2
     w60u4       лист=124 страница=60 промеж.= 4 кол. = 2
     c3l300      лист=300 страница=100 промеж.=0 кол. = 3
     l120w60c3 - противоречивость, будет сообщение.

     Sчисло0-число1-..-число... -  Управление  последова-
    тельностью выводимых колонок. Число0  -  период, чис-
    ло1, число2 и т.д. - номера в периоде.  Номера больше
    нуля и не больше числа0.
     Пример1: S4-1-4
     Из каждых 4 страниц будут печататься только первая и
     четвертая.
     Пример2: S4-3-2
     Из каждых 4 страниц будут печататься только третья и
     вторая.
     Пример3: S12-12-1-10-3-8-5
     Из каждых 12 страниц  "брошюры"  выводятся  страницы
    первой стороны.
     Пример4: S12-2-11-4-9-6-7
     Из каждых 12 страниц  "брошюры"  выводятся  страницы
    второй стороны.
     Эти примеры имеют смысл при двухстраничной печати. В
    принципе, режим S не зависит от L -  выбранный  текст
    последовательно заполняет колонки  выводимой информа-
    ции. Величина "Число0" ограничивается  размером памя-
    ти, доступной программе (но не более 256). Если памя-
    ти недостаточно, программа сообщает об этом  и закан-
    чивает работу.
     Для "брошюрного" варианта предусмотрена  краткая ко-
    дировка символами 'a' и 'b',  которая  иллюстрируется
    двумя примерами:
     Пример5: S12-a
     Пример6: S12-b
     Пример 5 заменяет пример 3, пример 6 заменяет 4.

     Nчисло1-число2 - автоматическая  нумерация  страниц,
    номер располагается с  заданным  отступом  в  строке,
    например N60 означает отступ на 60 символов  от левой
    границы колонки. Если "число1" не  задано,  то  номер
    располагается посреди строки (длина  которой задается
    режимом L). При автонумерации добавляются 2  строки к
    каждой странице текста: одна - с  номером  и  одна  -
    пустая.
     Если "число1" = 0, то отмена нумерации.
     Число2 - начальное значение  номера  при автонумена-
    ции. Например N60-23 означает начало с 23.  Можно за-
    дать и так: N-23.
     При отсутствии этого режима нумерация не производит-
    ся.
$
     Ечисло1-число2 - диапазон номеров страниц. На печать
    (или в файл, заданный параметром F)  выводится  часть
    текста, определенная данными границами. Режим опреде-
    ляет два числа: начальный и конечный номера выводимых
    страниц. Числа разделяются знаком "минус" (без пробе-
    ла).
     Пример: Е25-40
     Этот режим отменяет режим V.
     Для печати текста до конца нужно  второму  числу за-
    дать заведомо большое значение, например: Е25-999.

     V - визуализация печати (V0 -  отмена визуализации).
    Печать осуществляется с остановкой перед  каждым оче-
    редным листом. На экран  дисплея  выводится  фрагмент
    листа (20 строк) и подсказка  относительно  вариантов
    дальнейшей работы. Они выбираются клавишами:
     ENTER - печать  листа и просмотр следующего листа.
     F10   - печать  листа без подгона следующего листа.
     ESC   - конец печати, завершение работы программы.
     PgDn  - пропуск листа.
     PgUp - возврат к предыдущему листу.
     CtrlHome - переход к первому листу.
     CtrlEnd - переход к последнему листу.
     +N    - пропуск N листов.
     -N    - возврат на N листов.
     CtrlUp - просмотр предыдущих 20 строк листа.
     CtrlDn - просмотр последующих 20 строк листа.
     CtrlLeft  - просмотр левой части листа.
     CtrRight  - просмотр  правой части листа.
     F1    - подсказка.
     F2    - печать до конца текста.
     F4    - изменение текущих режимов.

     Режим позволяет осуществить  выборочную  и  повторную
    распечатку листов текста.
     Этот режим отменяет режим E.

     Rчисло - величина проверяемого остатка страницы (см.
    далее описание управляющих символов печати). Этот ре-
    жим активизируется только совместно с управляющим сим-
    волом $.

     Fимя - Имя файла для вывода информации  на  диск.  В
    качестве имени может быть стандартное имя порта печа-
    ти (prn, lpt1, lpt2).

     B - Преобразование малых букв в больших  в альтерна-
    тивной русской кодировке (В0 - отмена). Режим полезен
    для подготовки файла к перекачке на ЕС  и  распечатке
    на АЦПУ.

     Xчисло - количество позиций  (символов)  отступа ко-
    лонки текста от левого края листа.  Эта  величина  не
    входит  в  ширину  колонки.  Она  может  быть отрица-
    тельной.

     )Символ - символ,  по которому осуществляется переход
    на новую  страницу  (см.  ниже  описание управляющего
    символа ")").
      Если "Символ" = '0', то данный режим отменяется.

     $Символ - символ,  по которому  проверяется величина
    остатка страницы (см. ниже описание управляющего сим-
    вола "$").
     Если "Символ" = '0', то данный режим отменяется.

     I - Печать через строку (I0 - отмена).

     Jтекст - Вставка текста перед номером страницы. Раз-
    мер текста не более 40 символов.  Символы подчеркива-
    ния в этом тексте заменяются пробелом.

     КСимвол1Символ2Символ3Символ4... -   замена   символа
    первого  на  второй,  третьего на четвертый и т.д.  во
    всем тексте
      Пример:КТ5У6
     В этом случае русские заглавные буквы Т и У  в тексте
     будут при печати заменены цифрами 5 и 6.
$
     YСимвол1Символ2Символ3Символ4... -  замена  символов,
    аналогичная предыдущей,  но в шестнадцатиричном предс-
    тавлении.  Символы  рассматриваются парами:  Символ1 и
    символ2 - шестнадцатиричный код  замещаемого элемента,
    символ3 и символ4 - код его заместителя и т.д.
      Пример1: Y92359336
     В этом случае также,  как и выше, заглавные буквы Т и
     У в тексте будут при печати заменены цифрами  5  и  6.
      Пример2: y0с20
     Здесь признак начала  страницы  (код  0С)  заменяется
     пробелом (код 20).

     Z - Печать имени файла, даты и  времени  (вывода  на
    печать) в первой строке первого листа. Z0  -  отмена.
    Z1 - печать имени перед каждым файлом в группе файлов.

     Pkiiii... - фрагмент вставки в выводимый  текст (см.
    далее).

     Qkiiii... - фрагмент 16-ичной  вставки  в  выводимый
    текст (см. далее).

     Tчисло - Печатать  "число"  экземпляров.  Отменяется
    режим визуализации. T0 - отмена режима T.

     Aчисло - замена символов табуляции на "число" пробе-
    лов. Если "число" отсутствует, то -  пропуск символа.
    A0 - отмена режима A.
$

              Значения режимов по умолчанию
              -----------------------------
     Вызов программы без задания режимов эквивалентен вы-
    зову: PRPAGE <имя_файла> H72 D10 L80 V0 N0  R8  B0 X0
    )) $$ I0 Z0.

     Рекомендуется обращение  к  программе   осуществлять
    через (BAT) пакетный файл. Например, файл PRT.BAT:

     prpage %1 h88 L160-10 v x3 %2 %3 %4 %5

     При этом печать осуществляется по команде:
     PRT имя_файла

$
                  ПЕЧАТЬ ГРУППЫ ФАЙЛОВ
                  --------------------

     Программа позволяет печатать группу файлов, как один
    сплошной текст. Пример использования: распечатка всех
    командных (.bat) файлов.
     Если первый символ параметра имени  равен @ (ад-ком-
    мерческое) и файла с данным именем нет в текущей дир-
    ректории, то оставшаяся без @ часть  имени рассматри-
    вается, как имя файла, хранящего имена файлов группы.
    Каждое имя задано отдельной строкой.
     Перед каждым файлом в распечатке можно поместить его
    имя в виде << имя >>. Для этого  нужно  задать  режим
    z1. См. далее замечания.

$
               УПРАВЛЯЮЩИЕ СИМВОЛЫ ПЕЧАТИ
               --------------------------

     Программа осуществляет разбивку  на страницы по мере
    заполнения их строками текста в соответствии со  зна-
    чением параметра Н. При этом она вставляет строки ну-
    мерации, если задан режим N.

     Если в  тексте  обнаруживается  управляющий   символ
    печати, то в этом месте осуществляется  условный  или
    безусловный переход к  новой странице.

     Управляющий символ должен находиться в первой  пози-
    ции строки текста. Эта строка не печатается.

     Используются два  символа,  определяемые  режимами -
    ')' и '$' ("закрывающая скобка" и  "доллар").  Первый
    означает безусловный, второй - условный переходы.
     Далее при описании логики работы с управляющими сим-
    волами будем предполагать,  что их значение соответс-
    твенно равно ")", "$".

     Вслед за символом ")" может следовать необязательный
    текст числа. Например: )5
     Число, означает новый текущий номер страницы
     Примеры:
     )15
     )

     Символ ")" без числа не влияет на нумерацию.
$
     Символ '$' означает проверку числа строк, остающихся
    до конца страницы. Если задано '$' без  параметра, то
    число сравнивается со значением, задаваемым режимом R
    (см. выше). Если оно меньше указанного  значения,  то
    переход осуществляется. Если нет, -  продолжается за-
    полнение страницы текстом.

     Вслед за символом "$" может следовать необязательный
    текст, изображающий:
     - число
     - символ [
     - символ ].
     В первом случае  сравнение  величины остатка страницы
    осуществляется с данным числом.
     Остальные два случая помечают  соответственно начало
    и конец фрагмента, который должен быть размещен цели-
    ком без перехода на новую страницу.  Указателем конца
    фрагмента служит так же любой код,  содержащий символ
    $ в первой позиции строки. Таким образом,  если  весь
    текст состоит из неделимых фрагментов,  то достаточно
    расставить между ними управляющие строки вида $[.
     Примеры:
     $12
     $
     $[
     $]
$
           РЕДАКТИРОВАНИЕ РЕЖИМОВ
           ----------------------
     Режимы отображаются в первой строке экрана.
     Вход в редактирование осуществляется нажатием клави-
    ши F4 в режиме визуализации (V).
     Для редактирования доступны все  клавиши  управления
    курсором. Кроме того:
     ENTER - конец редактирования
     ESC   - отмена редактирования
     DEL   - удаление символа
     BKCSP - затирание символа
     F1    - подсказка режимов
     Если вносятся изменения в режимы,  то осуществляется
    переход к началу исходного текста.
$

          ВСТАВКА УПРАВЛЯЮЩИХ ESC-ПОСЛЕДОВАТЕЛЬНОСТЕЙ
          -------------------------------------------

     В режиме визуализации можно оперативно вставлять уп-
    равляющую информацию для принтера  непосредственно  в
    выводимый текст.
     Вставке подлежат фрагменты, заданные режимами P или Q.

     Формат режима P:
     Pkiiiiii...
     Здесь к - произвольный символ, играющий  роль  шифра
    текстовой последовательности iiii...
     iiii - "тело" ESC-последовательности, т.е. управляю-
    щая последовательность без самого кода ESC (27).
     Пример: PaW1 PbW0
     В примере шифр 'a' присвоен команде  начала  широкой
    печати, 'b' - команде отмены широкой печати.

     Формат режима Q:
     Qkxxyyzz...
     Все аналогично, за исключением того,  что последова-
    тельность задается в  шестнадцатиричном  изображении.
    На каждый символ - два знака.
     Пример:
     Qa5731 Qb5730

     Необходимо курсор подвести к желаемой позиции встав-
    ки и ввести односимвольный код  последовательности. В
    данном примере - 'a' или'b'.

     Символ шифра 'k' произволен, но есть исключения:
     Если k = '*' (звездочка), то тело  фрагмента (iii..)
    - это имя файла подсказки. Подсказки  -  произвольный
    текст, предназначенный, в основном, для описания шиф-
    ров ESC - последовательностей.  Подсказка  вызывается
    нажатием '*'.
     Если k = ']', то  данный  фрагмент  рассматривается,
    как второй член пары фрагментов и заносится  в  конец
    ближайшего справа слова.
     Пример: P1W1 P]W0
     В примере: если нажать клавишу '1', то в  месте рас-
    положения курсора вставится  команда  начала  широкой
    печати, а в конец ближайшего слова -  команда  отмены
    широкой печати.
     Если k = '.' (точка), то данный  фрагмент рассматри-
    вается, как продолжение предыдущего.
     Если k = '!'(восклицательный знак),  то  фрагмент  с
    шифром '!' автоматически заносится в начало  текста в
    начале печати.
     Пример:  p!(1004X  p.&l0O  p.&k10H p. &l8C
     В начало текста будет автоматически занесен код:
     E(1004XE&l0OE&k10HE&l8C, где Е обозначает символ ESC.
$

     Замечания
     ---------
     Стандартный символ перехода на страницу (код 12) об-
    рабатывается, как ")", вне зависимости от его положе-
    ния в строке.

     При использовании  режима  автонумерации управляющие
    символы рекомендуется размещать  лишь  в  тех  местах
    текста, которые обязательно должны печататься с нача-
    ла страницы (например, в начале разделов документа) и
    проверяться на вмещаемость в страницу (например, таб-
    лицы).

     Программа при старте анализирует свои  режимы после-
    довательно в порядке их задания в  командной  строке.
    Если дважды задан один и тот же режим, то активизиру-
    ется последнее его значение. При многократном задании
    режимов К и Y происходит  "накопление"  информации  о
    преобразованиях. Это можно учесть при  разработке ко-
    мандного (bat) файла.

     В некоторых конфигурациях ПЭВМ необходимо  явно ука-
    зывать выходной файл печати в виде fPRN (см. параметр
    f).

     Для того, чтобы каждый файл в группе файлов начинал-
    ся с новой строки, нужно заканчивать  текстовые файлы
    символами 'новая_строка' и 'перевод_каретки'.
     Файл имен группы файлов можно легко получить, напри-
    мер, в среде Norton Commander, воспользовавшись прог-
    раммой Ncsfp.com А.В.Полякова. В  операционной  среде
    Dos 5.0 для этой цели можно  воспользоваться командой
    Dir c параметром /B.

$

               ОГРАНИЧЕНИЯ
               ===========

     Размер листа не более 200 строк
     Ширина листа не более 320 символов.
     Размер межстраничного промежутка не  больше  размера
       листа минус 5.
     Размер отступа номера страницы не более ширины стра-
       ницы минус 5.
     Размер отступа от левого края листа не более 78 и не
       менее отрицательной величины ширины колонки.
     Число страниц выводимого документа не более 2000.
     Длина строки режимов - не более 160 символов.
     Размер текста подсказки пользователя - не более 2000
       символов.
     Размер периода в режиме S не более 256.


                  КОД ЗАВЕРШЕНИЯ
                  ==============
     0 - нормальное окончание
     1 - ошибка в режимах
     2 - выходной файл не создан
     3 - входной  файл не найден

    Автор благодарен А.Г.Берману, Л.Б.Буничу, Б.А.Летуче-
    му за ценные советы и содействие в отладке новых вер-
    сий.

                 - Конец текста -



