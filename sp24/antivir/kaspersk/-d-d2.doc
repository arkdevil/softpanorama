----------------------------------
		  For Sia Only ...
                                 
Адрес Касперского Евгения :      
  Москва, ул. Б.Академическая,   
  дом 73 корпус 3 кв. 11.         
                                 
----------------------------------




                                              'Доктор'  Е. Касперский
                                              -----------------------

   -D.COM  -  детектор вирусов, логических бомб и "троянских коней"
   ================================================================

	Детектор -D  - это  резидентно находящаяся  в памяти  программа,
которая  позволяет  выявлять  все  "подозрительные" действия компьютера:
изменение и переименование  выполняемых программ (.COM-  и .EXE-файлов),
запись на диск  по абсолютному адресу,  форматирование диска и  создание
резидентных программ.

	Детектор  может   быть  полезен   при  работе   с   программами,
подозрительными на наличие вируса или "троянского коня", при  разработке
резидентных программ и программ, работающих с диском посредством  записи
информации на диск по абсолютным адресам.  Детектор позволяет следить за
распределением  оперативной  памяти  компьютера  (окно  "Карта памяти" в
основном  меню  детектора)  и,  таким образом, своевременно обнаруживать
резидентные вирусы.  При помощи  меню детектора можно выбрать, на  какие
из возможных "подозрительных" ситуаций должен реагировать детектор.

	При   "подозрительном"    поведении   компьютера    -D    выдает
предупреждение (на  экране появляется  окно с  подробной информацией)  и
ждет  указания  на  разрешение  или  запрещение  данного  действия. Ниже
приводится полный список выдаваемых сообщений.

Внимание!  При   работе  в   графическом   видео-режиме   предупреждения
	   не    появляются,    компьютер    будет    выполнять    любые
	   "подозрительные" действия,  не спрашивая  разрешения на  них.
	   При работе  с графикой,  кроме того,  нельзя вызвать основное
	   меню детектора.


		   Список сообщений детектора -D.COM
		   ---------------------------------

	       1. Запись на диск по абсолютному адресу,
		   форматирование секторов на диске

       |------------------------------------------------------|
       |  program_name                                        |
       |  ЗАПИСЫВАЕТ (int 13) на диск X: nnnn секторов        |
       |  начиная с трека tttt, сектора ssss, головки hhhh    |
       |------------------------------------------------------|
       |  program_name                                        |
       |  ФОРМАТИРУЕТ (int 13) на диске X: nnnn секторов      |
       |  начиная с трека tttt, сектора ssss, головки hhhh    |
       |------------------------------------------------------|
       |  program_name                                        |
       |  ЗАПИСЫВАЕТ (int 40) на диск X: nnnn секторов        |
       |  начиная с трека tttt, сектора ssss, головки hhhh    |
       |------------------------------------------------------|
       |  program_name                                        |
       |  ФОРМАТИРУЕТ (int 40) на диске X: nnnn секторов      |
       |  начиная с трека tttt, сектора ssss, головки hhhh    |
       |------------------------------------------------------|
       |  program_name                                        |
       |  ЗАПИСЫВАЕТ (int 26) на диск X:                      |
       |  nnnn секторов начиная с mmmm-ого                    |
       |------------------------------------------------------|

	Данные   сообщения   сигнализируют   о   том,   что    программа
"program_name" пытается  записать на  диск один  или несколько секторов,
используя  абсолютную  адресацию  секторов  на диске или отформатировать
один  или  несколько  секторов  на  диске.   Эти  функции практически не
используются обычными программами (за исключением утилит форматирования,
оптимизации  и  восстановления  диска),  зато  используются   некоторыми
вирусами. Использование прерываний 13h, 40h, 26h является одним из самых
эффективных  способов  уничтожения  информации  на  диске,  в частности,
таблиц Disk Partition Table и File Allocation Table.

Внимание!  При сообщении о записи или форматировании секторов на диске с
	   использованием  прерываний  13h   и  40h  указывается   номер
	   физического  диска  ('A:'  -  первый,  'B:' - второй и т.д.).
	   Если винчестер  разбит на  несколько логических  дисков, то в
	   сообщении указывается один и тот же номер физического диска -
	   'B:',   если   установлен   один   флоппи-диск,   'C:',  если
	   установлено 2  флоппи-диска.   Для того,  чтобы выяснить,  на
	   какой   логический    диск   ведется    запись,    необходимо
	   проанализировать  таблицы  разбиения  диска  (Disk  Partition
	   Table) на всех логических дисках.



	  2. Изменение и переименование выполняемых программ
			 (.COM- и .EXE-файлов)

       |------------------------------------------------------|
       |  program_name                                        |
       |  пытается ОТКРЫТЬ (FCB,int 21,f.0F) файл             |
       |  file_name                                           |
       |------------------------------------------------------|
       |  program_name                                        |
       |  пытается ОТКРЫТЬ для ЗАПИСИ (int 21,f.3D) файл      |
       |  file_name                                           |
       |------------------------------------------------------|
       |  program_name                                        |
       |  пытается СОЗДАТЬ (FCB,int 21,f.16) файл             |
       |  file_name                                           |
       |------------------------------------------------------|
       |  program_name                                        |
       |  пытается СОЗДАТЬ (int 21,f.3C) файл                 |
       |  file_name                                           |
       |------------------------------------------------------|
       |  program_name                                        |
       |  пытается ПЕРЕИМЕНОВАТЬ (FCB,int 21,f.17) файл       |
       |  file_name                                           |
       |------------------------------------------------------|
       |  program_name                                        |
       |  пытается ПЕРЕИМЕНОВАТЬ (int 21,f.56) файл           |
       |  file_name                                           |
       |------------------------------------------------------|

	Эти сообщения  будут появляться  при любом  действии, ведущем  к
изменению  .COM-  или  .EXE-файлов   (открытие  для  записи,   создание,
изменение имени).   Подобные действия предпринимаются  практически всеми
вирусами (за  исключением вирусов,  распространяющихся по  BOOT-сектору)
при  инфицировании  файлов.   С  помощью  детектора  -D можно остановить
распространение компьютерного вируса на самой ранней стадии.



	   3. Попытка программы остаться резидентно в памяти

       |------------------------------------------------------|
       |  program_name                                        |
       |  пытается остаться РЕЗИДЕНТНО в памяти (int 21,f.31) |
       |------------------------------------------------------|
       |  program_name                                        |
       |  пытается остаться РЕЗИДЕНТНО в памяти (int 27)      |
       |------------------------------------------------------|

	Многие  вирусы  оставляют  в  памяти компьютера свою резидентную
часть, некоторые  из них  используют для  этого прерывания  DOS.  В этом
случае будет выдано сообщение о попытке программы остаться резидентно  в
памяти.  Остальные вирусы при создании в памяти своей резидентной  части
оперируют с таблицами  распределения памяти, в  этом случае детектор  не
сможет предотвратить инфицирование памяти (не файлов!) компьютера.



		     Управление детектором  -D.COM
		     -----------------------------

	После выдачи любого из описанных выше сообщений необходимо  либо
разрешить, либо запретить операцию, вызвавшую сообщение.  При разрешении
операции компьютер  продолжит выполнение  этой операции.  При запрещении
операции устанавливаются соответствующие указатели об ошибке  (например,
"файл не найден", "диск защищен от записи" и пр.) и происходит возврат в
программу, вызвавшую "подозрительную" операцию. Если при этом вызывающая
программа не проверяет правильность выполнения операции, то результат ее
дальнейшей работы непредсказуем.

	Некоторые  операции  выполняются   многократно  (например,   при
форматировани  или  оптимизации  диска).  В  этом случае удобно временно
отключить соответствующий режим, при этом не будут выдаваться  сообщения
об  отключенной  операции  (например,  при  форматировании  диска  нужно
отключить  режим   проверки  на   форматирование).  Отключение   режимов
производится  либо  вызовом  основного  меню,  либо  повторным  запуском
детектора.

	Вызов  основного  меню  осуществляется  одновременным   нажатием
клавиш Alt  и '-',  выход -  нажатием клавиши  ESC.   При вызове меню на
экране появляются два окна:  окно установки режимов и окно карты памяти.
Если по некоторым причинам войти  в меню невозможно, то детектор  подаст
звуковой сигнал.

	В  меню  установки  режимов  выводится  информация об активности
(включено - 'ДА', выключено  - 'НЕТ') режимов выявления  соответствующих
"подозрительных" операций.

		 |-----------------------------------|
                 |  Изменение .COM-файлов        ДА  |
                 |  Изменение .EXE-файлов       НЕТ  |
                 |  Переименование .COM-файлов  НЕТ  |
                 |  Переименование .EXE-файлов   ДА  |
                 |  Создание резидент            ДА  |
                 |  Форматирование сектора       ДА  |
                 |  Прямая запись сектора        ДА  |
                 |------------------------------------

	Перемещение  курсора  в  меню  осуществляется  при помощи клавиш
HOME,  END,  UP,  DOWN.  Необходимая настройка детектора устанавливается
клавишей RETURN (ENTER) .

	Отключить или включить режимы  можно также и повторным  запуском
детектора.   При этом  детектор находит  в памяти  компьютера свою ранее
загруженную копию и передает ей параметры, указанные в командной строке:

	C:>-D  [список параметров]

	Все параметры должны быть разделены пробелами и состоять из двух
символов:  первый - '+'  (включить) или '-' (выключить) режим,  второй -
номер  устанавливаемого  режима  (цифры  от  '1' до '7', соответствующие
строке  в  окне  меню  режимов).  Все  режимы,  не указанные в командной
строке, будут включены. Например, при запуске детектора строкой

	C:>-D -1 +2 +3 -4

будут включены все режимы, кроме 1-ого и 4-ого (изменение .COM-файлов  и
переименование .EXE-файлов).


			     Карта памяти
			     ------------

	Карта памяти  состоит из  пяти колонок.  Первая колонка является
сегментным  адресом  Блока  Распределения  Памяти  (MCB - Memory Control
Block), вторая - сегментным адресом Префикса Программного Сегмента  (PSP
-  Programm  Segment  Prefix),  третья  -  размер блока в параграфах (16
байт), четвертая - имя программы, занимающей блок памяти, или знаки  '?'
или '*' если имя не определено, пятая - используемые вектора прерываний.


                        Благодарю за использование детектора -D.COM !
		                             'Доктор'  E. Касперский.
					      12 февраля 1990 г.





	   Детектор  -D2.COM  -  дополнительные возможности
	   ================================================

	В  детектор  -D2,  кроме  вышеперечисленных, включены   функции:
просмотра состояний регистров в момент вызова меню детектора,  просмотра
значений векторов прерываний  и дампа памяти.  Стал возможен вызов  меню
детектора и при работе в графическом видео-режиме.

Внимание! При   вызове  основного   меню   детектора   из   графического
	  видео-режима произойдет стирание с экрана (и из  видео-памяти)
	  всей графической информации.   Однако возможность вызова  меню
	  из графики и просмотр дампа памяти существенно экономит  время
	  при анализе программ типа Larry.



			1. Состояния регистров
			----------------------

	В  окно  состояний  регистров  выводится информация о содержимом
регистров CS,DS,SS,ES, AX,BX,CX,DX,  DI,SI,BP, IP,SP и  регистра флагов.
Если  основное  меню  вызвано  при  появлении  на  экране  сообщения   о
"подозрительном"  действии  компьютера,  то  в  окно состояний регистров
выводится  содержимое   регистров  в   момент  выполнения    компьютером
"подозрительного"  действия.  В  противном   случае  в  окно   выводится
состояние регистров в момент нажатия клавиш Alt и '-'.

	Выход из окна состояний регистров - клавишей ESC.


			 2. Вектора прерываний
			 ---------------------

	В  окно  векторов  прерываний  выводится  информация  о векторах
прерываний:   номер    прерывания,    значение   вектора    в    формате
"сегмент:смещение"  и  имя  программы  или  системной области памяти, на
которую указывает вектор прерывания.

	Перемещение в окне осуществляется  при помощи клавиш   UP, DOWN,
PGUP, PGDN, HOME, END.  Выход из окна - ESC.


			    3. Дамп памяти
			    --------------

	В окно дампа памяти выводится в текстовом или  шестнадцатиричном
виде  информация  о  содержании  оперативной  памяти  компьютера.  Выбор
необходимого  участка  осуществляется   либо  перемещением  в   пределах
текущего сегмента  при помощи  клавиш UP,  DOWN, PGUP,  PGDN, HOME, END,
либо указанием начального адреса участка при помощи клавиш LEFT,  RIGHT,
'0'-'9', 'A'-'F'.

	Смена  режима  просмотра  памяти   "текстовой/шестнадцатиричный"
производится нажатием клавиши F3.

	Поиск строки по  шаблону осуществляется из  меню поиска (вход  в
меню  -  F7).  В  меню  задается  строка-шаблон  в шестнадцатиричном или
текстовом виде,  адрес начала  и конца  участка памяти,  в котором будет
производиться поиск. Если строка не обнаружена, то на экран будет выдано
сообщение "строка не найдена".

	Выход из окна дампа памяти - клавишей ESC.


                       Благодарю за использование детектора -D2.COM !
		                             'Доктор'  E. Касперский.
					      14 марта 1990 г.

