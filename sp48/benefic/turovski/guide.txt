           Системная утилита FILTER (версия 1.00) для компьютеров
                IBM PC/XT, PC/AT, PS/2 и совместимых с ними,
                        операционной системы MS-DOS

                          РУКОВОДСТВО ПОЛЬЗОВАТЕЛЯ


                                 Содержание

   1. Назначение
   2. Концепция утилиты
   3. Технические характеристики
   4. Состав дистрибутивной дискеты
   5. Установка и запуск
   6. Пользовательский интерфейс
   7. Рекомендации по эффективному применению утилиты


   1. Назначение

   FILTER - системная утилита для работы в среде MS-DOS. Осуществляет
   мультифайловый поиск фрагментов текстовой информации заданного формата
   (записей), которые, в зависимости от наличия в них нескольких (до 15)
   произвольных последовательностей символов (ключевых слов),
   удовлетворяют заданному логическому условию, объединяющему эти
   ключевые слова (в качестве операндов) посредством операторов
   (И/ИЛИ/НЕ) и скобок.


   2. Концепция утилиты

   Тексты (делопроизводство, досье, картотеки, словари, справочники,
   руководства, описания, инструкции, программные "исходники", ...)
   хранятся в компьютере в виде файлов. Текстовый файл - это
   последовательность символов из расширенного набора ASCII (American
   Standart Code for Information Interchange; Американский стандартный
   код для обмена информацией). В ASCII каждый из 256 символов имеет
   оригинальный номер. Например, для большой буквы "S" ASCII = 83, для
   пробела ASCII = 32, для цифры "1" ASCII = 49. В ASCII существуют
   символы, которые используются в текстовых файлах как служебные.
   Например, последовательность двух символов с ASCII = 13 и 10 (в
   литературе часто обозначаемая CR-LF) встречается всякий раз там, где
   заканчивается строка текста. Эти два символа являются "невидимыми",
   поскольку при редактировании текста или его печати они не выводятся.
   Они лишь сигнализируют программе об окончании очередной строки. Когда
   при наборе текста мы нажимаем клавишу Enter, в создаваемый текстовый
   файл попадает комбинация CR-LF.

   Согласно нашей концепции, любой текстовый файл условно состоит из
   следующих друг за другом записей - последовательностей символов
   переменной длины, которые завершает характерная цепочка символов, так
   называемый разделитель. Отличительным свойством концепции является
   возможность выбора типа записи путем задания разделителя произвольной
   длины непосредственным вводом составляющих его символов. Например,
   если в качестве записей мы хотим представить строки текста, то
   разделителем сделаем комбинацию CR-LF. Таким образом, один и тот же
   текст без каких-либо преобразований может быть представлен состоящим
   из записей разных типов: слов, строк, предложений, абзацев, страниц,
   разделов, глав, ... Что выбрать в качестве разделителя - решается в
   конкретной ситуации. Последняя запись файла не содержит разделителя,
   его роль играет признак конца файла. Если в файле нет ни одного
   экземпляра заданного разделителя, то весь файл представляет собой одну
   запись. Количество записей в файле на единицу больше числа
   встретившихся в нем разделителей.

   Наша концепция предоставляет инструмент, позволяющий из всей
   совокупности записей выделить лишь те, которые в определенном
   сочетании содержат (не содержат) несколько (до 15) интересующих нас
   произвольных последовательностей символов (ключевых слов). Для этого
   задается логическое условие, объединяющее эти ключевые слова (в
   качестве операндов, принимающих значение ИСТИНА или ЛОЖЬ в зависимости
   от наличия ключевого слова в записи) посредством операторов И/ИЛИ/НЕ и
   скобок. Скобки, группирующие операнды, влияют на порядок
   доказательства истинности условия. Пример (запрос к библиотечной
   картотеке с целью получения списка статей об операционных системах для
   локальных сетей фирм Microsoft или Novell):

                 "локальные сети" И "операционная система"
                        И ("Microsoft" ИЛИ "Novell")

   Если запись соответствует условию, она считается активной. Результат
   работы программы - создание файла (отчета), содержащего активные
   записи и необходимую сопутствующую информацию (из каких файлов взяты
   записи, статистика, нумерация записей, ...).


   3. Технические характеристики

   Утилита ориентирована на компьютеры IBM PC/XT, PC/AT, PS/2 и
   совместимые с ними, версию DOS 3.0 или более поздние версии,
   использует 80 Кбайт оперативной памяти.

   Представляет собой исполняемый файл filter.exe и файл filter.ini, в
   котором сохраняется текущая конфигурация утилиты.

   Количество обрабатываемых файлов, находящихся в различных директориях,
   максимальная длина файла, количество записей, максимальный размер
   записи лимитируются только параметрами DOS.

   Необходимость резервирования на диске места для служебной информации
   отсутствует. Следует позаботиться лишь о возможности размещения файла
   с выходными данными, так как контроль на переполнение диска в целях
   повышения производительности не предусмотрен.

   Гарантируется целостность обрабатываемых файлов, поскольку они
   открываются в режиме "только для чтения" ("read only").

   Не существует каких-либо ограничений на тип файла и характер
   содержащейся в нем информации, однако следует учесть, что утилита
   "идеологически" ориентирована на работу с текстовыми данными.

   Максимальное количество ключевых слов в логическом выражении - 15.

   Максимальная суммарная длина ключевых слов и разделителя - 126
   символов.

   Нестрогий контроль высоты букв ориентирован на латинские и русские
   буквы (альтернативная кодировка).

   Производительность мультифайлового поиска средней сложности при работе
   на AT 286/12 MHz (с Overall Performance Index 5.8, полученным
   программой SYSINFO из Norton Utilities 6.0) составляет 8 Мбайт/мин.


   4. Состав дистрибутивной дискеты

        readme.1st
        filter.exe     утилита
        guide.txt      руководство пользователя (этот файл)


   5. Установка и запуск

   Для установки утилиты достаточно скопировать с дистрибутивной дискеты
   файл filter.exe на винчестер в любой удобный для пользователя
   директорий. Запуск производится по правилам DOS, ввод параметров в
   командной строке не предусмотрен. После первого использования утилиты
   в одном с filter.exe директории автоматически создается файл текущей
   конфигурации filter.ini.

   Рекомендация использующим Norton Commander. Поместите вызов утилиты в
   User Menu, для чего добавьте в файл nc.mnu следующее (filter.exe
   находится в директории C:\FILTER):

   F:   F I L T E R
        c:\filter\filter

   В результате запуск утилиты можно будет осуществить, находясь в любом
   директории, нажатием клавиш "F2" и "F".


   6. Пользовательский интерфейс

   После запуска программы на экране появляется единственный рабочий
   кадр. Верхние четыре строки заняты рекламной информацией.

   Следующие несколько строк представляют собой табло для вывода
   разнообразных сообщений о работе программы. Слева расположены счетчики
   количества обработанных файлов и записей (общего и активных). Под
   активным файлом понимается такой файл, в котором есть хотя бы одна
   активная запись. Имена всех активных файлов выводятся в отчет в виде:

        ** FILTER 1.00 ** <путь\ имя файла>,

   что позволяет при просмотре результатов определить, из какого именно
   файла взяты те или иные записи.

   Во время поиска на экране сменяются имена просматриваемых файлов.

   Альтернативным цветом могут выводиться 19 различных диагностических
   сообщений, некоторые из которых описаны ниже по ходу изложения.

   Оставшуюся часть рабочего кадра занимает меню, посредством которого
   осуществляется управление работой программы. Оно состоит из десяти
   разделов:

   A. Маска исследуемых файлов        F. Строгий контроль высоты букв
   B. Имя файла-приемника             G. Поиск в поддиректориях
   C. Разделитель записей             H. Копирование активных записей
   D. Логическое условие              I. Вывод пофайловой статистики
   E. Старт                           J. Вывод номеров записей

   Текущий раздел выделяется рамкой. Выбор необходимого раздела
   производится клавишами управления курсором. Предусмотрено круговое
   движение по меню.

   Выход из программы может быть произведен в любой момент (включая время
   поиска) нажатием клавиши Esc.

   Разделы A - D используют одну и ту же процедуру ввода строки данных в
   поле, выделенное альтернативным цветом. Эта процедура имеет
   особенность, вызванную спецификой ввода данных программы. Нажатие
   Enter приводит к появлению в соответствующем месте редактируемой
   строки комбинации CR-LF (смотри раздел "Концепция утилиты"), которая
   для лучшего восприятия отображается (и только!) двумя другими
   символами.

   Символы, отсутствующие на клавиатуре, могут быть введены посредством
   Ctrl-комбинаций (например, Ctrl-L) или так называемого Alt-ввода с
   использованием дополнительной цифровой клавиатуры по схеме:

        - нажимается (и не отпускается) клавиша Alt;
        - нажимаются поочередно клавиши с цифрами, соответствующими коду
   вводимого символа, например, 1, 9, 6;
        - отпускается нажатая клавиша Alt.

   Редактирование строки осуществляется клавишами:

              Клавиша                       Функция

               Стрелка влево     перемещение курсора на позицию влево
               Стрелка вправо    перемещение курсора на позицию вправо
               Home              перемещение курсора в начало строки
               End               перемещение курсора в конец строки
               Del               удаление символа, на котором установлен
                                 курсор
               BackSpace         удаление символа слева от курсора
               Alt-K             удаление строки целиком
               Alt-L             удаление части строки от
                                 курсора до конца
               Стрелки
               вверх, вниз       выход из процедуры редактирования с
                                 сохранением введенной строки и переход
                                 к новому разделу меню

   Необходимо отметить, что по выходе из процедуры редактирования в
   случае, если строка была изменена, производится специфический для
   каждого раздела контроль корректности данного. Если обнаруживается
   ошибка, выводится соответствующее диагностическое сообщение и перехода
   к новому разделу меню не происходит. Предоставляется возможность
   исправить строку. Если пользователь все же желает покинуть раздел без
   исправлений, программа далее не препятствует ему.

   Длина вводимой строки не лимитируется размером поля ввода, так как
   реализована возможность горизонтального скроллирования.

   Функция ввода строки выдает статусную информацию над вводимой строкой
   справа:

      Поз = <число>                        текущая позиция в строке
      ASCII = <число дес.>(<число шестн.>) десятичный и 16-ричный
                                           ASCII текущего символа
                                           (0 означает конец строки).

   Разделы меню F - J позволяют установить некоторые параметры работы
   программы (описаны ниже) путем выбора между ДА и НЕТ, который можно
   сделать любой клавишей, отличной от клавиш управления курсором.

   Назначение и описание разделов меню

   A. Маска исследуемых файлов

   Вводится строка в формате [ <маршрут>\ ] <шаблон>. Маршрут и шаблон
   являются понятиями DOS, их толкование имеется в справочнике по MS DOS.
   Мы ограничимся примерами шаблонов:

      *.*           все файлы директория;
      pcx*.doc      все файлы с именами, начинающимися с pcx типа doc;
      a?.*          все файлы, имена которых начинаются с a и состоят         
                    из одной или двух букв.

   Отметим, что контроля правильности ввода маски исследуемых файлов не
   производится, поэтому в случае ошибки необходимые файлы просто не
   будут найдены, что засвидетельствует 0 на счетчике числа обработанных
   файлов.

   B. Имя файла-приемника

   В этот файл FILTER помещает результаты своей работы (отчет).

   Если файл с указанным именем существует, FILTER задает вопрос: "Файл
   существует. Перезаписать?". В случае положительного ответа (нажатие
   Enter, когда альтернативным цветом выделено "ДА"; выбор между "ДА" и
   "НЕТ" - любая другая клавиша) содержимое файла теряется.

   В случае задания неправильного маршрута или имени файла, а также
   других причин, не позволяющих создать указанный файл, выдается
   сообщение "Невозможно открыть файл".

   C. Разделитель записей

   В этом разделе просто задается цепочка символов, являющаяся окончанием
   записи. Единственное условие - чтобы ее длина была хотя бы 1 символ. О
   том, какие разделители лучше использовать, смотри раздел "Рекомендации
   по эффективному применению утилиты".

   D. Логическое условие

   Существует строго контролируемый синтаксис, а именно:

        - ключевые слова заключаются в двойные кавычки (символ ");
        - ключевое слово может содержать любой символ, кроме двойных
   кавычек;
        - ключевые слова как операнды логического выражения соединяются
   операторами И (символ &) и ИЛИ (символ |);
        - перед ключевым словом как операндом может стоять оператор НЕ
   (символ ~);
        - доказательство логического выражения производится с учетом
   принятых для операторов И/ИЛИ/НЕ приоритетов (наивысший - у НЕ,
   наименьший - у ИЛИ), которые могут быть изменены путем использования
   куглых скобок;
        - пробелы вне двойных кавычек игнорируются, любые другие символы
   (кроме & , | , ~) не допускаются.

   Кроме того, имеются ограничения, указанные в разделе "Технические
   характеристики".

   Пример записи в нотации FILTER логического условия из раздела
   "Концепция утилиты":

                 "локальные сети" & "операционная система"
                         & ("Microsoft" | "Novell")

   E. Старт

   Если вы корректно ввели данные разделов A - D, то нажатие Enter начнет
   обработку, которая закончится с выдачей сообщения "Фильтрация данных
   завершена".

   F. Строгий контроль высоты букв

   При строгом контроле (ДА) не будет зафиксировано совпадение слов
   "Иванов" и "ИВАНОВ", а при нестрогом - будет. Эта функция
   ориентирована как на латинские, так и на русские буквы (альтернативная
   кодировка).

   G. Поиск в поддиректориях

   В случае ДА в поиск будут включены все поддиректории, выходящие из
   заданного в разделе меню A посредством <маршрут> (из текущего
   директория DOS, если <маршрут> не был указан). Глубина входа в
   поддиректории не ограничивается одним уровнем.

   H. Копирование активных записей

   При ДА активные записи копируются в отчет в том виде, в котором они
   представлены в оригинале. По необходимости это можно отменить.

   I. Вывод пофайловой статистики

   После того, как закончена обработка очередного файла и выяснилось, что
   он активный, в отчет выводится (если установлено ДА) строка:

        [В файле записей: всего - <число>, активных - <число>]

   J. Вывод номеров записей

   Каждую активную запись в отчете может сопровождать пара чисел в виде:

        [<число_1>:<число_2>],

   где  число_1 - порядковый номер записи в исходном файле;
        число_2 - порядковый номер записи в отчете.


   7. Рекомендации по эффективному применению утилиты

   Содержимое раздела носит характер советов, а не обязательных к
   выполнению правил. Он призван сообщить пользователю начальный толчок и
   способствовать более глубокому пониманию нашей идеи.

   Обладатель утилиты FILTER будет применять ее для обработки двух
   категорий текстов, различающихся по своему происхождению. К первой
   категории относятся уже имеющиеся, получаемые со стороны и
   сканированные тексты. Опыт показывает, что такие базы могут достаточно
   эффективно обрабатываться в том виде, в котором были в свое время
   подготовлены. Однако в ряде случаев для повышения эффективности
   использования FILTER желательна предварительная "доводка" баз
   текстовым процессором, причем главная операция, как правило, -
   контекстный поиск и замена. Поэтому используйте текстовый процессор с
   широким спектром подобных функций.

   Вторая категория - все тексты, создаваемые вами после принятия на
   вооружение концепции FILTER. Мы хотим специально подчеркнуть сочетание
   "все тексты", поскольку, во-первых, заранее неизвестно, какие из них
   будут подвергаться обработке, а во-вторых, строгость, единообразие и
   хороший стиль в оформлении документов ценились во все времена.

   Каким образом лучше всего разместить базу по определенной тематике? В
   отдельном директории, разбив ее по смыслу на файлы приемлемого
   размера. Каков приемлемый размер файла? На этот счет у каждого
   пользователя уже сложились свои представления, но все же рискнем
   указать примерный диапазон: 4 - 300 Кбайт. Что касается FILTER, то для
   него это значения не имеет. Если база очень большая (от нескольких
   Мбайт до десятков Мбайт), разместите файлы в нескольких директориях,
   имеющих общий директорий верхнего уровня.

   Порядок организации файла - произвольный по вашему усмотрению. Главный
   девиз - строгость и единообразие. Избегайте переносов, если есть
   вариант, что переносимое слово впоследствии станет ключевым.
   Устойчивое словосочетание, выступающее в качестве ключа, в тексте
   располагайте в одной строке, слова отделяйте раз и навсегда
   установленным числом пробелов. Учтите, что операции форматирования
   могут это число изменять. Используйте в качестве ключевых слова без
   окончаний.

   Рассмотрим типичные варианты записей и особенности работы с ними.

   Слово. Разделитель - пробел. Если слова в тексте отделены несколькими
   пробелами, то среди записей окажутся состоящие из одного пробела. Этот
   недостаток преодолевается предварительным исключением лишних пробелов.
   Если одно слово заканчивает строку, а другое начинает следующую, оба
   они попадут в одну запись. Этого можно избежать, начиная каждую строку
   текста с пробела.

   Строка. Разделитель - CR-LF.

   Предложение. Разделитель - точка. Если вы знаете, что в тексте имеются
   предложения, заканчивающиеся символами ? или !, замените их на точки.
   Если есть многоточия, удалите их и т.д.

   Абзац. Разделитель - CR-LF плюс число пробелов, хотя бы на один
   превышающее размер отступа обычной (не красной) строки. Если в тексте
   есть строки, напечатанные с большим отступом, они, увы, также будут
   восприняты как отдельные абзацы. Есть и другой, более эффективный
   подход к организации абзацев - отделение их друг от друга пустой
   строкой. Тогда разделитель - CR-LF-CR-LF. Пустая строка - едва ли не
   самый лучший способ разделения записей!

   Страница. Разделитель - ASCII = 12 (если текст разбит на страницы
   соответствующими символами).

   Раздел. Если перед вами готовый текст, посмотрите, как оформлены
   разделы. Возможно, они начинаются словом "РАЗДЕЛ". Смело используйте
   его в роли разделителя. Если сами создаете текст, отделяйте разделы
   каким-нибудь специальным сочетанием символов (в частности, двумя
   пустыми строками).

   Помните, что утилита не только копирует активные записи, но и
   подсчитывает количество активных и общее количество записей.
   Используйте это для проведения необходимых статистических исследований
   типа "Cколько в тексте абзацев?", "Сколько предложений с частицей
   бы?", "Сколько слов с буквой Ф?", ...

   Имейте также в виду, что можно скопировать и пассивные записи,
   поставив перед всем условием, взятым в скобки, НЕ ( ~ ).

   В качестве имени файла приемника могут выступать стандартные имена
   DOS, например:

        prn - копирование на принтер;
        nul - копирование "в никуда".

