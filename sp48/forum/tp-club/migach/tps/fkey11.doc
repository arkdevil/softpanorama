


                        F K E Y    V  1.1

            Модуль определения процедур по функциональным
                            клавишам

                     (c) 1990, Мигач Ярослав



                1. Общие сведения.

        Основная  часть модуля это обьект по управлению
   функциональной клавиатурой. Внедряя этот обьект в свои
   программы пользователь имеет возможность определять и
   переопределять любые свои процедуры, которые будут выполнятся
   при нажатии на клавиатуре заранее оговоренных функциональных
   клавиш. Fkey11 позволит повысить гибкость МО поскольку все
   назначения и переназначения производятся по ходу выполнения
   программы. Имеется также возможность сохранять старые
   назначения в стеке и затем при необходимости восстанавливать
   их оттуда. Целесообразно использовать Fkey везде, где имеется
   обращение к процедурамм ввода информации с клавиатуры.
   Написанные таким образом программы легко поддаются
   модификации. Достаточно лишь написать новые процедуры и
   подключить их к своей программе при помощи обьекта по
   управлению функциональной клавиатурой.
        Для удобства работы в рассматриваемом модуле определены
   символьные константы, соответствующие кодам функциональных
   клавиш. Например: клавише F1 соответствует символьная
   константа с именем f1. Одновременному нажатию клавиш Shift и
   F1 соответствует константа Shift_f1. Аналогично определены
   Alt_f1, Ctl_f1. В последнем разделе данного руководства
   приведен весь список установленных констант.




                2. Требования к окружению.

        Программа написана на языке Turbo Pascal 5.5 с
   применением обьектно-ориентированных элементов
   программирования и оформлена в виде TPU модуля. Применять
   модуль FKEY11.TPU можно только в среде Turbo Pascal 5.5.
        Для подключения к программе пользователя необходиы
   модули System, Crt из стандартной библиотеки TURBO.TPL, а 
   также модуль Def из "TURBO PASCAL SUPPORT". Подключение к 
   программе пользователя производится следующим образом:

        USES Crt, Def, Fkey11, ... ;

        Каждый из инициируемых обьектов управления по
   функциональной клавиатуре требует приблизительно 2 кбайт
   динамически распределяемой области памяти, независимо от
   того используется передача параметров или нет.




                3. Руководство программиста.


        3.1. Замечания по работе с обьектами модуля Fkey11.

        Обьекты по управлению функциональной клавиатурой
   обьявить в программе можно следующим образом:

        VAR
           keys1, keys2 : Control_Func_Key;

         . . . . . . . . . . . . . . . . .

        Вызов  той или иной процедуры или функции обьекта
   осуществляется путем написания имени обьекта и через точку -
   имени процедуры или функции. Например :

        keys1.Init;
        keys2.Init;

   инициализирует соответственно обьекты keys1 и keys2 при
   помощи процедуры Init.
        Для более подробного знакомства с правилами обьектного
   программирования следует прочитать первую главу справочного
   руководства программиста по системе программирования Turbo
   Pascal 5.5, а также просмотреть примеры программ,
   иллюстрирующих работу модуля Fkey11.

        Внимание ! Вызов процедуры Init обязателен до
        ^^^^^^^^^^ использования обьекта типа Cntrol_Func_Key

        Освобождение динамической памяти из под использованного
   обьекта производится при помощи вызова процедуры

        Done;

        Внимание ! Использование процедуры Done обязательно
        ^^^^^^^^^^ при прекращении работы с обьектом. Перед
                   завершением программы для всех используемых
                   обьектов необходимо выполнить процедуры Done.
                   В противном случае при возврате из основной
                   программы возможны конфликты с операционной
                   системой.


        3.2. Описание процедур и функций.


        Процедура:

        Set_Key ( key, NameProc );

   устанавливает процедуру по заданной функциональной клавише
   key / символ типа CHAR /. NameProc - имя процедуры которая
   будет выполнена при нажатии на клавиатуре символа key. такая
   процедура должна удовлетворять следубщим требованиям:

        1. Она не должна иметь параметров.
        2. Процедура не должна быть вложенной.
        3. Процедура должна быть странслированна
           при установленной директиве {$F+} или
           обьявлена в интерфейсной секции.

   Невыполнение одного из изложенных требований приведет к
   ошибке трансляции программы, включающей в себя модуль Fkey11.
   Пример такой процедуры приведен в тестовом примере TESTS.PAS

        Получить указатель на установленную процедуру для
   заданной функциональной клавиши позволяет процедура

        Get_Key ( key, PointProc );

   Передаваемые параметры аналогичны процедуре Set_Key.

        При помощи процедуры

        Set_Param ( num, parameter, size );

   можно установить параметр с заданным номером, для
   последующего использования этого параметра в процедуре
   вызванной по нажатию одной из функциональных клавиш.
   Num - номер устанавливаемого параметра. Принимает значения от
   0 до 255. Parametr - сам устанавливаемый параметр, который
   может быть переменной любого типа. Size - количество байтов
   выделяемых под переменную parametr.

        Процедура

        Get_Param ( num, parametr );

   позволяет получить параметр с заданным номером. Num и
   Parametr такие же как и в предыдущем случае.



        Процедура

        Push_Clear;

   сохраняет назначения текущего обьекта в "стеке" и создает
   новое поле для назначений процедур во функциональным клавишам
   для текущего обьекта с очисткой всех предшествовавших
   назначений.

        Процедура

        Push_Save;

   сохраняет назначения текущего обьекта в "стеке" и создает
   новое поле для назначений процедур по функциональным клавишам
   для текущего обьекта с дублированием в это поле всех
   предшествующих назначений.

        Процедура

        Pop;

   вщсстанавливает из "стека" все предыдущие назначения в том
   случае, если "стек" не пуст.

        Исполнить по заданной клавиши ранее установленную
   процедуру позволит

        Run_For_Key ( key );

   где key символьная переменная соответствующая
   идентифицируемой клавише.

        Функцию

        Run_Char

   можно использовать вместо ReadKey с той лишь разницой, что
   при нажатии на клавишу, по которой установлена процедура,
   произойдет выполнение этой процедуры, а затем, только возврат
   из Run_Char



                4. Краткий справочник по процедурам,
                      функциям и константам.


   Имя                     Назначение                Параметры

   ___________________________________________________________

   Init         инициализация обьекта                нет
   ___________________________________________________________

   Set_Key      установка процедуры          key : CHAR;
                                             NameProc :
                                                 func_proc
   ___________________________________________________________

   Get_Key      получение процедуры          key : CHAR;
                                             VAR NameProc :
                                                 func_proc
   ___________________________________________________________

   Set_Param    установка параметра          num : BYTE;
                                             VAR param;
                                             size : WORD
   ___________________________________________________________

   Get_Param    получение параметра          num : BYTE;
                                             VAR param
   ___________________________________________________________

   Push_Clear   сохранить и очистить               нет
   ___________________________________________________________

   Push_Save    сохранить и оставить               нет
   ___________________________________________________________

   Pop          восстановить назначения            нет
   ___________________________________________________________

   Run_For_Key  исполнить процедуру           key : CHAR
   ___________________________________________________________

   Run_Char     получить символ и исполнить        нет
   ___________________________________________________________

   Done         уничтожить обьект                  нет
   ___________________________________________________________


     Имя        Клавиша                 Имя        Клавиша
  константы                          константы

     f1           F1                 Shift_f1   Shift + F1
     f2           F2                 Shift_f2   Shift + F2
     f3           F3                 Shift_f3   Shift + F3
     f4           F4                 Shift_f4   Shift + F4
     f5           F5                 Shift_f5   Shift + F5
     f6           F6                 Shift_f6   Shift + F6
     f7           F7                 Shift_f7   Shift + F7
     f8           F8                 Shift_f8   Shift + F8
     f9           F9                 Shift_f9   Shift + F9
     f10          F10                Shift_f10  Shift + F10

     Ctl_f1   Ctl + F1               Alt_f1     Alt + F1
     Ctl_f2   Ctl + F2               Alt_f2     Alt + F2
     Ctl_f3   Ctl + F3               Alt_f3     Alt + F3
     Ctl_f4   Ctl + F4               Alt_f4     Alt + F4
     Ctl_f5   Ctl + F5               Alt_f5     Alt + F5
     Ctl_f6   Ctl + F6               Alt_f6     Alt + F6
     Ctl_f7   Ctl + F7               Alt_f7     Alt + F7
     Ctl_f8   Ctl + F8               Alt_f8     Alt + F8
     Ctl_f9   Ctl + F9               Alt_f9     Alt + F9
     Ctl_f10  Ctl + F10              Alt_f10    Alt + F10

     Arrow_down   указатель вниз
     Arrow_up     указатель вверх
     Arrow_left   указатель влево
     Arrow_right  указатель впрвво
     Page_down    PgDn
     Page_up      PgUp
     Key_home     Home
     Key_end      End
     Key_ins      Ins
     Key_del      Del

     Shift_tab        Shift + Tab
     Ctl_Arrow_left   Ctl +  указатель влево
     Ctl_Arrow_right  Ctl +  указатель вправо
     Ctl_Page_up      Ctl +  PgUp
     Ctl_Page_down    Ctl +  PgDn
     Ctl_Key_end      Ctl +  End
     Ctl_Key_home     Ctl +  Home


     Alt_Q    Alt +  Q          Alt_F     Alt +  F
     Alt_W    Alt +  W          Alt_G     Alt +  G
     Alt_E    Alt +  E          Alt_H     Alt +  H
     Alt_R    Alt +  R          Alt_J     Alt +  J
     Alt_T    Alt +  T          Alt_K     Alt +  K
     Alt_Y    Alt +  Y          Alt_L     Alt +  L
     Alt_U    Alt +  U          Alt_Z     Alt +  Z
     Alt_I    Alt +  I          Alt_X     Alt +  X
     Alt_O    Alt +  O          Alt_C     Alt +  C
     Alt_P    Alt +  P          Alt_V     Alt +  V
     Alt_A    Alt +  A          Alt_B     Alt +  B
     Alt_S    Alt +  S          Alt_N     Alt +  N
     Alt_D    Alt +  D          Alt_M     Alt +  M














