                    ╔═══════════════════════════════════╗		
		    ║    Драйвер дисплея и клавиатуры   ║
		    ║	            KEYRUS	        ║
		    ╚═══════════════════════════════════╝
			
	
  Драйвер KEYRUS является драйвером клавиатуры/монитора, который
поддерживает русскую клавиатуру и символы кириллицы в различных режимах
разрешения текстового или графического экрана на таких графических
адаптерах, как EGA , VGA , PVGA , EGA mono , CGA и MDA ( с зашитым в BIOS
русским фонтом ). При этом в оперативной памяти драйвер занимает от 1 до 7
килобайт.

Достоинства драйвера :
     В оперативной памяти резидентная часть занимает 1 - 7.5 килобайт
 ( в зависимости от конфигурации ). 
     Драйвер можно выгружать из памяти с помощью популярной программы RELEASE.
     В русском режиме клавиатуры поддерживается рамка.
     Пользователь может при запуске определить драйверу любую конфигурацию.
     Можно настроить конфигурацию так, что драйвер будет поддерживать русские
 символы в графических режимах.
     Драйвер поддерживает шрифты 8x8, 8x14, 8x16 в текстовых ( можно и в 
 графических ) режимах при наличии видео карт EGA или VGA ( PVGA ).
     При использовании драйвера, на клавиатуре без проблем набираются такие
 символы, как русское "р" и др. ( За исключением программы 
 Norton Commander , которая в этом отношении работает несколько 
 некорректно - она просто "отбрасывает" символ 'р', введенный с клавиатуры.
 Можно очень просто исправить этот недостаток - см. примечание в конце 
 документации ).

О всех обнаруженных недостатках прошу сообщать автору программы.
	
				Гуртяк Дмитрий Александрович
				340048 г. Донецк ул. Артема 147 "г" кв. 23
		    		тел. 55-78-52 

			   Запуск драйвера		
			   ───────────────
			   
        KEYRUS < список ключей >
	
   Возможные ключи :
      /COLOR=<цвет>		- указать цвет рамки.
      /FONT=<файл>	 	- загрузить пользовательский фонт.
      /KEYS=<файл>		- загрузить пользовательскую клавиатуру.
      /GRAPH=<флаг>		- определить переключатель псевдографики.
      /SCAN=<скэнкод>		- определить клавишу для переключения Рус\Лат.
      /EXT			- используется совместно с /scan (см. дальше)
      /ROM			- указать на зашитый в BIOS фонт. 
      /128			- указать на конфигурацию 128 символов.
      /ALL			- указать на конфигурацию всех символов.
      
	Все параметры можно указывать в произвольном порядке      
	
	например :	KEYRUS /color=12
			KEYRUS /keys=kbd /graph=12
			KEYRUS /color=16 /font=vga.fnt /all /scan=58
			
	По умолчанию используется следующая конфигурация :
	
	клавиша переключения режимов Рус\Лат - Right SHIFT.
	цвет рамки - синий ( 1 ).
	клавиша переключения на псевдографику - Alt.
	Драйвер подгружает рисунок не всех символов, а только русской 
	части таблицы ASCII кодов, т.е. смволов 'А'-'п','р'-'я','Ё'-'ё'.
	При этом русские символы в графическом режиме не поддерживаются.
			   

		Более подробное описание ключей драйвера.
		─────────────────────────────────────────

   /Color=<цвет>   - указать цвет рамки в русском режиме клавиатуры.
   ─────────────     По умоланию - 1 ( синий ).
	Для адаптера EGA от 0 до 63, для CGA от 0 до 15, 
	для VGA,PVGA от 0 до 256, для монохромных адаптеров рамка не
	отображается.

   /Font=<файл>	   - Загрузить файл со шрифтом пользователя.
   ────────────	     допустимы фонты 3-х типов :
	8x8  ( CGA )   размер файла 2048 ( файлы CGA.FNT, CGA1.FNT )
	8x14 ( EGA )   размер файла 3584 ( файлы EGA.FNT, EGA1.FNT, BETA.FNT )
	8x16 ( VGA )   размер файла 4096 ( файлы VGA.FNT, VGA1.FNT )

	Можно одновременно загрузить 2 файла :
	Например : keyrus /font=cga.fnt /font=ega.fnt загружает
	один файл для фонта 8x8, другой - для фонта 8x14.
	При запуске драйвера фонт 8x8 грузится всегда, а из фонтов
	8x14 и 8x16 грузится только один, в зависимости от видеоадаптера.
		
   /Keys=<файл>	   - Загрузить файл с клавиатурой пользователя.
   ────────────	     вы можете задать расположенин клавиш, отличное
	от стандартного. Размер файла - 212 байт. 
	Файл состоит из 4-х равных частей, каждая из которых задает
	кодировку для 4-х клавиш смещения в русском режиме :
		< нет смещения >
		SHIFT
		клавиша включения псевдографики ( Alt )
		SHIFT + клавиша включения псевдографики ( Shift + Alt )

         Например, файл KBD задает следующее размещение клавиш.  

          <Shift>                         <Alt+Shift>       <Alt>      
       !":/%,.?()_+    1234567890-=      !":/%,.?()_+    1234567890-= 
       ЯВЕРТЫУИОПШЩ    явертыуиопшщ      ╔╦╗╒╤╕█▄▌▐      ┌┬┐╓╥╖│─║═   
       АСДФГХЙКЛ:"Ч    асдфгхйкл;'ч      ╠╬╣╞╪╡▀■¤       ├┼┤╟╫╢░▒▓    
       ЪЗЮЦЭБНМьЬЖ     ъзюцэбнм,.ж       ╚╩╝╘╧╛№         └┴┘╙╨╜√      
                                        
         Если файл не указан, используется стандартное размещение клавиш.

           <Shift>                      <Alt+Shift>       <Alt>     
       !":/%,.?()_+    1234567890-=     !":/%,.?()_+    1234567890-=
       ЙЦУКЕНГШЩЗХЪ    йцукенгшщзхъ     ╔╦╗╒╤╕█▄▌▐      ┌┬┐╓╥╖│─║═  
       ФЫВАПРОЛДЖЭ~    фывапролджэ`     ╠╬╣╞╪╡▀■¤       ├┼┤╟╫╢░▒▓   
       |ЯЧСМИТЬБЮЁ     \ячсмитьбюё      ╚╩╝╘╧╛№         └┴┘╙╨╜√     

   /Graph=<флаг>   - Используется для переопределения клавиши, переключающей
   ─────────────     в режим набора символов псевдографики. В русском 
	режиме при нажатии указанной клавиши смещения генерируются символы
	псевдографики. По умолчанию используется клавиша Alt.

		     Возможные ключи :
			 1 : Нажата правая клавиша Shift
			 2 : Нажата левая клавиша Shift
			 4 : Нажата клавиша Ctrl
			 8 : Нажата клавиша Alt ( по умолчанию )
			16 : Режим Scroll Lock
                 	32 : Режим Num Lock
			64 : Режим Caps Lock
		       128 : Режим Ins	

		 Допустимы любые комбинации указанных ключей.
	Например если указать ключ 12 ( 12=8+4 ), то псевдографика
	будет генерироватся при одновременном нажатии Ctrl и Alt.
	Если указан 255, то псевдографика никогда не будет
	генерироваться.  Не рекомендуется указывать для этой цели
	клавиши Shift или Caps Lock, т.к. они используются для
	переключения на заглавные буквы.
	  Пример : KEYRUS /graph=32
        Рекомендуются значения 16 (Scroll Lock) или 32 (Num Lock).

   /Scan=<скэнкод> - Переопределить клавишу переключения Рус/Лат.
   ───────────────   По умолчанию - 54 ( right SHIFT ).
	     При использовании для этой цели клавиш  Capslock ( 58 ),
	     Numlock ( 69 ) или ScrollLock ( 70 ) для фиксации режимов
	     CapsLock, NumLock или ScrollLock соответственно, надо нажать
	     эту клавишу + SHIFT.
	     Для определения для этой цели клавиш, присутствующих только
	     на расширенной клавиатуре используйте ключ /ext
	     Таблица кодов клавиатуры дана в приложении.

   /EXT		   - Определить клавишу переключения Рус/Лат для клавиш,
   ────		     присутсвующих только на расширенной клавиатуре.
	     Используется совместно с ключем /scan.
	     Этот параметр указывает, что клавиша генерирует 2 скэнкода -
	     0e0h + <скэнкод расширения>, в параметре /scan надо указать
	     2-й скэнкод.
	     Примеры :
 		 KEYRUS /ext /scan=29   Определяет клавишу  'Right Ctrl'
					на клавиатуре AT.
		 KEYRUS /scan=29	Определяет клавишу  'Left Ctrl'.
					( как видно, ключ /ext не указан )
		 KEYRUS /ext /scan=56   Определяет клавишу  'Right Alt'
					на клавиатуре AT.

	     
   /ROM		   - Используется на компьютерах с адаптерами EGA или VGA,
   ────	     	     у которых рисунок русских символов "зашит" в BIOS.
   	Если параметр указан, то при запуске грузится только драйвер
	клавиатуры, и драйвер в памяти занимает гораздо меньше памяти.
	
   /128		   - Если указан этот ключ, то драйвер будет подгружать
   ────		     не только русские символы, а все 128 последних
   	символов таблицы ASCII. При этом драйвер занимает в памяти 4-5 
	килобайт.
	В этом режиме символы кириллицы поддерживается в текстовых
	режимах и в графических режимах CGA ( 4,5,6 ).
	
   /ALL		  - Если указан этот ключ, то драйвер будет подгружать
   ────		    не только русские символы, а всю таблицу 
	кодов ASCII. При этом драйвер занимает в памяти 7-8 килобайт.
	В этом режиме символы кириллицы поддерживаются во всех текстовых
	и графических режимах.
	

                     Программное управление драйвером 
                     ────────────────────────────────
 KEYRUS обслуживает функцию 92h мультиплексного прерывания 2Fh.
                MOV ah,92h
                MOV al,< номер подфункции >
                INT 2Fh
        
 AL 
  0         :   Проверка - загружен KEYRUS ?                            
                 Если KEYRUS загружен на выходе в AL будет 82h 
              
  1         :   Проверка - какой режим клавиатуры активен ?
                 На выходе :  AL = 4   - Латинский режим
                              AL = FBh - Русский режим.
        
  90h ('Р') :   Включение русского режима клавиатуры.                   
  
  4сh ('L') :   Включение латинского режима клавиатуры.                 




			      ╔════════════╗
  			      ║	Примечания ║
			      ╚════════════╝
(1)        Что нужно сделать, чтобы программа Norton Commander 
                      "понимала" русскую букву "р".
      ────────────────────────────────────────────────────────────────
Для Norton Commander ( вер. 2.0 ) -
  С помощью утилиты  NU или PCTools скорректируйте программу NC.EXE :
  по смещению  9CBD замените байт 0e0h('р') на 00

Для Norton Commander ( вер. 3.0 ) -
  С помощью утилиты NU или PCTools скорректируйте программу NCMAIN.EXE :
  по смещению  1E02 замените байт 0e0h('р') на 00.
       

(2)                   Таблица скэнкодов клавиатуры.
	              ─────────────────────────────
    ┌─────────╥──────────╥────────────╥─────────────╥───────────────┐
    │ Dec Key ║ Dec Key  ║ Dec Key    ║ Dec Key     ║ Dec Key       │
    │─────────╫──────────╫────────────╫─────────────╫───────────────│
    │  1  Esc ║ 18  E    ║ 35  H      ║ 52  . >     ║ 69  NumLock   │
    │  2  1 ! ║ 19  R    ║ 36  J      ║ 53  / ?     ║ 70  ScrollLock│
    │  3  2 @ ║ 20  T    ║ 37  K      ║ 54  Shft(Rt)║ 71  Home [7]  │
    │  4  3 # ║ 21  Y    ║ 38  L      ║ 55  * PrtSc ║ 72  Up   [8]  │
    │  5  4 $ ║ 22  U    ║ 39  ; :    ║ 56  Alt     ║ 73  PgUp [9]  │
    │  6  5 % ║ 23  I    ║ 40  " '    ║ 57  spacebar║ 74  <циф> -   │
    │  7  6 ^ ║ 24  O    ║ 41  ~ `    ║ 58  CapsLock║ 75  Left [4]  │
    │  8  7 & ║ 25  P    ║ 42  Shft(L)║ 59  F1      ║ 76       [5]  │
    │  9  8 * ║ 26  [ {  ║ 43  \ |    ║ 60  F2      ║ 77  Right[6]  │
    │ 10  9 ( ║ 27  ] }  ║ 44  Z      ║ 61  F3      ║ 78  <циф> +   │
    │ 11  0 ) ║ 28  Enter║ 45  X      ║ 62  F4      ║ 79  End  [1]  │
    │ 12  - _ ║ 29  Ctrl ║ 46  C      ║ 63  F5      ║ 80  Down [2]  │
    │ 13  + = ║ 30  A    ║ 47  V      ║ 64  F6      ║ 81  PgDn [3]  │
    │ 14  bksp║ 31  S    ║ 48  B      ║ 65  F7      ║ 82  Ins  [0]  │
    │ 15  Tab ║ 32  D    ║ 49  N      ║ 66  F8      ║ 83  Del  [.]  │
    │ 16  Q   ║ 33  F    ║ 50  M      ║ 67  F9      ║               │
    │ 17  W   ║ 34  G    ║ 51  , <    ║ 68  F10     ║               │
    └─────────╨──────────╨────────────╨─────────────╨───────────────┘
                       Скэнкоды расширенной клавиатуры
    ╒═════════════════════════════════════╦═════════════════════════╕
    │ Клавиша                   Код       ║ Клавиша       Код       │
    ├─────────────────────────────────────╫─────────────────────────┤
    │ F11 ..................... 87        ║ Home ........ 71 (ext)  │
    │ F12 ..................... 88        ║ End ......... 79 (ext)  │  
    │ Right-Alt ............... 56 (ext)  ║ Up .......... 72 (ext)  │
    │ Right-Ctrl .............. 29 (ext)  ║ Down ........ 80 (ext)  │
    │ Shft-PrintScreen (SysReq) 55 (ext)  ║ PgUp ........ 73 (ext)  │ 
    │ Ctrl-PrintScreen (SysReq) 55 (ext)  ║ Pgdn......... 81 (ext)  │
    │ Alt-PrintScreen ......... 84        ║ Right ....... 77 (ext)  │   
    │ Insert .................. 82 (ext)  ║ <циф> Enter . 28 (ext)  │
    │ Delete .................. 83 (ext)  ║ <циф> / ..... 53 (ext)  │
    │ Left .................... 75 (ext)  ║ 		            │
    ╘═════════════════════════════════════╩═════════════════════════╛
