                                DATE Macro Package

 (c) Copyright 1992, Raymond P. Tackett
                     434 East Woodlawn Avenue
                     Philadelphia, PA 19144

                     Compuserve 76416,276

Distribution policy:  This package may be distributed freely in its original,
                      unmodified form, provided no charge beyond reasonable
                      and customary duplication and/or connect time charges
                      is made.  This package may not be bundled with any other
                      goods or services.

Registration:  There is no registration or fee for private, non-commercial use
               of this package.  Users who send gifts of $10 or more will
               receive notice of upgrades and future products, and a price
               break on registration fees.

               The registration fee for a single commercial license is $25 in
               US dollars drawn on a US bank.  Additional commercial licenses
               for the same site are $5 each.

               Other commercial usage, such as incorporation into a book must
               be negotiated with the author.

Legalese:  Use of this package is at the user's sole risk.  No warranty is
           expressed or implied with regard to any function of this package.

           Multi-Edit is a product of American Cybernetics.
           Compuserve is a trademark of H&R Block Corporation.
           All other trademarks found herein are the property of
             their owners.

Included files:

           DATEDEF.S  The date and string format definitions
           DATEMAC.S  Source for internal support macros
           DATEMATH.S Source for externally callable macros
           DATEMATH.MAC Date package in ready-to-run form
           DATE.DOC   This file

Software Requirements:
           American Cybernetics Multi-Edit version 6.0 or higher.

Overview:

This package includes source and object for Multi-Edit macros which do date
arithmetic.  Included functions are:

   Number of days between dates
   Date formatting in either words or numbers under control of a format string
   Julian/Gregorian date conversions
   Date plus or minus N days
   Day of week which corresponds to given date
   Conversion of numbers to words, e.g., 123 -> one hundred twenty three
   Conversion of ordinals to words, e.g., 123 -> one hundred twenty third
   Removal of leading zeros from a string of digit characters

Date formats, separator characters, and character strings (e.g., "Sunday") are
all user-modifiable for foreign language support, etc.  See file DATEDEF.S.

Comments and/or bug reports are invited.


Design comments:

As far as is practical, there are no hard-coded constants in the macros
themselves.  The definition file, DATEDEF.S, contains definitions for
most constants.  The objective is to be as independent of language and of
date formats as possible.

To that end, the code is not as efficient as it might be.  Functionality is
broken out in a modular, readable form so that the user can customize the
package further if desired.

For example, the NUMWORD macro can work almost as-is if the word strings are
translated into Spanish.  If the target language is German, word ordering is
different. If the target language is French, the wording system is based upon
twenty, not ten.

Although translation to other languages may require reworking some of the code,
the structure is intended to be obvious enough to point the way.

Likewise, implementing other calendars such as Chinese or Hebrew may require
extensive changes, but the basic structure of the package should still be
workable.


Included macros:

 DOW (<date>) Return the day of the week name and ordinal,
              e.g. Sunday and 1, for <date>
 GREGORIAN (<date>) Return corresponding Gregorian date in form mm-dd-yyyy
 JULIAN (<date>) Return corresponding Julian date in form ddd.yyyy
 NDAYS  (<date1> <date2>) Return number of days from date1 to date2
 PLUSDAYS (<date> <N>) Return date of <date> + N days
 EATZEROS (string) If the string begins with a "0", strip all leading zeros and
                   return the result.  E.g. "0003 is the number" in yields
                   "3 is the number" out.  If the integer portion of the string
                   evaluates to zero, one zero will be preserved.
 NUMORD  (integer number) Return an ordinal string.  E.g., 123 in yields
                          "one hundred twenty third" out. English is the
                          default language.  Other languages may be set up.
 NUMWORD (integer number) Return a string suitable for check writing. E.g.,
                          1234 in yields "one thousand two hundred thirty
                          four" out.  English is the default language.  Other
                          languages may be set up.
 TEXTDATE (<date> [control string]) Return given date in a form specified
                                    by the control string.


General notes:

  Date formats:

    Gregorian dates are in form dd-mm-yyyy or dd-mm-yy.

    Julian dates are in form ddd.yyyy or ddd.yy.

  Any date format is acceptable to any function.  Output date format
    will be the same as input format, including use of two or four digit year
    numbers, except that GREGORIAN and JULIAN will always output in their
    designated format.

  The date formats shown above are the way this package is supplied.  Values in
    DATEDEF.S may be changed to suit the user's locality and/or preference.  Of
    course, any changes will require that DATEMAC.S be recompiled in order for
    them to take effect.

  If any date parameter is omitted, the date the call is made is assumed.

  All date computations follow the rules for the Gregorian calendar.  The
    Gregorian calendar was first used in 1582 AD.  Therefore, results for years
    before 1582 are not meaningful.

  If a four digit year is input and the function returns a date, the following
    rules for the year value apply:

      Two digit years:
         The resulting year will be the full, computed year value minus the
           constant 'century'.  Therefore, two digit results outside the
           current century may not be what is expected.

      Four digit years:
         Negative year numbers are BC.  See note regarding 1582 AD, above.
         If the result year is not four digits, all digits of the result
         will be returned.

  Parameter formats:

    Examples:  rm('julian 6/9/92');
               rm('textdate 179.1992 %M %d, %y');
               rm('ndays 6/9/92 9/14/93');

    Note that the normal parameter labeling conventions ("/foo=bar") are not
     used. A single space separates the first parameter from the macro name.
     Any number of spaces may separate the first parameter from the second. The
     second parameter is the rest of the parameter string, no matter how many
     blanks are embedded.  To omit the first parameter but use the second, e.g.
     to use the current date for TEXTDATE, use two or more blanks to separate
     the macro name from the second parameter:  rm('textdate    %M %d, %y');

  Changing formats and languages:

  The following items are in file DATEDEF.S.  They may be changed to accomodate
    date formats for other countries.

  Date separator characters
  The order of Gregorian month day and year
  The order of Julian day and year
  Month and day name strings (may be translated into other languages)
  Number word strings (may be translated into other languages)
  Default date format control string


DOW (<date>) Return the day of the week name and ordinal,e.g. 'Sunday' and 1,
              for <date>.
              Example:   DOW 3-8-45
                         Returns 'Thursday' and 5

    The example uses the supplied DATEDEF.S definitions of date format and
    return values.  DATEDEF.S may be customized for other date formats and
    languages.

    If the date parameter is not supplied, the date of the call is the
    default.  Both return_str and return_int are set appropriately:

  0  ''     (bad input date format);
  1  D_1    (see DATEDEF.S for string definition of D_1 (supplied as 'Sunday'))
  2  D_2    (supplied as 'Monday')
  3  D_3    (supplied as 'Tuesday')
  4  D_4    (supplied as 'Wednesday')
  5  D_5    (supplied as 'Thursday')
  6  D_6    (supplied as 'Friday')
  7  D_7    (supplied as 'Saturday')

GREGORIAN (<date>)
     Return corresponding Gregorian date in form mm-dd-yyyy
     The Gregorian date form can be changed in DATEDEF.S.
     If <date> is omitted, the current date is used.

JULIAN (<date>)
     Return corresponding Julian date in form ddd.yyyy
     The Julian date form can be changed in DATEDEF.S.
     If <date> is omitted, the current date is used.

NDAYS  (<date1> <date2>) Return integer number of days from date1 to date2.
     If <date2> is before <date1> the return value is negative.


         For this, or any other macro which takes two parameters, the first
         is separated from the macro name by EXACTLY one blank.  There may
         be any number of blanks between the first and second parameters, e.g.:
             rm('ndays 6-12-92 177.1992')
                      |       |
                      |       Any number of blanks
                      Exactly one blank

         To indicate omission of the first parameter, use two or more
         blanks between the macro name and the second parameter, e.g.:
             rm('ndays    177.1992');
                       |
                       Two or more blanks


PLUSDAYS (<date> <N>) Return string date of <date> + N days.
         Output date format will correspond to input date format.
         N may be negative or zero.  Date may be omitted.

         For this, or any other macro which takes two parameters, the first
         is separated from the macro name by EXACTLY one blank.  There may
         be any number of blanks between the first and second parameters, e.g.:
             rm('plusdays 6-12-92 30')
                         |       |
                         |       Any number of blanks
                         Exactly one blank

         To indicate omission of the first parameter, use two or more
         blanks between the macro name and the second parameter, e.g.:
             rm('plusdays    30');
                          |
                          Two or more blanks


EATZEROS (string) If the string begins with a "0", strip all leading zeros and
                  return the result.  E.g. "0003 is the number" in yields
                  "3 is the number" out.  If the integer portion of the string
                  evaluates to zero, one zero will be preserved.

                  The parameter string must be separated from the macro name
                  by exactly one blank.



NUMORD  (integer number) Return an ordinal string.  E.g., 123 in yields
                         "one hundred twenty third" out. English is the
                         default language.

                         Integer must be positive.



NUMWORD (integer number) Return a string suitable for check writing. E.g.,
                         1234 in yields "one thousand two hundred thirty
                         four" out.  English is the default language.

                         Negative numbers begin with the word 'minus'.

                         Zero returns as 'zero'.


TEXTDATE (<date> <control_string>) Return components of <date> in a form 
                                   specified by <control_string>.

         <Date> may be omitted to default to the date of call.
         <Control_string> defaults to definition T_F in DATEDEF.S.

         <Control_string> may consist of any characters.  Metasymbols
         defined in DATEDEF.S are replaced with the corresponding date
         elements, e.g.:

            rm('textdate 6-12-92 What is so rare as a day in %M?');

         will set return_str to:

            'What is so rare as a day in June?'

         because '%M' is a metasymbol for the word-name of the month.

         Metasymbols may occur anywhere in the control string.  If the
         definitions in DATEDEF.S are changed to include other metasymbols,
         recursive substitution will occur until all valid metasymbols have
         been replaced.

         Characters following the CTL_SEP ('%') character which do not form
         valid metasymbols are ignored, e.g., '%X' will be returned as-is.

         Valid metasymbols and their definitions (as supplied) are (using
         6-12-92 as the example date):

         %M = month name      = June
         %m = month number    = 6
         %D = day name        = twelfth
         %d = day number      = 12
         %Y = year name       = nineteen hundred ninety two
         %y = year number     = 1992
         %W = week day name   = Friday
         %w = week day number = 6
         %J = year day name   = one hundred sixty fourth
         %j = year day number = 164

         If <date> is not valid, no substitutions occur.

         For this, or any other macro which takes two parameters, the first
         is separated from the macro name by EXACTLY one blank.  There may
         be any number of blanks between the first and second parameters, e.g.:
             rm('textdate 6-12-92 %M %d, %y')
                         |       |
                         |       Any number of blanks
                         Exactly one blank

         To indicate omission of the first parameter, use two or more
         blanks between the macro name and the second parameter, e.g.:
             rm('textdate    %M %d, %y');
                          |
                          Two or more blanks

