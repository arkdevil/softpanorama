




                      Вирусный локатор и вирусный интегратор.
                   ( Virus Locator 1.4 & Virus Integrator 1.2 )



                        1. Введение.

  Программа VL ( Virus Locator ) предназначена для поиска вирусов, размножаю-
щихся через файлы, по маскам вирусов.
  Отличие VL от таких программ как PC-TOOLS в том, что он ищет в файле все
маски вирусов одновременно, а также может работать без остановки при обнаруже-
нии вируса, выводя информацию о зараженных файлах на принтер. Кроме того, VL
удалит инфицированный файл (если вы выберете режим удаления), избавив вас от
этой нудной на большом винчестере работы.
  VL удобен для профилактической проверки винчестеров и дискет. В большом кол-
лективе пользователей вирус быстро переходит с машины на машину. После его
локализации на одном из PC и занесения новой маски в VL достаточно запустить
VL по всем машинам и вирус будет ликвидирован.
  Программа VI ( Virus Integrator ) служит для использования имеющихся у вас
антивирусов в комплексе. Идеей для VI послужил Norton Integrator. С помощью VI
вы можете запускать антивирусы по одному (по вашему выбору) или все вместе,
один за другим. Для активной работы с VL, т.е. при "коллекционировании масок"
необходимы определенные знания низкоуровневых сторон PC, в то время как для
работы с VI достаточно иметь надежный источник антивирусов, и только.
  Эти две программы позволяют сделать мощную защиту от вирусов. Действительно,
если к вам попадает новый антивирус, вы помещаете его в VI, а если вдруг вы уз-
наете маску нового вируса или просто "вычислите" ее, то помещайте маску в VL.
Тогда, используя VI и VL совместно, вы минимизируете опасность заражения.




                        2. Подробнее о VL (вирусном локаторе).


  Полная поставка VL включает 5 файлов:

     READ.ME        - краткая информация о том, как развернуть файл VLI.DOC
     VLI.DOC        - файл, который вы сейчас читаете
     BOA.EXE        - программа для разворачивания VLI.DOC
     VL.EXE         - собственно вирусный локатор (называемый далее VL)
     VL.MSK         - маленький файл ( 3 Кб ), в котором VL хранит маски и име-
                      на вирусов, а также техническую информацию.

  В VL.MSK уже установлены несколько масок вирусов: те, с которыми я столкнулся
при работе на PC или получил со стороны для определения маски.
  Для ознакомления с особенностями этих и других вирусов рекомендую обратиться
к "электронным статьям":
  1. Безруков Н.Н. "Компьютерная вирусология" ,
  2. Бончев В.     "Ваксини срещу компютърни вируси" (на болгарском языке),
  3. Бончев В.     "Еще раз о компьютерных вирусах".


  VL ищет файл VL.MSK в том каталоге, в котором находится VL.EXE. Если VL.MSK
не будет найден, локатор сообщит об этом и прекратит работу.


  В самом начале работы VL выводит на экран головное меню:

                     ┌─── Main menu ───┐
                     │                 │
                     │   Full search   │
                     │  Quick search   │
                     │  Select options │
                     │  Show options   │
                     │  Print options  │
                     │  Mask editing   │
                     │  Save changes   │
                     │      Info       │
                     │      Quit       │
                     └─────────────────┘
Его элементы:

             Full search          - начало поиска вирусов по
                                    установленным опциям. Эта
                                    опция соответствует Begin search
                                    из более ранних версий VL


            Quick search          - быстрый, но, возможно, не гаранти-
                                    рующий нахождение всех вирусов поиск.
                                    Его алгоритм будет описан дальше.


            Select options        - выбор опций поиска, ниже будет
                                    описан подробнее


            Show options          - вывод на экран текущих опций поиска
                                    вирусов


            Print options         - печать текущих опций на принтер


            Mask editing          - работа с масками : удаление и
                                    добавление масок, печать масок и
                                    вывод их на экран


            Save changes          - сохранение измененных опций и
                                    отредактированных масок


            Info                  - краткая информация о VL


            Quit                  - выход из VL


  Если вы войдете в подменю Select options, то получите возможность выбора:


        Sound is                  - включения/выключения звукового
                                    сигнала, подаваемого при обнаруженни
                                    вируса


        File extension            - расширения файла, по которому будут
                                    выбираться файлы для поиска в них
                                    вирусов

        Search virus at           - поиска вируса: в каталоге, в
                                    файловой системе (системах), в
                                    конкретном файле. При поиске по
                                    каталогам происходит поиск и по
                                    подкаталогам

       Output sent to             - вывода краткой информации о
                                    найденном вирусе. При установке
                                    вывода на принтер VL не будет
                                    останавливаться при обнаружении
                                    вируса, а выведет информацию на
                                    печать и продолжит поиск

       File with virus            - реакции на зараженный файл: удаление
                                    без подтверждения, с подтверждением
                                    или не удаление



  Некоторые ограничения : VL хранит не более 50 масок, длина маски вируса не
менее 2 и не более 15 символов. Алгоритм поиска вирусов таков, что чем длиннее
маска, тем быстрее поиск.

  Отличие VL от аналогичных программ в том, что он- открытая система. Вы полу-
чаете полную информацию о его работе, управляете локатором. Это куда лучше,
чем какой-нибудь "детектор", который ищет неизвестно что неизвестно по какому
принципу выбирая файлы поиска. И, кроме того, VL распространяется бесплатно,
так что скопировав у кого-нибудь эту программу и поработав с ней можете с
чистой совестью звонить мне с предложениями, советами, замечаниями по VL.
  Я с благодарностью приму также и информацию о новых вирусах и их масках, и
сам сообщу о тех, что стали мне известны за последнее время.

  Вы работаете с VL версии 1.4. Версия 1.0 страдала многими недостатками и, в
первую очередь, плохим алгоритмом поиска. Поскольку VL ищет маску по всему
файлу, то поиск является критическим местом в программе. Поэтому версию 1.0 я
решил не распространять, взял другой алгоритм поиска (Боуера и Мура) и сделал
версию 1.1. Скорость поиска в ней увеличилась в 3,2 раза.
 В версиях 1.0 и 1.1 файл VL.MSK имеет размер 1 Кбайт. Однако оказалось неудо-
бным работать с масками вирусов, не зная их имен. Дело в том, что из одного ви-
руса можно выделить несколько масок, да и обмениваться просто масками не так
уж и удобно. Поэтому с версии 1.2 вы можете указать имя вируса и за счет этих
имен файл VL.MSK увеличился до 3072 байта (3 Кб). Версии с 1.1 по 1.4 совместимы
снизу-вверх по файлу VL.MSK. При чтении VL.MSK размером в 1 Кб локатором версии
1.4 все маски будут безымянными.
 Версия 1.2 требовала инсталляции локатора для поиска файла VL.MSK. Эта инстал-
ляция оказалась делом обременительным и я решил возложить заботы о поиске файла
VL.MSK на сам локатор (начиная с версии 1.3). Кроме того в версии 1.3 несколько
изменен формат вывода имен масок вирусов.
 Версия 1.4 избавлена от некоторых ошибок версии 1.3. Более удобным стал ввод
имени файла, каталога, маски. В предыдущих версиях вход в режим ввода любого
текста означал безусловную потерю его предыдущего содержимого. Особенно это было
заметно при переименовании маски, когда ради изменения одного символа приходи-
лось перебивать весь текст.
 В VL 1.4 добавлен простой самоконтроль на заражаемость. Если размер файла VL.EXE
изменится (обычно в результате заражения вирусом), локатор сообщит об этом и
откажется продолжать работу.
 Для ускорения поиска вирусов введена опция Quick Search. При ее отработке алго-
ритм поиска маски по файлу таков:

         Если
                  размер файла < 8 Кб   ?           - читается весь файл,
         иначе
                  файл не имеет .COM-структуру ?    - читаются первые и последние
                                                      4 Кб файла
         иначе
                  первые байты файла: команда JMP ? - проверка корректности
                                                      перехода по JMP и переход
                                                      с чтением 4 Кб
         иначе
                  читаются первые и последние 4 Кб файла


  Такой алгоритм дает увеличение скорости в 2-3 раза но будет пропускать изощ-
ренные вирусы (знакомые с подобными алгоритмами!). Правда, я с такими еще не
сталкивался. Если вам попадется подобный вирус, переходите на опцию Full Search
(по английски FULL - полный,всеохватывающий, а глупый - FOOL, хотя и звучат
почти одинаково). И действительно, что может быть надежнее глупого полного поис-
ка маски по всему файлу?



  При именовании вирусов я придерживаюсь следующей системы: имя начинается с
типа размножения вируса, затем идет приращение файла при записи в него вируса,
затем - дополнительные признаки.
  Например:
                 CE1234R   означает, что вирус размножается через .COM и .EXE
файлы, увеличивая их на 1234 байта и становясь резидентным. Применяется следу-
ющая типизация:
                 C - размножение через .COM файлы
                 E - размножение через .EXE файлы
                 B - размножение через Boot Record (начальный загрузчик)
                 R - вирус становится резидентным
                 N - вирус распространяется через сеть ЭВМ





                        3. Подробнее о VI (вирусном интеграторе).


  Полная поставка VI включает 5 файлов:

     READ.ME        - краткая информация о том, как развернуть файл VLI.DOC
     VLI.DOC        - файл, который вы сейчас читаете
     BOA.EXE        - программа для разворачивания VLI.DOC
     VI.EXE         - собственно вирусный интегратор (называемый далее VI)
     VI.DAT         - текстовый файл, из которого VI черпает информацию о
                      вирусных докторах, имеющихся в наличии
      ...           - несколько вирусных докторов (их имена см. в VI.DAT).

  VI ищет файл VI.DAT в том каталоге, в котором находится интегратор. Если
файл VI.DAT не будет найден, интегратор сообщит об этом и завершит работу.



  В самом начале работы VI выводит на экран головное меню:

                     ┌────  Main menu  ────┐
                     │Start all Antiviruses│
                     │ Search on drive  A: │
                     │ Select Antivirus    │
                     │        Info         │
                     │        Quit         │
                     └─────────────────────┘
Его элементы:


            Start all Antiviruses - запуск всех указанных в файле VI.DAT
                                    антивирусов


            Search on drive    A: - поиск на диске. Выводится имя текущего
                                    диска. Для установки другого имени диска
                                    нажмите Enter и подменю позволит выбрать
                                    диск


            Select antivirus      - позволяет выбрать антивирус и запустить его.
                                    Нажатие клавиши Esc приводит к возвращению
                                    в основное меню без вызова антивируса.


            Info                  - краткая информация о VI


            Quit                  - выход из VI


  Файл VI.DAT имеет следующий формат :
             - строка с каким-либо комментарием (обычно имя вируса). Помещается
               без изменений в строку меню выбора антивирусов.
             - строка с именем антивируса (до 20 символов). Эта строка исполь-
               зуется для вызова антивируса.
             - пустая строка - разделитель записей.

  Вы можете поместить в файл VI.DAT до 18 записей, т.е. запускать до 18 анти-
вирусов в интеграторе.
  В VI.DAT уже находится несколько записей для примера того, как нужно заполнять
этот файл. Для работы с VI вам следует удалить эти записи и вставить свои, соот-
ветствующие имеющимся у вас антивирусам.
  Перед выбором антивирусов рекомендую прочесть файл ANTI-VIR.DOC из декабрь-
ского 1989 г. выпуска "Софтпанорамы" (Киев,КИИГА). В этом файле анализируются
достоинства и недостатки многих известных на сегодняшний день антивирусов.
  Будьте внимательны! VI запускает антивирусы ТОЛЬКО из того каталога, в кото-
ром находятся VI.EXE и VI.DAT (а не из текущего и не из определенных в PATH).
  Для VI.DAT подходят не все антивирусы. Идеальный вариант : антивирус не за-
прашивает никаких параметров в диалоге, сам определяет имя текущего диска и
проводит поиск по всей его файловой системе.
  Вы работаете с интегратором версии 1.2. Версия 1.1 отличается от версии 1.0
только тем, что в 1.1 отсутcтвует инсталляция VI для поиска файла VI.DAT.
Теперь этот файл ищет сам интегратор.
  В версию 1.2 введен простейший самоконтроль на зараженность, такой же как и
для VL. Кроме того в этой версии число максимально допустимое число антивирусов
уменьшено со 100 до 18. Как показал опыт, такого количества вполне хватает. В
остальном версии 1.1 и 1.2 совпадают.
  Также, как и VL, программа VI распространяется бесплатно.




                        4. Разное.


  VL и VI написаны на языке Turbo-Pascal 5.0 с использованием оконного модуля
WindTS и прогрессивной Р-технологии.
  Оконный модуль (unit) WindTS (Windows from TechnoSoft) избавил меня от всех
хлопот по созданию окон и меню на экране. Этот модуль является моей адаптацией
пакета Windows из TopSpeedModula под Turbo-Pascal (начиная с версии 4.0). Для
многих программ модуль WindTS куда удобнее, чем стандартный модуль CRT из
Turbo-Pascal.
  Р-технология (представление програм в виде графов) позволила быстро написать
VL и VI и без труда их отладить. Признанным свойством Р-технологии является
повышение качества и скорости работы программиста, улучшение читабельности
программ. В Технософте, ведущем разработчике Р-технологии, созданы Turbo-R-
системы под языки Turbo-Pascal, Turbo-C, Modula-2.
  Если вы хотели бы узнать подробнее об Р-технологии, свяжитесь с Технософтом
и вы получите подробную информацию. Обращайтесь по адресу:

       252207 Киев 207, проспект академика Глушкова, 20-а , Технософт.


  Если вы работаете с Turbo-Pascal и заинтересовались модулем WindTS, обращай-
тесь ко мне по этому-же адресу (отдел Ковалева) и / или по телефону 266-00-97
(Киев,с 9.00 до 18.00 по рабочим дням).


                   январь 1990 г.         Шеховцов Александр
