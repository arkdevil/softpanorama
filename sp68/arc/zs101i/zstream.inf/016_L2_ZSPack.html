<HTML XPOS=LEFT YPOS=TOP HEIGHT=100%>
<HEAD>
<!-- extra bytes: 03 01 44 01 00 04 00 21 58 02 64 00 --><TITLE>ZSPack</TITLE>
</HEAD>
<BODY>
<!-- entering slot 17 --> 
<P>
<B>Introduction</B> 
<P>
The ZSPack utility is used to compress files, so that they can be transparently
accessed as decompressed files via ZipStream.
<P>

<P>
<B>Usage</B><!-- lm: 0x2 5 -->
<UL>
<P>
zspack<I> filenames</I>
<P>
<I>filenames</I> may consist of OS/2 wildcard characters.<!-- lm: 0x2 1 -->
</UL>
<P>
<B>Compression Options</B>
<P>

<P>
ZSPack by default uses a standard set of compression parameters when compressing
files.  These parameters can optionally be configured by using the Warp
'-w number' option.
<P>
Currently Warp values of '4', '6' and '7' may be applied. 
<P>
Warp 4
<P>
Warp 4 has the following effects:<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->File fully virtualised on open.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Does not to use Grip cache.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Asynchronous write back if modified.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Use default compression effort.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Use best compression method.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Use auto algorithm selection.<!-- lm: 0x2 1 -->
<BR>

<P>
 
<P>
Warp 6
<P>
Warp 6 has the following effects:<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->File fully virtualised on open.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Files *.exe and *.dll placed in Grip cache for
default Grip period.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Asynchronous write back if modified.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Use default compression effort.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Use best compression method.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Use auto algorithm selection.<!-- lm: 0x2 1 -->
<BR>

<P>
 
<P>
Warp 7
<P>
Warp 7 has the following effects:<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->File fully virtualised on open.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Place in Grip cache for default period.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Asynchronous write back if modified.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Use default compression effort.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Use best compression method.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Use auto algorithm selection.<!-- lm: 0x2 1 -->
<BR>

<P>

<P>
The higher the warp value selected, generally will result in higher performance
when accessing compressed files. This may also cause larger Swapper file
space requirements.
<P>
Without a warp option selection, the default selection of Warp 6 will be
applied. The default method is recommend in most cases.
<P>
Warp 4 is recommended for infrequently accessed files or for machines with
low amounts of RAM. 
<P>
Warp 7 is recommended for games in which access to compressed data must
occur at the fastest possible rate. 
<P>

<P>
<B>Grip Cache</B>
<P>
The Grip cache is one of the forms of cache that ZipStream utilises to boost
performance. Basically, a compressed file that has the Grip cache option
will be retained in memory as uncompressed data for a period of time after
the last access. The benefit of this is that any subsequent accesses within
the Grip time period will avoid the decompression delay.
<P>
Currently the default Grip period is 1 minute.
<P>
It is not recommended to use the Grip cache in all situations as this may
result in very large Swapper file space requirements.
<P>
Notes:<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->This cache operates independently to the other
ZipStream caches.<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->The maximum cache size is currently fixed (at
a very large value).<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Files are never cached if they have been modified.
<!-- lm: 0x2 1 -->
<P>
 <LI><LI><!-- lm: 0x2 5 -->Files that have been modified retain their Grip
cache option.<!-- lm: 0x2 1 -->
<BR>
 
<P>

<P>
<B>Actual versus Effective Compression</B>
<P>
ZSPack reports both Actual compression and Effective (parenthetical) compression
ratios.
<P>
Actual compression ratio is the ratio of the original file size to the final
compressed file size.
<P>
Effective compression is the ratio of the amount of disk space used to store
the uncompressed version of the file, compared to the disk space used to
store the compressed version of the file.
<P>
The difference between Effective and Actual compression ratios arises as
the disk space is allocated in blocks of bytes, not just bytes as the file
size is measured. The number of bytes in a block is dependant on the underlying
File System. The HPFS File System always allocates blocks of 512 bytes,
while the FAT (DOS) File System allocates blocks as follows: 
<PRE>┌────────────────────┬────────────────────┐
│Partition Size      │Block Size          │
├────────────────────┼────────────────────┤
│less than 16 MByte  │4 KByte             │
├────────────────────┼────────────────────┤
│less than 128 MByte │2 KByte             │
├────────────────────┼────────────────────┤
│less than 256 MByte │4 KByte             │
├────────────────────┼────────────────────┤
│less than 512 MByte │8 KByte             │
├────────────────────┼────────────────────┤
│less than 1 <!-- entering slot 18 -->GByte   │16 KByte            │
├────────────────────┼────────────────────┤
│less than 2 GByte   │32Kbyte             │
├────────────────────┼────────────────────┤
│less than 4 GByte   │64 KByte            │
└────────────────────┴────────────────────┘
</PRE>

<P>
As ZSPack works on a byte basis and the Disk System works on a block basis,
a difference between Actual and Effective compression can occur. However,
this difference will generally only be noticed on smaller files. Obviously
then, Effective compression is what counts, as this represents the true
saving in disk space.
<P>
To further illustrate this situation, consider the following scenario:
<P>
<!-- lm: 0x2 5 -->
<UL>You have a HPFS partition with a file 'letter.doc'
occupying 700 bytes. This file is then compressed to 350 bytes. A 50 percent
Actual reduction. The HPFS File System has a block size of 512 bytes.  Therefore,
the file would have used 2 blocks (1024 bytes) before compression. After
compression, the file would occupy 1 block (512 bytes).  Once again a 50
percent Effective reduction.  In this case the Actual and Effective compression
ratios are the same.
<P>
Now consider another file 'letter1.doc' which is 700 bytes in size. This
file is then compressed to 500 bytes, a 28 percent Actual reduction. As
in the previous case, the number of disk blocks used has been reduced from
2 to 1, a 50 percent reduction. In this case the Effective compression is
greater than the Actual compression.<!-- lm: 0x2 1 -->
</UL>
<P>
<B>When ZSPack will not compress a file</B>
<P>
There are situations when ZSPack will not compress files. In these cases
it will report<I> filename</I><B> Skipped:</B><I> Reason</I>
<P>
The possible reasons are as follows:
<P>
<!-- lm: 0x2 5 -->
<UL><B>Skipped: No net gain achieved.</B>
<P>
This means that after ZSPack has attempted to compress a file, it checks
if an Effective reduction in the disk space utilisation has been achieved.
If none is achieved, then the file is skipped.  In this case compression
is of no benefit.
<P>
This situation can occur when the file is small or very low Actual compression
has been achieved.<!-- lm: 0x2 10 -->
<UL>
<P>
<B>Example</B>
<P>
A file 'letter.doc occupies 900 bytes, and this is 2 disk blocks in a HPFS
partition. After compression it is reduced in size to 600 bytes (a 33 percent
actual reduction). However, 2 blocks are still required to store the file,
so there has been no effective saving.<!-- lm: 0x2 5 -->
</UL><B> Skipped:
Too small, no effective gain possible.</B>
<P>
This situation occurs when the file is smaller than the File System Block
size. This situation is much more likely to occur on FAT File Systems rather
than on HPFS File Systems, as the block size on a FAT file system is larger
than that of HPFS, and it increases in size as the partition size increases.
<!-- lm: 0x2 10 -->
<UL>
<P>
<B>Example 1</B>
<P>
A file 'letter.doc' occupies 400 bytes, and this is 1 disk block in a HPFS
partition. Even with compression, the amount of disk blocks used cannot
be reduced. 
<P>
<B>Example 2</B>
<P>
A file 'letter1.doc' occupies 2000 bytes, and this is 1 disk block in a
FAT partition (that is less than 120 MByte in size). Even with compression,
the amount of disk blocks used cannot be reduced. In this case, saving could
be achieved if the partition used the HPFS File System. 
<P>
<!-- lm: 0x2 5 --><B>Skipped: Already compressed by ZipStream.</B>
</UL> This
means that the file has already been compressed by ZipStream.  It is not
possible to further compress a file in this way.
<P>
 
<P>
<!-- lm: 0x2 5 --><B>Skipped: Already in another Foreign Compressed Format.
</B>
<P>
Before ZSPack attempts to compress a file, it checks if the file is already
in a compressed format (e.g. Zip, Gif etc).  Generally, very little or no
compression can be achieved on a file that is already compressed. 
<P>
<!-- lm: 0x2 5 --><B>Skipped: OS/2 System File.</B>
<P>
In order to ensure that your system will remain operational, and provide
the greatest possible performance, ZipStream will refuse to compress any
file that is deemed part of the OS/2 system (including OS/2 LAN Server).
 
<P>
<!-- lm: 0x2 5 --><B>Skipped: Directory cannot be compressed.</B>
<P>
Currently the ZSPack utility will not process files in a directory, if it
is given only the directory name.
<P>

<P>
Instead of<B> zspack</B><I> dir</I> try<B> zspack</B><I> dir\*.*</I> 
<P>
<!-- lm: 0x2 1 -->  
</BODY>
</HTML>
