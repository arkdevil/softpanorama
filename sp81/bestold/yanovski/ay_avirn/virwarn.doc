          VirWarner - Универсальный детектор вирусов
                (С) А.Яновский (PC▐┤awk), 1994

    Программа VIRWARNER  предназначена для предотвращения зара-
жения системы резидентными и нерезидентными компьютерными виру-
сами,  включая Stealth- и Ghost-вирусы. При попадании в систему
вируса последний обнаруживается  при  первой  же  перезагрузке.
VIRWARNER не "лечит" файлы и бутсекторы,  т.к.  не ориентирован
на конкретные вирусы, а больше напоминает ревизор.
    Для идентификации используются следующие параметры среды:
 - Вектора прерываний (раздельно I и II половины);
 - Количество дисковых буферов DOS;
 - Все блоки MCB, включая UMB-блоки;
 - Адреса всех дисковых драйверов DOS;
 - Режим процессора (80286 и выше);
 - Цепочки обработчиков прерываний 13h, 21h, 40h;
 - MBR и Boot Sector активного раздела;
 - Контрольные суммы указанных файлов.
    Необходимость проверки каждого из этих параметров  задается
индивидуально с помощью меню конфигурирования программы.
    В программе принят ряд мер по усилению защиты  (использова-
ние  оригинального  вектора  Int 13h,  получение адреса таблицы
векторов через команду SIDT (!) и т.п.), и создание вируса, ко-
торый мог бы обойти VIRWARNER,  видится весьма и весьма непрос-
той задачей.
                   Возможности VIRWARNER'а:
    1. Индивидуальная настройка для каждого параметра среды
    2. Ведение журнала срабатываний защиты
    3. Сохранение до 10 конфигураций системы с комментариями
    4. Парольная  защита от ошибочных действий неподготовленных
       пользователей (2 уровня)
    5. Поддержка англо- и русскоязычного интерфейса
    6. Видео- и аудиоэффекты (сирена) при срабатывании

    Для работы требуется DOS версии не менее 4.01 и адаптер EGA

    Для инсталляции программы необходимо:
    - скопировать  VIRWARN.EXE и  VWFILES.EXE в PATH-директорию
(желательно);
    - вставить в AUTOEXEC.BAT команду VIRWARN возможно ближе  к
концу файла (после всех резидентов).
    Установка, разумеется,  должна выполняться на чистой систе-
ме. При этом рекомендуется заодно обновить архив: при заражении
вирусом лучше всего восстановить программы с архивных копий, да
и фага может не оказаться под рукой.

    В процессе работы VIRWARNER использует следующие файлы (все
они находятся в той же директории, что и VIRWARN.EXE):
 VIRWARN.CFG - Параметры (создается при первом запуске)
 VIRWARN.DAT - База конфигураций (создается при первом запуске)
 VIRWARN.FLS - Список контролируемых файлов
 VIRWARN.LOG - Журнал срабатываний
 VIRWARN.MBR - Копии MBR и Boot-сектора (создается автоматичес-
ки)
    Для проверки контрольных сумм файлов  необходимо  предвари-
тельно создать базу информации командой VWFILES, причем в теку-
щей директории должен находиться файл VIRWARN.FLS, где перечис-
лены  в  столбик  полные  имена всех подлежащих контролю файлов
(например, C:\COMMAND.COM).  Программа VWFILES допишет в каждой
строке контрольную  сумму  соответствующего файла для проверки,
после чего VIRWARN.FLS примет законченную форму.
    При отсутствии  какого-либо  файла с образцами данных (.MBR
или .DAT) этот файл будет создан заново БЕЗ срабатывания  защи-
ты.  Таким образом, при первом запуске конфигурация будет авто-
матически записана в ячейку 1 базы.  При включении проверки MBR
и Boot будет также создан MBR-файл.  Если впоследствии Вам пот-
ребуется изменить эти сектора, удалите VIRWARN.MBR, иначе защи-
та сработает по несовпадению их содержимого с записанным в фай-
ле.
    После завершения установки (и в дальнейшем при внесении из-
менений в файлы AUTOEXEC.BAT и CONFIG.SYS)  следует  перезагру-
зить  систему  и сохранить конфигурацию в базе (до 10 вариантов
загрузки).  Срабатывание VirWarner при других  обстоятельствах,
как правило,  означает вирус. На всякий случай при срабатывании
защиты на экране отображается дата последней модификации файлов
AUTOEXEC.BAT и CONFIG.SYS.
    В процессе  использования  может  возникнуть  необходимость
входа в меню при корректной конфигурации. Для этого моджно выз-
вать VIRWARNER с параметром "!" или держать  правый  [Alt]  при
загрузке.

          Работа с программой в интерактивном режиме

    При срабатывании защиты (или при вызове с "!" или [Alt]) на
экране отображается окно с результатами проверки по сравнению с
наиболее "похожей"  из сохраненных конфигураций (если разрешена
генерация подробного отчета) и главное меню, содержащее следую-
щие пункты:

 1) Boot     / переЗагрузка - Холодный рестарт
 2) Continue / Продолжать   - Игнорировать и выйти
 3) Save     / Сохранить    - Сохранение текущих параметров
 4) cLear    / Очистить     - Очистка каких-л. ячеек базы
 5) cOnfigure/ Конфигурация - Настройка параметров VIRWARNER'а
 6) Detail   / Подробно     - Ручной просмотр структур данных

    Предусмотрена парольная защита пунктов 3..5 по первому  па-
ролю (т.е.  ограничение  прав изменения конфигурации),  а также
пункта 2 по второму паролю (запрет игнорирования подозрительных
ситуаций). Пароли  создаются,  изменяются  и уничтожаются через
меню настройки параметров.

┌──────────────────────────────────────────────────────────────┐
│                      LICENSE & WARRANTY                      │
│  This software is Copyright (C) 1994 by Alexander Yanovsky.  │
│                                                              │
│   This software may not be changed or  modified  in  any  way│
│except by the author.  It is FREEWARE,  and may be freely used│
│and distributed,  as long as it remains in its  complete  form│
│and no fee is charged.                                        │
│   The author makes no warranty of any kind,  either expressed│
│or implied.                                                   │
│   IN NO EVENT SHALL THE AUTHOR  BE  LIABLE  FOR  ANY  DIRECT,│
│INDIRECT,  CONSEQUENTIAL, OR INCIDENTAL DAMAGES ARISING OUT OF│
│THE USE OR INABILITY TO USE THIS PRODUCT EVEN  IF  THE  AUTHOR│
│HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES OR CLAIM. │
│                                                              │
│          ЛИЦЕНЗИОННОЕ СОГЛАШЕНИЕ И ОТВЕТСТВЕННОСТЬ           │
│   Авторские права на данное программное обеспечение принадле-│
│жат Александру Емельянову (Яновскому). Copyright (C) 1994     │
│                                                              │
│   Настоящее программное обеспечение не может быть модифициро-│
│вано никем,  кроме автора.  Оно является FREEWARE,  т.е. может│
│свободно  использоваться и распространяться в полной изначаль-│
│ной форме при условии,  что из распространения не  извлекается│
│выгода.                                                       │
│   Автор не дает никаких гарантий, связанных с настоящим прог-│
│раммным обеспечением.                                         │
│   НИ ПРИ КАКИХ ОБСТОЯТЕЛЬСТВАХ АВТОР НЕ НЕСЕТ ОТВЕТСТВЕННОСТИ│
│НИ ЗА КАКИЕ ПРЯМЫЕ, КОСВЕННЫЕ, ЗАКОНОМЕРНЫЕ ИЛИ СЛУЧАЙНЫЕ ПОВ-│
│РЕЖДЕНИЯ,  ПРОИСШЕДШИЕ ПРИ ПРАВИЛЬНОМ ИЛИ НЕПРАВИЛЬНОМ ИСПОЛЬ-│
│ЗОВАНИИ  НАСТОЯЩЕГО ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ,  ДАЖЕ ЕСЛИ АВТОР│
│БЫЛ ПРЕДУПРЕЖДЕН ОБ ИХ ВОЗМОЖНОСТИ.                           │
└──────────────────────────────────────────────────────────────┘
