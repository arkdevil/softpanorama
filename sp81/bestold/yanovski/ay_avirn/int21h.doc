             Универсальное средство для обнаружения
                  резидентных файловых вирусов
                     в цепочке обработчиков
                             Int21h

    Предлагаемая программа  позволяет в любой момент работы про-
верить оперативную память компьютера  на  наличие  "посторонних"
программ,  перехватывающих  прерывание DOS.  Таким образом можно
обнаружить большинство файловых вирусов (т.е.  те, в которых от-
сутствуют  приемы сопротивления трассировке).  Суть работы прог-
раммы состоит в следующем:
    1. Путем  трассировки прерывания составляется таблица сигна-
тур (первые 16 байт) всех обработчиков Int 21h
    2. Полученные  сигнатуры сравниваются с запомненными ранее в
файле INT21H.TBL
    3. Для всех "знакомых" программ выводятся их условные имена,
а для "незнакомых" - запрос-предупреждение:  Unknown program  in
chain at  XXXX:XXXX  (Неизвестная  программа в цепочке по адресу
XXXX:XXXX). В последнем случае предлагается меню из  трех  пунк-
тов: идентификация программы (попытка получения имени файла, за-
нимающего эти адреса, вывод на экран и возврат в меню), сохране-
ние сигнатуры  в  списке  (имя  запрашивается,  если проводилась
идентификация - по  умолчанию  предлагается  определенное  ранее
имя) или  пропуск неизвестной программы (если Вы не знаете,  что
это такое).

    Следует заметить, что при изменении порядка запуска резиден-
тов в AUTOEXEC.BAT, исключении некоторых из них, а также при до-
бавлении программ,  не перехватывающих Int 21h, программа Int21h
опознает их корректно и не будет "паниковать".
    Программу рекомендуется использовать в качестве дополнения к
программе VirWarner,  т.к. она, в отличие от последнего, не тре-
бует идентичности среды при запусках  (т.е.  работает  одинаково
под любыми оболочками и т.п.)
    P.S. В процессе испытания программы выявлен интересный факт:
драйвер 800.COM опознается неверно (под именем соседней програм-
мы), что вызвано его (драйвера) "хитрой" инсталляцией в  память.
Определить это  нарушение  можно  по смещению адреса:  оно равно
03F8h. Область HMA не опознается,  но с ней все просто: линейный
адрес больше  FFFFFh,  к  тому же обработчик - следующий за DOS,
который идентифицируется корректно.

┌──────────────────────────────────────────────────────────────┐
│                      LICENSE & WARRANTY                      │
│  This software is Copyright (C) 1994 by Alexander Yanovsky.  │
│                                                              │
│   This software may not be changed or  modified  in  any  way│
│except by the author.  It is FREEWARE,  and may be freely used│
│and distributed,  as long as it remains in its  complete  form│
│and no fee is charged.                                        │
│   The author makes no warranty of any kind,  either expressed│
│or implied.                                                   │
│   IN NO EVENT SHALL THE AUTHOR  BE  LIABLE  FOR  ANY  DIRECT,│
│INDIRECT,  CONSEQUENTIAL, OR INCIDENTAL DAMAGES ARISING OUT OF│
│THE USE OR INABILITY TO USE THIS PRODUCT EVEN  IF  THE  AUTHOR│
│HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES OR CLAIM. │
│                                                              │
│          ЛИЦЕНЗИОННОЕ СОГЛАШЕНИЕ И ОТВЕТСТВЕННОСТЬ           │
│   Авторские права на данное программное обеспечение принадле-│
│жат Александру Емельянову (Яновскому). Copyright (C) 1994     │
│                                                              │
│   Настоящее программное обеспечение не может быть модифициро-│
│вано никем,  кроме автора.  Оно является FREEWARE,  т.е. может│
│свободно  использоваться и распространяться в полной изначаль-│
│ной форме при условии,  что из распространения не  извлекается│
│выгода.                                                       │
│   Автор не дает никаких гарантий, связанных с настоящим прог-│
│раммным обеспечением.                                         │
│   НИ ПРИ КАКИХ ОБСТОЯТЕЛЬСТВАХ АВТОР НЕ НЕСЕТ ОТВЕТСТВЕННОСТИ│
│НИ ЗА КАКИЕ ПРЯМЫЕ, КОСВЕННЫЕ, ЗАКОНОМЕРНЫЕ ИЛИ СЛУЧАЙНЫЕ ПОВ-│
│РЕЖДЕНИЯ,  ПРОИСШЕДШИЕ ПРИ ПРАВИЛЬНОМ ИЛИ НЕПРАВИЛЬНОМ ИСПОЛЬ-│
│ЗОВАНИИ  НАСТОЯЩЕГО ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ,  ДАЖЕ ЕСЛИ АВТОР│
│БЫЛ ПРЕДУПРЕЖДЕН ОБ ИХ ВОЗМОЖНОСТИ.                           │
└──────────────────────────────────────────────────────────────┘
