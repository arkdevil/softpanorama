

	Модуль обработки текстовых потоков и строковых
		 списков  LcText V 1.2

                (c) 1992 Мигач Ярослав

	Модуль содержит  ряд процедур  и функций  для работы  со
строковыми списками, что позволяет выполнять такие действия  как
добавление строки в список,  удаление строки из списка,  вставка
подсписка  в  список,  усечение  списка,  получение  ссылки   на
необходимый элемент списка, вычисление размера списка в  строках
и байтах.  Процедуры и  функции по  обработке списков  позволяют
также построить список из заданных строковых констант,  получить
список  строк  имен   файлов  текушего  поддиректория.   Имеется
процедура для получения пути в текущий поддиректорий.
	Однако основой  модуля являются  не процедуры  обработки
строковых  списков,  а  текстовые  потоки  ввода/вывода, которые
представлены  несколькими  обьектными   типами  обьявленными   в
интерфейсной   секции   модуля.   Необходимость    использования
текстовых потоков обьясняется отсутствием гибкости при работе  с
текстовыми   файлами.   В   обычном   текстовом   файле  имеется
возможность только последовательного чтения или последовательной
записи строк в файл. Нет возможности, скажем вернутся на  строку
назад.  Для  выполнения  даже  такого  простейшего,  казалось бы
дествия придется переоткрывать файл  заново и читать все  строки
до предыдущей  включительно. Если  в файле  содержится более 500
строк то такая программа будет работать очень медленно.
	Текстовый поток предоставляет возможность  произвольного
доступа  в  текстовый  файл.  Аналогично  процедуре  SEEK  можно
установить номер  строки с  которой начинать  чтение или запись.
Текстовый поток позволяет читать или писать в файл сразу не одну
строку,  а  список  строк  заданного  размера.  Кроме  этого   в
текстовом  потоке  имеется  совершенно  уникальная   возможность
удалять строки из середины  текстового файла, втавлять строки  в
середину  файла.  Имеется  также  возможность добавлять строки в
конец  текстового   файла  или   усекать  файл   по  строке    с
установленным номером. Текстовые потоки работают с файлами любой
длины   занимая    при   этом   миммум   места   в   динамически
распределяемой  области  памяти.  Размер  выделяемого буфера под
дисковые  операции  от   512  байт  до   64  Кбайт  по   желанию
пользователя.   Оптимальный   размер   буфера   4   Кбайта,  что
установлено эксперементальным путем.
	Ранее  речь  шла  только  о  текстовых  файлах.   Однако
благодаря   гибкости   обьектного   программирования  информация
для текстового потока модет быть представлена не только  файлами
различной структуры, но и например списком или массивом строк из
памяти  компьютера.  При  этом  программе использующей текстовые
потоки  совершенно  без  разницы  откуда  текстовый  поток берет
информацию  и  куда  передает  ее.  Именно  благодаря   гибкости
текстовых потоков  этот модуль  стал базовым  для многих модулей
ситемы  поддержки  TURBO  PASCAL  SUPPORT.  На  основе текстовых
потоков  созданы  модули  просмотра  текстов,  строковых   меню,
текстового редактора,  шаблона редактирования  для баз  данных и
д.р.  Список  подобных  модулей  постоянно расширяется поскольку
именно текстовые потоки предоставляют уникальные возможности для
программ обработки текстовой информации.


	Модуль LcText реализован на языке  Tupbo Pascal V 6.0  и
требует для своей поддержки  такие стандартные модули как  Crt и
Dos.  LcText  написан  методом  защитного программирования и при
некорректных обращениях к методам того или иного обьектного типа
будет  выдаваться  сообщение  о  месте  и характере произошедшей
ошибки.  В   такой  ситуации   работа  программы    прерывается.
Существует также  класс некритических  ошибок для  распознавания
которых служит функция получения кода ошибки.  Необходимо  также
отметить  что  многие  процедуры  и  функции  обработки  списков
используют   рекурсию.   Вследствие   этого   при  использовании
процедур,  функций  или  методов  обьектных типов, работающих со
списками, необходимо выделять область стека от 32 до 48 Кбайт.


	        Обработка строковых списков.

	В интерфейсной  секции модуля  для работы  со строковыми
списками обьявлены следующие типы данных :

RecLinePtr = ^RecLine;

	- обьявляет указатель на элемент строкового списка.

RecLine = RECORD
		Line : STRING;
	        Next : RecLinePtr
	  END;

	- обьявляет элемент строкового списка который включает в
себя:
        Line - строку списка;
        Next - указатель на следующую строку в списке.
        Если указатель имеет значение NIL то рассматриваемый
        элемент в списке   последний.

	Все процедуры и  функции обработки списков  расчитаны на
работу    с    прямолинейными     списками.    Списки     нельзя
"закольцовывать", т.е. указателю конца списка присваивать  какой
либо  из  элементов  этого  списка.   Это приведет к "зависанию"
ппрограммы  при  попытке  обработки   такого  списка  одной   из
приведенных в модуле процедурой или функцией.

	Рассмотрим  процедуры  и   функции  обработки   строовых
списков:

PROCEDURE ClearListRecLine ( VAR LnPtr : RecLinePtr );

	-  уничтожает  список  сторок   по  указателю  LnPtr   и
возвращает значение указателя NIL.



FUNCTION FindLine ( Quantity : LONGINT; LnPtr : RecLinePtr ) : RecLinePtr;

	-  возвращает  указатель  на  заданный  элемент  списка.
Quantity - номер элемента на который требуется указатель.  LnPtr
-  указатель  на  начало  строкового  списка.  В  случае, еслиии
элемент  с  заданным  номером  в  списке  несуществует,  функция
возвращает значение NIL.

FUNCTION SizeListLine ( LnPtr : RecLinePtr ) : LONGINT;

	-  возвращает  количество  элементов  в строковом списке
LnPtr. Где LnPtr - указатель на начало строкового списка.

PROCEDURE DelListLine ( Number : LONGINT; VAR LnPtr : RecLinePtr );

	-  удаляет  элемент  с  порядковым  номером  Number   из
заданного  строкового  списка.  LnPtr  -  указатель  на   начало
строкового списка из которого удаляется строка.

PROCEDURE AddListLine ( VAR LnPtr, InsPtr : RecLinePtr );

	- добавляет подсписок к списку. Где LnPrt - указатель на
заданный список,  а InsPtr  - указатель  на заданный  подсписок.
После добавления  процедура возвращает  значение NIL  в качестве
указателя на добавляемый подсписок.

PROCEDURE InsertList ( Number : LONGINT;
                     VAR LnPtr, InsPtr : RecLinePtr );

	-  вставляет  подсписок  в  список  начиная  с заданного
элемента  списка.  Где  LnPtr  -  указатель  на начало списка, а
InsPtr -  указатель на  начало подсписка.  После вставки элемент
списка  с  номером  Number  будет  первым элементом вставленного
подсписка.  Процедура  возвращает   значение  NIL   в   качестве
указателя  на  добавляемый   подсписок.  Если  значение   Number
превосходит номер  последнего элементааа  списка, то  происходит
добавление подсписка в конец списка.

FUNCTION FullSizeList ( LnPtr : RecLinePtr ) : LONGINT;

	-  возвращает  размер  списка  в  байтах. Причем к длине
каждой строки  списка прибавляется  2 для  учета знаков перевода
строки  и  перевода  каретки,  которые  отсутствуют  при обычном
представлении  строк  в  Паскале.   LnPtr  - указатель на первый
элемент рассматриваемого списка.

FUNCTION FullSizeQLines ( Quantity : LONGINT; LnPtr : RecLinePtr ) : LONGINT;

	-  возвращает  размер  первых  Quantity  строк   списка.
Работает аналогично предыдущей функции.


PROCEDURE TruncateListLine ( MaxLine : LONGINT; VAR LnPtr : RecLinePtr );

	- отсекает элементы от списка оставляя в списке  MaxLine
первых   строк.   LnPrt   -   указатель   на   первый    элемент
рассматриваемого списка.

FUNCTION BuildLineList ( Line : STRING;
                         Next : RecLinePtr ) : RecLinePtr;

	- возвращает указатель на список состоящий из  строковых
констант.  Line  -  строка  составляющая  элемент списка; Next -
указатель на следующий  элемент списка. Приведем  простой пример
построения списка строк :

     BuildLineList ( 'Первая строка',
     BuildLineList ( 'Вторая строка',
     BuildLineList ( 'Последняя строка',
                   NIL ) ) );

FUNCTION CopyListLine ( Quantity : LONGINT;
                        LnPtr : RecLinePtr ) : RecLinePtr;

	-  возвращает  указатель  на  копию списка состоящего из
первых Quantity элементов исходного списка. LnPtr - указатель на
исходный список.

FUNCTION BuildDirList ( DirPath : STRING ) : RecLinePtr;

	-  возвращает  указатель  на  список  строк  имен файлов
указанного   директория.   DirPath   -   путь   в  запрашиваемый
директорий.

FUNCTION GetCurrentDir : STRING;

	-  возвращает   строковое  значение   пути  в    текущий
поддиректорий.

       	    Обработка ошибок в текстовом потоке.

	Следующаая процедура  обьявленная в  интерфейсной секции
модуля  является  процедурой-заглушкой  для  выдачи  сообщения о
некритической   ошибке   обработки   текстового   потока.    При
необходимости одним из методов обработки текстового потока можно
заменить эту процедуру процедурой пользователя.

PROCEDURE NulErrProc ( Err : BYTE );

	Для увеличения  гибкости системы  в разделе  определения
типов интерфейсной  секции представлен  тип процедуры  обработки
некритических  ошибочных  ситуаций  вознииикающих  в   текстовых
потоках:
         ErrorProcedure = PROCEDURE ( Err : BYTE );

где Err - код ошибки.



   	       Обьектные типы текстовых потоков


	В модуле представлены 3 обьектных типа различных
текстовых потоков. Следует отметить, что потоки не обрабатывают
строки содержащие более 255 символов.


LocationText = OBJECT

	- базовый обьктный тип обеспечивающий обмен информацией
через текстовый поток с обычным текстовым файлом.


LocationListText = OBJECT   ( LocationText )

	- обьектный тип обеспечивающий обмен информацией через
текстовый поток со стороковым списком. ( процедуры и функции для
обраьотки строковых списков представлены в педыдущем разделе ).


LocationProtectText = OBJECT   ( LocationText )

	- обьектный тип обеспечивающий обмен информацией через
текстовый поток с закодированным текстовым файлом. Здесь
представлен самый примитивный способ кодирования - прибавление
некоторой константы к каждому байту текстового файла. Этот
способ кодирования может быть усложнен пользователем путем
написания собственных методов кодирования/декодирования.

	Для удобства использования в интерфейсной секции модулей
обьявлены типы указателей на приведенные обьектные типы
текстовых потоков:

LocationTextPtr = ^LocationText;

LocationListTextPtr = ^LocationListText;

LocationProtectTextPtr = ^LocationProtectText;

	- к имени обьектного типа добавляется Ptr



               Поля обьектного типа LocationText

	Рассмотрим поля переменных обьявленыые в обьектном  типе
LocationText.   Запрещается изменять  значения этих  полей путем
непосредственного  обращения  к  ним.  Подобные  изменения могут
повлечь непредсказуемое  поведение программы.  Получать значение
того  или  иного  поля  рекомендуется  только  через  специально
предназначенные  методы  обьектного  типа.  Автор  программы  не
гарантирует совпадения  значений полей  с последующими  версиями
модуля обработки текстовых потоков.

BufferPtr : ^TypeBuffer;

	- указатель на буфер обмена текстового потока. Место под
буфер выделяется  при инициализации  потока. Буфер  уничтожается
только при уничтожении потока.

SizeBuf : WORD;

	-   размер   буфера   текстового   потока   в    байтах.
Устанавливается при инициализации.

SizeFact : WORD;

	-  фактическое  количество  информации  в  буфере.   Это
значение изменяется каждой операцией чтения информации из  файла
в буфер.

PointBeginBuf : LONGINT;

	- указатель на начало буфера текстового потока в  файле.
Фактически  буфер  представляет  собой  плавающее окно по файлу.
Значение указателя при инициализации обьекта устанавливается в 0
и изменяется при чтении или записи информации в поток.

DublePointBeginBuf : LONGINT;

	- сохраненное значение предыдущего указателя.

NowLinePtr : WORD;

	-  указатель  на  начало  обрабатываемой строки в буфере
потока. Перед  вызовом любого  из методов  потока этот указатель
должен находится на первом символе текущей строки.

DubleNowLinePtr : WORD;

	- сохраненное значение предыдущего указателя.

NowLineNumber : LONGINT;

	- номер текущей строки в потоке.


DubleNowLineNumber : LONGINT;

	- сохраненное значение номера текущей строки.

MaxLineNumber : LONGINT;

	- количество строк в текстовом потоке. Если файл пуст то
считается  что  в  потоке  находится  одна  единственная  пустая
строка. Если последние символы текстового файла - перевод строки
и  перевод  каретки,  то  считается,  что последняя строка файла
пустая.

KeyEOF : BOOLEAN;

	- признак выхода указателя за границу потока.

DubleKeyEOF : BOOLEAN;

	- сохраненное значение предыдущего признака.

SingState : BOOLEAN;

	- признак сохраненного состояния.

NumError : BYTE;

	- код некритической ошибки возникшей в текстовом  потоке
при обработке файла.

0 - успешное завершение операции
1 - ошибка чтения файла
2 - ошибка записи в файл
3 - общая ощибка дисковой операции
4 - установлен несуществующий номер строки
5 - ошибка при усечении файла
6 - нет места в динамически размещаемой области памяти.

	Если перед вызовом одного из методов чтения, записи  или
установки номера    строки  код ошибки  будет отличен  от нуля -
вызывается процедура с выводом сообщения о критической ошибке  и
выполнение  программы  прерывается.  Метод  проверки кода ошибки
сбрасывает  его  в  0.  При  возникновении  некритической ошибки
вызывается соответствующая процедура вывода сообщения об ошибке,
которая   назначается   пользователем.   Если   такая  процедура
пользователем  неназначена,  то   никаких  действий  по   выдаче
предупреждающих сообщений непроизводится. Если методом  проверки
состояния  кода  ошибки  обнаружен  кож  ошибки отличный от нуля
следует  воспользоваться  методом   сброса  потока  в   исходное
состояние  и  затем  попытатся  повторить  выполнение   операции
вызвавшей установку кода ошибки.



ErrorProc : ErrorProcedure;

	- процедура выдачи  сообщения о некритической  ошибке. В
исходном состоянии указывает на процедуру NulErrProc обьявленную
в  интерфейсной  секции  модуля.  Эта  процедура  не  производит
никаких действий.

Fl : FILE;

	- хендл  файла обрабатываемого  текстовым потоком.  Этот
файл  открывается   при  инициализации   текстового  потока    и
закрывается  при  его  уничтожении  ( деинициализации при помощи
деструктора ).

SingWrite : BOOLEAN;

	- признак  того что  требуется запись  буфера потока  на
диск в случае смены буфера.

SingStreamEOF : BOOLEAN;

	- признак  достижения  конца потока.  Устанавливается  в
том  случае,  если  прочитана   последняя  строка  потока.   При
обращении  к  методу  установки  номера  текущей стороки признак
сбрасывается


	   Констракторы и дестракторы обьектного типа
		       LocationText.


CONSTRUCTOR Init ( SzBuf : WORD; Name : STRING );

	-  производит  построение  таблицы  виртуальных методов,
Открывает файл  с именем  Name. Если  такой файл  отсутствует на
диске,  то  он  будет  создан.  Происходит выделение динамически
распределяемой  области  памяти  под  буфер  обмена для дисковых
операций чтения/записи. Подсчитывается общее количество строк  в
файле. Производится установка  всех указателей на  первую строку
файла. Установленное состояние считается сохраненным ( См. далее
медоды сохранения и восстановления текущего состояния ).

DESTRUCTOR Done; VIRTUAL;

	- производит уничтожение  таблицы виртуальных методов  и
буферов обьекта. Закрывает файл.


	Базовые методы обьектного типа LocationText.


	Рассмотрим  базовые  методы  обработки текстовых потоков
обьявленные обьектным типом LoationText:

PROCEDURE ReSetStream;

	-  устанавливает  обьект  потока  в  исходное состояние.
Номер  текущей  строки  потока   становится  равным  1.   Заново
подсчитывается количество строк в потоке. Этот метод  вызывается
констрактором    инициализации    потока.    Метод    необходимо
использовать при возникновении некритической ошибки в потоке.

FUNCTION GetNumberError : BYTE;

	- позволяет получит код некритической ошибки возникшей в
текстовом потоке.  После вызова  этого метода  поле кода  ошибки
сбрасывается в нулевое  состояние. Возможны следующие  значения,
возвращаемые эитим методом:

0 - успешное завершение операции
1 - ошибка чтения файла
2 - ошибка записи в файл
3 - общая ощибка дисковой операции
4 - установлен несуществующий номер строки
5 - ошибка при усечении файла
6 - нет места в динамически размещаемой области памяти.

Необходимо учитывать, что если  перед вызовом любого из  методов
потока / кроме  метода установки потока  в исходное состояние  /
поле  кода   ошибки  содержит   значение  отличное   от  0,   то
генерируется   критическая   ошибка   и   выполнение   программы
прекращается.

PROCEDURE SetLineNumber ( Num : LONGINT ); VIRTUAL;

	- устанавливает номер текущей строки в потоке. Нумерация
строк в потоке  ведется от 1.  В отличии от  процедуры SEEK, для
файлов  прямого  доступа,  этот  метод непозволяет устанавливать
номер  строки  за  пределы   потока.  Таким  образом   последний
разрешенный  номер  это  общее  количество  строк  в потоке. При
попытке   установить   номер   выходящий   за   пределы   потока
генерируется код некритической ошибки #4.

FUNCTION GetLineNumber : LONGINT;

	-  позволяет  получить   номер  текущей   обрабатываемой
строки.

FUNCTION GetSize : LONGINT;

	- возвращает общее количество строк в потоке.


FUNCTION GetCurrentChar : CHAR; VIRTUAL;

	- внутренний метод потока, позволяющий получить  текущий
символ   текущей   строки.   Заменив   этот   метод   на   метод
декодирования   можно   обрабатывать   зашифрованные   текстовые
потоки. Непосредственное использование метода нерекомендуется.

PROCEDURE SetCurrentChar ( Ch : CHAR ); VIRTUAL;

	-  внутренний  метод  потока,  позволяющий  установить /
записать  /  символ  в  текущую  строку  по  текущему   значению
указателя.  Заменив  этот  метод  на  метод  кодирования   можно
обрабатывать  зашифрованные  текстовые  потоки. Непосредственное
применение метода нерекомендуется.

PROCEDURE NextChar;

	- внутренний  метод. Перемещает  указатель к  следующему
символу.  При  необходимости  перезагружает  буфер.  При попытке
вывода указателя за пределы потока устанавливает признак KeyEOF.
Перед  обращением  к  методам  чтения,  записи, установки номера
строки указатель  должен находится  под первым  символом текущей
строки. При невыполнении этого условия генерируется  критическая
ошибка и работа программы прерывается. Поэтому  непосредственное
использования этого метода запрещается.

PROCEDURE PrevChar;

	- внутренний метод.  Перемещает указатель к  предыдущему
символу. в остальном  аналогичен методу перемещения  указателя к
следующему символу.

FUNCTION EofText : BOOLEAN;

	- позволяет получить признак  чтения последней    строки
текстового  потока.  Этот  признак  устанавливается  только  при
чтении последней строки потока и сбрасывается методом  установки
номера строки.

PROCEDURE TruncateLines;

	-  отсекает  поток  по  текущей  строке.  Размер  потока
становится на  1 меньше  чем номер  ранее установленной  строки.
Текущей   становится   последняя   строка   потока.   Исключение
составляет отсечение потока  по первой строке.  В этом случае  в
потоке остается одна  единственная строка нулевой  длины. Размер
файла при этом становится равным 0.

PROCEDURE DelLines ( Quantity : LONGINT ); VIRTUAL;

	- удаляет  из потока  заданное количество  строк начиная
с  текущей.  При  попытке  удалить  строку  за  пределами потока
генерируется код некритической  ошибки #4. Номер  текущей строки
остается неизменным за исключением того случая, когда  удаляется
последняя строка потока.


PROCEDURE ReadLines ( Quantity : LONGINT;
                      VAR LnPtr : RecLinePtr ); VIRTUAL;

	- читает из потока  заданное количество строк начиная  с
текущей.  Создает   строковый  список   из  прочитанных   строк.
Возвращает указатель LnPtr на прочитанный строковый список.  При
попытке  передачи  непустого  указателя  генерирует  критическую
ошибку. Номер текущей строки смещается на количество прочитанных
строк. Исключение составляет  случай, когда прочитана  последняя
строка  потока.  В  этом   случае  текущей  строкой   становится
последняя строка потока. При попытке прочесть больше строк,  чем
находится в потоке генерируется код некритической ошибки #4.

PROCEDURE InsertLines ( Quantity : LONGINT;
                        LnPtr : RecLinePtr ); VIRTUAL;

	-  вставляет  в  поток  заданное  количество  строк   из
строкового списка LnPtr начиная с текущей. Номер текущей  строки
увеличивается на количество вставленных строк. Размер текстового
потока  увеличивается  на  количество  вставленных  строк.  Если
указано  количество  строк  больше,  чем  находится  в строковом
списке,  ошибки  непроисходит.  При  помощи  этого метода нельзя
добавить строки после последней строки потока.

PROCEDURE AddLines ( Quantity : LONGINT;
                     LnPtr : RecLinePtr ); VIRTUAL;

	-  добавляет  в   поток  заданное  количество   строк из
строкового  списка  LnPtr  после  последней строки потока. Номер
текущей строки неизменяется.  В остальном этот  метод аналогичен
предыдущему.

PROCEDURE ReplaseLines ( DelQuantity : LONGINT;
                         InsQuantity : LONGINT;
                         LnPtr : RecLinePtr ); VIRTUAL;

	- заменяет в потоке DelQuantity строк начиная с  текущей
на InsQuantity строк из  строкового списка LnPtr. Номер  текущей
строки  номер   текущей  сторки   увеличивается  на   количество
вставленных новых строк.

PROCEDURE ReadLine ( VAR Line : STRING );

	- читает одну строку из текстового потока. Номер текущей
строки увеличивается на 1,  если прочтитана не последняя  строка
потока.

PROCEDURE InsLine ( Line : STRING );

	- вставляет одну строку  в поток перед текушей.  Текущей
становится вставленная строка.


PROCEDURE DelLine;

	- удаляет текущую строку из потока. Номер текущей строки
неизменяется, если была удалена не последняя строка потока.

PROCEDURE WriteLine ( Line : STRING );

	-  записывает  строку  в  поток  вместо  текущей.  Номер
текущей строки увеличивается на 1.

PROCEDURE AddLine ( Line : STRING );

	- добавляет  одну строку  в конец  потока. Номер текущей
строки неизменяется.

PROCEDURE SetErrorProc ( Param : ErrorProcedure );

	-  позволяет  определить  процедуру  выдачи  сообщения о
некритической  ошибке  для  данного  обьекта  текстового потока.
Установленная  процедура  будет  вызываться  всякий раз, когда в
потоке возникнет некритическая ошибка.

PROCEDURE SaveState; VIRTUAL;

PROCEDURE RestoreState; VIRTUAL;

	- эти два метода можно рассматривать только вместе.  Они
служат  для  ускореня  обработки  текстов  при  помощи текстовых
потоков.  Первый  метод  запоминает  текущее  состояние потока -
номер текущей строки, состояние буфера, указатели и т.п.  Второй
метод позволяет  восстановить это  сохраненное ранее  состояние.
Восстановление  состояния  происходит  значительно  быстрее, чем
установка  строки   с  заданным   номером.  При    использовании
текстового  потока  только  для  чтения  применение этих методов
невызывает препятствий. Однако, когда кроме чтения  производится
и  запись  информации  в  поток, восстановление состояния бывает
невозможно.  В  случае  невозможности  восстановления  состояния
генерируется   критическая   ошибка   и   выполнение   программы
прерывается. После инициализации сохраненным считается начальное
состояние потока.


   	    Поля обьекного типа LocationListText.

	Рассмотрим   поля   обьекного   типа    LocationListText
текстового потока  обработки строковых  списков. Этот  обьектный
тип наследует  все поля  и методы  обьектного типа LocationText.
Нерекомендуется  использовать  значения   обьявленных  полей   в
своей программе. Запрещается изменять значения этих полей.

List : RecLinePtr;

	- указатель на первый элемент строкового списка  потока.
Запрещается обрабатывать  текстовый список  принадлежащий потоку
какими либо другими  методами, кроме как  доступом к нему  через
методы определенные обьектным типом текстового потока.

MaxLine : LONGINT;

	-  максимально  разрешенное  количество  строк в потоке.
Это поле вводится для  ограничения размера строкового списка  во
избежании   перепонения   динамически   распределяемой   области
памяти.


	Констракторы и дестракторы обьектного типа
		   LocationListText.

CONSTRUCTOR Init ( LnPtr : RecLinePtr; Max : LONGINT );

	- инициализирует значения полей потока, создает  таблицу
виртуальных  методов.  LnPtr  -  указатель  на  первый   элемент
строкового  списка  обрабатываемого  текстовым  потоком.  Max  -
максимально   разрешенное    значение    количества    элементов
строкового списка обрабатываемого  потоком. В случае  превышения
этого  значения  необходимое   количество  последних   элементов
строкового   списка    отсекается.   Запрещается    обрабатывать
текстовый  список   принадлежащий  потоку  какими  либо  другими
методами, кроме как  доступом к нему  через методы  определенные
обьектным типом текстового потока.

DESTRUCTOR Done; VIRTUAL;

	-   деинициализирует    обьект.    Уничтожает    таблицу
виртуальных  методов.  Строковый  список  принадлежащий   потоку
уничтожается.


	Базовые методы обьектного типа LocationListText.


FUNCTION GetListPtr : RecLinePtr;

	-  возвращает  значение  указателя  на  первый   элемент
строкового списка текстового потока.


	Ниже    приведенные     методы    обрабатывают     поток
аналогично  методам  обьектного  типа  LocationText. Запрещается
использовать  методы  наследованные   от  LocationText,  но   не
перечисленные ниже.

PROCEDURE ReSetStream;

	- Начальная установка текстового потока

PROCEDURE SetLineNumber ( Num : LONGINT ); VIRTUAL;

        - установить номер обрабатываемой строки

PROCEDURE TruncateLines;
        - отсекает строки из по потока начиная с текущей

PROCEDURE DelLines ( Quantity : LONGINT ); VIRTUAL;

        - удалить из потока  заданное количество строк   начиная
с текущей

PROCEDURE ReadLines ( Quantity : LONGINT;
                    VAR LnPtr : RecLinePtr ); VIRTUAL;

        -  создает   список  из   заданного  количества    строк
загружая их из потока

PROCEDURE InsertLines ( Quantity : LONGINT;
                        LnPtr : RecLinePtr ); VIRTUAL;

        -  вставляет  заданное  количество  строк  из   списка в
поток

PROCEDURE AddLines ( Quantity : LONGINT;
                     LnPtr : RecLinePtr ); VIRTUAL;

        -  добавляет  заданное  количество  строк  из   списка в
поток

PROCEDURE SaveState; VIRTUAL;

        - сохранить текущее состояние

PROCEDURE RestoreState; VIRTUAL;

	- восстановить сохраненное ранее состояние


       	      Обьектный тип LocationProtectText.

	Этот обьектный  тип является  расширение обьекного  типа
LocationText.  Все  поля  и  методы  обьявленные  в LocationText
действуют  и  в  LocationProtectText, который представляет собой
текстовый поток для  обработки закодированных текстовых  файлов.
Здесь добавлено только одно поле:

Password : BYTE;

	- константа защиты.

Констракторы  и  дестракторы  этого  обьектного  типа аналогичны
обьявленным в LocationText.


   	      Базовые методы обьектного типа
                   LocationProtectText.

FUNCTION GetCurrentChar : CHAR; VIRTUAL;

	-   возвращает   текущий    символ   потока,    выполняя
раскодирование.

PROCEDURE SetCurrentChar ( Ch : CHAR ); VIRTUAL;

	-   устанавливает   текущий   символ   потока,  выполняя
кодирование.

PROCEDURE SetPassword ( Ps : BYTE );

	- Установка  новой константы  защиты. При  инициализации
обьекта значение константы защиты - 18.
