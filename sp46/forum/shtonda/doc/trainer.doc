                   Программа  Trainer.
                   -------------------

       Программа Trainer иллюстрирует в динамике операции  В+  дерева.
Вы можете запустить ее для  примера  того  как  система  Turbo  Pascal
Access вводит и добавляет ключи.

       Наберите командную строку  DOS:  Trainer.  На  экране  появятся
следующие ключи (опции):

     Help    - Выдает описание программы:
     Write   - Позволяет вам добавить ключ и запись в В+ дерево;
     Read    - Читает существующую запись.
     Delete  - Удаляет существующую запись и ее ключ из В+ дерева.
     Next    - Перемещает указатель файла на следующий ключ в
             - последовательности.
     Explain - Выводит комментарии о текущих активных областях
             - экрана;
     Speed   - Выбирает скорость: медленно, средне, быстро;
     Audio   - Включает и выключает звук;
     Quit    - Выход из программы.

       Для активизации  любой  из  этих  функций,  нажмите  клавишу  с
начальной  буквой  выбранной  функции;  например,  для  выхова   Help,
нажмите H.

       Trainer  запускается  командным  файлом,  TRAINER.CMD,  который
автоматически строит  В+  дерево  и  возвращает  управление  вам.  Для
запуска Trainer без автоматического  построения  дерева,  переименуйте
TRAINER.CMD. Программа будет запускаться вручную если  командный  файл
не будет найден.

       После  того  как  Trainer  загрузит  некоторые  данные,   будет
неплохо установить скорость  выполнения  (Speed)  медленной  (slow)  и
переключить Explane в on.

       При  добавлении  ключа  в  В+  дерево,  дерево  проверяется  на
наличие такого же ключа в уже существующей структуре. Если ключ  новый
или  если  дублирование  ключей  разрешено,   поиск   завершается   на
оконечной странице. Если оконечная страница не полная,  ключ  вводится
на страницу таким образом, чтобы  страница  оставалась  сортированной.
Если  оконечная  страница  заполнена  (т.е.  она   уже   содержит   2n
элементов), добавляется новая страница.

        Если вы запускаете Trainer, нажмите клавишу W для  активизации
функции Write. Вам булет предложено ввести пятибуквенное имя (ключ)  и
восьмизначный номер телефона (запись).

        Когда вы введете эти данные, вы увидите как ключ  переместится
на  первую  страницу,  которая  является  одновременно  и  корневой  и
оконечной страницей, и запись переместится  за  ключем.  Добавьте  еще
три клюса с записями для заполнения страницы.

        Этот процесс добавления новых страниц  называется  расщепление
страниц (page splitting). Распределяются  2n+1  ключей.  n  наименьших
элементов перемещаются  на  новую  страницу,  n  наибольших  элементов
остаются на старой  странице,  и  оставшийся  ключ  на  этой  странице
копируется вверх на родительскую страницу, где  она  ассоциируется  со
ссылкой на новую страницу.

        Если  родительская  страница  заполнена,   она   должна   быть
расщеплена для того, чтобы  принять  элемент  перемещаемый  с  нижнего
уровня. На этом пути расщепление страниц  распространяется  рекурсивно
с нижнего уровня по всему пути к  корню.  Если  расщепляется  корневая
страница, то создается новая корневая страница, и  степень  В+  дерева
увеличивается на единицу.

        Для  того,  чтобы  увидеть  процесс  расщепрения   страниц   в
программе Trainer, добавьте еще один ключ. Если вы  все  сделали  так,
как  здесь  описано,  вы  будете  иметь  полную  страницу  с  четырьмя
ключами. Вы увидите, как выш новый ключ будет  добавлен  на  страницу,
делая ее состоящей из пяти ключей - на один больше чем  допустимо  для
этого  частного  файла.  Страница  будет  расщеплена,  образовав   две
оконечные  страницы.  Оставшийся  на  каждой  странице   ключ,   будет
скопирован  на  верхний  уровень,  для  формирования  новой   корневой
страницы. Вы можете продолжить добавление ключей  и  понаблюдать,  как
распространяютя страницы. Обратите  внимание,  что  как  только  новая
норневая  страница  становится  слишком  большой,   она   расщепляется
увеличивая порядок дерева.

        При удалении ключа, система Turbo Pascal  Access  находит  его
местоположение в дереве, удаляет элемент с оконечной страницы, где  он
находится, и уменьшает счетчик страницы.

        Если удаляемый элемент  является  последним  на  странице,  то
другая копия этого  ключа  находится  на  родительской  странице.  Это
должно быть заменено  новым  последним  элементом  на  странице.  Если
перемещаемый элемент был последним на родительской  странице,  то  его
родительские копии должны быть заменены, и т.д. вверх по дереву.

        Когда количество элементов на странице  становится  меньше  n,
система Turbo  Pascal  Access  рассматривает  возможность  слияния  со
смежнной   страницей   (страницей   на   том   же   уровне,   что    и
рассматриваемая, и имеющая того же родителя). При этом возникает  один
из следующих вариантов:

     1. Если общее количество элементов на  двух  страницах  равно  2n
страницы сливаются в одну новую  страницу.  Их  родительская  страница
заменяет два элемента, которые указывали на две  исходные  страницы  с
одним элементом одним элементом указывающим на новую страницу.

     2. Если Общее количество элементов на двух страницах больше,  чем
2n и, поэтому,  они  не  смогут  образовать  одну  страницу,  элементы
перераспределяются между двумя страницами  таким  образом,  чтобы  они
обе имели одинаковое количество элементов (отдавая  или  забирая  один
элемент). Это будет изменять оставшийся элемент на одной  из  страниц,
так, чтобы указатель родительской страницы  изменялся  соответствкющим
образом.

       Процесс  удаления  также  иллюстрирован  в  программе  Trainer.
Введите D для активизации функции удаления,  и  затем,  введите  ключ,
который  вы  хотите  удалить.  Ключ  будет  удален  с   баллансировкой
страницы, если  необходимо,  будет  иметь  место  слияние  страницы  и
пересещение ключей в родительской странице.
