
       Утилита TABuild (Экспериментальный выбор значений констант)
       -----------------------------------------------------------

     Рабочая таблица утилиты TABuild представляет собой  не  что  иное
как упражнение для программиста, который  любит  играться  с  цифрами.
Она  позволяет  вам  экспериментировать  с  различными  константами  в
рамках программы TABuild.  Для  того  чтобы  вызвать  рабочую  таблицу
утилиты  TABuild,  загрузите  программы  TABuild  с  ключем  /W+   для
создания вашей специально сконфигурированной  утилиты  доступа,  введя
следующую командную строку DOS:

              > TABUILD /W+ "Ваш".TYP

    Замечание: Вы можете создать ваш файл определений типов  "Ваш".TYP
с помощью любого текстового редактора, такого как, например,  редактор
встроенный в окружение Турбо Паскаля. Если  "Ваш".TYP  не  существует,
будет создан новый файл определений типов который  будет  загружен  во
встроенный редактор модуля TABuild, после чего  вам  будет  предложено
напечатать секцию определений записи и  ключа  как  описывалось  выше.
Когда вы закончите нажмите клавишу F10 для начала построения.

     TABuild использует ваши определения типов как  include  файл  для
очень простой программы называемой  TASizes  которая  имеет  следующий
основной блок:

     begin
       Writeln(output, 'MaxDataSize' = ', SizeOf(MaxDataType));
       Writeln(output, 'MaxKeyLen = ', SizeOf(MaxKeyType) - 1);
     end

     TABuild компилирует эту программу, в случае  успешной  компиляции
запускает ее на выполнение. Вы заметите, что эта  программа  ссылается
на типы MaxDataType и  MaxKeyType,  которые  вы  должны  определить  в
вашем файле определений типов. Если эти  типы  не  определены  иили  в
вашем  файле  есть  синтаксическая  ошибка,  TABuild  при   компиляции
обнаружит ошибку и передаст ваш файл  определений  типов  в  редактор.
После  того  как  вы  исправите  ошибку,   вы   можете   пнрезапустить
формирование констат, нажав клавишу F10.

     После успешного  выполнения  программы  TASizes  и  получения  ее
выходных данных, TABuild имеет информацию, которая ему необходима  для
вычисления остальных констант подсистемы  доступа.  Теперь  вы  будете
видеть  компиляцию  модуля   Access   для   создания   TACCESS.TPU   и
TAHIGH.TPU, которые будут храниться в вашей рабочей директории.

     Теперь вы можете используя эти модули продолжать  развивать  вашу
прикладную программу обслуживания базы данных.

     Для того  чтобы  просмотреть  список  командных  опций  программы
TABuild, наберите следующую командную строку DOS:

              > TABUILD

      Которая распечатает следующее:

      Syntax:  TABuild [ опции ] TypesFile
     Options:
              /W+  - Использовать константы рабочей таблици программы
                      TABuild для вычисления констант для Turbo Pascal
                      Access.
              /H-  - Не компилировать модуль доступа высокого уровня.
              /E-  - Без сообщений об ошибках и именах процедур.
              /$xx - Компиляция Access с директивой xx.

         Функции этих опций следующие:

              /W+   По умолчанию устанавливается состояние W-, TABuild
         будет вычислять сонстанты Turbo Pascal Access основываясь на
         вашем размере записи и резмере ключа.
              /H-   По умолчанию /H+, TABuild будет компиллировать
         TAHIGH.PAS, модуль вызовов верхнего уровня системы Turbo Pascal
         Access, если этот файл существует в вашей директории Access.
              Если вашей программе  не нужен этот модуль  установите опцию
         /H-.
              /E-    Как и /W опция, /E- может быть использовага только в
         том  случае  когда  вы  завершили  разработку  и  отладку  своей
         программы обслуживания БД.  /E- ликвидирует сообщения об ошибках,
         которые  генерирует  процедура  TurboFatalError  в  случае аварии
         вашей программы.  Turbo Pascal Access также  не будет отслеживать
         имена процедур которые действовали в момент аварии. В этом случае
         ваш  окончательный  результат  будет  компактнее  и  эффективнее,
         однако это вызовет трудности при отладке ваших программ.

╔════════════════ TABuild Constants WorkSheet ══════════════════════╗
║                                                                   ║
║    Estimated total records in the Database    1000                ║
║                                                                   ║
║    Max. Record Size   344    Data File Size     344344 bytes      ║
║                                                                   ║
║    Max. Key Length     25    Index File Size     47035 bytes      ║
║                                                                   ║
║    Page Size - Max. number of keys on a page       60             ║
║                                                                   ║
║    Page Stack Size - Max. pages in memory          31             ║
║                                                                   ║
║    Page Stack memory requirements                63395 bytes      ║
║                                                                   ║
║    Avg. comparisons in a key search               1.81            ║
║                                                                   ║
║    Searches satisfied in memory                  99.00 %          ║
║                                                                   ║
║    Disk searches needed                           1.00 %          ║
║                                                                   ║
║                                                                   ║
║                                                                   ║
║ Defaults     F2 - Save and Quit     Esc - Exit      Calculate     ║
╚═══════════════════════════════════════════════════════════════════╝

          Рисунок С.1 Рабочая таблица программы TABuild.

     Как вы можете видеть, отображаются максимальный размер  записи  и
размер максимальной длины ключа. От вас требуется ввести три вещи:

   - Оценочное значение количества записей которое может быть в файле;
   - Количество ключей на странице (PageSize);
   - Количество страниц в памяти (PageStackSize).

     Когда вы введете количество записей в  файле,  вы  будете  видеть
среди прочего общий размер файла базы данных и индексного  файла.  Это
подскажет  вам,  какого  размера  могут  быть  ваши  файлы.  Если   вы
чувствуете, что каждый из них  слишком  велик,  вы  можете  попытаться
вернуться  назад  и  уменьщить   длину   вашей   записи   данных   или
максимальную длину ключа. Не беспокойтесь, если реальная  база  данных
будет больше чем ваша предварительная оценка. Этот параметр не  влияет
на результат работы TABuild.
     Получив  эти  значения,  TABuild  вычисляет  несколько   выходных
значений; каждое значение дается для базы данных заполненной  на  75%.
Плотность базы данных зависитт от того, как она  создавалась  (порядок
введения новых элементов данных), и стремится приблизится к  75%.  Эти
выходные значения следующие:
    - размер файла  данных  -  апроксимированный  размер  заполненного
файла данных;
    - размер индексного файла- апроксимированный  размер  заполненного
индексного файла;
    - память используемая для стека страницы - количество  RAM  памяти
используемое стеком страницы.
    - среднее число  просмотров,  необходимое  для  нахождения  ключа-
среднее количество раз, которое индексный файл должен быть  просмотрен
для нахождения конкретного ключа.
    - среднее число просмотров обеспечиваемое стеком  страницы  -  при
поиске ключа, некоторые из индексных страниц  которые  необходимы  для
поиска, будут находиться в стеке страниц.
    -  среднее  число  обращений  к  диску  для  поиска  ключа-  число
обращений, которые останется выполнить после  того  как  стек  страниц
исчерпан.
    -  PageSize  и  PageStackSize  могут  быть  изменены   в   сторону
уменьшения количества необходимых  для  нахождения  ключа  (медленных)
обрашений к  диску  когда  нет  необходимости  тратить  слишком  много
памяти под стек страниц.
      Значения четырех наиболее важных выходных параметров следующие:

   1.  Память,  используемая  для  стека  страниц  -  при   увеличении
значения используется больше памяти. Максимальное значение 64Кбайт;

   2.  Размер  индексного  файла  -  при  увеличении  значения,  будет
использоваться большее дисковое пространство;

   3.  Размер  файла  данных  -   при   увеличении   значения,   будет
использоваться большее дисковое пространство;

   4. Среднее число  обращений  к  диску  необходимое  для  нахождения
ключа - при увеличении значения будет требоваться большее время.

     Увеличение PageSize и PageStackSize всегда  увеличивает  значения
параметров пунктов 1 и 2, и уменьшает  значения  параметра  пункта  4.
Балланс может быть найден когда число обрашений к  диску  мало,  в  то
время  как  количество  используемой  памяти  также   мало;   Важность
пространства памяти и  диска  зависит  от  конкретных  приложений.  На
параметр пункта 3 влияет только размер записи  данных  и  размер  базы
данных, таким образом  для  того,  чтобы  уменьшить  занимаемый  объем
необходимо минимизировать размер записи данных.
      Когда вы определите все  значения,  нажмите  F2  для  выхода  из
программы и сохранения ваших констант.
