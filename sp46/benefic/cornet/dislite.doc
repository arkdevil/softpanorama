                                    DISLITE

                            Executable file expander

CONTENTS

         WHAT                          MESSAGES
         WHY                           BUGS
         HOW                           PRICE
         LIMITS                        SOURCE
         TECHS                         WHO


WHAT

   DISLITE expands all programs compressed using PKLITE (tm) to their
   original image. Expanding your files has many benefits over leaving
   them in their compressed state.
   
   First, PKLITE compressed programs can hardly be compressed any further
   using "regular" file compressors like ARJ, LHA. The uncompressed files
   however, usually compress quite well using these products, and normally
   the result of compressing the original file is better than that
   achieved when first compressing with PKLITE, and then with another
   compression utility.
   
   The same argument usually helds if you are using products like Stacker
   or SpeedStor to enlarge your disk, which could be considered as
   compression utilities on-the-fly.
   
   Then there is an increase in execution speed of the uncompressed files,
   because the uncompression is no longer needed before execution. This
   may, on the other hand, not be true on fast machines with slow drives.
   In these circumstances the compressed file might actually execute
   quicker because there is less disk access.
   
   For the compression-hunters, there are a few extra's in this program
   that lets you strip unnecessary information off of the executables,
   so they compress a little better when you PKLITE them next time.
   
   Finally there is the large benefit of being able to "peek" into the
   executable, for those who can understand such information.



WHY

   You could ask why this separate program is necessary, as PKLITE
   supports the -x options to extract compressed files.
   
   The answer is simple. There is also an option in the commercial
   version of PKLITE to generate "unextractable" files (-e). Needless
   to say there are numerous programs available nowadays in this
   "unextractable" format. For those of us who don't like PKLITE for
   some reason, this presents a problem!
   
   DISLITE has the capability of expanding these "unextractable" files
   to their original image. Unfortunately some information is lost
   during the compression process of PKLITE, but there is no important
   information missing. See the TECHS section further on to get
   more details on this.



HOW

   Usage of DISLITE is very simple. If you type it without any arguments,
   a short help screen appears to remind you of the proper usage. If you
   specify the name of an executable file, DISLITE will expand that
   executable to its original state (provided it was compressed using
   PKLITE). If you specify two filenames, the second will be treated as
   the destination file, which will contain the decompressed image.
   Note that you do not need to specify the extension of the executables.
   Then there are several options which may occur anywhere on the command
   line.
   
   The official prototype of the command is as follows:

      DISLITE [options] [d:][/path]Infile [[d:][/path]Outfile]

      Options are:
        -b = make backup .BAK file of original
        -e = Extract unextractable file
        -h = remove irrelevant header data
        -o = overwrite output file if it exists
        -p = align text data on a page
        -r = remove overlay data
        -s = silent, do not generate any warnings
        -u = update file time/date to current time/date
        -v = verbose

   Options can always be combined, so "-b -v -h" can be abbreviated as
   "-bvh". A short description of all possible options follows:
   
   -b  This option makes a backup of the compressed file image, which
       has the same name and path as the Infile, but the extension .BAK.
       Any existing file with that name will be overwritten.
		   
   -e  This option serves two purposes: First, to annoy Phil Katz, the
       original writer of the (quite good) program PKLITE. Second, to
       allow you more freedom in the creation of profane and filthy
       words with the option letters. To further support you in this,
       double specified options have no addition effect at all. The
       commonly heard rumour that the filthiest, profanest words will
       get you enhanced performance of DISLITE is absolutely untrue.
       This option is further completely ignored by the program.
   
   -h  Most linkers include in the exe file header some information that
       is not needed for program execution in any way, information that
       might be used by a debugger later. Use this option to remove that
       information from the executable. (For the technically gifted:
       the information between the end of the documented DOS header, and
       the start of the relocation table. PKLITE ignores all information
       after the relocation table in the header, so that is lost forever
       after using any PKLITE compression method.)
       Note that this option has no effect on .COM files as they have no
       exe header, and neither on extra-compressed files, as the extra
       header data is then removed by PKLITE on compression.

   -o  Use this option to overwrite an output file that already exists.
       Note that files with extensions .BAK and .$$$ with the name of
       the Infile are always overwritten (provided these files are
       generated by the program. You normally never see .$$$ but this
       is used as an interim file in case you only specify an Infile).
   
   -p  Align text data on a page. This option can be used for any .EXE
       file, to make the exe header a multiple of 512 bytes. Some say
       that the executable loads faster if this is the case.
   
   -r  Remove any overlay data present. Overlay data is data after the
       executable file image until the physical end of file. DISLITE
       never complains when overlays are present.
       
   -s  Be silent. No warnings are given, and the header is suppressed
       too. Usefull for background or batch execution.
   
   -u  Update time. Use this option to set the file date/time stamp to
       the current time. Normally, DISLITE leaves the file date/time
       of the file the same (even when you specify an Outfile).
   
   -v  Be verbose. When you use this option, you will get a progress
       indicator, and lots and lots of information about the file
       being uncompressed. Recommended to the nosey.



LIMITS

   DISLITE uses quite a lot of memory. I haven't exactly calculated it,
   but I expect you need approximately 150K + the amount the expanded
   program takes to execute.

   The program uses the build-in extractor of the executable, and
   therefore a very smart virus can get hold of your system if you
   expand a file with a virus in it. But since DISLITE disallows DOS
   access for the expanding program, the chances that you actually
   catch a virus hidden in a file that is expanded are much larger.
   
   The "effective compression" ratio as described under MESSAGES can
   give odd or incorrect results if you specify one of the -hpr
   options.
   
   I haven't really tried to turn DISLITE into a speed demon. Especially
   the part where the resulting executable is written could be a little
   faster. That probably requires quite a thorough rewrite, though.



TECHS

   As said in the previous section, DISLITE uses the extractor build
   into the compressed file to decompress it. There is a little
   debugger inside DISLITE that allows it to only execute the build-in
   decompressor and extracting information from it at the same time.
   Because of this, DISLITE is likely to work with future versions of
   PKLITE also, in case a slightly different encoding scheme is used.
   Currently DISLITE has been tested with PKLITE versions upto 1.13.
   
   .COM files are always extracted to their original image, and so are
   normal compressed .EXE files. (Well, at least restored just as
   PKLITE -x would restore them. If there was any information stored
   after the relocation table, that is lost.)

   Extra compressed .EXE files can not be completely restored to their
   original image. As said before, the information stored in the header
   just after the DOS header and before the relocation table cannot be
   recovered. This information is not needed anyway. Further, there are
   3 entries in the DOS header that can not be recovered completely.
   Two of these, the headersize and the position of the relocation table
   follow from the fact that the additional header data is lost.
   
   The third entry that can not be completely recovered is the minimum
   memory to allocate to the program. This value might be a little bigger
   in the newly extracted image as compared to the original one. In case
   you have such a critical memory setup that the program cannot execute
   with this larger minimum memory requirement, it wouldn't have done so
   WITH the PKLITE decompression code either. Resuming, this is again not
   a great loss.
   
   However, DISLITE is very well able to COMPLETELY restore the relocation
   or fixup table. In fact DISLITE goes through some trouble finding the
   right segment for each fixup, as PKLITE kindly throws that information
   away.



MESSAGES

   Many! DISLITE is stuffed to under its chin with all kinds of information
   messages, most of which are self-explanatory. I will, however, name
   some.
   
   There are four types of messages DISLITE can produce: informational,
   harmless warnings, warnings, and errors.
   
   Informational messages are enabled with the -v option. They include:
   progress indicators, and various file information. There are two
   compression ratio's mentioned for .EXE files: the real compression and
   the effective compression. The real compression is the compression of
   text (executable) data, as achieved by the PKLITE algorithms, and the
   effective compression if the file-to-file overall compression factor,
   the one that PKLITE displays. This latter value might not be correct
   in all circumstances. See LIMITS section.
   

   There are only two harmless warnings (and turned off with -s):
   
      Harmless warning: design thinko or linker cockup.
      Fixup XXXX:XXXX out of segment (should be in XXXX)
      ...
      
   This can only occur if you are extracting a normal compressed .EXE
   file. It means that DISLITE found a fixup to be incorrectly
   specified in the wrong segment. No harm is done, however, since the
   fixup is applied to the same file location nevertheless. This either
   means that there is a major design flaw in DISLITE or, more probably,
   some linker (or other expander software) has made an error. This is
   likely to happen if you expand a file that has previously been
   compressed with LZEXE, uncompressed with an old version old UNLZEXE,
   and then immediately compressed with PKLITE again, without using
   HDROPT first.
   
   What this effectively means is, that if this would have been an extra-
   compressed file, DISLITE would have rebuild it in a different way.
   
   The other harmless warning reports that a relative segment in the .EXE
   is ignored. Not likely to happen.
   
   The program will complete like nothing happened after a harmless warning.
   

   Warnings are given if you try to expand a program that has no executable
   extension, if you are expanding a program that has an .EXE extension but
   is in fact a .COM file or vice versa, if you are expanding a program
   that was compressed with an unknown version of PKLITE (pre 1.03 or post
   1.13), or if the program has unknown internal PKLITE flags set.
   
   You are asked to confirm before proceeding. Again, setting -s turns this
   all off.
   

   There are innumerable errors, mostly DOS errors of the format
   "short explanation:DOS error description". These are all of the type
   "get your dirty hands off that disk drive door and retry". DISLITE
   can't do much about it.
   
   There are some DISLITE specific errors, like "Cannot find end of
   decode loop.", or "Unexpected DOS interrupt from processed program",
   followed by a dump of all internal registers.
   
   This all means that DISLITE has lost track of what's happening, and
   it gives up. I regret to say that DISLITE could be a bit smarter
   about some things. It is a little too keen on giving up currently.
   
   You cannot turn off the errors or stop them from aborting the program.



BUGS

   Just one, but I can't find it. ;-(



PRICE

   Zero. Give this away to all your friends, especially if their initials
   are PK ;) But of course donations are greatly appreciated. See the
   WHO section below to know where to send your money.



SOURCE

   Is very messy. I've written the lot using Borland C++ 2.0. The source
   is one single file, most of it is in C, parts are inline assembler.
   Now that it's finished I realise how it all Should Have Been Done (tm),
   but it's too late for that now.
   
   If you want to take a look at the source, it is available, but not for
   free. If you think you can learn something from this source then I
   can CERTAINLY make you think that you should pay me before I hand out
   that source.
   
   The price is HFL 15,- DM 15,- or AM$ 10 (Yes, the Germans are screwed
   by this, sorry...). See the WHO section below to find out where you
   should sent your payment too. Please include an internet E-mail or
   FidoNet address where I can send the source to. If you don't, include
   a self-addresses envelope properly stamped (or include international
   return coupons). Specify how you want to receive the source: diskette
   or paper.



WHO

   I can be reached:
   
      Jan-Pieter Cornet
      Aletta Jacobsstraat 8
      2642 AD  Pijnacker
      Netherlands
      phone: +31 1736 98480
      Email: cornet@duteca.et.tudelft.nl
          or ba132@cleveland.freenet.edu

      Dutch Bank: ABN Bank Delft, 562217320, tnv. J.P.M. Cornet
      Dutch Giro: 1444902, tnv. J.P.M. Cornet, Pijnacker


   DISLITE (pd)   Executable File Expander   Version 0.91   23-12-91
   Written 1991 JohnPC.   No rights reserved.   Blatant hacking
