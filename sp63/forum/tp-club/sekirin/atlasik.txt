     Предлагаем НА ИЗЛАГАЕМЫХ НИЖЕ УСЛОВИЯХ написать  программу  иденти-
фикации веществ и материалов по их инфракрасным спектрам. Возможны вари-
анты (включение спектров комбинационного  рассеяния,  создание  программ
иного назначения). ОБРАШАТЬСЯ ПО ТЕЛ.:(044)265-15-52, Секирин И.В.
     Вашему вниманию предлагается демo-версия. Комплект поставки:
 README.1ST - информация для редакции бюллетеня;
 ATLASIK.TXT - данная документация;
 ATLASHVV.INC,ATLAALGO.INC,ATLATEST.PAS,ATLASIK2.PAS - исходные тексты;
 ATLAHERZ.DAT,ATLARAST.DAT,ATLAMILL.DAT - атласы;
 C6H6HERZ.DAT,C6H6RAST.DAT,CHCLHERZ.DAT,CHCLRAST.DAT - примеры данных.

                               ОГЛАВЛЕНИЕ
 1. ПРЕДЛАГАЕМЫЕ УСЛОВИЯ: ПОЧЕМУ ИМЕННО ТАК?
 2. КОМУ ЭТО МОЖЕТ БЫТЬ НУЖНО
 3. ЧТО ЭТО ТАКОЕ
 4. ПОЧЕМУ ТАК МАЛО
 5. ПРЕДЛАГАЕМЫЕ УСЛОВИЯ

               1. ПРЕДЛАГАЕМЫЕ УСЛОВИЯ: ПОЧЕМУ ИМЕННО ТАК?
     Существующая практика  поставки  только  exe-файлов,  да  еще  и  с
защитой  от  копирования  и  юридической  защитой  "прав  разработчика",
представляется автору ВСТУПИВШЕЙ В ПРОТИВОРЕЧИЕ С ДУХОМ ПРОГРЕССА. Время
и  усилия,  которые  можно  было  бы  потратить   на   совершенствование
алгоритма, создание новых удобств  для  пользователя,  да  и  просто  на
устранение    ошибок,    тратится    на    создание    средств    против
"несанкционированного копирования" или "взлома", как некоторые  называют
реконструкцию. Создаются роскошные заставки  и  интерфейсы  с  окнами  и
меню,  за  которыми  прячутся   недодуманные   детали,   оборачивающиеся
неудобствами для пользователя,  или  даже  ошибки  в  буквальном  смысле
(лично  встречал).  Автору   известна   (естественно,   коммерческая   и
поставляемая без исходных текстов)  программа,  в  которой  для  расчета
спектров молекул задавать данные можно _только_ в  диалоговом  режиме  -
можно представить, как выглядит расчет  серии  конформеров  какой-нибудь
сложной молекулы  с  помощью  такой  программы.  Преобладает  взгляд  на
пользователя как на дурачка, которому можно за  его  же  деньги  вручить
экзэшник, позволяющий халтурщику вставить в свою статью  фразу  "Расчет,
проведенный по программе ...,  подтверждает  эти  результаты"  (за  счет
случайной компенсации грубейших ошибок и в эксперименте, и в программе),
но не пригодный ни как учебное пособие, ни как основа для улучшений. При
этом разработчик может приговаривать, что, если пользователь  недоволен,
то он  просто  не  освоил  прекрасное  изделие  разработчика.  На  место
рассуждений  о  "второй   грамотности"   (утверждение   "он   не   умеет
программировать"   будет   восприниматься   людьми   так,  как    сейчас
воспринимается утверждение "он не умеет ни  читать,  ни  писать") пришла
реклама продуктов,  требующих  умения  нажимать  кнопки  и  закрепляющих
ситуацию, когда пользователь может не понимать, что же именно он  делает
- например, применять метод за рамками его применимости,  не  подозревая
об этом: зачем разбираться с методом - "пусть  каждый  занимается  своим
делом".  Создалась  целая  индустрия  продуктов,  расчитанных  на  такое
положение дел - от систем "защиты" от реконструкции до пакетов типа Tur-
bo Vision, имеющих  смысл,  по-моему,  лишь  тогда,  когда  пользователя
считают быдлом, не поставляя ему исходные тексты. Окна и меню суют  куда
не лень. Стоит приделать к своей программе заставку и  меню  и  спрятать
текст - все, можно  торговать.  Автору  известны  продукты,  с  которыми
нельзя работать "вслепую" - нужно следить, попал ли ты курсором в нужный
пункт меню (это, с моей точки зрения, неудобно). Уже и разработчики  ОС,
похоже,  начинают  ориентироваться  на  людей,   не   желающих   учиться
программировать. Хваленая Windows не дает никаких преимуществ перед  ДОС
для выполнения такого простого  задания,  как  замена  во  всех  текстах
программ в каталоге, например, имени включаемого файла  с  подпрограммой
или в  смысле  возможности  хранить  задание  в  одном  файле,  а  не  в
нескольких (транслятору - в одном, библиотекарю - в другом, компоновщику
- в третьем,  а  указание  о  том,  кто  за  кем  должет  работать  -  в
четвертом).   Зато   рекламируется   "многозадачность",    на    поверку
оказывающаяся  имитацией  многозадачности.  Наиболее   поразивший   меня
пример: в одной из последних "Софтпанорам"  приведен  программа  анализа
ресурсов машины: объем, в который можно было бы вогнать  статью  о  том,
как это сделать самому (что способствовало бы повышению образовательного
уровня обшества), занимают: окна и меню; +  куча  вещей,  которые  можно
почерпнуть из Help'а; + немного действительно полезных вещей, до которых
надо добираться путем реконструкции программы; + сопроводиловка  о  том,
что это Shareware, что его надо стереть или заплатить  авторам  5$.  ...
(autocensored).    Казалось    бы,    есть    техническая    возможность
неограниченного копирования - надо думать, как ее использовать на  благо
другим, а не как бороться с "несанкционированным копированием". Впрочем,
похоже, дело упирается в _генетически обусловленное_ различие  этических
систем, выявляемое уже вопросом, должен ли оплачиваться талант, и,  если
человек считает, что должен, то это надолго.
     В итоге автор предлагает выполнить работу на условиях,  которые,  с
его  точки  зрения,  являются  элементарным   проявлением   уважения   к
пользователю.
     Автору  неизвестно,  сколько  стоит  упоминаемая  далее  разработка
московского ИОХ. По непроверенным данным, аналогичная  разработка  фирмы
Брукер стоит около 10000  марок  ФРГ.  Вероятно,  обе  поставляются  без
исходных текстов.

          Автор считает возможным сделать аналогичный атлас намного
     дешевле и  с  поставкой  с  исходным  текстом,  что  открывает
     пользователю возможность самостоятельно улучшать его.

                      2. КОМУ ЭТО МОЖЕТ БЫТЬ НУЖНО
     Предлагаемая  программа,  как  надеется  автор,  может  представить
интерес для производственников или химиков, перед которыми иногда встает
вопрос: не является ли нечто (получившееся при  синтезе,  выделенное  из
природного или из промышленного образца, стоящее на полке с отвалившейся
этикеткой) чем-то хорошо известным?  Предполагается,  что  у  возможного
пользователя есть ИК-спектромертр и ЭВМ и что он достаточно компетентен,
чтобы не задавать вопросы типа "А можно ли  снять  ИК-спектр,  например,
этой  колбасы  из  бутерброда?".  (Прим.  авт.:  это  реально   заданный
неспециалистом вопрос; ответ: в принципе можно,  но  без  разделения  на
фракции это крайне малоинформативно).

                            3. ЧТО ЭТО ТАКОЕ
     Иногда при анализе ИК-спектров приходится довольствоваться выводами
типа  "есть  полоса   групп   >C=O".   Однако,   если   можно   выделить
индивидуальные соединения, для их идентификации желательно  использовать
не только  характеристические  полосы  функциональных  групп.  Программы
расчета спектров органических соединений через найденные для аналогичных
соединений  и  приводимые  в  литературе  силовые  и   электрооптические
параметры,  как  показывает  практика,  малопригодны  для  нужд  анализа
(основные недостатки:  трудность,  а  в  коммерческих  версиях  часто  и
невозможность задать перебор "по всем соединениям" даже  узкого  класса;
недостаточная точность расчета; трудность поиска, а иногда и  отсутствие
в литературе данных для соединений, действительно аналогичных  предпола-
гаемым). Т.к. неорганические соединения слишком непохожи друг на  друга,
для них такой подход вообще неприменим. Квантовохимические программы ра-
счета спектров также малопригодны для нужд анализа (тоже трудно или  не-
возможно задать поиск "по всем соединениям"; тоже  точность  недостаточ-
на). Видимо, оптимальным для таких нужд был бы  набор  атласов  реальных
спектров соединений разных классов с возможностью автоматического поиска
в них.
     Около двух лет  назад,  когда  автор  был  в  Москве  (в  Институте
органической  химии  АН   СССР),   ему   показали   программу,   которая
осуществляла поиск в библиотеке из, если не ошибаюсь, ~10000 ИК-спектров
и, если находила, выдавала, что это такое, а если нет - выдавала  список
нескольких наиболее похожих по спектрам соединений - в  расчете  на  то,
что для пользователя их формулы могут оказаться подсказкой. На вопрос об
идее алгоритма был получен ответ типа "не знаю, этот кусок писал не я  -
я писал только оконный интерфейс". Меня заинтересовало, как такое  можно
сделать.  По  Science  Citation  Index'у  на  сочетание   spectra+search
попадалось  или  явное  не  то,  или  малодоступные   работы.   Пришлось
придумать самому.
     Предлагаемая программа основана на следующих идеях:
     1. Анализируемый спектр поочередно  сравнивается  со  спектрами  из
атласа. Сходство оценивается по системе баллов, как  в  соцсоревновании:
там - стольо-то баллов - за монографию, столько-то - за статью; здесь  -
столько-то за отсутствие полосы, столько-то - за различие частот и т.д.
     2. Спектры представляются не  в  виде  зависимостей  поглошения  от
частоты, а в виде таблиц частот  и  интенсивностей  полос.  Во-1-х,  это
легко позволяет объяснить программе, что сдвиги частот  следует  считать
слабыми различиями. Во-2-х, это позволяет использовать статьи, в которых
таблицы частот даны без рисунков.
     3. Выбор системы  баллов  имеет  такой  вид.  Сравниваемые  спектры
нормируем, чтобы сумма всех интенсивностей была =1 (считаем, что  "очень
сильная" линия в e или в sqrt(10) раз сильнее, чем "сильная",  и  т.д.).
Через дерево возможностей втискиваем эталонный  спектр  в  анализируемый
(не наоборот - в анализируемом могут быть посторонние полосы!). Штраф за
отказ  от  полосы   равен   ее   нормированной   интенсивности,   а   за
отождествление - равен, например, сумме штрафов  за  различие  частот  и
интенсивностей, но отождествление принимается лишь в случае, если  штраф
за него меньше, чем за отказ от полосы. Т.о., если  ни  одну  полосу  не
удается отождествить, штраф =1, а если все совпало - =0;  это  позволяет
задавать  один  и  тот  же  пороговый  штраф  для  разных  анализируемых
спектров.
     4. Конкретный вид штрафов за различие  частот  и  интенсивностей  и
пороговый штраф варьируются, чтобы обеспечить по  возможности  уверенное
узнавание спектров одного и того же вещества из разных источников при не
слишком большом числе ложных  срабатываний;  текущий  вариант  смотри  в
исходном тексте.
     Предлагаемая программа была написана автором для собственных нужд и
успешно используется в нашей лаборатории. Демонстрация работы: запустите
ее (головной файл - ATLASIK2.PAS) в среде Турбо-Паскаля. ATLA*.DAT - это
данные из "Атласа спектров растворителей" под ред.В.А.Коптюга и из книги
Г.Герцберга "Колебательные и вращательные спектры многоатомных молекул";
C6H6*.DAT и CHCL*.DAT - это взятые из них спектры бензола  и  хлороформа
как  образцы  анализируемых  спектров.  Поварьируйте  имена   атласа   и
анализируемого образца. Видно, что каждый раз находится только  то,  что
надо, несмотря  на  неидентичность  спектров  из  разных  источников  (у
Коптюга данные относятся к жидкости, а у Герцберга - к газу).

                           4. ПОЧЕМУ ТАК МАЛО
     Этот вопрос, вероятно, появившийся у  потенциального  пользователя,
автору представляется обоснованым - действительно, в атласе  всего  ~200
веществ против ~10000 в  упомянутой  выше  программе.  (Начало  ответа.)
Число веществ можно было бы незначительно увеличить за счет уже набитого
нами для наших нужд,  но  тогда  было  бы  утрачено  важное  свойство  -
исчерпывающий охват  веществ  некоторого  уровня  сложности  (представим
себе:   спектр   1альфа,4бета-бутилциклогексанкарбоновой   кислоты   или
холестерилпальмитата есть, а обычных нафталина или гидрохинона - нет). А
для существенного повышения  числа  веществ  (это  может  быть  сделано,
напр., просмотром реферативных журналов,  начиная  с  послевоенных  лет)
необходимы значительные затраты времени и,  как  представляется  автору,
это имеет смысл делать только на заказ и  за  оплату.  Заметим,  что  то
обстоятельство, что предлагаемая версия  представлена  в  виде  текстов,
позволяет пользователю самому расширить себе атлас! (Конец ответа.)

                         5. ПРЕДЛАГАЕМЫЕ УСЛОВИЯ
     1. Оплачивается не потребительская  стоимость,  а  -  при  успешном
выполнении - работа  автора  или  авторов  (ориентировочно  -  несколько
человеко-месяцев, возможны вариации в зависимоости  от  объема  атласа).
Детали согласуются дополнительно.
     2. Пользователь высказывает замечания по ходу разработки, а в конце
принимает работу и - при успешном выполнении - покупает продукт.
     3. Оплаченный продукт оказывается собственностью как авторов, так и
покупателей, и каждый из них имеет право дарить  или  продавать  продукт
кому  угодно,  отсылать   потенциальных   покупателей   к   автору   или
совершенствовать продукт независимо от автора и продавать  новые  версии
(в т.ч. самому автору).  Можно  и  изначально  скооперироваться  и  -  в
случае, если от  каждого  участника  будет  достаточно  нескольких  дней
работы - сделать атлас на некоммерческой  основе,  друг  для  друга,  по
принципу "свободного труда свободно собравшихся людей".

     Автор  считает  возможным  отступить   от   заданной   спецификации
(включить атлас КР, ЯМР или масс-спектров или взяться за что-либо иное),
но  для  обеспечения  высокого  качества  может  оказаться   необходимым
включить в группу разработчиков соответствующих специалистов, что -  при
коммерческом подходе - повысит себестоимость продукта.
     Предлагаемая демо-версия идет на Турбо-Паскале фирмы Борланд версии
3.01А. Автор использует эту версию в  надежде  минимизировать  возможные
санкции  за  использование  несанкционированной  копии  транслятора.  По
желанию пользователя программу можно переписать (напр., на  ларионовский
Форт). Автор принципиально не  использует  графику,  т.к.  она,  по  его
мнению, была бы ненужным украшательством. Столь же  принципиально  автор
не реализовал задание параметров через командную строку  -  это  реально
полезно лишь при поставке  пользователю  exe-файла,  что  автор  считает
морально неприемлемым.

     Желаю успехов в использовании демо-версии.

     И.Секирин.                    1993,12,6.
