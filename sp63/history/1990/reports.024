СОФТПАНОРАМА No.4, 1990                 Составитель Н.Н.Безруков
*******************************************************************
 В Ы С Т У П Л Е Н И Я   У Ч А С Т Н И К О В   С Е М И Н А Р А
*******************************************************************
               Приводимые выступления публикуются  по
               сокращенной     и    отредактированной
               Составителем  cтенограмме. Из-за недо-
               статка времени, текст, полученный в ре-
               зультате обработки и    редактирования
               стенограммы,  с   авторами  согласован
               не был. Составитель приносит извинения
               за возможные ошибки, неточности и иска-
               жения мыслей  докладчиков.
*******************************************************************

        Адаптация пакетных документаторов NROFF/TROFF
        и связанных с ними пакетов OS UNIX для MS DOS.

                                           Арпаксыд В.М.

     Основное  преимущество  документатора NROF-TROF - то, что это
старинное традиционное изделие. Ему уже около 20 лет и,  наверное,
многие последующие продукты вырастали из этого классического изде-
лия.  Это  базовое  средство  документирования  в системе UNIX и в
принципе среди тех текстов на магнитных лентах, которые к нам при-
ходят с Запада, процентов 80 всего текстового материала  подготов-
лено под NROF.
     Кроме  того,  за те годы, что у нас существует на СМ ЭВМ и на
ЕС ЭВМ система INMOS и DEMOS, уже накоплен достаточно большой мас-
сив текстов русских, отформатированных тоже под этот документатор.
     На ПК пакетные документаторы не столь распространены, но диа-
логовые  документаторы их не исключают. Скажем так, если программа
типа Лексикон уподобляет вас машинистке, т.е .вы сами  непосредст-
венно набираете текст, то пакетные документаторы типа NROF предла-
гают вам быть автором сдающим рукопись в типографию или в машбюро.
Если вам необходимо изготовить письмо быстро, то конечно, нечего с
NROF  возиться. Если вы выпускаете программную документацию, кото-
рую потом будете корректировать, то надо подумать чем пользоваться
- Лексиконом или мощным документатором, который вам  автоматически
составит  оглавление  и сделает массу всяких удобных вещей. А если
вы делаете систему, например, САПР, где выпуск текстового материа-
ла является выходом какой-то проектирующей задачи, то там, естест-
венно, нужен только пакетный документатор. Другого  нельзя  приме-
нить, поскольку процесс автоматический.
     Вот такова экологическая ниша  для  пакетных  документаторов.
Если же выбирать из них, то мне кажется, что стоит остановиться на
старом  испытанном  и  главное стандартном средстве. NROF является
одним из "китов" на котором стоит UNIX.Вот пожалуй пpо NROF и все.
     А  сейчас хочу пояснить чуть шире. Нами проводилась работа по
переносу UNIX-инструментария в среду DOS. Это делалось для нас са-
мих и для пользователей, которые привыкли работать с  UNIX-инстру-
ментами.  Но должен сказать, что эти инструменты полезны не только
для адаптов UNIX, но и для программистов. Использование  различных
экзотических  средств,  а именно интерактивных в своей основе сис-
тем, может быть не совсем оправдано, а просто  модно.  Вот  передо
мной говорили об инвертировании текстов на PL/1 в С с помощью МЕ.
     Среди  UNIX-инструментальных  средств,  апробированных  очень
мощных, существуют такие средства как JACC , т.е.  компилятор-ком-
пиляторов,  где можно сделать очень хороший конвертор, который бу-
дет учитывать многие контекстные зависимости и т.д.
     LEX  можно использовать для конвертирования тех объектов, ко-
торые укладываются в регулярные грамматики (LEX и  JACC  уже  были
опубликованы в СОФТПАНОРАМЕ, однако используются недостаточно).
     Нами также перенесен потоковый редактор SED, который позволя-
ет производить тотальное редактирование больших файлов.
     Наконец, просто редактор ED. При всем изобилии красивых, раз-
ноцветных редакторов на ПК, есть вещи, которые можно сделать толь-
ко редактором ED.
     Т.е. я хочу сказать, что UNIX-продукты, которые сейчас немно-
го отодвинулись в сторону вот этим разноцветным богатством продук-
тов  на  ПК,  тем не менее не утрачивают свою актуальность.
Рекламные материалы по нашим работам по переносу инструментальных
средств UNIX в MS DOS приведены в предыдущих выпусках СОФТПАНОРАМЫ.

      Вопрос: С какими проблемами  вы  сталкивались  при  переносе
              текстов с UNIX в MS DOS?

     Ответ:  Может  быть  технические  вопросы  не будут интересны
всем, подойдите ко мне в частном порядке.
     А общие проблемы таковы. Наиболее неприятная проблема  -  это
некачественность  СИ-компиляторов  на  ПК.  Все  хваленные  TURBO,
QUICK-компиляторы не все конструкции "кушают".В частности, при пе-
реносе я натолкнулся на такое обстоятельство,  это  конечно  очень
неприятно.
     Компиляторы для ПК писались в расчете на программистов, кото-
рые  особо  затейливые  конструкции  не строят. И когда там четыре
уровня индексации или цепочка указателей через стрелочки  глубиной
восемь, то компилятор загибается. А продукты UNIX в основном изго-
тавливались "хакерами" т.е. людьми, любящими СИ и выкручивающие из
этого СИ все что возможно. Так вот представьте себе, что какая-ни-
будь конструкция, где идет доступ через адресацию с одновременными
инкрементами,  дикриментами этих указателей индексов. Вот тут ком-
пиляторы С в MS DOS "умирают". Я зту  проблему  ставлю  на  первое
место, потому что текст, который объявлен мобильным, вы перетранс-
лировали.  И  действительно,  все  работает, но вдруг при каком-то
стечении обстоятельств вы получаете, скажем,  на  ПК  неадекватный
результат.  Т.е. на это надо смотреть очень внимательно и рекомен-
дация такая: пропустить этот текст через  максимальное  количество
СИ-компиляторов.  Например.  через  CL,QCL  и  Turbo-C  может быть
где-то "выплывет".
     А остальные проблемы переноса - это общие  проблемы  переноса
программного  обеспечения, как они описаны во всех учебниках. Т.е.
надо смотреть порядок байтов в слове, размеры и т.д.
     В целом  тексты  юниксовских  продуктов  очень  качественные,
проблем особых не возникает, за исключением того, что нужно всегда
делать  руками. Например, если это документатор и он прекрасно де-
лает грамматические переносы в  английских  словах,  то  надо  это
"выстригать" и вставлять, скажем, переносы русские.
     Кроме  того, все те места, где в UNIX идет работа с каталога-
ми, с какими-то системными реалями UNIX, все это  надо  убирать  и
вставлять соответствующие для DOS. Это самые общие рекомендации.




                         Мини редактор.
                                                   Обухов Л.И.

     Редактор  называется  MIKA,  был задуман как микроструктурный
редактор. Основная идея проекта сделать текстовый редактор с неко-
торыми новыми возможностями, в основном предназначен для  редакти-
рования программных текстов на языках СИ, Паскаль,ассемблере.
     Идея структурных редакторов существует уже давно, но реализа-
ций  пока известно мало. Главная идея состоит в том, что программа
через редактор представлялась в иерархическом виде, т.е.  какие-то
части программы были бы скрыты из поля зрения.
     Допустим, вы выделяете в программе крупные части (заголовки),
которые имеют в себе более малозначительные части. Эти  более  ма-
лолзначительные части вы отодвигаете с помощью пробелов - ведущих,
допустим, на два пробела. Еще более малозначительное опять отодви-
гаете  вправо.  Идея в том, чтобы вот эти незначительные фрагменты
вообще не просматривались в редакторе.  В  Multi-Edit  есть  режим
"Конденс",  кто работал и его запускал, знает - суть его состоит в
том, что видны на экране только те строчки, у  которых  количество
ведущих  пробелов, допустим, меньше двух, меньше четырех и т.д., в
зависимости от глубины. Вот на этой идее был  основан  структурный
редактор.  Основная  его функция - это установка глубины просмотра
2,4,6.8. Возьмем, например, 8. Это означает, что на экране в текс-
товом редакторе вы будете видеть все строки, у которых  количество
ведущих пробелов меньше восьми. Все строки, у которых ведущих про-
белов больше восьми, из поля зрения исчезают.
     Далее в редактор вносилась вся текстовая обработка, иммитиру-
ющая  работу с блоками. Имеется в виду, что на каком-то определен-
ном уровне просмотра, когда вы удаляете одну  строку,  в  действи-
тельности  вы  удаляете вместе с ней и весь блок привязанных к ней
строчек более низкого уровня. В какой-то мере ваша программа  ста-
новится  иерархической  и  похожей  на файловую систему по катало-
гам.Там тоже вы видите каталог наиболее значительных файлов, затем
входите внутрь каталога и видите следующий каталолг и т.д.
     Примерно на этой же идее основан и редактор. Вы видите строки
определенного типа, а более глубокие строки не видны, так как  они
не  только не видны, но и работа с ними не видна, но они существу-
ют. Например, существует операция перемены строк  местами.  Каждая
строка является своеобразным заголовком абзаца более низкого уров-
ня.  Допустим, вы сейчас находитесь на уровне просмотра, например,
на уровне шести ведущих пробелов. Так вот, когда  строки  меняются
местами, вы видите на экране их перемещение, но реально поменяются
местами их блоки. Т.е. с ними, допустим были связаны две процедуры
на  языке СИ или Паскаль, эти процедуры в тексте поменяются места-
ми. Вот такая основная идея была реализована.
     Все текстовые  операции  становились  автоматически  блочными
операциями.  Удаление  строчки,  одновременно являлось и удалением
связанного с ней блока.
     Работа с программой представляет собой многоуровневую работу.
Вы устанавливаете внизу, как у магнитофонов заштрихованную  полос-
ку, указывающую текущий уровень просмотра. На самом внешнем уровне
вы  видите, что вся программа помещается на половине странички. Вы
видите основные заголовки всех крупных  частей,  выбираете  нужный
вам  фрагмент, повышаете уровень и на экране появляется более глу-
бокая структура и т.д.
     Вот это вкратце все, что реализовано.
     Конкретно по поводу реализации. Редактор был назван MIKA, его
объем  2,5  К. Написан был на ассемблере и обладает еще одной осо-
бенностью - это самый маленький по объему редактор. До этого самый
маленький редактор был R ПЭД, написанный на СИ, он занимал 4,5  К.
Вот  такой  маленький редактор удобен тем, что его можно использо-
вать для оперативного (быстрого) просмотра.
     Кроме того, в отличие от клавиши F4 в  NORTONе, объем,  кото-
рый он берет - максимально 65 К, т.е. в точности на размер сегмен-
та памяти.
     Для приобретения - обращаться в совместное предприятие  "Диа-
лог", распространение будет вести это предприятие. Я права на него
уже утратил.

     Вопрос: На что похожа система команд MIKA?

     Ответ:  Она  тяготеет  к  NORTON  COMMANDER, к его редактору.
Именно, к самому простому редактору клавиши F4 - движение курсора,
вставка символов, вставка строк, все основные операции,  изменение
цвета. Специальной блоковой работы нет. Работа с блоками косвенная
- через структуризацию текста, хотя эквивалентом работы с блоками
является повторное использование одной команды.
     Введено понятие цепочки клавишей. Одна клавиша - удаление од-
ной строчки, если вы ее нажмете 10 раз, то  удаляете  10  строчек.
Все  строки  накапливаются в буфере и затем по клавише копирования
все удаленные строки вставляются в другом месте по значению курсо-
ра.
     В частности, эти строчки могли быть в свою очередь блоками  и
т.о.  возможна перестановка текста, в чем приоритет за его предва-
рительную структуризацию. Т.е. эти блоки косвенно  существуют  как
бы в той структуризации, которую вы ввели с помощью ведущих пробе-
лов. Но и за счет удаления возможна мелкая блочная работа (за счет
группового удаления и вставок строк).



           Интегрированная система защиты от вирусов
           с возможностью использования интерфейса
           Norton Commander; метод защиты от несанкцио-
           нированного доступа и некоторые системные
                          утилиты

                                              Водянюк


     Вашему  вниманию предлагается пакет, разработанный нашей фир-
мой - пакет защиты от вирусов. В нашем пакете есть несколько реше-
ний, которые делают его интересным.
     Называется он "интелектуальный защитник  от  записи"  -  IWP.
Состоит из двух утилит. Собственно IWP - это резидент, который за-
щищает от записи. И работает он в паре с другой утилитой MAP.
     На каком принципе основана эта программа?
     Представьте себе, что вам удалось защитить конкретный файл от
записи.  Что  значит защитить? Обычно защита от записи диска - это
не что иное, как глухая защита, не позволяющая делать на диске ни-
каких изменений. Но стоит вам снять такую защиту и  вредная  прог-
рамма  может  сделать свое дело. Когда вы установите защиту снова,
получится так, что все это оказалось бесполезным. Так вот IWP  за-
щищает файл так, что новые изменения и дополнения на диске делают-
ся  совершенно точно также, как прежде. Но если ваша запись затро-
нит тело файла, который защищен, запись о нем в каталоге или  цепь
кластеров  в таблице размещения файлов, то IWP отвергнет такую за-
пись и предупредит вас об этом.
     С помощью утилиты MAP строится карта  защищенных  зон  диска.
Что  представляет  собой  эта утилита? Вы видите директории в окне
подобно NORTОN COMMANDER, отмечаете файлы, которые не должны отме-
чаться в процессе работы. Это могут быть  файлы  COM, EXЕ,  многие
постоянные  файлы  данных. После чего MAP создает карту защищенных
зон.
     Все кластеры, подлежащие защите, попадают в эту карту  и  все
цепи FАТ и области директорий, которые не должны изменяться, также
попадают  в  карту. В дальнейшем, собственно резидентная программа
IWP, использует эту карту и все, что вы пишите на  диск,  проходит
через  "сито". Оценивается - законная запись или нет. Законной она
считается в том случае, если она удовлетворяет карте, т.е. то ,что
вы пишите на диск, не противоречит тому , что в ней отмечено.
     Следующая особенность. Традиционными методами защиты является
перехват вектора 13 и вектора 21. Перехват вектора 21, т.е.  функ-
ции  DOS, позволяет многим традиционным защитникам отслеживать та-
кие операции, как открытие файла для записи, запись файла,  удале-
ние его и т.д. Но, к сожалению, существует не очень сложный прием,
позволяющий обойти такую защиту.
     Довольно  сложно устроенный "троянский конь" может в принципе
восстановить вектор прерывания DOS и войти в DOS  напрямую,  минуя
такие  защитники  как  FLUSHOT. Такая же ситуация складывается и с
вектором 13. Можно войти в BIOS напрямую, минуя программные защит-
ники.
     IWP применяет третью возможную технику защиты. Он  перехваты-
вает путь от DOS к драйверу. Что представляет собой запрос к драй-
веру?  Когда в DOS нужно прочитать тот или иной участок диска, она
вызывает драйвер с помощью команды CALL и передает параметры,  на-
чиная  с какого сектора, сколько и т.д. Технически трудно перехва-
тить этот путь, но здесь эта задача решена.
     По поводу второго, можно возразить, что обход  вектора  13  и
прямая  передача  управления  BIOS представляет собой неразрешимую
проблему. Да, это так, если пользоваться лишь  только  программой.
Наша  фирма  представляет  новые  способы защиты - аппаратные. Эта
плата, может быть вставлена в clot вашего ПК и при этом все опера-
ции с портами дисковых контроллеров и с портами памяти СИ МОS ста-
нут наблюдаемыми и контролируемыми. И поэтому,  если  какая-нибудь
программа  войдет в BIOS напрямую или совершит прямой вывод в порт
с целью испортить ваш диск, вы будете об этом предупреждены.
     Роль  IWP при этом состоит в правильном управлении аппаратным
контролем. Наш пакет доступен по цене 2000 рублей (если без платы,
то в два раза дешевле). Плата обеспечивает вам 20 % общего  уровня
защиты, но самые трудные проценты те, которые на программном уров-
не принципиально не контролируются.
     Т.о. этот пакет вирусную проблему существенно снимает вообще.
Кроме  этого,  поскольку  на пути между программой и более низкими
частями DOS стоит своеобразное "сито", решающее какая  запись  за-
конна,  а какая нет, вы получаете надежную защиту не только от ви-
русов, но и от программ, которые могут разрушить иформацию на дис-
ке, и обычными методами эти программы не могут быть выявлены, пос-
кольку это может быть какая-то логическая  "бомба",  упрятанная  в
чужом пакете, или "троянский конь".

     Вопрос: Как защитить винчестер, который разбит  на  несколько
логических дисков?

     Ответ: Для каждого защищаемого диска, будь то С,D и т.д.  вам
придется загрузить один экземпляр IWP.
     Собственно IWP занимает в памяти 30 Кб. Карта защиты занимает
объем, зависящий от диска, который вы защищаете - примерно 1 Кб на
1 Мб защищаемого пространства, т.е. 32 Мб диска - это около 32 Кб.

     Вопрос:  Какой,  по  вашему мнению, наиболее выгодный вариант
защиты?

     Ответ:  Наиболее выгодный вариант защиты следующий. Допустим,
у вас жесткий диск 40 Мб разделен на два диска 8 и 32. Восемь  ис-
пользуется  в  качестве  вашей системы, а 32 для ваших работ. Если
используете защиту с помощью IWP раздела С, раздел  В  оказывается
защищенным  автоматически, но точной диагностики при этом не дает-
ся. Таким образом затраты вашей памяти могут быть сведены к 60 Кб.
Вы можете загрузить и для первого диска защиту,  пожертвовать  еще
40 Кб.

     Вопрос: На сколько ухудшает быстродействие ПК применение это-
го пакета ?

     Ответ:  Применение платы совершенно не влияет на скорость ра-
боты ПК, потому что "слежка" включается в  те моменты,  когда  она
нужна, и когда работает BIOS, она выключается.
     Время расходуется на анализ соответствия записи карте. На  ПК
со  100%  быстродействием, этот показатель очень сильно зависит от
быстродействия самого диска и поэтому точный процент  нельзя  наз-
вать.  Мы  не  сталкивались с падением скорости более, чем на 20%.
Это лишь только запись, чтение идет с прежней скоростью.

     Вопрос: А что, если имитировать вход в драйвер?

     Ответ: Действительно, можно зная устройство  этой  программы,
обойти  ее.  Можно найти в памяти карту защищенных зон и разрушить
ее там. Главный плюс состоит в том, что, как правило вы сталкивае-
тесь с "бомбой" или вирусом, который написан автором,  не  имевшим
представления о том, что применяется подобная система.
     Принципиально невозможно защититься от человека, который зна-
ет  устройство  этого  пакета  достаточно хорошо. Это очень сложно
технически, нужна очень большая квалификация. Если мы будем выпус-
кать периодически новые версии пакета с несколько измененными  ха-
рактеристиками, то "бомбы", разрушающие избирательно данную версию
IWP,  будут  неэффективными. По крайней мере, установив этот пакет
на ПК сейчас, вы исключите возможность заражения вирусами.


     Вопрос: Как поступает IWP с драйвером который  не  использует
BIOS?

     Ответ: В IWP несколько условий, когда  отключается  контроль,
обеспечиваемый платой.
