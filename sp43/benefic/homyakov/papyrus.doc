Описание программы печати "Папирус"                              1




        Описание программы печати "ПАПИРУС".  Версия 4.80
        -------------------------------------------------



                           Содержание:

   Возможности ................................................ 1
   Типичный сеанс работы с программой ......................... 2
   Основные понятия ........................................... 3
   Диалог с пользователем ..................................... 4
   Запуск программы ........................................... 5
   Структура меню ............................................. 5
   Основное меню .............................................. 5
   Помощь ..................................................... 8
   Файловый монитор ........................................... 8
   Формирование билистового файла ............................. 9
   Выполнение, прерывание и отмена ........................... 11
   Подменю ................................................... 11
   Подменю "Параметры страницы" .............................. 11
   Подменю "Параметры печати" ................................ 14
   Подменю "Коррекция выходного файла" ....................... 16
   Подменю "Настройка программной среды" ..................... 17
   Экран операционной системы ................................ 18
   Временный выход в операционную систему .................... 18



                           Возможности

    Программа предназначена для  форматирования и печати текстовых
файлов, хранящихся в расширенном ASCII формате. Программа проста в
использовании и в то же время обладает функциональной полнотой.

    Основные возможности программы следующие:

    1. Входной файл для печати может быть разделенным  или не раз-
       деленным на страницы.

    2. Выходной файл получается разделенным или не разделенным на
       страницы.

    3. Формирование билистового выходного  файла с двумя варианта-
       ми размещения страниц на листе.

    4. Печать всех страниц файла подряд, только нечетных или толь-
       ко четных.

    5. Вывод всего  файла или некоторой его части  в указанном ин-
       тервале страниц.

    6. Формирование страниц с  заданными параметрами (длина, шири-
       на, заголовок, левый отступ, выравнивание правого края тек-
       ста).

    7. Вычисление максимальной ширины страницы для файла или груп-
2                              Описание программы печати "Папирус"


       пы файлов.

    8. Удаление или добавление ведущих пробелов при печати.

    9. Непрерывная (сквозная) нумерация  страниц текста, размещен-
       ного в нескольких файлах.

   10. Изменение длины страницы в уже отформатированном файле.

   11. Преобразование форматированного файла  в файл, не разделен-
       ный на страницы.

   12. Добавление пустой страницы в конец файла, если общее коли-
       чество страниц в файле нечетно.

   13. Изменение кодировки выходного файла.

   14. При выводе на принтер печать на рулонной или листовой бума-
       ге; установка типа  шрифта, межстрочного интервала, коррек-
       ция проскальзывания бумаги, запуск внешнего файла настройки
       принтера, установка приоритета внутренней и внешней настро-
       йки.

   15. Файловый монитор, совместимый с Norton Commander, позволяет
       производить  обычные  операции  типа  копирования, создания
       каталогов,  запуска  программ,  просмотра  и редактирования
       (при  помощи  внешнего  редактора  текстов),  а также выбор
       файлов и постановка их в очередь для печати.

   16. Запуск программы пользователя (по умолчанию Norton Command-
       er).

   17. Временный выход в операционную систему.

   18. Сохранение и восстановление состояния программной среды.

   19. Просмотр содержимого экрана операционной системы.

   20. Контекстно-зависимая помощь со сквозным сюжетом.



               Типичный сеанс работы с программой


    Предположим,   что  требуется   распечатать  данное  описание,
используя установки параметров по умолчанию.

   1. Убедитесь, что в текущем каталоге отсутствует файл настройки
      программы PAPYRUS.INI. Если файл существует, удалите его.

   2. Наберите в командной строке ДОС: PAPYRUS.

   3. Дважды нажмите клавишу "ENTER".

   4. После  загрузки программы  мы  попадаем  в основное  меню. В
      строке  с именем  входного файла  отобразиться имя  текущего
      каталога, например C:\TOOLS\.
Описание программы печати "Папирус"                              3



   5. Нажмите  клавишу  "F3",  чтобы  перейти  в файловый монитор.
      Используя    клавиши    управления    курсором,    подведите
      полосу-курсор к имени файла PAPYRUS.DOC.

   6. Нажмите  клавишу  "F3",  чтобы  просмотреть  этот  файл. При
      сканировании файла, в средине 25-ой  строки экрана  появится
      символ-индикатор  указывающий, что  данный файл  разделен на
      страницы. Нажав клавишу "Esc", возвращаемся в монитор.

   7. Нажимаем клавишу  "Ins", чтобы выбрать  файл PAPYRUS.DOC для
      печати.  Имя  выбранного  файла  помечается  символом  "■" и
      цветом. Нажав клавишу "Esc", возвращаемся в основное меню.

   8. В поле имени входного файла появится: C:\TOOLS\PAPYRUS.DOC.

   9. Используя клавиши  управления курсором, перейдите  на вопрос
      "Файл Разделен на страницы или  Нет ? Н". Нажмите комбинацию
      клавиш "Ctrl+ENTER" и в поле ввода буква "Н" будет  заменена
      на "Р" (разделен).

  10. Нажимаем клавишу "F5" - начать ординарную печать.

  11. Программа просматривает входной файл,  определяя его длину в
      страницах.

  12. По окончании просмотра программа предложит подготовить прин-
      тер к печати.

  13. Вставьте рулон бумаги и включите принтер.

  14. Нажмите клавишу "ENTER", чтобы подтвердить  готовность к пе-
      чати.  Течение  процесса печати будет  отображаться  в  окне
      выполнения.

  15. После  того, как  все  страницы  с нечетными  номерами будут
      напечатаны,  повторите   действия,  начиная  с   пункта  10,
      предварительно    заправив   бумагу    так,   чтобы   печать
      осуществлялась на другой стороне рулона.

  16. По  окончании  печати,  дважды  нажмите  клавишу  "ESC".  Вы
      попадете  в последний  пункт  основного  меню. В  поле ввода
      этого вопроса  будет указана буква  "В" (Выход). Подтвердите
      свой  выбор нажатием  клавиши "ENTER".  Работа с  программой
      закончена.



                        Основные понятия

    Программа  рассматривает входной  файл как  последовательность
кодов расширенной таблицы ASCII. Управляющими служат коды Возврата
Каретки (ВК) - десятичное значение  13, Перевода Строки (ПС) - 10,
Перевода Формата  (ПФ) - 12,  Горизонтальной Табуляции (ГТ)  - 9 и
Конца Файла  (КФ) - 26. Комбинация  кодов ВК/ПС воспринимается как
признак конца строки.  Наличие кода КФ не обязательно,  но если он
встретиться раньше  действительного конца файла,  то выходной файл
будет  усечен.  Коды  ГТ  программа  заменяет  на  соответствующее
4                              Описание программы печати "Папирус"


количество пробелов кратное 4.
    Часть  файла, размещенного  между двумя  соседними кодами  ПФ,
началом файла  и первым кодом  ПФ, концом файла  и последним кодом
ПФ, считается страницей.
    Обратите внимание, что  в описании  термины  вывод и печать, а
также форматированный  и разделенный на страницы  обычно считаются
синонимами.



                     Диалог с пользователем

    Диалог,   осуществляемый  при   работе  программы,   позволяет
формировать   выходной   файл   в   соответствии   с  требованиями
пользователя.
    Основными  факторами,  определяющими   ход  диалога,  являются
такие:
       - разделен ли входной файл на страницы;
       - выходной файл направляется на принтер или диск.

     Программа  требует ответа  на  ряд  вопросов. На  все вопросы
существуют  ответы по  умолчанию  -  они отображаются  при запуске
программы. Вопросы сгруппированы в несколько меню.
     Для перехода к тому или иному вопросу внутри меню используйте
клавиши управления  курсором. До нажатия  клавиши "ENTER" возможно
редактирование  ответа.  Клавиша  "INS"  осуществляет переключение
между режимами Вставки/Замены - при этом изменяется форма курсора.
Если курсор расположен в первой  позиции редактируемой строки и до
зтого  не  производилось  никаких  действий,  то  при вводе нового
символа строка будет очищена.
     Ответы по умолчанию не требуют подтверждения нажатием клавиши
"ENTER".
     На вопросы, допускающие один  из нескольких вариантов ответа,
нужно ввести либо букву, выделенную размером и цветом, либо цифру,
соответствующую порядковому номеру варианта.  Например, в ответ на
запрос "Печать  страниц Нечетных, Четных или  Подряд ?" для печати
страниц  с нечетными  номерами -  букву "Н"  на верхнем или нижнем
регистре  или  цифру  "1".  Другой  способ  выбора  заключается  в
последовательном  нажатии  комбинации   клавиш  "Ctrl+ENTER",  что
вызовет циклический перебор вариантов ответа.
     Некоторые  вопросы  требуют  ввода   полного  имени  файла  и
допускают  указание параметров  его командной строки.  Обязательно
вводите расширение  имени файла, в противном  случае файл не будет
найден. Имя файла может быть пустым.
     Ряд  вопросов  ожидает  в  ответ  числовые  данные,  причем в
некотором интервале значений.
     При выходе из подменю 2-го уровня программа запоминает, а при
входе в  него восстанавливает текущим тот пункт, который изменялся
или подтверждался последним.
     Сообщения программы можно разделить на предупреждения, ошибки
и фатальные  ошибки.  Предупреждения  могут  быть проигнорированы,
ошибки должны  быть исправлены, а  фатальные (неустранимые) ошибки
приводят   к   немедленному    завершению   программы.   Сообщения
отображаются  в  течение  5  секунд,  после  чего  исчезают. Можно
быстрее "погасить" сообщение, нажав любую клавишу.
     Заметим, что при  возникновении неустранимой ошибки программа
сохраняет свое текущее состояние в файле настройки PAPYRUS.INI.
     Нижняя строка зкрана отображает текущие назначения выделенных
Описание программы печати "Папирус"                              5


(функциональных) клавиш.



                        Запуск программы

    Формат запуска программы из командной строки ДОС:

                C:\>PAPYRUS [Входной Файл]

    Квадратные  скобки  синтаксически  ограничивают необязательный
параметр и при вводе в командную строку не заносятся.



                         Структура меню

     Сразу  после  загрузки  программмы  доступно  основное  меню.
Основное  меню  содержит  вопросы,  ответы  на  которые необходимо
давать  при  печати  практически  каждого  файла. Остальные четыре
подменю требуются гораздо реже.
     Подменю   "Параметры  страницы"   (клавиша  "F6")   позволяет
установить  длину и  ширину страницы,  левый отступ,  выравнивание
правого  края  текста,  удаление   прежних  заголовков  страниц  в
форматированных файлах и вид новых заголовков.
     Подменю  "Параметры  печати"  ("F7")  определяет  тип бумаги,
используемый  при  печати,  тип  шрифта,  интервал между строками,
корректировку проскальзывания бумаги, очередность внутренней и/или
внешней (файловой) настройки принтера и загрузку пользовательского
файла настройки принтера.
     Подменю   "Коррекция   выходного   файла"   ("F8")  разрешает
перекодировку   выходного  файла,   определяет  последовательность
страниц  в билистовых  файлах, добавляет  пустую страницу  в конец
файла.
     Подменю   "Настройка   программной   среды"   ("F9")   задает
определение длины выходного файла, включает или отключает звуковое
дублирование  процесса работы  программы, определяет  имя внешнего
файла редактора текстов, сохраняет и восстанавливает значения всех
параметров в файле конфигурации.
     Из  основного меню  выдается команда  начала ординарой печати
("F5") и билистового форматирования ("F4").
     Для  прерывания  или  отмены  любого  действия служат клавиши
"Ctrl+ESC" и "ESC" соответственно.
     Из  основного меню  также осуществляется  переход в  файловый
монитор  ("F3"),  просмотр  последнего  экрана  ДОС  ("Alt+F2")  и
временный выход в операционную систему ("Alt+F9").



                          Основное меню

     Сразу  после вызова  программы появляется  заставка с  именем
программы  и  звучит  мелодия.  При  нажатии  произвольной клавиши
происходит выход в основное меню, иначе появляется окно помощи.

     Вопросы  этого  меню  определяют  основные параметры процесса
печати.

6                              Описание программы печати "Папирус"


           - Входной файл ? E:\TURBO\
           - Файл разделен на страницы или Нет ? Н
           - Выходной файл ? LPT1
           - Печать страниц Нечетных, Четных или Подряд ? Н
           - Номер первой страницы ? 1
           - С какой страницы начать ? 1
           - Какой страницей закончить ? 9999

           - Продолжать или Выход ? П

     Примечание:  после  знака  "?"  указаны  примерные  ответы по
                  умолчанию.

     Строка  между  вопросами  "Какой  страницей  закончить  ?"  и
"Продолжать  или Выход  ?" называется  строкой статуса  и отражает
текущее  состояние  программы.  Сообщение  "Коррекция..." означает
ожидание  команд пользователя  на ввод  новых значений параметров,
перехода в другое меню, начала процесса печати и т.д.


     ■ Входной файл ?

     Установка  активна для  форматированного и неформатированного
     входного файла.

     Имя входного файла для печати должно задаваться явно, то есть
не  содержать  в  себе  метасимволов  "*"  и "?". Выбор нескольких
файлов и постановка их в  очередь для печати возможна из файлового
монитора,  работа с  которым будет  описана ниже.  Кроме того, имя
входного  файла   может  задаваться  в   командной  строке  вызова
программы, например, C:>PAPYRUS FILE.TXT.
     Если несколько  файлов поставлены в очередь,  то по окончании
печати текущего  файла присходит замещение  имени в поле  входного
файла  следующим  файлом  из  очереди.  Поскольку  имена в очереди
отсортированы в  алфавитном порядке, что  не всегда удобно,  можно
выбрать нужный файл из очереди нажатием комбинации "Ctrl+ENTER".
    При  определении  максимальной  ширины  страницы (См. соответ-
ствующий пункт  подменю "Параметры страницы") для  группы файлов в
этом поле  отображается имя текущего просматриваемого  файла, а по
завершении - имя файла с самой широкой страницей.


     ■ Файл разделен на страницы или Нет ?

     Установка  активна для  форматированного и неформатированного
     входного файла.

     Входной файл может быть  форматированным, то есть содержать в
себе  коды  Перевода  Формата  (ПФ)  или  быть  неформатированным.
     Когда указано,  что файл не  разделен на страницы,  программа
удаляет  прежние  коды  ПФ  (если  они  найдены),  а  также  - при
необходимости  -   прежние  заголовки  страниц.   Затем,  согласно
установкам  подменю "Параметры  страницы", формируются  новые коды
ПФ,  заголовки,  длина  и  ширина  страниц  и выравнивается правая
граница текста.
     Форматированный файл считается полностью сформированным и по-
этому минимально подвержен изменениям. Фактически, такие файлы до-
пускают только одно преобразование:  если задать удаление заголов-
Описание программы печати "Папирус"                              7


ков страниц, то получим выходной  файл не разделенный на страницы.
В остальном программа просто копирует входной файл в выходной.
     Таким образом, иногда для  форматированного файла имеет смысл
указать, что он неформатированный и наоборот.
     При формировании  билистового файла входной  файл должен быть
разделенным на страницы.


     ■ Выходной файл ?

     Установка  активна для  форматированного и неформатированного
     входного файла.

     Имя  выходного файла  может быть  именем дискового  файла  (и
должно  задаваться  явно)  или  быть  именем  внешнего  устройства
(обычно  принтер).  При  формировании  билистового  файла он может
направляться только на диск. В любом случае, если файл с указанным
именем уже существует на  диске, программа потребует подтверждения
на его перезапись.
     В результате работы программы  обычно получается файл, разде-
ленный  на страницы,  вне зависимости  от формата  входного файла.
Единственный  способ  получить  неформатированный  файл  - указать
удаление заголовков страниц для входного форматированного файла.
     Нажатие комбинации  клавиш "Ctrl+Enter" приведет  к цикличес-
кому выводу в это поле имен устройств (LPT1, LPT2 и т.п.).


     ■ Печать страниц Нечетных, Четных или Подряд ?

     Установка  активна для  форматированного и неформатированного
     входного файла.

     Как  для  форматированного,  так  и неформатированного файлов
программа  позволяет выводить  нечетные, четные  страницы или  все
подряд.  При  формировании  билистового  файла  он  обрабатывается
целиком, то есть все страницы подряд.
     По  окончании  печати  нечетных  страниц  файла автоматически
устанавливается режим печати четных страниц и наоборот.


     ■ Номер первой страницы ?

     Установка  активна для  форматированного и неформатированного
     входного файла.

     Номер первой  страницы файла считается сквозным,  то есть при
печати  одного  текста,  размещенного  в  нескольких файлах, можно
сохранять  непрерывную нумерацию  для всего  текста. Если  указать
значение  номера  первой  страницы  больше  2-х,  то  в дальнейшем
программа  автоматически будет  увеличивать номер  первой страницы
для  следующего  файла  на   число  страниц  в  предыдущем  файле.
Например, имеются три файла: первый  содержит 12 страниц, второй -
8, третий  - 11. Соответственно номера  первых страниц будут равны
1, 13,  21. После печати  всех страниц первого  файла номер первой
страницы снова  установиться в 1  и теперь нужно  явно указать 13.
Однако  после печати  второго файла  номер первой  страницы станет
равным 21.
     При  формировании  билистового  файла  номер  первой страницы
8                              Описание программы печати "Папирус"


может быть равен только 1.


     ■ С какой страницы начать ?
     ■ Какой страницей закончить ?

     Установка  активна для  форматированного и неформатированного
     входного файла.

     Распечатать  можно  только   часть  файла,  указав  требуемый
интервал страниц  (с какой начать  и какой закончить).  Зти номера
должны  быть  не  меньше   номера  первой  страницы  файла.  Если,
используя  предыдущий пример,  нужно вывести  3, 4  и 5-ю страницы
третьего файла, необходимо задать номер первой страницы равным 21,
начать с 23-ей и закончить 25-ой.
     При  формировании  билистового файла  номер  первой страницы
может быть равен только 1.


     ■ Продолжать или Выход ?

     Выход   из   программы   требуется   подтвердить  ответом  на
соответствующий  вопрос,   перейти  на  который   наиболее  просто
последовательными   нажатиями   клавиши   "ESC"   (число   нажатий
определяется положением в структуре меню).
     Когда  в поле  ответа  появится  буква "В",  подтвердите свое
намерение выйти из Папируса нажатием клавиши "Enter".


                             Помощь

    В  любом  месте  программы  при  нажатии  клавиши  "F1"  можно
получить  краткую подсказку,  зависящую от  контекста (положения в
структуре меню). Помощь имеет сквозной сюжет, сходный по структуре
с данным описанием.



                        Файловый монитор

    Клавиша  "F3"  инициирует  вызов  файлового  монитора. Монитор
выполняет  две  основные  функции:  выбор  файлов  с  установкой в
очередь для печати и стандартная работа с файлами (смена каталога,
копирование,  удаление  и  т.п.).   Команды  монитора  в  основном
соответствуют файловой оболочке Norton Commander.
    При  работе монитора  в  центре  зкрана отображается  панель с
расположенными на  ней списками имен каталогов,  файлов и дисковых
устройств. Каждый из списков  отсортирован по алфавиту. Два окошка
справа указывают обьем свободной  памяти на текущем/выходном диске
и общую длину выбранных для обработки файлов. Внизу, в зависимости
от  ситуации,  располагаеся  окно  для  смены  текущего  каталога,
запуска программ, копирования и т.п.
    Для перемещения по панели  имен используйте клавиши управления
курсором. Полоса-курсор отмечает текущий элемент каталога.
    Выбор/отмена  выбора файлов  производится клавишей  "INS"; для
групповых  операций  -  клавиши  "+"  и  "-".  Когда  общая  длина
выбранных  файлов  превысит  обьем  свободного  места  на выходном
диске, звуковой сигнал будет сопровождать выбор каждого следующего
Описание программы печати "Папирус"                              9


файла и перемещение курсора по панели. Если в поле выходного файла
указано  внешнее устройство,  то выходным  диском будет  считаться
текущий диск.
    Выход из монитора производится по клавише "ESC". Если при зтом
были выбраны  (отмечены) какие-то файлы, они  помещаются в очередь
для печати,  а первый по алфавиту  - в поле имени  входного файла.
Каждый вход в монитор очищает очередь.
    Для  файловых операций  типа копирования,  если нет отмеченных
файлов,   выбранным   считается    файл   на   котором   находится
полоса-курсор.
    Установив  курсор на  имя каталога  или диска  и нажав клавишу
"ENTER",  можно перейти  в этот  каталог или  диск. Клавиша  "TAB"
позволяет перейти в окно  изменения каталога, что дает возможность
быстро попасть в несмежный каталог. Это же окно может в дополнение
принимать маску файлов. Например  команда C:\MEDIT вызовет переход
в указанный   каталог  и   отображение  всех   файлов  в  каталоге
(подразумевается  маска *.*),  а команда  C:\MEDIT\*.TXT отобразит
только  файлы  с  расширением  .TXT.  Выбор  имени диска на панели
подразумевает маску *.*.
    Если  установить полосу-курсор  на имя  исполняемого файла  (с
расширением .COM, .EXE или .BAT)  и нажать "ENTER", будет запрошен
ввод  параметров   командной  строки  (например,   для  текстового
редактора   необходимо   имя   редактируемого   файла).  Указанная
программа  будет выполнена.  В случае  файла с  другим расширением
будет  запрошен ввод  команды операционной  системы, например, DIR
*.PAS или E:\TURBO\TC A:\EXAMPLE.C.

    Нажатие клавиши "F2" запускает  программу, имя которой указано
в переменой  окружения  ДОС,  посредством  команды  SET  PAPYRUN =
ИмяПрограммы. По умолчанию загружается программа с именем "NC.EXE"
(то есть Norton Commander), если переменная не была задана.

    Клавиша "F3" позволяет  просмотреть текстовый файл, отмеченный
полосой-курсором.  При просмотре  файла, разделенного  на страницы
кодами  ПФ, в  25 строкe  экрана внутри  круглых скобок появляется
символ-индикатор в форме астрологического Знака Земли.

    Клавиша "F4"  вызывает внешний редактор текстов,  если его имя
было указано в подменю "Настройка программной среды".

    Копирование выбранных файлов осуществляется при помощи клавиши
"F5".  Уже существующие  и защищенные  файлы перезаписываются  без
запроса  на  подтверждение.   Рекомендуется  проверять  результаты
копирования, так как обычно копирование производиться в каталог не
отображаемый на панели.

    Клавиша "F6" позволяет переименовывать файлы и каталоги.

    При посредстве "F7" можно создавать новые каталоги.

    Для   удаления  файлов   и  каталогов   служит  клавиша  "F8".
Защищенные файлы удаляются без запроса на подтверждение.



                 Формирование билистового файла

    Нажатие  клавиши "F4"  из основного  меню инициирует  создание
10                             Описание программы печати "Папирус"


билистового файла.
    При такой  печати на одной  стороне листа рядом  располагаются
две страницы текста. Входной файл должен быть уже форматированным,
а выходной файл - только дисковым.

    Если входной файл имеет структуру:

          [1] [2] [3] [4] [5] [6] [7] [8] [9] [10] [11] [12]

    то выходной файл будет иметь структуру:

                [1 4]  [3 2] [5 8] [7 6] [9 12] [11 10]

    или

                [1 2]  [3 4] [5 6] [7 8] [9 10] [11 12]


    где  [   ] - изображает страницу, ограниченную кодом ПФ
         1..12 - номер страницы из входного файла

    Первый  вариант расположения  страниц формруется  при создании
двухстороннего билистинга, а второй  - одностороннего. См. подменю
"Коррекция  выходного  файла"  пункт  "Билистинг Односторонний или
Двухсторонний".

    Билистинговый файл считается  частным случаем файла, разделен-
ного на страницы. Поэтому  подразумевается, что печать билистового
файла    будет    осуществляться    программой,    как    обычного
форматированного файла; нечетных страниц  на одной стороне листов,
а четных - на другой. В этом  случае под страницей с номером 1 (на
другой стороне  листа) окажется страница  с номером 2,  а под 4-ой
окажется 3-я  и т.д. Листы  разрезаются посредине, а  для подшивки
служат  внешние   края  широкого  листа,  так   как  обычно  здесь
расположены  отверстия  перфорации   для  транспортного  механизма
принтера.

    Имена   входного    и   выходного   файлов    извлекаются   из
соответствующих  полей основного  меню, а  ширина листа  - из поля
"Ширина страницы..."  подменю "Параметры страницы".  Выходной файл
может быть  только дисковым, обрабатывается файл  целиком, так как
для билистового  файла не имеет особого  смысла печать в некотором
интервале страниц.
    Значение ширины страницы зависит  от максимальной длины строки
одиночной  страницы  и  используемого  при  печати  шрифта.  Таким
образом, если ширина текста на одиночной странице равна 72, то для
печати файла  с двумя страницами на  листе нужно требуется указать
не менее  72+4+72 = 148.  Стандартные значения максимальной  длины
строки  на  принтере  равны:  черновиковый  -  136, злитный - 163,
уплотненный  -  233,  качественный  -  136.  Как видно, для нашего
примера    файл   невозможно    будет   впоследствии   распечатать
черновиковым или  качественным шрифтом. Чтобы  получить приемлемый
результат, рекомендуется при расчете длины строки для билистинга к
удвоенной длине одиночного листа добавлять не менее 12.
    Хороший результат получается при  выводе уплотненным шрифтом с
узким  интервалом  между  строками,  если  печатать подготовленный
билистинговый файл на стандартном  листе писчей бумаги, повернутом
на 90 градусов.
Описание программы печати "Папирус"                             11




                 Выполнение, прерывание и отмена

    Если нажать  клавишу "F5", находясь  в любой строке  основного
меню, начнется обработка файла в режиме Ординарной печати.
    Клавиша "F4" инициирует формирование Билистингового файла.
    Прекратить процесс ординарной  печати или формирования билист-
инга можно  двумя способами. Нажатие  комбинации клавиш "Ctrl+ESC"
приведет  к  немедленному  прерыванию  вывода  (и  очисткой буфера
принтера).  Нажатие  "ESC"  вызовет  отмену  обработки  только  по
окончании формирования текущей страницы и сохранит номер страницы,
с которой можно впоследствии продолжить выполнение.
    Допустимо,  но не  рекомендуется, прерывать  вывод на  принтер
путем его выключения.
    В  процессе  выполнения  программа  определяет длину выходного
файла и  затем при печати  отслеживает процесс вывода.  В процессе
печати отображается  общее количество страниц в  файле и число еще
не  отпечатанных страниц.  Заметьте,  что  в данном  контексте под
страницей обычно  понимается физический лист,  т.е. сколько листов
нужно приготовить для печати данного файла. Например, если всего в
файле 100  страниц и установлен режим  печати всех страниц подряд,
будет указано  значение 100, т.к. подразумевается  печать на одной
стороне  листа (рулона).  Если  же  печать будет  производиться по
одному листу  (с паузой) на  обеих сторонах, очевидно  потребуется
только 50  листов. При печати  только нечетных или  четных страниц
будет показано значение 50.


                             Подменю

    Клавиши  "F6", "F7",  "F8",  "F9"  позволяют войти  в подменю,
содержащие параметры  форматирования и печати,  которые приходится
изменять  достаточно редко.  Эти подменю  или их  отдельные пункты
могут находиться  в пассивном состоянии,  когда коррекция значений
параметров   не  будет   оказывать  воздействия   на  формирование
выходного  файла.  Например,  при  выводе  на  диск установки меню
"Параметры печати"  программой не используются,  а значение ширины
страницы пассивно для файла, обьявленного разделенным на страницы.



                  Подменю "Параметры страницы"

    Клавиша   "F6"   вызывает    подменю   "Параметры   страницы".
Большинство  пунктов этого  подменю  активно  только при  работе с
файлами, считающимися не разделенными на страницы.

       - Длина страницы в строках ? 58
       - Ширина страницы в символах ? 80
       - Левый отступ ? 0
       - Удаление заголовка страницы в строках ? 0
       - Выравнивать строки или Нет ? Н
       - Заголовок страницы, Край, Центр, Файл или Отсутствует ? Ц


    ■ Длина страницы в строках ?

12                             Описание программы печати "Папирус"


    Установка активна для неформатированного входного файла.

    Длина  страницы   задается  в  строках.   Допустимый  интервал
значений от 20 до 90. На  стандартном листе бумаги помещается 58 и
75  строк   для  широкого  и   узкого  интервала  между   строками
соответственно.


    ■ Ширина страницы в символах ?

    Установка активна для неформатированного входного файла.

    Ширина  страницы  (иначе  длина  строки)  задается в символах.
Допустимый  интервал  -  40..255  символов.  Если будет обнаружена
строка  длиннее  заданной,  избыточная  часть  будет перенесена на
следующую  строку. Заметим,  что, если  на принтере  вставить лист
слишком близко к правому  краю транспортного механизма или указать
слишком большее  значение для левого  отступа, может произойти  не
контролируемый  программой  перенос  строки  и  нарушится  процесс
формирования страниц.
    При задании ширины страницы равной 0, программа сама установит
значение этого  поля равным длине самой  длинной строки во входном
файле.  Если очередь  печати не  пуста, программа  последовательно
просмотрит все файлы из очереди. Имя текущего файла отображается в
поле имени входного файла, а длина  текущей строки - в поле ширины
страницы.  По окончании  просмотра файла  длина его  самой длинной
строки отображается примерно 2 секунды, а затем происходит переход
к следующему файлу  из очереди. Когда  очередь будет исчерпана,  в
поле ширины страницы будет  отображено значение максимальной длины
строки для всех просмотренных файлов, а в поле имени входного фай-
ла - имя файла с самой широкой страницей.


    ■ Левый отступ ?

    Установка  активна для  форматированного и  неформатированного
    входного файла.

    Левое  поле  (отступ)  позволяет  сдвинуть  текст  на странице
вправо.  Допустимый интервал  значений от  -60 до  60 позиций. При
отрицательном  значении  отступа  при  считывании очередной строки
входного файла  из ее начала  удаляется соответствующее количество
символов (обычно это ведущие  пробелы). При положительном значении
отступа перед выводом очередной строки в выходной файл в ее начало
помещается указанное  число пробелов. Таким  образом, первый режим
сдвигает текст на  странице влево, а второй - вправо  и при этом в
значение ширины страницы, установленную  в предыдущем пункте этого
меню,  удаляемые  или  прибавляемые  символы  отступа  не  входят.
Фактически  отступ  сдвигает  уже  готовый  (сформированный) текст
страницы по листу.
    Однако   при  формировании   билистинга  происходит  центровка
изображения двух  страниц за счет  вставки в начало  каждой строки
цепочек  пробелов,  поэтому  установка  нулевого  отступа наиболее
целесообразна.
    Если  при выводе  на принтер  вставить лист  слишком близко  к
правому краю  транспортного механизма или  указать слишком большее
значение  для левого  отступа, может  произойти не  контролируемый
программой  перенос   строки  и  нарушится   процесс  формирования
Описание программы печати "Папирус"                             13


страниц.


    ■ Удаление заголовка страницы в строках ?

    Установка  активна для  форматированного и  неформатированного
    входного файла.

    Существует   возможность  изменить   длину  страниц   для  уже
форматированного  файла.  Если  файл  был  разделен  на страницы в
соответствии с соглашениями Папируса,  т.е. вверху каждой страницы
имеется строка  заголовка, несколько пустых  строк и далее  текст,
можно  удалить  заголовки  и  пустые  строки,  а  затем вместо них
вставить новые  (здесь или в  другом месте). Для  этого необходимо
задать режим  неформатированного входного файла,  а в этом  пункте
указать  количество  удаляемых  строк.  Для  Папируса это значение
равно 3  - строка заголовка и  две пустые строки. В  данном режиме
программа,  обнаружив  код  ПФ,  удаляет  не  только его, но также
указанное  количество   последующих  строк.
    Если  указать удаление заголовков для  файла обрабатываемого в
режиме форматированного файла, то  получим выходной файл не разде-
ленный на  страницы. Такой файл удобнее  редактировать, так как не
нужно следить за целостностью заголовков страниц.


    ■ Выравнивать строки или Нет ?

    Установка активна для неформатированного входного файла.

    Программа  позволяет   осуществить  ограниченное  выравнивание
правого края  текста на листе.  Ограниченность заключается в  том,
что  абзацы  как  таковые  не  отслеживаются  и  к остатку длинной
строки,  перенесенному на  следующую строку,  остальные строки  не
подстыковываются,  а  абзац  не  переформатируется. При включенном
выравнивании, если длина  текущей строки будет не более  чем на 10
символов  короче  установленной   ширины  страницы,  строка  будет
расширена пробелами  до полной ширины  страницы. В данном  случае,
если последняя  строка абзаца будет достаточно  длинной, она также
будет  расширена.  Таким  образом,  если  указана  ширина страницы
равной 80  символам, то строки  короче 70 символов  остануться без
изменений,  строки длиной  от 70  до 80  символов будут  расширены
пробелами  до  80  знаков,  а  длиннее  80  -  будут перенесены на
следующую строку по границе слов.


    ■ Заголовок страницы, Край, Центр, Файл или Отсутствует ?

    Установка активна для неформатированного входного файла.

    В  верхней  части  сформированной  страницы программа помещает
заголовок  страницы  (иначе  колонтитул)   и  две  пустые  строки,
отделяющие заголовок  от собственно текста.  Заголовок обязательно
содержит  номер  страницы.  Номер  может  располагаться  по центру
страницы (Центр) или сбоку (Край) - на странице с нечетным номером
справа,  с  четным  -   слева.  На  противоположном  конце  строки
заголовка может  выводиться полное имя  печатаемого файла и  дата,
поддерживаемая  операционной  системой  (Файл),  или  произвольная
строка,  длиной до  45 символов.  Заметим, что  для данного пункта
14                             Описание программы печати "Папирус"


варианту  Край  соответствует  номер  2  и  далее  порядку.  Таким
образом, любой ответ отличающийся от "К", "2", "Ц", "3", "Ф", "4",
"О",  "5" будет  буквально  перенесен  в заголовок  страницы. Если
нужно подавить вывод заголовков страниц, укажите последний вариант
(Отсутствует) и в верхней части страницы будут помещены три пустые
строки.


                   Подменю "Параметры печати"

    Клавиша "F7" активирует  подменю "Параметры печати", установки
которого действенны только при выводе на принтер.

   - Бумага Рулонная или Листовая ? Р
   - Черновиковый, Элитный, Уплотненный или Качественный шрифт ? Э
   - Интервал между строками Широкий или Узкий ? Ш
   - Коррекция проскальзывания бумаги ? 0
   - Внутренняя настройка принтера Предшествует пользовательской,
        Завершает или Отсутствует ? З
   - Файл пользовательской настройки принтера ?


    Современные  принтеры  воспринимают   некоторые  коды  или  их
последовательности     как    управляющие     воздействия    (т.н.
ESC-последовательности).  Существует два  основных стандарта кодов
управления  - EPSON  и  IBM.  Большинство управляющих  кодов обоих
стандартов  идентичны.  В  своей   работе  с  принтером  программа
использует  только ESC-последовательности  установки типа  шрифта,
межстрочного  интервала,  включения  и  отключения  датчика  конца
бумаги.


    ■ Бумага Рулонная или Листовая ?

    Установка  активна для  форматированного и  неформатированного
    входного файла.

    Программа допускает  печать как на  рулонной бумаге, так  и на
отдельных  листах.  В  последнем  случае  после  печати  очередной
страницы  процесс  вывода  приостанавливается  для  смены  листа и
возобновляется  после  нажатия  клавиши  "ENTER".  При  печати  на
рулонной бумаге вывод происходит без пауз. В этом случае возможена
ситуация, когда печать продолжается  даже после окончания (обрыва)
бумаги.    Рекомендуется    отключать    датчик    конца    бумаги
соответствующим   переключателем   на   принтере.   Когда  принтер
обнаружит  отсутствие бумаги,  он прекратит  печать и остановится.
Вставьте  новый  рулон,  переведите  принтер  в  режим "On Line" и
процесс  печати возобновиться.  На некоторых  типах принтеров этот
метод   (отключение   датчика)   может   не   дать  положительного
результата.


    ■ Черновиковый, Элитный, Уплотненный или Качественный шрифт ?

    Установка  активна для  форматированного и  неформатированного
    входного файла.

    Установка  типа   шрифта  для  печати   определяет  не  только
Описание программы печати "Папирус"                             15


начертание собственно  символов, но также  максимальное количество
символов  в   строке  и  скорость   печати.  Стандартные  значения
максимальной   длины   строки   на   "широком"   принтере   равны:
черновиковый - 136, злитный - 163, уплотненный - 233, качественный
- 136. Наиболее  медленно происходит печать  качественным шрифтом,
всего  быстрее -  черновиковым или  элитным (по  крайней мере  для
точечно-матричных принтеров).  На некоторых типах  принтеров режим
качественной  печати  может  не   отрабатываться,  если  зтого  не
позволяет  драйвер  принтера  или  встроенная/загружаемая  таблица
шрифтов.


    ■ Интервал между строками Широкий или Узкий ?

    Установка  активна для  форматированного и  неформатированного
    входного файла.

    Программа  позволяет устанавливать  расстояние между строками.
На  стандартном  листе  бумаги  при  широком  (двойном)  интервале
помещается 58 строк, а при узком (полуторном) интервале - 75.


    ■ Коррекция проскальзывания бумаги ?

    Установка  активна для  форматированного и  неформатированного
    входного файла.

    На некоторых типах принтеров происходит проскальзывание бумаги
при печати. Это проявляется в сдвиге текста к верхнему краю листа,
особенно  заметному  при  печати  на  рулонной  бумаге.  Коррекция
проскальзывания состоит  в вставке пустой  строки в начале  каждой
страницы, номер  которой кратен указанному в  данном пункте числу.
Допустимый  интервал  от  0  до  20.  По  умолчанию  коррекция  не
производится (значение 0).


    ■ Внутренняя настройка принтера Предшествует пользовательской,
      Завершает или Отсутствует ?

    Установка  активна для  форматированного и  неформатированного
    входного файла.

    В  начале  каждого  цикла  печати  очередного  файла программа
осуществляет ряд действий по настройке принтера: загрузка внешнего
пользовательского  файла  инициализации  принтера  (так называемая
внешняя настройка) и выдача  команд установки параметров печати по
инициативе самого Папируса (внутренняя настройка).
    Данный  пункт  позволяет   установить  приоритет  внешней  или
внутренней   настройки.  Так   файл  настройки   может,  например,
содержать  в себе  Esc-код установки  злитного типа  шрифта, в  то
время как  во втором пункте зтого  меню указан качественный шрифт.
Если   внутренняя   настройка   следует   после   пользовательской
(файловой),  то ее  установка на  качественный тип  шрифта и будет
использована.  Ряд  параметров  печати  можно  установить с панели
принтера  и тогда  целесообразно вообще  отказаться от  внутренней
инициализации.
    Перед  началом  внутренней  и  внешней  настройки  в статусной
строке  появляется  соответствующее  сообщение,  а  при завершении
16                             Описание программы печати "Папирус"


каждой - звуковой сигнал разного тона.
    Процесс настройки повторяется  перед печатью очередного файла,
что  позволяет при  необходимости (например,  для заправки бумаги)
выключать  принтер.  Заметьте,  что   при  этом  произойдет  сброс
принтера  в начальное  состояние. При  этом в  частности очищаются
внутренний   буфер    печати   и   буфер    загружаемых   шрифтов,
устанавливается черновиковый шрифт,  широкий межстрочный интервал,
нулевой левый отступ и т.п. (См. описание конкретного принтера).
Сброс принтера происходит и  при перывании печати комбинацией кла-
виш "Ctrl+ESC".


    ■ Файл пользовательской настройки принтера ?

    Установка  активна для  форматированного и  неформатированного
    входного файла.

    Последний пункт этого меню позволяет выполнить указанную в нем
программу   (допускаются  параметры).   Подразумевается,  что  зта
программа служит для обслуживания принтера, например, загружает во
внутреннюю   память  принтера   таблицу  русификации.   Если  файл
инициализации  содержит  только  ESC-последовательности,  создайте
командный  (пакетный)  файл,  включающий  одну  команду  типа COPY
ИмяФайла.BAT PRN.  Некоторые программы (особенно  резидентные) "не
любят"  многократного запуска  - их  можно выполнить  из файлового
монитора или  перед печатью следующего  файла установить это  поле
пустым.   Если  имя   файла  не   задано,  внешняя   настройка  не
производится.


               Подменю "Коррекция выходного файла"

    Клавиша "F8" открывает меню  коррекции выходного файла. В этом
меню  собраны установки  которые относятся  либо к  файлам в любом
формате, либо только форматированным.

       - Изменять кодировку с альтернативной на Основную, КОИ-7,
             КОИ-8, Болгарскую, Пользовательскую или Нет ? Н
       - Билистинг Односторонний или Двухсторонний ? Д
       - Добавлять пустую страницу или Нет ? Н



    ■ Изменять кодировку с альтернативной на Основную, КОИ-7,
      КОИ-8, Болгарскую, Пользовательскую или Нет ?

    Установка  активна для  форматированного и  неформатированного
    входного файла.

    Программа  позволяет  в  процессе  печати  изменить  кодировку
входного  файла из  альтернативной  в  основную, КОИ-7  (Набор 2),
Кои-8,  болгарскую  (MIK)  или  пользовательскую,  таблица которой
хранится в файле PAPYRUS.COD.
    Пользовательский  файл  перекодировки  содержит  массив из 256
байт. Смещение  от начала массива  (индекс) соответствует значению
кода  символа  во  входном  файле,  а  число, находящееся по этому
смещению,  содержит перекодирующее  значение.
    Фактически программа допускает произвольную кодировку входного
Описание программы печати "Папирус"                             17


файла, требуя  только, чтобы управляющие  коды ВК, ПС,  ПФ, ГТ, КФ
сответственно  были  равны  13,  10,  12,  9,  26 и выполняли свои
обычные функции.


    ■ Билистинг Односторонний или Двухсторонний ?

    Установка активна для форматированного входного файла.

    При формировании билистингового файла можно задать две способа
размещения   страниц   в   выходном   файле.   При  одном  способе
(Одностороннем)  страницы размещаются  по две  на листе  в порядке
строгого возрастания их номеров:

             [1 2]  [3 4] [5 6] [7 8] [9 10] [11 12] ...

а в другом (Двухстороннем) - нумерация не последовательна:

             [1 4]  [3 2] [5 8] [7 6] [9 12] [11 10] ...

    где  [   ] - изображает страницу, ограниченную кодом ПФ
         1..12 - номер страницы из входного файла

    Подразумевается,  что  в  первом  случае  печать  будет осуще-
ствляться  на  одной  стороне  рулона,  а  во  втором  -  на обеих
сторонах.


    ■ Добавлять пустую страницу или Нет ?

    Установка  активна для  форматированного и  неформатированного
    входного файла.

    Общепринято, что  каждая новая глава книги  начинается с новой
страницы, имеющей  нечетный номер. Для  подобных случаев программа
может добавлять  пустую страницу с  четным номером в  конец файла,
если общее  количество страниц в  файле нечетно. Данная  установка
полезна    также   при    подготовке   файлов    для   билистового
форматирования.


              Подменю "Настройка программной среды"

    Клавиша "F9" вызывает меню настройки среды программы Папирус.

          - Устранять "снег" на экране дисплея или Нет ? Н
          - Включить звук или Отключить ? В
          - Файл текстового редактора ?
          - Сохранять значения параметров или Обновлять ? С


    ■ Устранять "снег" на экране дисплея или Нет ?

    При смене  изображения на экране  дисплея, подключенного через
устаревшие  модели адаптера  CGA, обычно  появляются помехи  (т.н.
"снег"). Указание  этого параметра позволяет избавиться  от них за
счет некоторого замедления вывода на зкран.

18                             Описание программы печати "Папирус"



    ■ Включить звук или Отключить ?

    Программа сопровождает свою загрузку, работу и вывод сообщений
об   ошибках   мелодичными   сигналами,   звучание  которых  можно
отключить.


    ■ Файл текстового редактора ?

    Если  указать путь  доступа  и  имя внешнего  файла текстового
редактора, становиться возможной работа  с ним в файловом мониторе
по клавише "F4".


    ■ Сохранять значения параметров или Обновлять ?

    Текущие значения  параметров для всех  меню можно сохранить  в
файле  настройки  PAPYRUS.INI,  помещаемом  в  текщий каталог. При
запуске  программа ищет  в текущем  каталоге файл  PAPYRUS.INI и в
случае  успеха  загружает  хранящиеся  в  нем  значения в качестве
умалчиваемых.  Обновить значения  параметров можно  также в  любой
момент, выполнив соответствующий пункт подменю.


                   Экран операционной системы

    Нажатие клавиши  "Alt+F2" из основного  меню позволяет увидеть
содержимое зкрана операционной системы. Это удобно, если Вам нужно
просмотреть  результат  работы   программ,  запущенных  до  вызова
Папируса, из файлового монитора или при временном выходе в ДОС.


             Временный выход в операционную систему

    Клавиша  "Alt+F9"  позволяет  временно  выйти  ДОС.  Возврат в
Папирус осуществляется по команде EXIT.


                                        Игорь Анатольевич Хомяков

                                            (044) 213-79-49 (р)
                                            (044) 213-22-73 (р)


