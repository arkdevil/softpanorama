
Copyright: Груздев Александр Петрович, ноябрь 1991
           г.Пермь (код 342-2), тел. 39-58-81

             ИНСТРУКЦИЯ ПО ИСПОЛЬЗОВАНИЮ ПРОГРАММЫ

                  -------------------------
                   P r o t e c t M A K E R
                  -------------------------

   Уважаемые сограждане, программа PMAKER предназначена для
защиты программ, составленных на языке СУБД типа DBase III+
FoxBase, FoxPro  и им подобных, от копирования и взлома ин-
теллектуальной начинки. Так как любителей пользоваться  чу-
жими  разработками не убывает и даже написаны программы ге-
нерации листинга из модулей, созданных компилятором FoxBase
и FoxPro (как с опцией шифровки, так и без), то автор пред-
лагает следующий способ защиты с помощью программы  PMAKER,
основанный на использовании механизма макроподстановок:    
                                                           
1. Составляется список имен (чего угодно: файлов, процедур,
переменных),  использующихся  в программах на языке СУБД, и
ему  ставится в соответствие список символических имен. Пе-
речень имен заносится в обычный текстовый файл в формате:  
         символическое_имя = настоящее_имя                 
если в строке больше одной пары, то их надо разделить запя-
той:                                                       
         с_имя_1 = н_имя_1, с_имя_2 = н_имя_2              
                                                           
2. Затем каждое вхождение настоящего имени заменяется в за-
щищаемых модулях на последовательность команд, как показано
в примере ниже (скрытие имени вызываемого модуля MENU_1):  
                                                           
   Старая команда:                                         
                    do ..\example\MENU_1                   
                                                           
   Новая последовательность команд:                        
                    _TMP_=\"ключ_1\"                       
                    call SECRET with _TMP_                 
                    do ..\example\&_TMP_.                  
   Здесь:                                                  
         _TMP_   - промежуточная строковая переменная с    
                   любым именем                            
         ключ_1  - символическое имя, используемое бинар-  
                   ным  модулем SECRET для поиска и замены 
                   на настоящее имя 'MENU_1'               
         SECRET  - имя бинарного модуля, загружаемого в    
                   головном модуле командой LOAD SECRET.ext

3. В головной модуль программы для СУБД вставляется команда
                    load SECRET.ext                        

Примечание:
-----------
   Шаги 1-3 можно выполнить с помощью программы PLIST,  ко-
торая прилагается. Вся работа сводится с составлению списка
имен, которые предназначаются для скрытия(замены), и списка
PRG-файлов, в которых требуется провести  замену  вхождения
имени на последовательность описанных выше команд.PLIST ав-
томатически генерирует перечень символических имен, необхо-
димый для программы PMAKER и стандартным образом  вставляет
нужные  строки команд в файлах, указанных в списке PRG-фай-
лов. Оригинальные PRG-файлы сохраняются с расширением *.OLD

Формат команды:
   PLIST <List_file> <Macros_file> <PRG_list_file> <Binary_file>
где
   List_file    - файл со списком имен, подлежащих защите.
   Macros_file  - имя файла с перечнем подстановок, который
                  будет сгенерирован и подан на вход PMAKER
   PRG_list_file- файл со списком PRG-файлов, которые необ-
                  ходимо обработать.
   Binary_file  - имя бинарного модуля, которое будет ука-
                  зано для PMAKER.

4. Следующим шагом будет запуск программы PMAKER, чтобы со-
здать  бинарный модуль SECRET.ext на основании перечня сим-
волических и настоящих имен, содержащегося в обычном  текс-
товом файле в формате, описанном выше.                     
   Запуск программы PMAKER осуществляют с двумя параметрами
первый  из них есть имя текстового файла с перечнем имен, а
второй есть имя бинарного модуля, который будет загружаться
в программе для СУБД.

   Ограничения:                                            
      - символическое имя не должно содержать пробелов и
        иметь такую же длину как и настоящее имя, МАКСИ-
        МАЛЬНАЯ длина = 80 символов

      - размер файла с перечнем имен должен быть меньше    
        30 Килобайт, это связано с размером области, ко-   
        торую выделяет СУБД бинарному модулю               

      - PMAKER привязывает бинарный модуль не только к     
        конкретной ЭВМ, но также и к конкретному (теку-    
        щему) каталогу, поэтому PMAKER необходимо запу-    
        скать, когда текущим является каталог с модулем    
        СУБД, из которого происходит ЗАГРУЗКА и ПЕРВЫЙ     
        вызов (call) бинарного модуля                      

PS:
   Данную защиту следует отнести к защите среднего уровня  
   и она сравнительно легко взламывается, но освобождение  
   программного продукта от нее достаточно трудоемко, и    
   эта трудоемкость прямо пропорциональна количеству под-  
   становок, используемых в продукте.                      
PPS:
   Автор с удовольствием выслушает критику и примет поже- 
   лания заинтересованных сограждан по улучшению програм-  
   мы.

---------------------------------------------------------
          Пример последовательности действий
---------------------------------------------------------

   Пусть у нас есть программа EXAMPLE.prg и процедурный 
   файл EXAMPL_.prg в подкаталоге CHECK текущего каталога 
                  
       *** ---- начало EXAMPLE --- ***
       set procedure to check\exampl_
       clear all
       Cur = 1
       Drv = ""
       do Check
       ? Drv+str(Cur)
       return
       *** ---- конец EXAMPLE ---- ***
   
       *** ---- начало EXAMPL_ --- ***
       procedure Check
       Drv = "Цифра:"
       return
       *** ---- конец EXAMPL_ ---- ***
       
   1. Составим список имен и запишем в текстовый файл
      NAME.LST:
   
       Check
       Cur
       Drv
   
   2. Составим список PRG-файлов и запишем в текстовый файл
      PRG.LST:
        
       example
       check\exampl_

   3. Запускаем PLIST в текущем каталоге:
   
      PLIST name.lst macro.lst prg.lst secret.bin
      
   4. Файл MACRO.LST, созданный PLIST подаем на вход PMAKER
      и дублируем имя бинарного модуля SECRET.BIN:
      
      PMAKER macro.lst secret.bin
      
   5. Все! Можно запускать FoxBase (или FoxPro).
