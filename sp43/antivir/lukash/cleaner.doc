
                          Антивирус Cleaner.

    Антивирус предназначен  для поиска и уничтожения вирусов RCE-5173 и
С-384 в файлах и оперативной памяти. Его длина 8368 байт.
    Вирус RCE-5173  относится к файловым резидентным вирусам.  Заражает
как COM-,  так и EXE- файлы при запуске,  открытии  или  закрытии  фай-
ла. (функции 21h-4Bh, 21h-3dh, 21h-3h).
    Файлы заражаются однократно.  В качестве признака заражения для об-
резания  своей  длины  используется поле времени .Однако иммунизировать
файлы таким способом нельзя.Приращение длины при заражении  равно  5173
байт.  Тело вируса дописывается в хвост файла. Командный проессор зара-
жается как обычный COM файл.  Как и в случае вируса RCE-1800, заражение
командного  процессора обычно происходит сразу после инсталляции вируса
в памяти.
    Заражаемые EXE-файлы могут иметь любую длину. При заражении изменя-
ется заголовок. Тело вируса дописывается в хвост файла.Длина зараженно-
го EXE-файла увеличивается ровно на 5173 байта.
    При инсталляции вирус создает себе "дыру" в старших адресах  опера-
тивной памяти путем манипуляий с MCB,  и записывает туда свое тело, за-
тирая при этом транзитную часть  COMMAND.COM.  После  инсталляии  обьем
доступой памяти уменьшается примерно на 6 К. Вирус перехватывает преры-
вание 21h, обрабатывая 14 его функций (3Dh,3Ch,5Bh,3h,4Bh,56h,43h,6Ch,1
Ah,4h,4Fh,11h,12h,40h). При каждом вызове прерывания 21h вирус перехва-
тывает прерывание 13h, обрабатывая две его функции (2h,80h), и прерыва-
ние 24h. При наличии вируса в оперативной памяти приращение длины зара-
женных  файлов  маскируется.  И  Norton  Commander  и  команда  DIR  не
показывают настоящей длины файла, однако если вызвать файл на просмотр,
то Norton показывает его истинную длину. При доступе к зараженному фай-
лу вирус не выкусвает свое тело.  Вирус обходит некоторые сторожа, нап-
ример TSAFE из пакета TNTVIRUS.  При дезассемблировании вируса  приемы,
которые могли бы мешать этому,  отсутствуют. Однако вирус написан очень
странным почерком.  Можно подумать,  что крайне часто применялись  мак-
ро-определения, или вирус написан на очень мощном компиляторе. RCE-5173
использует довольно сложный метод кодировки 24-х сохраненных  байт. При
декодировании сначала вычисляется контрольная сумма,  а затем ее значе-
нием производится расшифровка.  При чем шифруются только четные  байты.
После  закодированых  байт идет текстовая строка "You won't hear me,but
you'll feel me...(c)1990 by Sentinel.Thanks Borland.".
    При своей работе вирус проверяет версию операционной системы. Рабо-
тоспособность с версией 5.0 автором не проверялась.
    Фаза проявления  видимо  заключается  в  зацикливании  при загрузке
MSDOS,  а также исчезновении файлов с расширением DOC.  Вирус обнаружен
Лукашом Д.В. и Еловым С.М. в КПИ в 1992 г.

                                С-384. ATAS

    Вирус заражает только COM-файлы,  увеличивая их длину на 384 байта.
Не детектируется программой "Lie detector" Сусликова. При удачном зара-
жении очередного файла выводит на экран сообщение "Ok.". Имеет довольно
необычный инсталлятор:  вместо обычной команды JMP  используется  конс-
трукция:

     MOV  REG,"АДРЕС НАЧАЛА ДАМПА"
     PUSH REG
     RET

причем от файла к файлу имя регистра изменяется  (AX,BX,CX,DX). Признак
заражения  -  первый байт файла имеет значение 50h.  В своем теле вирус
имеет зашифрованую текстовую строку:  "*.COM $ATAS Ok.Cr 24.01.92". Что
позволяет судить о отечественном присхождении вмруса.
     При попытке  заражении файла находящегося на диске,  защищенном от
записи, и при других ошибках,  стандартные сообщения DOS об ошибках от-
сутствуют.
     Обнаружен в КПИ 15 февраля 1992 года Лукашом Д.В.  и Еловым С.М.


    Опции антивируса Cleaner:

       /f - обезвреживать без подтверждения,
       /а - проверять все файлы,
        * - проверять все разделы винчестера.

        Антивирус написан  учениками  школы-лицея N157
        Лукашом Дмитрием Владимировичем
        Еловым Сергеем Михайловичем.

        Контактный телефон: (044)-410-47-14, Лукаш Д.В.

