

------------------------ SMARTMOU.DOC ---------------------------

	     Эмулятор мыши SMARTMOU.EXE

		     ( User's Guide )

	     Руководство пользователя

	 Содержание :

     1. Назначение программы .
     2. Загрузка программы .
     3. Способы короткого и задержанного нажатия .
     4. Режимы интерпретации экранного контекста .
     5. Набор меню пользователя .
	5.1 Меню пользователя .
	5.2 Выбор меню .
	5.3 Редактирование меню .
	5.4 Сохранение и загрузка меню .
     6. Назначение кодовых последовательностей для короткого нажатия .





     1. Назначение программы .


  Программа SMARTMOU.EXE предназначена для эмуляции клавиатуры с помощью
манипулятора "мышь" при работе с программами, в которых первоначально не
предусмотрено  ее  использование  .  Другими словами, манипулируя мышью,
пользователь  имеет  возможность  порождать  необходимые  для управления
прикладной  программой  коды  так,  как  если  бы  они  были  введены  с
клавиатуры. SMARTMOU.EXE имеет следующие характеристики :

	- позволяет использовать для формирования кодов те подсказки,
	  которые выводит на экран прикладная программа ( для этого
	  достаточно указать на подсказку маркером мыши ) ;

	- обеспечивает перемещение текстового курсора в позицию,
	  указанную маркером мыши, что особенно удобно при работе с
	  формами в базах данных ;

	- допускает создание и модификацию пользователем собственных
	  меню, произвольной формы и цвета непосредственно в процессе
	  работы с прикладной программой и в контексте ее экранов ;

	- производит автоматический выбор оптимальной чувствительности
	  мыши в зависимости от состояния прикладной программы .

	- занимает не более 19 Кбт оперативной памяти ( в минимальном
	  варианте 14 Кбт ) ;

	- не влияет на быстродействие прикладной программы ;



	2. Загрузка SMARTMOU.EXE .

  Для использования SMARTMOU.EXE  в прикладной программе необходимо перед
входом в нее выполнить команду :

	>SMARTMOU  [ключи]

  Если  такая  команда  выполняется  впервые  после  загрузки   системы,
программа  SMARTMOU.EXE  остается  резидентной  и  возвращает управление
системе  .   Все  последующие  вызовы  эмулятора  служат  для управления
работой резидентной части с помощью следующих ключей :

	/slave -  назначить эмулятору  низший приоритет  . Это означает,
		   что  он  будет  работать  только  с теми программами,
		   которые не имеют собственной мыши .

	/master - назначение высшего приоритета . В этом случае эмулятор
		   доступен даже в тех программах, которыми предусмотрен
		   опрос мыши .

	/read="Имя файла " - загрузка ранее сохраненного состояния  мыши
				   вместе с набором меню .

	/write"Имя файла  " -  сохранение в  файле на  диске   состояния
				эмулятора .

	/help - выдача экрана-подсказки .

  Подробнее о меню эмулятора см. раздел 5 .

     3. Способы короткого и задержанного нажатия .

  Коротким нажатием назван режим, при котором кнопка ( или обе кнопки  )
мыши удерживаются  в зажатом  состоянии не  более четверти  секунды .  В
результате такой операции происходит то же, что произошло бы при нажатии
на  некоторую  клавишу  клавиатуры  .  Например,  по  умолчанию короткое
нажатие левой кнопки эквивалентно нажатию на клавишу Return  клавиатуры,
правая кнопка соответствует клавише Esc, а обе кнопки - F10 . О том, как
изменить умолчания, см. раздел 4 .

  Перемещение  мыши  при  освобожденных  кнопках  вызывает посылку кодов
соответствующих стрелок . Таким образом, пользователь может осуществлять
выбор  пункта  меню  или  позиционировать  курсор  при  редактировании .
Поскольку  в  различных  режимах  прикладной программы необходима разная
чувствительность  мыши,  эмулятор  автоматически  изменяет  ее,  выбирая
оптимальное по его мнению значение . Например, если прикладная программа
находится  в  режиме  редактирования,  мышь  будет более чувствительна к
перемещению,  чем  в  режиме  меню  или  в  режиме работы с формами базы
данных.

  Если удерживать кнопку  мыши в зажатом  состоянии более 0.25  секунды,
эмулятор  переходит  в  режим  задержанного  нажатия или, иначе, в режим
маркера.   При этом  на экране  появляется маркер  мыши, а  в левом углу
экрана отображается информация о том действии, которое произойдет  после
отпускания нажатой клавиши  . Пользователь может,  не отпуская кнопок  и
перемещая мышь, управлять положением  маркера на экране, выбирая  нужный
ему  объект  .  Сразу  поясним  примером  . Предположим, все стандартные
установки  (умолчания)  не  менялись  пользователем,  и  пусть на экране
имеется текстовый  фрагмент "F10",  выделенный цветом  или разделителями
(пробелы, символы псевдографики и т.п.).  Тогда, нажав на левую кнопку и
переместив  маркер  мыши  в  любую  позицию  фрагмента, пользователь при
освобождении кнопки сэмулирует нажатие  на функциональную клавишу F10  .
Та же операция  с правой клавишей  будет эквивалентна комбинации  клавиш
Alt-F1,  а  с  обеими  клавишами  -  Ctrl-F1  .   Таким образом эмулятор
анализирует контекст,  указанный маркером  мыши на  экране компьютера, и
порождает код или последовательность кодов в соответствии с тем  режимом
интерпретации,  который  установлен  для  зажатой  кнопки  . О возможных
режимах интерпретации см. следующий раздел . После отжатия кнопки маркер
и меню мыши исчезают с экрана .

     4. Режимы интерпретации экранного контекста .

  Управление курсором

	Пользователь  указывает  маркером  мыши  позицию  на  экране   и
	отпускает кнопку . В результате текстовый курсор будет перемещен
	в указанную маркером позицию экрана или, если это невозможно,  в
	ближайшую доступную позицию .

  Слово

	Под словом здесь и далее подразумевается контекст, состоящий  из
	букв, цифр и символов  подчеркивания . Если пользователь  указал
	маркером на некоторое слово и отпустил кнопку мыши при  активном
	режиме "Слово", результат будет эквивалентен вводу этого слова с
	клавиатуры .  Исключением являются ключевые слова, такие как  F1
	, Esc , Return , PgDn и другие . Список ключевых слов приведен в
	приложении . Ключевые словами, как правило, являются обозначения
	клавиш  клавиатуры,  и   указание  на  них   в  режиме   "Слово"
	эквивалентно их нажатию .

  Alt + Заглавные буквы

	В  этом  режиме  в  указанном  пользователем  слове   выделяются
	заглавные буквы, и формируется последовательность кодов из  этих
	букв с учетом регистра Alt . Если, скажем, указано слово Option,
	будет послан  код Alt-O  . Слову  FileName будет соответствовать
	последовательность Alt-F ,  Alt-N . Если  в слове нет  заглавных
	букв,используется   первая   .Ключевые   слова    обрабатываются
	аналогично режиму	"Слово", но с учетом регистра Alt . 

  Ctrl + Заглавные буквы

	Этот режим  совершенно аналогичен  предыдущему, но  для регистра
	Ctrl .

  Заглавные буквы

	Аналогичен двум предыдущим, но без учета регистров .

  Прежде  чем  описать  выбор  режимов  интерпретации и собственных меню
эмулятора, нужно  сказать, что  эмулятор различает  два состояния экрана
прикладной программы  - с  видимым и  невидимым текстовым  курсором ( не
путать с  маркером мыши  !) .  Все изменения  в настройке  мыши, которые
пользователь осуществляет из состояния  с видимым курсором не  влияют на
назначения  при  невидимом  курсоре  и  наоборот . Вся описываемая далее
настройка   параметров   производится   после   перехода   в   состояние
задержанного нажатия .

  Выбор режима интерпретации

	  В   любой   момент   каждой   из   кнопок  мыши  соответствует
	определенный способ интерпретации указанного маркером  экранного
	контекста .  Пользователь  может сменить способ интерпретации  .
	Для этого  нужно нажать  на кнопку,  для которой  предполагается
	сменить режим, и, нажимая клавишу Tab, выбрать требуемый  способ
	интерпретации  .  Еще  раз  подчеркнем,  что  изменение  способа
	интерпретации при  видимом курсоре  не влияет  на параметры  при
	невидимом курсоре .



     5. Набор меню пользователя .

	5.1 Меню пользователя .

  Работая  с  прикладной  программой,  пользователь  может  создавать  и
редактировать собственные  меню  эмулятора . Всего имеется  10 различных
меню, пронумерованных  от 0  до 9  . Каждое  из меню  представляет собой
произвольно размещенный на экране текст . В каждый момент времени каждой
из кнопок соответствует одно из этих меню . Когда пользователь  нажимает
кнопку  мыши  и  удерживает  ее  зажатой  0.25  секунды, "поверх" экрана
прикладной  программы   выводится  соответствующее   кнопке  меню   .  В
дальнейшем пользователь  может указывать  маркером на  контексты меню  и
порождать соответствующие им коды .  Сразу после отпускания кнопки экран
пользователя восстанавливается .


	5.2 Выбор меню .

  Чтобы изменить соответствие между определенной кнопкой и номером меню,
нужно произвести задержанное  нажатие кнопки и  нажать на клавиатуре  на
клавишу с  соответствующей цифрой  (от 0  до 9)  . Номер  активного меню
отображается в левом углу экрана . Заметим, что одной и той же кнопке  в
разных состояниях  экрана (курсор  видим/невидим) могут  соответствовать
меню с различными номерами .


	5.3 Редактирование меню .

  Предположим, что  мы хотим  отредактировать 3-е  меню, которое  должно
появляться при зажатой левой кнопке и видимом курсоре . Для этого  нужно
выполнить следующие действия :

a) Перейти  в прикладной  программе в  то состояние,  где предполагается
использование создаваемого меню (мы уже предположили, что в нашем случае
в этом состоянии на экране имеется текстовый курсор) ;

b) Зажать левую кнопку ;

c) После появления на экране маркера мыши не отпуская кнопки выбрать 3-е
меню (нажав на клавишу клавиатуры с цифрой 3) ;

d) Нажать на клавишу F2 клавиатуры .

  После этого Вы попадаете  в состояние редактирования выбранного  ранее
меню  и  можете  освободить  кнопки  мыши  .  Для  редактирования  можно
использовать клавиши  перемещения курсора  , клавиши  Del и  BackSpace .
Набор меню осуществляется естественным  образом в позицию курсора  . Для
изменения  цвета  очередного  символа  используются  комбинации   клавиш
Ctrl-<Left>, Ctrl-<Right> , Ctrl-<PgUp> и Ctrl-<PgDn> . Для формирования
рамки меню можно  использовать цифровую клавиатуру  в режиме NUM_LOCK  .
Для выхода из режима редактирования нажмите на клавишу Esc .


	5.4 Сохранение и загрузка меню .  

  Чтобы сохранить  те изменения  в настройке  эмулятора, которые  сделал
пользователь  при  работе  с  прикладной  программой  необходимо   после
завершения работы с прикладной программой выполнить следующую команду :

	>SMARTMOU.EXE /w="Имя файла"

  Для загрузки настройки из файла в оперативную память используйте

	>SMARTMOU.EXE /r="Имя файла"

  По умолчанию используется имя STATUS.SMM .



     6. Назначение кодовых последовательностей для короткого нажатия .  


  Чтобы измененить настройку кнопок  для короткого нажатия нужно  зажать
выбранную кнопку (или обе кнопки) и после появления маркера мыши  нажать
клавишу F3  клавиатуры .  После этого  можно освободить  мышь и ввести с
клавиатуры  соответствующую   выбранной  кнопке   и  состоянию    экрана
последовательность клавиш . При этом ввод последовательности  начинается
с нажатия  на клавишу,  не входящую  в описываемую  последовательность .
Второе нажатие на эту клавишу  является признакм конца ввода .  Первый и
последний  коды   не  попадают   в  создаваемую   последовательность   .
Максимальная длина последовательности - 10 символов .


