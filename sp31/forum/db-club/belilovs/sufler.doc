

              ФОРМИРОВАНИЕ ПОДСКАЗОК
        С ИСПОЛЬЗОВАНИЕМ ФАЙЛОВ БАЗЫ ДАННЫХ
                     (SUFLER)

   1. В диалоговых программах ввода и корректировки баз дан-
ных    часто  возникает необходимость запрашивать справочную
информацию из базы данных и подавать ее на экран в  качестве
подсказок.    При этом пользователь должен иметь возможность
отмечать отдельные значения полей, чтобы использовать    эти
значения или соответствующие  этим значениям записи для фор-
мирования или корректировки других файлов.
     В качестве примера рассмотрим задачу ввода кадровой ан-
кеты, когда перечень допустимых должностей зафиксирован    в
справочнике  должностей. Тогда вместо заполнения поля "долж-
ность" можно вызвать на экран указанный перечень и  отметить
курсором     нужное значение.  Если перечень не помещается в
выделенную область экрана(окно), нужно листать      перечень
(вперед и назад).
    Эти и некоторые другие дополнительные возможности  пред-
ставляет   процедура SUFLER, функционирующая в среде FOXBASE
(для  CLIPPER,  DBASE  существуются  соответствующие  версии
 SUFLER).

   2. SUFLER позволяет:
    - управлять положением и размерами окна экрана, где рас-
полагаются подсказки;
    - автоматически размещать подсказки в одну или несколько
колонок в зависимости от ширины окна и длины подсказок;
    - осуществлять перемещение светового маркера с использо-
ванием  клавиши  'стрелка вверх',  'стрелка вниз',  'стрелка
влево', 'стрелка вправо', а листание - клавишами PGUP, PGDN,
CTRL+PGUP, CTRL+PGDN.  Выбор осуществляется нажатием клавиши 
ENTER, а прерывание поиска -  клавишей ESC;
   - назначать значения  одного или нескольких полей     за-
писи файла базы данных в качестве подсказки;
   - указывать дополнительные символы (разделители    полей)
перед и после каждого поля записи внутри подсказки;
   - в верхних и нижних строках окна выводить шапку и приме-
чания(подвал);
   - задавать индексированные или неиндексированные    файлы
базы данных;
   - указывать критерии поиска записей в файле (фильтр);
   - управлять расцветкой окна;
   - использовать массивы строк или чисел вместо полей  базы
данных для формирования подсказок.

   3. SUFLER  возвращает вызывающей программе текст  выбран-
ной  подсказки  и номер записи файла базы данных, содержащей
выбранную подсказку(или индекс массива).
   По умолчанию основной цвет окна бирюзовый с черными  сим-
волами(n/bg), цвет маркера - синий с белыми  символами(w/b),
цвет шапки и подвала - бирюзовый с синими символами(b/bg).
   SUFLER подсчитываает длину  подсказки  в  зависимости  от
длин полей базы данных и  указанных  разделителей, а   затем
вычисляет количество колонок подсказок, помещающихся в окне.
Если параметры размещения окна указаны неправильно, то выда-
ются  диагностические сообщения.
   Для формирования очередной подсказки SUFLER  читает   за-
пись указанного  файла базы данных(или элемент массива), из-
влекает значения указанных полей, размещает между ними  раз-
делители. Если текст очередной подсказки совпадает с текстом
предыдущей, то эта подсказка пропускается. Таким образом  на
экране не могут появится одинаковые смежные подсказки. Полу-
чив управление SUFLER запоминает, а перед  завершением  вос-
станавливает содержимое экрана.

   4.Перед вызовом SUFLER нужно выполнить команду

     SET PROCEDURE TO SUFLER

   Вызов процедуры SUFLER осуществляется командой

DO SUFLER WITH п1,п2,п3,п4,п5,п6,п7,п8,п9,п10,п11,п12,n13,n14

    где п1 - номер строки левого верхнего угла окна для  ра-
змещения подсказок(по умолчанию - 1);
        п2 - номер столбца левого верхнего угла окна(по умо-
лчанию - 1);
        п3 - количество строк окна(по умолчанию  n3 = 24-n1,
т.е. окно до  нижней строки экрана. Если записей, удовлетво-
ряющих критерию поиска, меньше, чем требуется для заполнения
окна,то для окна будет выделено меньшее количество строк;
        п4 - ширина  окна (по  умолчанию n4=79-n2, т.е. окно
до правой границы экрана). Если ширина окна не кратна  длине
подсказки (  с учетом разделительного пробела между колонка-
ми), то  ширина окна будет автоматически уменьшена;
        п5 - переменная с именем файла, содержащего запраши-
ваемые поля. SUFLER  открывает  этот файл в текущей  рабочей
области.  Поэтому рекомендуется  перед вызовом SUFLER  акти-
визировать рабочую область командой SELECT. Если этот  пара-
метр  пуст, то SUFLER  работает   с активизированным в теку-
щей рабочей области файлом, а по завершении работы  позицио-
нирует указатель текущего кортежа в исходное состояние. Если
нужно работать не с  базой данных, а с одномерным  массивом,
то этот параметр должен содержать имя массива с предшествую-
ими символами "\\." ; за именем массива в круглых    скобках
нужно указать его размерность.
        п6 - переменная с именами и форматами полей   файла,
используемых в качестве подсказок. Этот параметр представля-
ет собой символьную строку, содержащую описания полей   базы
данных.  Описание поля включает имя поля и при необходимости
длину и количество знаков после десятичной точки (точность).
Перед длиной ставится  двоеточие,  перед  точностью - точка.
Описания полей отделяются друг от друга пробелами. Hапример,
"pole1:15 pole2:5.1 pole3" . По умолчанию  длина  символьных
полей равна длине поля базы данных, а числовых - 10 при точ-
ности   4. Hе может быть указано более 10 полей;    Для мас-
сивов имя поля может быть произвольным; элементы массива мо-
гут быть числовыми, символьными,  логическими и типа DATE;
        п7 - выходной параметр, который по завершению SUFLER
содержит либо номер записи (или индекс массива),  соответст-
вующий  выбранной подсказке, либо 0, если была   нажата кла-
виша ESC;
        п8 - выходной параметр, который по завершению SUFLER
содержит  текст  выбранной  подсказки или пробелы, если была
нажата клавиша ESC;
        п9 - переменная  с именем индексного файла.     Если
этот    параметр пуст, то активизация файла производится без
открытия индексного файла;
        п10 - критерий поиска записей. Критерии поиска пред-
ставляет собой строку, которая удовлетворяет правилам    со-
ставления операнда команды SET FILTER TO. Если этот параметр
пуст, то будут обрабатываться все записи файла. В    случае,
когда     имя  файла ( параметр п5) не указано, то действует
указанный ранее фильтр. Если в файле нет записей,   удовлет-
воряющих   критерию поиска, выдается диагностическое сообще-
ние;
        п11 - разделители  полей  внутри подсказки, разделе-
нные символом \ ( обратная  косая   черта) .   Первый   раз-
делитель  будет предшествовать первому полю, второй - второ-
му и т.д. Если количество  разделителей меньше    количества
полей    подсказки, то последний указанный разделитель будет
распространятся на остальные поля, включая разделитель между
последним полем и краем подсказки;
        п12  - шапка  окна. Этот параметр представляет собой
символьную      переменную, которая будет размещена в первой
строке окна. Если необходимо сформировать шапку окна из  бо-
лее чем одной строки, то  этот параметр должен содержать си-
мвольную переменную, в первых трех  позициях которой  разме-
щены символы "\\." , а за ними имя массива с  текстом шапки.
Первый элемент массива должен содержать количество строк ша-
пки,    второй - первую строку шапки, третий - вторую строку
шапки и т.д.
        n13 - подвал окна. Этот параметр  представляет собой
символьную  переменную, которая будет размещена в  последней
строке окна. Если необходимо сформировать подвал окна из бо-
лее чем одной строки, то этот  параметр должен содержать си-
мвольную  переменную, в первых трех  позициях   которой раз-
мещены символы "\\." , а за ними имя массива с  текстом под-
вала.    Первый элемент массива должен содержать  количество
строк подвала, второй - первую строку подвала, третий - вто-
рую строку  подвала и т.д.
        n14 - расцветка окна.  Этот  параметр  должен    со-
держать    пустую  символьную переменную (тогда расцветка по
умолчанию) или имя массива.   Первый элемент массива  должен
содержать     описание основного цвета окна  (по умолчанию -
"n/bg"), второй - цвет маркера ("w/b"), третий - цвет  шапки
("b/bg"), четвертый - цвет подвала ("b/bg").

    5.В связи с возможностью совмещения основного цвета окна
и цвета  маркера SUFLER может использоваться в качестве сре-
дства просмотра  файлов  и  массивов (подобно командам LIST,
DISPLAY) и обеспечивающего листание экрана вперед и назад.

   6. Инструкция   по   эксплуатации  SUFLER   находится   в
файле  SUFLER.DOC,  демонстрационный    пример - в файлах
SUFLTEST.PRG  и  SUFLTEST.DBF, а  сама  процедура - в  файле
 SUFLER.FOX .

   7.При обнаружении ошибок просьба обращаться к Белиловско-
му Е.Л. по телефону  5135758(дом) или 2160794(cл.).


