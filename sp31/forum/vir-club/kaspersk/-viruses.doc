
                          3. Описание вирусов
			  ═══════════════════

	Ниже приводятся результаты анализа алгоритма работы имеющихся  у
меня файловых  и загрузочных  вирусов. Наиболее  общие свойства  вирусов
представлены в таблицах каталога (см. файл -VIRUSES.TBL), дополнительная
информация о каждом вирусе содержится в пунктах 3.2 и 3.3.

	Если свойство вируса  отмечено в таблице,  то в описании  вируса
оно может не упоминаться. Если файловый или загрузочный вирус  совершают
стандартные действия (см.  2.1 и 2.2),  то описание этих  действий может
быть опущено.


			  3.1 Каталог вирусов
                          ═══════════════════

	В предлагаемом каталоге для каждого вируса приведена  информация
по свойствам, описанным в пунктах  1 и 2. Символьное представление  этих
свойств во многом повторяет классификационный код Н.Н.Безрукова.

	В качестве основных  опознавателей вируса будет  указываться его
имя и длина. Если вирус имеет несколько имен, то указываться будет  одно
из них, остальные известные мне имена приведены таблице 3 каталога.

	Длиной  файлового  вируса  считается  длина  тела вируса (коды +
данные  +  стек  вируса,  если  есть)  без всяких добавок. В большинстве
случаев она равна минимальному приращению длин файлов при их  заражении.
Для загрузочных вирусов в  качестве длины принимается полная  длина тела
вируса, т.е. число занимаемых вирусом секторов, умноженное на число байт
в секторе.

	В таблицах каталога встречаются следующие символы:

	+ 		- наличие свойства;
	-		- отсутствие свойства;
	*		- в пунктах 3.2 и 3.3 имеется дополнительная
			  информация;
	&		- одновременное выполнение свойств.

	V		- вызывает видеоэффекты (Video);
	M		- вызывает звуковые эффекты (Music);
	H		- имеет деструктивную функцию (Harm);
	Er		- содержит ошибку, которая может проявляться как
			  деструктивная функция (Error);
        Ch              - изменяет служебную информацию: на диске - имя
                          диска, в DOS - возвращает неверную версию DOS
                          и т.п. (Change).

	Для файловых вирусов (табл. 1):

	C		- COM-файлы;
	.C		- .COM-файлы;
	E		- EXE-файлы;
	.E		- .EXE-файлы;
        S               - SYS-файлы;
        O               - прочие файлы (Other).

        Для загрузочных вирусов (табл. 2):

	B		- Boot-сектор винчестера;
	M		- MBR винчестера;
	F		- Boot-сектор флоппи-дисков.

        Для  файлово-загрузочных  вирусов  употребляется  полный   набор
символики.

	Например,  если  для  файлового  вируса в графе, соответствующей
поражаемым  объектам,  указано  "E  C&.C",  то  это  означает, что вирус
поражает  только  файлы,  имеющие  либо  формат  EXE,  либо формат COM и
одновременно расширение имени ".COM" (т.е. не поражаются файлы,  которые
имеют формат COM и расширение имени ".EXE").

        При описании свойств файловых вирусов (табл. 1) используются
специальные знаки.

Место внедрения в файл:	s    - начало (start);
			e    - конец (end);
                        i    - середина (insert).
Метод заражения:	FIND - используя функции FindFirst и FindNext;
                        INT  - перехватывая обращения DOS к файлам;
                        INFI - используя оба способа.
Способ внедрения в оперативную память (только для резидентных вирусов):
			MCB  - оперируя с MCB;
			KEEP - используя прерывания DOS (int 21h f.31
			       или int 27h);
                        IntTable - записывается в таблицу векторов;
                        Buffer   - записывается в дисковый буфер.
Длина:                  L    - длина вируса;
                        $    - длина заражаемого файла увеличивается до
			       значения, кратного параграфу;
                        ++   - повторное заражение файлов.


════════════════════════════════════════════════════
═══════ Таблицы приведены в файле -VIRUSES.TBL. ════
════════════════════════════════════════════════════


			 3.2. Файловые вирусы
                         ════════════════════

                      Семейство вирусов "Amstrad"
                      ═══════════════════════════
        Семейство  (в  моей  коллекции  -  6 штук) нерезидентных опасных
вирусов. Общие черты:

        Заражаются все .COM-файлы в текущем оглавлении, вирус записывает
себя  в  начало  файла.  При  этом  возможно  повторное заражение. Файлы
большой длины могут быть уничтожены.

        Некоторые версии  вируса быстро  проявляются:   начиная с пятого
"поколения" вируса при старте зараженной программы с вероятностью 1/2 на
экране появляется сообщение : "Programm sick error:  Call doctor or  buy
PIXEL for cure description". Одна из версий выдает на экран политический
лозунг на болгарском языке.

                    Семейство вирусов "Anti-Pascal"
                    ═══════════════════════════════
        Семейство (5 штук) очень опасных нерезидентных вирусов. Заражают
или портят  не более  2-х файлов  во всех  каталогах на  текущем диске и
диске C:. При поиске незараженных файлов используется рекурсивный  обход
дерева каталогов. Заражают .COM- ,.BAK- и .PAS файлы. В случае COM-файла
вирус записывается в его конец (версии  вируса длин 400, 440 и 480)  или
начало  (оставшиеся  версии  вируса).  При  заражении .BAK и .PAS-файлов
записывается в начало файла, при этом старое начало не сохраняется, т.е.
файл  оказывается   безвозвратно  потерян.   Некоторые  версии    вируса
переименовывают .BAK и .PAS файлы в .EXE.

                Вирусы семейсива "April 1st" ("SURIV")
                ══════════════════════════════════════
                         Вирус "April 1st COM"
                         ─────────────────────
        Файловый резидентный опасный  вирус. Поражает .COM-файлы  (кроме
COMMAND.COM) при их запуске на выполнение (int 21h, ax=4B00h).  Опасен -
не проверяет длин файлов.  Записывается в начало файла. При заражении:

        а) создает файл TMP$$TMP.COM;
        б) записывает в него свою копию;
        в) дописывает в него заражаемый файл;
        г) уничтожает заражаемый файл;
        д) переименовывает TMP$$TMP.COM в имя заражаемого файла.

        При  создании  своей  резидентной  копии  использует функцию 31h
прерывания 21h (по схеме "Иерусалимского" вируса).

        Проявляется начиная с 1  апреля 1988 года при  заражении файлов:
1 апреля  выводит сообщение  "APRIL 1ST  HA HA  HA YOU  HAVE A  VIRUS" и
завешивает  систему;  в  последующие  дни  выводит сообщение "YOU HAVE A
VIRUS !!!".

        Перехватывает  прерывание  21h.  Помимо  перечисленных  содержит
текстовые строки  "sURIV" (в  начале зараженного  файла), "COMMAND.COM",
"TMP$$TMP.COM".

                         Вирус "April 1st EXE"
                         ─────────────────────
        Файловый резидентный опасный  вирус. Поражает .EXE-файлы  при их
запуске на выполнение (int 21h, ax=4B00h).  Опасен - не вполне корректно
работает с длиной файла. При заражении внедряется в середину файла между
заголовком (EXE header) и загружаемым модулем, при этом вирус:

        а) создает файл TMP$$TMP.EXE;
        б) считывает  из  заражаемого   файла   первые  1Bh   заголовка,
           модифицирует  в  них  байты,  соответствующие  длине  модуля,
           стартовым значениям CS, IP,  SS, SP, контрольной сумме  файла
           (устанавливается   значение    1984h);    затем    записывает
           модифицированный заголовок в файл TMP$$TMP.EXE;
        в) копирует  из  заражаемого   файла   в  TMP$$TMP.EXE   таблицу
           настройки  адресов  (ТНА),  модифицируя  ее  описанным   ниже
           способом;
        г) дописывает в файл TMP$$TMP.EXE копию вируса;
        д) дописывает в файл TMP$$TMP.EXE загружаемый модуль
           инфицируемого файла.
        е) уничтожает заражаемый файл;
        ж) переименовывает TMP$$TMP.EXE в имя заражаемого файла.

               Незараженный файл        Зараженный файл
                 ┌───────────┐          ┌───────────┐
                 │EXE header │ ───────> │EXE header │
                 ├───────────┤          ├───────────┤
                 │Загружаемый│ ───┐     │Вирус      │
                 │модуль     │    │     │           │
                 │           │    │     ├───────────┤
                 │           │ ─┐ └───> │Загружаемый│
                 └───────────┘  │       │модуль     │
                                │       │           │
                                └─────> │           │
                                        └───────────┘

        Так  как  загружаемый  модуль  файла  при заражении смещается на
расстояние,  равное  длине  вируса,  то  вирусу  приходится  производить
соответствующие  изменения  в  ТНА:  у  каждого  элемента ТНА содержимое
байтов, соответствующих  смещению сегмента,  увеличивается на  значение,
равное длине вируса в параграфах.

        При  создании  своей  резидентной  копии  использует функцию 31h
прерывания 21h (по схеме "Иерусалимского" вируса).

        Проявляется  начиная  с  1  апреля  1988  года  при активизации:
первого апреля расшифровывает (XOR  FFh) и выводит сообщение  "APRIL 1ST
HA HA  HA YOU  HAVE A  VIRUS" и  завешивает систему;  в последующие  дни
сообщение не выводит, систему  завешивает через приблизительно 55  минут
после активизации.

        Перехватывает прерывание 21h и,  в зависимости от текущего  дня,
может  перехватывать   прерывание  1Ch.   Содержит  строки   "sURIV"   и
"TMP$$TMP.EXE".

                       Семейство вирусов "Eddie"
                       ═════════════════════════
                           Вирус "Eddie-651"
                           ─────────────────
        Инфицирует  COM-  и  EXE-файлы  при  загрузке  их  в  память для
выполнения  (int   21h,  ax=4B00h).  У  заражаемого  файла устанавливает
значение секунд  в 1Fh.  Никак не   проявляется. Содержит  строку "Eddie
lives". Изменяет вектор прерывания 21h.

        Вирус перехватывает функции DOS  FindFirst и FindNext (int  21h,
ah=11h,  12h)  и  "уменьшает"   длины  зараженных  файлов,  т.е.   вирус
невозможно  определить  по  изменению  длин  файлов  (если,  конечно, он
резидентно находится в памяти). Утилиты, которые не используют указанные
функции  DOS  (например,  Norton   Commander),  а  напрямую   используют
содержимое  секторов,  хранящих  каталог,  показывают  правильную  длину
зараженных файлов.   При "уменьшении"  длин файлов  вирус определяет  их
зараженность по значению секунд даты последней модификации (62  секунды)
и  не  проверяет  истинных  длин  файлов.   Если  такое  значение секунд
встретится у  файла небольшой  длины (меньше  651 байт),  то команда DIR
выдаст несколько странную длину файла - около 4 гигабайт.

                          Вирус "Eddie-1800"
                          ──────────────────
	Очень опасный резидентный  файловый вирус. Быстро  размножается:
инфицирует COM- и EXE-файлы при загрузке их в память для выполнения, при
создании, переименовании, открытии и  закрытии файла (int 21h,  ax=4B00h
или ah=3Ch, 5Bh, 56h, 3Dh, 2Eh).

	При создании своей копии  в оперативной памяти компьютера  вирус
пытается  занять  область  памяти  с  самыми старшими адресами, разрушая
временную  часть  командного  интерпретатора  COMMAND.COM.  По окончании
работы  программы  командный  интерпретатор  COMMAND.COM восстанавливает
свою временную часть, при этом происходит открытие файла COMMAND.COM  и,
соответственно,  его  заражение.   Таким  образом, наиболее подверженным
заражению файлом является COMMAND.COM.

	Вирус предпринимает ряд эффективных мер для того, чтобы остаться
незамеченным:

	1) При старте любой программы вирус помечает программный сегмент
	   как последний и становится  невидимым для этой программы,  по
	   окончании работы программы вирус помечает программный сегмент
	   как не последний.
        2) Аналогично  вирус  поступает  с  вектором прерывания 21h  при
	   старте  программы:  он  восстанавливает  его   первоначальное
	   значение.
        3) Вирус не позволяет программам изменять вектор прерывания  21h
	   и  защищается  таким  образом  от  резидентных   антивирусов,
           установленных после того как активизировался вирус.
        4) Вирус пытается обойти программы, следящие за прерыванием 13h,
	   и  установить  вектор  этого  прерывания в его первоначальное
	   значение.

	Вирус  очень  опасен:  периодически  стирает сектор со случайным
номером  ("оплевывает"  диск),  при  этом  он  может  уничтожить   часть
информации на диске. Вирус анализирует 2 байта (8-й и 10-й) BOOT-сектора
диска, с которого была запущена зараженная программа.  Вирус увеличивает
на 1 значение 10-го  байта и сохраняет его  в BOOT-секторе.  Если  новое
значение 10-го  байта кратно  16, то  вирус стирает  на диске  сектор со
случайно выбранным номером, зависящим от значения 8-го байта.

	Изменяет вектора прерываний 13h, 21h, 27h.

	Содержит  текстовые  строки  "Eddie  lives...somewhere in time",
"Diana P.", "This program was written  in the city of Sofia (C)  1988-89
Dark Avenger".

                  Вирусы "Eddie-2000" и "Eddie-2100"
                  ──────────────────────────────────
        Очень опасные резидентные файловые вирусы. Быстро  размножается:
инфицируют файлы при загрузке их в память для выполнения, при  создании,
переименовании и закрытии файла, при чтении или изменении его  атрибутов
(int 21h, ax=4B00h или ah=3Ch, 3Eh, 43h, 56h, 5Bh).

	Вирус следит за тем, чтобы длины заражаемых файлов увеличивались
ровно на  2000 (или  2100) байт  (к EXE-файлам,  помимо выравнивания  на
границу параграфа,  дописывается необходимое  число байт).  У заражаемых
файлов  (как  и  при  поражении  вирусом "Vienna") устанавливается новое
значение секунд даты последней модификации - 62 секунды.

        Вирус "Eddie-2000" предпринимает  ряд эффективных мер  для того,
чтобы остаться  незамеченным, многие  из них  повторяют аналогичные меры
вируса "Eddie-1800". Маскирующую функцию играет длина вируса: достаточно
трудно заметить приращение длины, кратное 1000 байтам. Введена и  другая
функция защиты: вирус перехватывает функции DOS FindFirst и FindNext FCB
(int 21h,ah=11h,12h) и "уменьшает" длины зараженных файлов на 2000 байт.

        Вирус "Eddie-2100"  дополнительно к  этому обрабатывает  функции
FindFirst  и  FindNext  ASCII  (ah=4Eh,4Fh);  исправлена  ошибка,  из-за
которой команда  DIR сообщала,  что длина  файла около  4 гигабайт  (см.
описание вируса "Eddie-651"). Вирус непонятным мне образом  манипулирует
с  секторами  винчестера  -  видимо,  пытается  либо активизировать либо
вылечить неизвестный мне загрузочный вирус.

        Вирусы  "Eddie-2000"  и  "Eddie-2100"  очень  опасны: аналогично
вирусу "Eddie-1800"  стирают cектора  со случайными  номерами. При  этом
вирусы обращаются  напрямую к  драйверу, обслуживающему  диск, и обходят
многие резидентные блокировщики.

        Изменяет вектора  прерываний 13h,  21h, 27h.  Содержат текстовые
строки "Диана П.", "(c) 1989 by Vesselin Bontchev"; вирус "Eddie-2000" -
"Zopy me - I want to trawel", вирус "Eddie-2100" - "Eddie lives".

	Если в  теле запускаемой  программы содержится  строка "Vesselin
Bontchev" (Весселин Бончев - автор известных болгарских антивирусов), то
вирус зацикливается и система зависает.

                      Вирусы семейства "Cascade"
                      ══════════════════════════
        Мне   известны   два   вируса   семейства:   "Cascade-1701"    и
"Cascade-1704".  Тело  вируса,  за  исключением  его  начала (32 байта),
зашифровано.  В  качестве  ключа  используется  длина зараженного файла,
поэтому два "штамма" вируса в большинстве случаев будут совпадать только
на первых 32-х байтах.

	При  выполнении  зараженной  программы  управление  командой JMP
передается на  начало вируса.  Первыми командами  вирус определяет длину
исходного файла и расшифровывает свое тело.

	При cоздании своей резидентной копии вирус :

	а) копирует свое тело в старшие адреса памяти;
	б) перемещает в старшие адреса тело основной программы;
	в) перемещает  тело  вируса  в  освободившееся  пространство над
	   телом основной программы;
	г) устанавливает  вектора  прерываний  1Ch,  21h  и  28h на свою
	   копию.

		     а)               б)               в)
        │ ...     │      │ ...     │      │ ...     │      │ ...     │
        ├─────────┤      ├─────────┤      ├─────────┤      ├─────────┤
        │Программа│      │Программа│──┐   │Свободная│  ┌──>│Вирус    │
        │         │      │         │  │   │память   │  │   │         │
        │         │      │         │  │   ├─────────┤  │   ├─────────┤
        ├─────────┤      ├─────────┤  └──>│Программа│  │   │Программа│
        │Вирус    │──┐   │Вирус    │      │         │  │   │         │
        │         │  │   │         │      │         │  │   │         │
        ├─────────┤  │   ├─────────┤      ├─────────┤  │   ├─────────┤
        │ ...     │  └──>│Вирус    │      │Вирус    │──┘   │ ...     │
			 │(копия)  │      │         │
			 ├─────────┤      ├─────────┤
			 │ ...     │      │ ...     │

	Вирус заражает  только COM-файлы  при загрузке  их в  память для
выполнения (int 21h,  ax=4B00h). Инфицирование производится  стандартным
способом. Наиболее  распространенные версии  этого вируса  не производят
повторного заражения файла.

	Изменяет вектора прерываний 1Ch, 21h и 28h.

	Вызывает характерный видеоэффект: осыпание букв на экране. Не
имеет деструктивной функции.

                     Семейство вирусов "Jerusalem"
                     ═════════════════════════════
        Мне известны 5 представитетей семейства "Иерусалимских" вирусов:
"Jerusalem", "Sunday", "Kylie", "Fumanchu", "Taiwan". Их общие свойства:

        Заражаются  .COM-  и  .EXE-файлы  при  загрузке  их в память для
выполнения  (int  21h,  ax=4B00h).  Вирус  анализирует  имя  заражаемого
файла  и  не  заражает  файлы   с  именем  COMMAND.COM,  чем   несколько
затрудняет свое обнаружение.

        При заражении .COM-файла вирусы функцией ALLOC (int 21h, ah=48h)
выделяет  память,  куда  копируют  себя,  а затем зараженный файл (таким
образом, при заражении не вирус дописывается к файлу, а файл к  вирусу).
Затем уже зараженный файл сохраняется на диск.

        Инфицирование  .EXE-файлов  производится  стандартным   образом,
большинство вирусов семейства изменяют значение контрольной суммы файла.
Возможно  внедрение  вируса  в  середину  файлов  (в  результате  ошибки
вируса), что может привести к их потере.

        При выполнении инфицированной программы вирус проверяет  наличие
своей копии  в памяти  компьютера.   Затем вирус  остается резидентным в
памяти, при этом он выполняет следующие действия:

	а) сохраняет   в  своем  теле  значения байтов памяти с адресами
	   003FCh-003FEh;
	б) по   этим  адресам  вирус  помещает  программу  копирования и
	   передает ей управление;
	в) при  копировании  тело  вируса  перемещается в самые  младшие
	   адреса, выделенные для основной  программы (при этом вирус  в
	   COM-программе  копируется  сам  в  себя,  а  в  EXE-программе
	   стирает часть кода основной программы), возврат из  программы
	   копирования происходит в копию вируса;
	г) восстанавливает  старое содержимое  байтов памяти  с адресами
	   003FCh-003FEh;
	д) уменьшает размер выделенной под основную программу памяти;
	е) определяет имя основной  программы и функцией EXEC  (int 21h,
	   ax=4B00h)  запускает  ее   на  выполнение  (т.е.   происходит
	   повторный запуск основной программы);
	ж) по  окончании  работы  программы  вирус остается  резидентным
           (int 21h, ah=31h).

            а) б) в)        г) д)           е)            ж)

   │ ...     │    │ ...     │   │ ...     │   │ ...     │   │ ...     │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │EXE-     │ ┌─>│Вирус    │   │Вирус    │   │Вирус    │   │Вирус    │
   │программа│ │  ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │         │ │  │         │   │ ...     │   │EXE-     │   │ ...     │
   ├─────────┤ │  ├─────────┤                 │программа│
   │Вирус    │─┘  │Вирус    │                 │         │
   ├─────────┤    ├─────────┤                 ├─────────┤
   │ ...     │    │ ...     │                 │Вирус    │
                                              ├─────────┤
                                              │ ...     │

   │ ...     │    │ ...     │   │ ...     │   │ ...     │   │ ...     │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │Вирус    │───>│Вирус    │   │Вирус    │   │Вирус    │   │Вирус    │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │COM-     │    │COM-     │   │ ...     │   │Вирус    │   │ ...     │
   │программа│    │программа│                 ├─────────┤
   ├─────────┤    ├─────────┤                 │COM-     │
   │ ...     │    │ ...     │                 │программа│
                                              ├─────────┤
                                              │ ...     │

        Вирусы семейства содержат текстовую строку "COMMAND.COM".

                           Вирус "Jerusalem"
                           ─────────────────
	Этот резидентный файловый вирус очень распространен, упоминается
также  как  "Черная  Дыра",  "Тринадцатая  Пятница", "Вирус Замедления",
"Израильский" вирус.

	Очень опасен 13-го числа любого месяца, если этот день  является
пятницой, и опасен во все остальные дни.

        После  заражения  .COM-файла  к  нему  добавляется  5  байтов (в
наиболее распространенной версии   вируса - "MsDos").   По  этим  байтам
вирус  отличает  зараженные   файлы  от  незараженных  и   не производит
повторного инфицирования.

          Значение  контрольной  суммы  .EXE-файлов  изменяет на 1984h).
Проверочные  5    байтов  не   дописываются,  т.е.    .EXE-файлы   могут
инфицироваться повторно.

	Вирус изменяет вектора прерываний  8, 21h.

	При активизации вируса в любой день, кроме "13-й пятницы", вирус
перехватывает  прерывание  8  (TIMER  TICKS).  Через  некоторое время на
экране  появляется  черный  прямоугольник  и,  начиная  с этого момента,
работа  компьютера  существенно  замедляется  (при  каждом прерывании 8h
компьютер совершает холостой цикл). При активизации вируса 13-го числа в
пятницу происходит следующее:  при попытке запустить любую программу  на
выполнение файл,  содержащий эту  программу, уничтожается,  и DOS выдает
сообщение о том, что файл не найден.  В результате будут уничтожены  все
файлы, к которым произойдет обращение функции EXEC (int 21h, ax=4B00h).

                          Вирус "SunDay-1631"
                          ───────────────────
	Очень опасен: уничтожает файлы  при запуске их на  выполнение. В
воскресенье выдает сообщение: "Today is SunDay! Why do you work so hard?
All work and no play make you a dull boy! Come on! Let's go out and have
some fun!".

                          Вирус "Kylie-2272"
                          ──────────────────
        Поражает файлы начиная  с 20 января  1990 г. С  13 июля 1990  г.
проявляется проигрыванием мелодии.  Перехватывает прерывания  1Ch и 21h.
Содержит текстовую строку "Kylie Minogue".

                         Вирус "Fumanchu-2080"
                         ─────────────────────
        При "теплой"  перезагрузке (Alt-Ctrl-Del)  или в  зависимости от
текущего времени расшифровывает (XOR AFh)  и выдает на экран текст  "The
world will  hear from  me again!".  По-видимому, содержит  в своем  теле
много других зашифрованных текстов, но,  к сожалению, не было времени  в
них разобраться.  Непонятным мне  образом "фокусничает"  с клавиатурой -
опять таки не было времени разобраться.

        Перехватывает вектора прерываний  9, 16h, 21h.

                          Вирус "Taiwan-2900"
                          ───────────────────
        Заражает  файлы  не  только  при  выполнении, но и при открытии.
Очень опасен  - при  запуске файла  ACAD.EXE стирает  информацию на всех
доступных  дисках.  Примерно  раз  в  месяц  через  примерно  10   часов
непрерывной работы  проигрывает довольно  тоскливую мелодию.  Если в это
время  нажать  Alt-Ctrl-Del,  то  произойдет  то  же,  что и при запуске
ACAD.EXE.

        Перехватывает вектора прерываний 8, 9, 13h, 16h, 21h. Содержит в
своем  теле  зашифрованные  строки  "ACAD.EXE",   "COMMAND.COM.COM.EXE",
"Copyright (C) 1988, 1989 by ABT Group".

                        Вирусы семейства "Hymn"
                        ═══════════════════════
        Семейство резидентных очень опасных вирусов. Стандартно поражают
COM- и EXE-файлы при их запуске, закрытии, переименовании или  изменении
их атрибутов. Если номер текущего месяца совпадает с числом (1 января, 2
февраля,...) уничтожают  часть системной  информации Boot-сектора  диска
C:, затем расшифровывают и выводят на экран сообщение "USSR ViruSoft (c)
v1.1990" и исполняют Гимн СССР. В Boot-секторе диска обнуляются позиции,
в  которых  указываются  число  байтов  на  сектор, секторов на кластер,
зарезервированных  секторов,  число  FAT,  максимальное  число элементов
корневого оглавления и портится значение общего числа секторов на  диске
(всего 9 байт).  После того, как  я проделал подобные  изменения в Boot-
секторе своего компьютера, он перестал загружаться как с винчестера, так
и с  флоппи-диска, пришлось  слепить свой  мини-загрузчик. "Hymn-1962" и
"Hymn-2144" шифруют свое тело.

                          Семейство "Murphy"
                          ══════════════════
        Неопасные  резидентные  файловые вирусы.  Быстро   размножаются:
стандартным способом  инфицирует файлы  при загрузке  их в  память и при
открытии файлов (int 21h, ah=3D, 4Bh, 6Ch).

        Процедура копирования вируса в память во многом повторяет  вирус
"Eddie-1800",  после  чего  вирусы  "Murphy",  как и вирус "Eddie-1800",
поражают COMMAND.COM. Изменяют вектор прерывания 21h.

        Вирус  "Murphy-1277"  через  некоторое  время  после активизации
начинает издавать  мерзкий свист  очень высокого  тона. Содержит  текст:
"I'm  Murphy.  Nice  to  meet  you  friend.  I'm  written since Nov/Dec.
Copywrite (c)1989 by Lubo & Ian, Sofia, USM Laboratory."

        Вирус "Murphy-1521" проявляется так же, как и вирус "Ping-Pong":
запускает  "шарик",  который  перемещается  по  экрану, отражаясь от его
границ. Содержит текст  "It's me -  Murphy. Copywrite (c)1990  by Lubo &
Ian, Sofia, USM Laboratory".

   Новое в компьютерной микробиологии - Семейство вирусов "Phoenix"
   ════════════════════════════════════════════════════════════════
        Семейство ("Phoenix", "Evil", "Proud") очень опасных резидентных
вирусов. Инфицируют COM- и EXE-файлы ("Proud" - только COM) при закрытии
и выполнении.   Пораженные EXE-файлы  не распространяют  вируса -  к ним
стандартным  образом  приписывается  небольшой  участок  кодов   вируса,
стирающий при  некоторых условиях  всю информацию  на всех установленных
винчестерах.  Вирус  записывается  в  середину  COM-файлов  (см.   рис),
сохраняя стираемую при этом часть файла в его конец (кроме COMMAND.COM -
вирус записывается в область стека COMMAND.COM и не изменяет его длины).
Затем у файла изменяются первые 3 байта (JMP Loc_Virus).

  ┌───────────┐      ┌───────────┐     ┌───────────┐      ┌───────────┐
  │  Файл     │      │  Файл     │     │COMMAND.COM│      │COMMAND.COM│
  │           │      │           │     │           │      │           │
  │           │      │           │     │           │      │           │
  ├ - - - - - ┤      ├───────────┤     ├ - - - - - ┤      ├───────────┤
  │           │──┐   │  Вирус    │     │           │      │  Вирус    │
  ├ - - - - - ┤  │   ├───────────┤     ├ - - - - - ┤      ├───────────┤
  └───────────┘  │   │- - - - - -│     └───────────┘      └───────────┘
                 └──>│           │
                     └───────────┘

        При активизации вирусы семейства перехватывают прерывание 13h  и
затем в зависимости от некоторых условий случайным образом  переставляют
байты в считываемых или записываемых на диск блоках информации.

        Вирусы  семейства   используют  два   новых  для    компьютерной
микробиологии  приема.  Во-первых,  вирусы  отслеживают  обращение DOS к
исполняемым файлам НЕ ПЕРЕХВАТЫВАЯ для этого вектор прерывания 21h и  НЕ
ИЗМЕНЯЯ содержимое системного обработчика этого прерывания (используется
другой,  достаточно  экзотический,  способ).  Во-вторых, вирусы не имеют
постоянной  маски  (сигнатуры):  основная  часть  вируса  зашифрована, а
программа расшифрования  (длиной 32  байта) выбирается  из 204 возможных
вариантов (следует учесть, что вирусы семейства имеют длины: "Phoenix" -
1704 байт, "Evil" - 1701, "Proud" - 1102 байта).

        Используемые  при  этом  алгоритмы  еще не стали общеизвестными.
Поэтому я воздержусь от их подробного изложения, дабы несколько отдалить
момент появления аналогичных вирусов советского производства.

        Вирусы содержат в себе следующие текстовые строки (зашифрованные
вместе с остальной частью  вируса): вирус "Phoenix" -  строку "PHOENIX";
вирус "Evil" - строку "The evil that men do lives on and on and  on...";
вирус "Proud" - "Proudly made in Sofia".

                     Семейство вирусов "Saratoga"
                     ════════════════════════════
        Семейство  резидентных  опасных  вирусов.  Стандартным   образом
поражают  каждый  второй  (или  десятый  в зависимости от версии вируса)
.EXE-файл при его  выполнении или загрузке  в память (int  21h, ah=4Bh).
После  каждого  удачного  заражения  файла  объявляют  один из свободных
кластеров текущего диска сбойным (т.н. псевдосбойный кластер).

                        Семейство вирусов "SVC"
                        ═══════════════════════
                    Вирусы "SVC-1689" и "SVC-1700"
                    ──────────────────────────────
        Резидентные  безобидные  вирусы,  стандартно  поражают  COM-   и
EXE-файлы при запуске  на выполнение (int  21h, ax=4B00h).   Не заражают
файлы AI*.* и SC*.* (AIDSTEST.EXE и SCAN.EXE).  Обрабатывают функции DOS
FindNext и FindFirst и подставляют  старую длину файла. При запуске  под
отладчиком  самоизлечиваются.   Устанавливают  секунды  даты   последней
модификации файла в 1Eh (60 секунд).  Содержат строку "(c) 1990 by  SVC,
Vers. 4.0".  Перехватывают прерывание 21h.

                           Вирус "SVC-3103"
                           ────────────────
        Резидентный  безобидный  вирус,   стандартно  поражает  COM-   и
EXE-файлы при запуске на выполнение или открытии или закрытии файла (int
21h,  ax=4B00h  или  ah=3Dh,3Eh).   Незначительная  часть  кода   вируса
зашифрована.  Как  и  "SVC-1689"  подставляет  старую  длину файла.  При
попытке  установить  отладчик  на  коды  вируса перезагружает компьютер.
Содержит строку  "(c) 1990  by SVC,Vers  5.0". Перехватывает  прерывание
21h.
        Штамм вируса передан мне сотрудниками МВД. Они же сообщили, что
автор вируса проживает в г. Нижний Новгород.

                       Семейство вирусов "Tiny"
                       ════════════════════════
        Состоит  из  11-ти  резидентных  вирусов,  стандартным   образом
поражающих COM-файлы. Вирусы семейства копируют свою резидентную часть в
область памяти по адресу 0000:0600.

        Отличаются небольшими  размерами -  от 133  до 198  байт. В  эти
байты  вмещаются  подпрограммы  восстановления  истинных 3-х байт начала
файла,  проверки  наличия  вируса  в  памяти, создания резидентной копии
вируса и  оьработчик прерывания  21h. Ассемблерный  текст вируса состоит
всего  из  80-100  строк,  но  его  анализ доставит большое удовольствие
настоящему хакеру.

                       Вирусы семейства "V-1024"
                       ═════════════════════════
        Семейство  неопасных  резидентных  вирусов.  Стандартно поражают
COM- и EXE- файлы при их загрузке в память (int 21h, ah=4Bh).  Указывают
"уменьшенную" длину файла при  вызове функций FindNext и  FindFirst (int
21h, ah=11h,12h).  Через некоторое  время после  активизации "запускают"
несколько разноцветных  шариков, в  беспорядке перемещающихся  по экрану
(эффект напоминает движение шарика у вируса "Ping-Pong").

                       Вирусы семейства "V-600"
                       ════════════════════════
                             Вирус "V-600"
                             ─────────────
	Файловый резидентный  вирус, безобиден.  Часть вируса  (50 байт)
зашифрована (XOR DDh).

	Инфицирует .COM-файлы  при загрузке  их в  память для выполнения
(int  21h,  ax=4B00h).  Вирус  внедряется  в файл по схеме, напоминающей
вирус "Peterburg":  переписывает начало  заражаемого файла  (600 байт) в
его конец  и записывает  свою копию  в освободившийся  участок. При этом
переписываемая часть файла шифруется (XOR BBh).

        Изменяет вектор прерывания 21h. Вирус никак не проявляется и  не
имеет деструктивной функции. В теле вируса содержится зашифрованный (XOR
1Ah)  текст:   "Oleynikoz  S.,1990".  Видимо,  проба  пера   начинающего
программиста, т.к. невооруженным глазом заметно достаточно узкое  знание
возможносией языка ассемблера.

                         Вирус "Voronezh-1600"
                         ─────────────────────
	Резидентный  файловый  опасный  вирус.  Поражает  файлы  при  их
выполнении  или  открытии  (int  21h,  ax=4B00h  или  3D00h).  COM-файлы
заражаются по схеме вируса "V-600".

	EXE-файлы инфицируются по сложному алгоритму:  у них  изменяется
5 байт точки входа  в программу на код  команды CALL FAR Loc_Virus,  при
этом изменение адреса точки входа в заголовке файла не требуется.  Вирус
корректирует  таблицу  настройки  адресов  (ТНА):   добавляет в нее один
элемент, соответствующий команде CALL FAR Loc_Virus; необходимым образом
изменяет 1  элемент ТНА,  указывающий на  измененные 5  байт (если такой
элемент существует). Затем вирус дописывает  к  файлу свою копию  (длина
файла  при этом НЕ увеличивается до параграфа).

	Перехватывает прерывание 21h.

	Вирус содержит ошибки: анализируются не более 640 элементов ТНА;
не анализируется случай, когда  модифицируемый элемент ТНА указывает  на
5-й байт от точки входа (т.е. слово, которое настраивается при  загрузке
файла, лежит  на границе  изменяемых 5  байт). При  запуске такого файла
возможно зависание компьютера.

	Судя по информации, предоставленной Д.Н.Лозинским, вирус написан
неким  "мелким   пакостником"  Стасом   Олейниковым  специально   против
антивируса   AIDSTEST.EXE.  Механизм  прикрепления  вируса  к EXE-файлам
разработан таким  образом, что  AIDSTEST.EXE не обнаруживает изменений в
своем  теле.  Вероятно,  С.Олейников  не  остановится  на  достигнутом и
принесет  немало  неприятностей  организациям,  в  которых ему предстоит
работать.

                      Семейство вирусов "Vienna"
                      ══════════════════════════
        Моя коллекция содержит 13 вирусов семейства. Их общие черты:

        Стандартным образом заражают .COM-файлы  в текущем каталоге и  в
зависимости  от  версии  вируса  в  корневом  каталоге либо в каталогах,
отмеченных системной переменной PATH.  Заражение происходит при  запуске
инфицированной программы, при этом заражается не более одного файла.

        При попытке заражения у  файла проверяется значение секунд  (или
месяца в зависимости от версии вируса) последней модификации файла, если
оно равно 1Fh (62 секунды, соответственно 0Dh - 13-й месяц), то файл  не
заражается.  При  заражении  файла  некоторые  версии  вируса  проверяют
системное  время,  если  значения  последних трех бит шестнадцатеричного
разложения секунд  равны 0,  то вирус  "убивает" файл,  записывая в  его
начало  5  байтов  либо  перехода  на перезагрузку (JMP F000:FFF0), либо
команду JMP C800:0005, JMP C800:0000 или JMP C800:0006 в зависимости  от
версии вируса. Восстановить в первоначальном виде такой файл невозможно.
Если cреди значений последних трех бит разложения секунд есть хоть  одна
единица, то вирус дописывает себя к файлу и меняет первые 3 байта файла.
Затем вирус устанавливает значение секунд последней модификации файла  в
1Fh (соответственно, месяц - в 0Dh).

        Содержат строку "*.COM".   Одна из версий вируса  содержит текст
"Microsoftyright Microsoft 1988".Файлы, пораженные версиями "Vienna-776"
и "Vienna-757", периодически сообщают:

"Vienna-776":          "Я, кажется, подхватила какую-то заразу...
                        Срочно звоните Дмитрию Николаевичу Лозинскому
                        по телефону 292-40-76 (Москва) и приобретите
                               ПРОГРАММУ AIDSTEST !!!";
"Vienna-757":          "Безвредный вирус:
                        Долой Кузьмичей !!!".

        Вирус "Vienna-757"  изменяет первые  4 байта  файла, не поражает
"COMMAND.COM".

        Вирус  "Vienna-644"  поражает  файлы  только если значение минут
системного времени меньше  20.  Изменяет  5 байт начала  файла (PUSH CS;
POP DS; CALL Loc_Virus).  Устанавливает некоторые биты времени последней
модификации файла ( OR 1234h).

        Вирус "Big Piter" состоит из двух блоков. Первый блок ("голова")
практически  полностью  повторяет  вирус  "Vienna-648";  он осуществляет
заражение файлов и вызов второго блока.  Второй блок (основной)  получен
при  помощи  компилятора  Microsoft  C  (об  этом  говорят тексты в теле
вируса).  Основной блок выводит на экран изображение компьютера и  текст
"regional engeneering  centre LENINFORMATIKA  ...", после  чего может (в
зависимости  от  некоторых  условий)  оставить  резидентную   программу,
блокирующую  запись  на  винчестер.  Очень  опасен  -  может  уничтожить
COM-файлы  длиной  более  40K.   Помимо  указанного  текста содержит все
строки,  которые  вставляет  в  тела  программ  компилятор  Microsoft C.
Изменяет прерывание 60h - использует для вызова основного блока.

                Семейство вирусов "VACSINA" и "Yankee"
                ══════════════════════════════════════
        Семейство вирусов  "VACSINA" (не  "VACCINA"!) и  "Yankee Doodle"
насчитывает более 40 файловых  резидентных неопасных вирусов. Каждый  из
них содержит в своем теле метку, состоящую из трех байт:  F4h, 7Ah, NNh.
Третий  байт  NNh  рассматривается  как  номер вируса в семействе (номер
версии  вируса)  и  в  дальнейшем  будет  фигурировать  в именах вирусов
("VACSINA-NN" и "Yankee Doodle -  NN").  При активизации вирусы  данного
семейства записывают в память по адресам 0000:00C5, 0000:00C6, 0000:00C7
байты 7Fh, 39h, NNh.  Характерной особенностью вирусов данного семейства
является  то,  что  они  восстанавливают  файлы,  зараженные предыдущими
версиями вирусов семейства, и затем инфицируют их.

	Вирусы "VACSINA-NN" содержат в своем теле слово "VACSINA".

        Заражаются  COM  и  EXE-файлы  при  загрузке  их  в  память  для
выполнения (вирусы версий  до 26h при  вызове int 21h,  ax=4B00h, версий
26h и выше - int 21h, ah=4Bh, т.е. могут заражаться и оверлейные файлы).

        COM-файлы заражаются стандартным  образом. Вирусы версий  до 9-й
включительно проверяют у заражаемого  COM-файла вирус первый байт.  Если
этот байт  не равен  E9h (JMP),  то файл  не заражается.  Вирусы старших
версий заражают  COM-файлы вне  зависимости от  их первого  байта. Кроме
этого вирусы "VACSINA" увеличивают длину заражаемого файла до параграфа.
Начиная с версии 2Ah к файлу после заражения дописываются дополнительные
4 байта.

        Вирусы младших версий (до 23h) инфицирует EXE-файлы  специальным
образом:  файлы  переводятся  в  формат  COM-файлов.  Для  этого к файлу
дописывается небольшой фрагмент вируса (132 байта), настраивающий адреса
по  таблице  адресов  при  загрузке  файла  в  память  для выполнения, и
изменяются первые три байта файла (JMP на фрагмент).  Дописанные к файлу
132 байта  не распространяют  вируса. Их  действие заключается  только в
настройке адресов программы при ее запуске.  Обработанный таким  образом
файл  будет  выполняться  операционной  системой  и  заражаться  многими
вирусами как  COM-файл.   При выполнении  EXE-программы, содержащейся  в
подобном  файле,  управление  передается  на фрагмент настройки адресов,
который анализирует таблицу адресов в заголовке файла и  соответствующим
образом корректирует загруженную программу. Затем управление  передается
на стартовый адрес, указанный в заголовке файла.

        Вирусы  перехватывают   вектор  прерывания   21h,  а   некоторые
представители семейства "Yankee" - вектора 1, 3, 9, 1Ch.

        Вирусы вызывают  звуковые эффекты:  при заражении  файла вирусом
"VACSINA"  раздается   звуковой  сигнал   (BELL),  вирусы   "Yankee"   в
зввисимости  от  некоторых  условий  (при  одновременном  нажатии клавиш
Alt-Ctrl-Del либо в 17.00) исполняют мелодию "Yankee Doodle Dandy".  При
некоторых условиях вирус "VACSINA-06"  расшифровывает и выдает на  экран
строку "Az sum vasta lelja."

        Вирусы семейства содержат  несколько "изюминок". Так,  начиная с
версии  18h,  вирусы  определяют  первоначальное значение вектора 21h-го
прерывания (адрес обработчика прерывания в DOS) и при внедрении в  файлы
вызывают  прерывание  по  этому  значению.  Таким образом вирусы обходят
резидентные антивирусные  мониторы. При  определении адреса  обработчика
прерывания используется следующий алгоритм:

	а) установка   прерывания  01h   (точка   входа   при   отладке;
	   это прерывание вызывается  в режиме отладки  после выполнения
	   процессором  каждой  команды)  на  подпрограмму   определения
	   истинного значения вектора прерывания;

	б) включение режима отладки;

	в) вызов  "безопасной"  с  точки зрения  резидентных антивирусов
	   функции прерывания 21h.

	При   выполнении   "безопасной"   функции   21h-го    прерывания
последовательно  выполняются  команды  всех  программ,  которые изменяли
вектор прерывания 21h,  затем выполняются команды  операционной системы,
обрабатывающие  данное  прерывание.  При  этом  после каждой выполненной
команды   управление   получает   подпрограмма   вируса,    определяющая
первоначальное  значение  вектора  прерывания.  Она  анализирует   адрес
последней выполненной команды  и, если этот  адрес указывает на  область
памяти, принадлежащую операционной  системе, выключает режим  отладки, а
адрес данной команды  рассматривает как первоначальное  значение вектора
прерывания 21h.

			    │ ...            │
			    ├────────────────┤
			    │Операционная    │
        ┌──────────────────>│cистема         │
        │                   ├────────────────┤
        │                   │COMMAND.COM     │
        │           int 21h ├────────────────┤
        └───────────────────│Пользовательская│───┬─── Программы,
        ┌──────────────────>│программа       │   │    изменявшие
        │                   ├────────────────┤   │    вектор прерывания
        │                   │ ...            │   │    21h.
        │           int 21h ├────────────────┤   │
        └───────────────────│Пользовательская│───┘
        ┌──────────────────>│программа       │
        │                   ├────────────────┤
        │                   │ ...            │
        │                   ├────────────────┤
        │                   │Вирус           │
        │           int 21h │   ─────────────┤
        └───────────────────│команда вызова  │
                            │прерывания 21h  │
           ^  │             │   ─────────────┤
           │  └────────────>│подпрограмма    │
           │                │определения     │
           └────────────────│вектора         │
                            ├────────────────┤
                            │ ...            │

        Начиная с версии 21h вирусы перехватывают действия,  совершаемые
отладчиком  и,  если  под  отладчиком  находится  тело вируса, блокируют
процесс отладки. При  этом при попытке  просмотреть зараженный файл  под
отладчиком файл "самоизлечивается".

        Начиная с  версии 21h  вирусы семейства  кодируют себя  линейным
блоковым кодом  и хранят  в своем  теле проверочные  байты. Периодически
вирусы  проверяют  себя   на  наличие  исправлений   и  по   возможности
восстанавливают их.

        Начиная  с  версии  2Сh  вирусы  дезактивируют резидентную часть
вируса  "Ping-Pong",  а  начиная  с  2Eh  -  принимают  некоторые   меры
противодействия вирусам семейства "Cascade".

                   Модификации "VACSINA" и "Yankee"
                   ────────────────────────────────
        Семейство  вирусов  "VACSINA"  и  "Yankee"  в  достаточной  мере
"популярно": помимо нескольких десятков "оригинальных" вирусов, начинают
появляться их мутации, иногда довольно точно скопированные с  оригинала.
Так в г. Иркутске  обнаружен вирус ("Yankee'-1905"), который  претендует
на то, чтобы  называться вирусом "Yankee-53h".  Однако несмотря на  свой
номер (53h)  использует всего  одну "изюминку"  - трассировку прерывания
21h.

        Вирус "Yankee'-1049"  - файловый  резидентный безобидный  вирус.
Поражает  COM-  и  EXE-файлы  при  их  запуске  на  выполнение (int 21h,
ax=4B00h).  Изменяет первые 32  байта файла и дописывается в  его конец.
Во многом совпадает с вирусами "Yankee Doodle". Использует вектор 21h.

                     Семейство вирусов "Yanshort"
                     ════════════════════════════
        Вирусы семейства стандартным образом заражает EXE-файлы во  всех
оглавлениях текущего диска. Не опасны. Зараженные файлы содержат  строку
"motherfucker",  по  которой  вирус  различает зараженные и незараженные
файлы. Вирус "Yanshort-1961"  проявляется проигрыванием мелодии  "Yankee
Doodle Dandy" при запуске  зараженной программы. При некоторых  условиях
пограммы, пораженные вирусом "Yanshort-1624", зависают при запуске.

                        Семейство вирусов "512"
                        ═══════════════════════
        Семейство насчитывает  6 практически  совпадающих очень  опасных
вирусов.  Поражают  .COM-файлы,  записываясь  в  их  начало.   Заражение
происходит  при  запуске  или  закрытии  файла  (int  21h,  ax=4B00h или
ah=3Eh).   Начало  файла  сохраняется  в  первом  неиспользуемом секторе
последнего кластера файла.

    │ <─────────── Файл ──────────────────────────> │
    ┌───────────┬───────────┬─  ──┬───────────┬───────────┐
    │ кластер   │ кластер   │ ... │ кластер   │ кластер   │
    └──┴──┴──┴──┴──┴──┴──┴──┴─  ──┴──┴──┴──┴──┴──┴──┴──┴──┘
     ^                                               ^  ^
     └─ Начало вируса.  Сохраненное начало файла  ───┘  │
                        Неиспользуемый сектор     ──────┘

	Длина заражаемого файла  не изменяется. У  файла устанавливается
время  последней  модификации  -  62  секунды.  При заражении в качестве
рабочей    области    используется    таблица    векторов     прерываний
(0000:0200 - 0000:03FF).

	При активизации вирус располагает свою резидентную копию в одном
из  системных   буферов.  При   заражении  файлов   активно   использует
недокументированную область DOS -  System File Table. При  чтении начала
зараженного  файла  подставляет  его  истинное  начало. Этими действиями
вирус очень хорошо маскирует свое присутствие в системе.

	Очень  опасен:  может  поражать  файлы, которые имеют расширение
имени  .CO?  (?  -  любой  знак).  Может  произойти  утеря файла при его
копировании (последний кластер файла копируется не целиком).  Произойдет
потеря файла на диске, имеющем один сектор на кластере.

	Изменяет прерывание 21h, содержит строку "666".


               Вирусы, не входящие ни в какое семейство
               ════════════════════════════════════════

                            Вирус "Alabama"
                            ───────────────
        Файловый резидентный опасный вирус. Поражает .EXE-файлы текущего
оглавления диска, с которого  запускается на выполнение какой-либо  файл
или на котором открывается файл (int 21h, ah=4Bh, 3Eh). Поражаемый  файл
ищется  при  помощи  функций  FindFirst  и  FindNext  и  не  обязательно
совпадает с открываемым или запускаемым файлом. При заражении использует
FCB-функции  работы  с  файлами,  дописывается  в  конец файла, возможно
некорректное  заражение.   У  зараженного  файла  устанавливается  время
последней модификации - 62 секунды.

        "Выживает" при перезагрузке - для этого устанавливает прерывание
9h (клавиатура), перехватывает  нажатие клавиш Alt-Ctrl-Del,  после чего
гасит  экран  и  вызывает  процедуру  загрузки  (int 19h). При этом коды
вируса не стираются.

        В  зависимости  от  текущего  времени  может  выдать  на   экран
сообщение типа:

        ╔═════════════════════════════════════════════════════╗
        ║ SOFTWARE COPIES ARE PROHIBITED BY INTERNATIONAL LAW ║
        ║                                                     ║
        ║          Box 1055 Tuscambia ALABAMA                 ║
        ╚═════════════════════════════════════════════════════╝

        Перехватывает  прерывания  9  и  21h.  Cодержит текстовую строку
"????????EXE".  Не  содержит   деструктивных  функций,  но   некорректно
работает с файлами и памятью - может завешивать систему.

                           Вирус "ATTENTION"
                           ─────────────────
	Опасный файловый резидентный  вирус. Заражает .COM-файлы  при их
загрузке в  память (int  21h, ah=4Bh).   Копирует себя  в конец  файла и
изменяет его первые 16 байт :

        ┌───┬────┬────┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬───┬───────────
        │JMP Loc_Virus│A T T E N T I O N     !│1Ah│   файл
        └───┴────┴────┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴───┴───────────
	    3 байта            12 байт        1 байт

	При создании  своей резидентной  копии использует  самые старшие
адреса доступной  памяти (как и вирусы семейства "Eddie"). Перехватывает
прерывание 24h, но не восстанавливает его первоначальное значение -  это
может  привести  к  зависанию  системы.  Снимает атрибут  read-only и не
восстанавливает его.

	Перехватывает вектор прерывания 21h.

	Проявляется при заражении файлов на защищенном от записи диске -
у дисковода A:  включается мотор (вне  зависимости от диска,  к которому
идет обращение). Зараженные файлы, начиная с 4-го байта, содержат строку
"ATTENTION !".
                             Вирус "Bebe"
                             ────────────
        Опасный  файловый  нерезидентный   вирус.  Заражает   .COM-файлы
текущего оглавления. Увеличивает размер заражаемого файла до  параграфа,
копирует себя в  конец файла и  изменяет его первые  14 байт (  PUSH AX;
... ; JMP FAR Loc_Virus ).

        Нерезидентен,  но  создает  резидентную  программу.   Для  этого
копирует  часть  своего  тела  в  таблицу  векторов прерываний по адресу
0000:01CE  и  устанавливает  на  нее  прерывание  1Ch  (таймер).   Через
некоторое время на экране появляется сообщение:

			╔════════ VIRUS ! ══════╗
			║  Skagi "bebe" >       ║
			╚═══════════════════════╝

	После того, как с  клавиатуры вводится "bebe", вирус  добавляет:
"Fig Tebe !". По словарному запасу вируса можно вполне точно  определить
его происхождение.

	Содержит ошибку - не  восстанавливает DTA. Это может  привести к
зависанию  компьютера.  Еще  одна  очень  тонкая  ошибка  - не учитывает
наличие конвейера у процессоров Intel 80x86 и модифицирует следующую  за
текущей выполняемую команду, - в результате чего не работает на  старших
моделях IBM PC.

	Помимо перечисленного текста содержит строку "*.COM".

                           Вирус "Datacrime"
                           ─────────────────
        Файловый  нерезидентный   очень  опасный   вирус.  При   запуске
зараженного  файла  стандартно  инфицирует  не  более  одного  COM-файла
(COMMAND.COM не поражается) во  всех текущих оглавлениях всех  доступных
дисков.  В зависимости от текущего времени и своих внутренних  счетчиков
выдает на экран текст "DATACRIME  VIRUS RELEASED: 1 MARCH 1989"  и после
этого форматирует первые 9 треков винчестера.

                           Вирус "Joker-01"
                           ────────────────
        Файловый резидентный  неопасный вирус.  Синтез вирусов  "Falling
Letters" (создание резидентной копии), "VACSINA" (заражение EXE-файлов),
"Yankee Doodle" (обработка прерывания 21h) и программы-шутки  "FACE.COM"
(видео-эффекты). Имеет значительный размер - около 30 Кб.

        Поражает файлы при их запуске на выполнение (int 21h, ax=4B00h).
COM-файлы  поражаются  стандартным  способом,  EXE-файлы  переводятся  в
COM-формат по алгоритму вируса "VASCINA-04".

        При активизации  определяет в  DOS адрес  обработчика прерывания
21h.   Для   этого   используется   алгоритм   "Yankee   Doodle".  Затем
устанавливает  прерывание  1Ch,  которое  используется  для   реализации
процедуры "всплытия" обработчика 21h-го прерывания.

        При успешном  поражении файла  вирус устанавливает  прерывание 9
(клавиатура)  и  запускает  внутренний  счетчик.  Счетчик уменьшает свое
значение на 1  при каждом нажатии  на клавишу. При  достижении счетчиком
ноля на экране появляется изображение рожицы.

        Перехватывает прерывания 9, 1Ch и 21h. В конце зараженного файла
содержится строка "JOKER-01".

                           Вирус "Kemerovo"
                           ────────────────
	Опасный вирус,  длина -  256 байт.  Заражает .COM-файлы текущего
оглавления при запуске инфицированной программы, повторного заражения не
производит.  Копирует себя в конец  файла и изменяет его первые 4  байта
( XCHG AX,DX; JMP  Loc_Virus ).  Длина  файлов перед дописыванием к  ним
вируса  увеличивается   на  1   байт  (т.е.   длина  заражаемых   файлов
увеличивается на 256+1 байт).

	В  зависимости  от  текущего  времени может вызвать перезагрузку
компьютера.  Содержит  строку  ".COM".  При  попытке заражения открывает
файлы и может оставить их незакрытыми.

                           Вирус "Kuku-448"
                           ────────────────
        Файловый очень опасный нерезидентный вирус, поражает  .COM-файлы
при  запуске  инфицированного  файла,   записывается  в  их  начало.   В
зависимости от  времени (с  вероятностью 1/8)  "убивает" файлы. "Убитый"
файл при старте расшифровывает и  в большом количестве выводит на  экран
разноцветные  надписи  "Kuku!",  при  этом  компьютер  не  реагирует  на
нлавиатуру.

                            Вирус "Lehigh"
                            ──────────────
        Файловый резидентный очень опасный вирус. Достаточно  примитивен
несмотря на знаменитость. Записывается в середину файла COMMAND.COM  при
его запуске или просмотре оглавления, содержащего COMMAND.COM,  функцией
FindFirst  (4Eh).  Вирус  размещается  в  области стека COMMAND.COM и не
увеличивает его длину. Изменяет 2-й и 3-й байты файла (JMP Loc_Virus).

        В теле вируса хранится счетчик, увеличивающийся на 1 при  каждом
успешном поражении очередного  COMMAND.COM. Счетчик сохраняется  на диск
только  в  том  случае,  если  зараженный  COMMAND.COM  был  запущен   с
винчестера. Иначе состояние счетчика обнуляется при каждой  перезагрузке
DOS.  При  достижении  счетчиком  значения  4  вирус  стирает  первые 32
логических сектора диска, с которого был запущен.

                           Вирус "LoveChild"
                           ─────────────────
	Очень опасный  файловый резидентный  вирус. Заражает  .COM-файлы
при их загрузке в память, при открытии и создании (int 21h, ah=3Ch, 3Dh,
4Bh и 5Bh),  длин файлов не  проверяет.  Копирует  себя в конец  файла и
изменяет его первые 4 байта ( STI; JMP Loc_Virus ).

	При создании своей резидентной копии переписывает себя в область
памяти, содержащую таблицу векторов прерываний, по адресу 0000:01E0.

	Если на компьютере установлена DOS 3.30, то вирус  предпринимает
маскирующие действия - вирус "знает" адрес обработчика прерывания 21h  и
адрес, по которому хранится исходное значение прерывания 13h.  Используя
это,  вирус  модифицирует  память,  занятую операционной системой, таким
образом, что обрабатывает вызов прерывания 21h непосредственно перед DOS
(записывает вместо первых пяти  байт обработчика прерывания 21h  команду
перехода  на  вирус  -  JMP  FAR  Loc_Virus).  С  прерыванием  13h вирус
поступает проще - восстанавливает его первоначальное значение.

	Имеет деструктивные функции:  в зависимости от  счетчика времени
может уничтожать файлы или создавать вместо файла подкаталог с таким  же
именем. Вирус периодически модифицирует EXE-файлы таким образом, что  их
запуск вызовет стирание секторов винчестера (стирается часть информации,
расположенной на секторах, соответствующих 0-3 головкам записи/чтения).

        Перехватывает вектор прерывания 21h. Содержит текстовые  строки:
"v2 (c) Flu Systems (R)" и "LoveChild in reward for software sealing".

                           Вирус "Loz-1023"
                           ────────────────
        Резидентный опасный  вирус. Тело  вируса (кроме  первых 38 байт)
зашифровано.  Стандартно  поражает  COM-файлы  при выполнении и открытии
(int  21h,  ax=3D00h,  4B00h).  Изменяет  первые  4  байта  файла   (JMP
Loc_Virus; DB  '+'). При  создании резидентной  копии уменьшает значение
слова  [0000:0413].  Корректирует  системную  информацию в Boot-секторах
дискет (обнуляет слово, соответствующее  числу головок дисковода).   При
запуске AIDSTEST.EXE  с непревзойденным  остроумием замечает  "Welcom to
demo version (C) Zherkov.  Лозинский-ДУБ, AIDSTEST-горбуха".  Неплохо бы
добавить ", а создатель сего вируса - гений-самоучка".

                           Вирус "MGTU-273"
                           ────────────────
        Файловый  нерезидентный  опасный  вирус.  Крайне примитивен. При
старте поражает все .COM-файлы текущего оглавления используя FCB из PSP.
Изменяет первые  4 байта  файла (JMP  Loc_Virus; DB  EBh -  опознаватель
зараженного файла) и дописывается в его конец. Опасен, т.к. не проверяет
длин файлов при их заражении.

        Никак не проявляется. Содержит текст "Эта пpогpамма написанна  в
МГТУ студентом гpуппы ИУ4".

                          Вирус "Minsk-1075"
                          ──────────────────
        Резидентный  опасный  вирус.  Прислан  из  г. Минска. Стандартно
поражает .COM и  .EXE-файлы при их  открытии (int 21h,  ax=3D00h,3D02h).
При  каждом  20-м  чтении  из  .DBF-файла  вместо  считанной  информации
подставляет пробелы.

        Содержит  опасную  ошибку  -  если  вирус  создает   резидентную
копию  при  запуске  из  EXE-файла,  то вместо естественного обращения к
функциям прерывания 21h, вызывает  прерывание 15h. Видимо, автор  вируса
не  до  конца  разобрался  в  отличии  десятичной  системы  счисления от
шестнадцатеричной ( 21 = 15h ).

                            Вирус "Mirror"
                            ──────────────
        Файловый резидентный очень  опасный вирус. Стандартным  способом
поражает каждый 3-й запускаемый (int 21h, ah=4Bh) .COM-файл. Меняет  при
этом  4  байта  заголовка  (JMP   Loc_Virus,  DB  17h  -   идентификатор
зараженности).

        Достаточно  странно  манипулирует  с  памятью при создании своей
резидентной  копии  -  не  исключено,  что у меня немного "подпорченный"
образец вируса.

        При 1000-м вызове прерывания 21h экран "переворачивается"  (верх
<-> низ, право  <-> лево), а  в нулевой сектор  (содержащий MBR) первого
винчестера записываются  коды вируса,  при этом  первые 5  байт кодов  -
команда перехода на перезагрузку (JMP FAR F000:FFF0).

        Перехватывает прерывание 21h. Текстовых строк не содержит.

                           Вирус "MLTI-830"
                           ────────────────
        Резидентный очень опасный вирус. Стандартно поражает  .COM-файлы
при их запуске. В пятницу  через некоторое время после запуска  начинает
уничтожать  файлы  вместо  из  запуска.  Содержит  много текста: "Hello!
MLTI!", "Eddie die somewhere in  time! This programm was written  in the
city of Prostokwashino (C) 1990 RED DIAVOLYATA".

                              "Peterburg"
                              ───────────
	Файловый  резидентный  вирус,  не  опасен. Инфицирует .COM-файлы
при  загрузке  их  в  память  для  выполнения (int 21h, ax=4B00h). Вирус
внедряется в файл по следующей схеме:

	а) переписывает первые 529 байт файла в его конец;
	б) записывает в начало файла свое тело.

	     ┌────────┐  а)   ┌────────┐  б)   ┌────────┐
             │Файл    │───┐   │Свободно│       │Вирус   │
             │--------│   │   ├────────┤       ├────────┤
             │        │   │   │Файл    │       │Файл    │
             │        │   │   │        │       │        │
             └────────┘   │   │--------│       │--------│
                          └──>│        │       │        │
		              └────────┘       └────────┘

	При   выполнении   инфицированной   программы   вирус   остается
резидентным в памяти, совершая следующие действия:

	а) изменяет  размер  выделенной  под основную программу  памяти,
	   резервируя дополнительную память для своих нужд;
	б) определяет имя основной  программы и функцией EXEC  (int 21h,
	   ax=4B00h)  запускает  ее   на  выполнение  (т.е.   происходит
	   повторный запуск основной программы);
	в) по  окончании  работы  программы  вирус остается  резидентным
	   (int 21h, ah=31h).

		     а)              б)              в)
	│ ...     │     │ ...     │     │ ...     │     │ ...     │
	├─────────┤     ├─────────┤     ├─────────┤     ├─────────┤
	│Вирус    │────>│Вирус    │     │Вирус    │     │Вирус    │
	├─────────┤     │- - - - -│     │- - - - -│     │- - - - -│
	│Программа│     │         │     │         │     │         │
        │         │     ├─────────┤     ├─────────┤     ├─────────┤
	├─────────┤     │ ...     │     │Вирус    │     │ ...     │
	│ ...     │                     ├─────────┤
			                │Программа│
			                │         │
			                ├─────────┤
			                │ ...     │

	Вирус никак не проявляется и не имеет деструктивной функции.

                            Вирус "RC-492"
                            ──────────────
	Очень опасный файловый резидентный вирус. Заражает COM-файлы при
запуске их на выполнение (int 21h, ax=4B00h), длин файлов не  проверяет.
Копирует  себя   в  конец   файла  и   изменяет  его   первые  6    байт
(JMP xx xx zz zz zz).

	При активизации ищет файл C:\COMMAND.COM и инфицирует его. Затем
остается резидентным  в памяти.  Для этого  он копирует  себя в  область
памяти,  содержащую  таблицу  векторов  прерываний, по адресу 0000:0200.
Если в памяти компьютера находятся программы, использующие  уничтоженные
таким образом вектора прерываний, то произойдет зависание системы.

	Имеет  деструктивную  функцию:  периодически  стирает  несколько
секторов со случайными номерами. Изменяет вектора прерываний 1Сh и  21h.
Содержит команду `PUSH 100h', поэтому не распространяется на компьютерах
с процессором 8086/88.

                           Вирус "Small-144"
                           ─────────────────
        Файловый резидентный безобидный вирус. Поражает COM-файлы при их
загрузке в память (int 21h, ah=4Bh), стандартно записываясь в их  конец.
Владельцы  EC-1840  могут  не  бояться  этого вируса, т.к. он использует
команды процессоров 80x86   POPA и PUSHA.  Отличается малой длиной  (144
байта), но все-таки отстает от лучших представителей семейства "Tiny". К
тому же вирусы "Tiny" работают и на процессоре 8086.

                            Вирус "Sylvia"
                            ──────────────
        Файловый нерезидентный безобидный  вирус. Записывается в  начало
.COM-файлов при  запуске зараженной  программы. Заражаемые  файлы ищет в
текущем оглавлении текущего диска и диска C:, при этом заражает не более
5 файлов. Не инфицирует файлы COMMAND.COM, IBMIO.COM и IBMDOS.COM.  Если
исправить  содержимое  текста,  содержащегося   в  вирусе  (см.   ниже),
расшифровывает и выводит на экран "FUCK YOU LAMER !! system  halted...",
после чего система действительно зависает.

        В начале вируса содержится текст:
      ┌────────────────────────────────────────────────────────┐
      │ This program is infected by a HARMLESS Text-Virus V2.1 │
      │ Send a FUNNY postcard to : Sylvia Verkade,             │
      │                            Duinzoom 36b,               │
      │                            3235 CD Rockanje            │
      │                            The Netherlands.            │
      │ You might get an ANTIVIRUS program.....                │
      └────────────────────────────────────────────────────────┘
        Пишите письма!

                           Вирус "VCOMM-637"
                           ─────────────────
        Файловый нерезидентный  опасный вирус.  При запуске  зараженного
файла  инфицирует  не  более  одного  EXE-файла  в  текущем  оглавлении:
выравнивнивает  файл  на  границу  блока  (512 байт), дописывается в его
конец и  добавляет один  элемент таблицы  настройки адресов  в заголовке
файла.   Записывает в  видео-память (сегментный  адрес BFFEh)  небольшую
резидентную программу, блокирующую запись на диск.

                             Вирус "V-516"
                             ─────────────
        Файловый резидентный  опасный вирус.  Поражает COM-файлы  при их
запуске на выполнение (int 21h,  ax=4B00h).  При этом заражаются  только
те файлы, первый байт которых равен E9h (т.е. файл начинается с  команды
JMP  Loc_Progr).  Вирус  заменяет  4  байта  по  адресу Loc_Progr на код
команды  JMP  Loc_Virus  и  байт-идентификатор  зараженности (см. рис.).
Таким образом, при заражении файла его заголовок не изменяется.

             Незараженный файл          Зараженный файл

             ┌─────────────┐            ┌─────────────┐
          ┌──│JMP Loc_Progr│         ┌──│JMP Loc_Progr│
          │  │             │         │  │             │
          │  │             │         │  │             │
          └─>│             │         └─>│JMP Loc_Virus│──┐ ─┐ 4 байта
             │             │            │DB  Infected │  │ ─┘
             │             │            │             │  │
             └─────────────┘            ├─────────────┤  │
                                        │ Вирус       │<─┘
                                        │             │
                                        └─────────────┘

        При  активизации  обрабатывает  DOS  2.x,  3.x,  4.0.  Уменьшает
количество дисковых  буферов на  1 и  записывает свою  копию в последний
буфер.

        Периодически при опросе версии  DOS (int 21h, f.30h)  возвращает
ноль  (т.е.  версия  DOS  0.0).  Помимо  этого  никак  не   проявляется.
Перехватывает прерывание 21h. Текстовых строк не содержит.

                             Вирус "V-707"
                             ─────────────
	Файловый резидентный неопасный вирус. Поражает .COM-файлы при их
запуске на выполнение (int 21h,  ah=4Bh).  Изменяет первые 5  байт файла
(MOV AX,Start_Virus; PUSH AX; RET near) и дописывается в его конец.

	Активизируется  только  в  DOS  3.30,  определяет (сканированием
памяти)  точки  входа  обработчиков  13-го  и  21h-го прерывания в DOS и
активно  их  использует  при  заражении  файлов.   Располагается в самых
старших  адресах  памяти,  корректируя  последний  MCB и уменьшая размер
доступной памяти (слово по адресу [0000:0413]).

	При заражении ведет подсчет уже зараженных файлов, и, как только
встречается  30-й  зараженный  файл,  устанавливает  прерывание  8h   на
подпрограмму генерации звукового сигнала.

	Перехватывает прерывания 8 и 21h. Текстовых строк не содержит.

                             Вирус "V-905"
                             ─────────────
        Файловый резидентный неопасный вирус. Поражает EXE-файлы при  их
запуске на выполнение (int  21h, ah=4B00h). Изменяет заголовок  файла и,
НЕ дополняя файл до параграфа, дописывается в его конец.

        При  активизации  уменьшает  последний  блок  (Z-блок)  памяти и
копируется в освободившееся место.

        Проявляется  в  зависимости  от  своих  внутренних  счетчиков  и
текущего года, месяца, дня и  только при наличии адаптера EGA.  При этом
наблюдается достаточно интересный видео-эффект: приблизительно через  20
минут  после  активизации  вируса  все  знаки,  отображенные  на экране,
"перевернутся вверх  ногами", т.е.  'P' ->  'Ь', 'U'  -> 'П' (начертание
приблизительно).  Знаки  остаются  на  своих  местах, изменяется лишь их
изображение. Через приблизительно 10 секунд восстановится первоначальное
состояние экрана, еще через 10 секунд - знаки перевернутся и т.д.

	Перехватывает прерывания 8 и 21h. Текстовых строк не содержит.

                           Вирус "Wish-1024"
                           ─────────────────
        Файловый резидентный  очень опасный  вирус. Стандартно  поражает
.COM-  и  .EXE-файлы  при  их  открытии  или запуске (int 21h, ax=3D00h,
4B00h).  При  каждом  пятом  заражении  модифицирует  BPB   Boot-сектора
текущего  диска:  уменьшает  на  единицу  (если  при этом текущий день -
"тринадцатая  пятница",  то  обнуляет)  содержимое  слова,  указывающего
число кластеров на диске,

                             Вирус "4096"
                             ────────────
        Файловый резидентный  вирус, длина  4096 (1000h)  байт. Поражает
файлы  при  их  запуске  или  закрытии  (int  21h, ax=4B00h или ah=3Eh).
Возможно поражение файлов данных. Перед заражением файлы дополняются  до
параграфа.   Дописывает свою  копию так,  чтобы размер  файла увеличился
ровно  на  4096  байт  (см.  описание вируса "Eddie-2000"). У пораженных
файлов увеличивает значение времени последней модификации на 100 лет.  У
COM-файлов изменяются первые 6 байт, у EXE - заголовок.

	При внедрении в  файлы пользуется истинными  значениями векторов
прерываний 13h  и 21h,  которые получает  по алгоритму  "Yankee Doodle".
Дополнительно к  этому, как  и "LoveChild",  модифицирует первые  5 байт
обработчика прерывания 21h.

	При создании резидентной копии располагается в старших  адресах,
что приводит к  заражению файла COMMAND.COM.  Устанавливает в своем  MCB
адрес владельца (owner),  совпадающий с адресом  владельца первой MCB  в
системе,  маскируясь   под  DOS.   В  дальнейшем   копия  вируса   может
перемещаться  по  памяти  в  направлении  младших  адресов, выделяя себе
новые участки памяти и освобождая старые.

	Перехватывает прерывание  21h, обрабатывает  20 (!)  его функций
(FindFirst, FindNext, Read,  Write, Lseek, Open,  Create, Close, Exec  и
т.д.) и хорошо маскируется. При обращении DOS к зараженному файлу  вирус
подставляет его  первоначальную длину  и время  модификации. При  чтении
файла  или  загрузке  его  в  память  модифицирует  считанную  с   диска
информацию таким образом, что файл  предстает в незараженном виде.   При
открытии файла  для записи  вирус лечит  его (т.к.  запись в  файл может
уничтожить часть вируса) и снова заражает при закрытии.

	Вирус  проявляется  с  22  сентября  по  31  декабря   ежегодно.
Проявления  вируса  мне  неизвестны,  поскольку  соответствующий участок
программы  оказался  уничтоженным.   Но  можно  предположить,  что вирус
уничтожает BOOT-сектор флоппи-диска и MBR-сектор винчестера, записывая в
них  собственный  код.  При  загрузке  с  такого диска на экран большими
буквами (при помощи псевдографики) выдается фраза "FRODO LIVES!".



			3.3. Загрузочные вирусы
			═══════════════════════

                       Семейство вирусов "Brain"
                       ═════════════════════════
        Мною  проанализированы  два  практически  совпадающих безобидных
вируса  семейства  -  "Brain-Ashar"  и  "Brain-Singapore".  Они заражают
BOOT-секторы  флоппи-дисков  при  обращении  к  ним  (int  13h,  ah=02).
Расположение на диске - стандартное. У зараженного диска устанавливается
новая метка тома:  "(C) Brain".

        Вирусы  труднообнаружимы:   при  попытке  просмотра BOOT-сектора
зараженного диска вирусы "подставляют" истинный BOOT-сектор.

                     Семейство вирусов "Ping-Pong"
                     ═════════════════════════════
                           Вирус "Ping-Pong"
                           ────────────────
        Не  опасен.   Заражает  BOOT-секторы  дисков,  имеющих следующие
характеристики:  размер сектора - 200h байт, число секторов в кластере -
2, при  обращении к  ним (int  13h). На  диске располагается стандартным
способом. "Ping-Pong" имеет байт,  содержащий номер версии вируса.  Если
вирус  обнаруживает  диск,  зараженный  своей  предыдущей версией, то он
"обновляет" ее.

        Вирус изменяет вектора прерываний 8 и 13h. Вызывает  видеоэффект
скачущего  шарика  (знак  07h  ASCII),  который  перемещается по экрану,
отражаясь от знаков и границ экрана.

                       Вирус "Hacked Ping-Pong"
                       ────────────────────────
        Очень опасен: стирает  первые 8 секторов  флоппи-диска. Является
модификацией  вируса  "Ping-Pong"  и  почти  полностью  его   повторяет.
Отличие: вместо запуска скачущего шарика происходит установка прерывания
13h на подпрограмму уничтожения секторов флоппи-диска.

              Вирус "Ping-Pong modified by Yankee Doodle"
              ───────────────────────────────────────────
	Является модификацией вируса  "Ping-Pong" и почти  полностью его
повторяет.   Изменен  вирусом  "Yankee  Doodle"  таким  образом, что при
каждой  загрузке  вируса  "Ping-Pong"  его  версия  (байт, содержащий ее
значение) увеличивается на 1.  При достижении версией нулевого  значения
(255+1), вирус дезактивируется.

                       Семейство вирусов "Stone"
                       ═════════════════════════
                             Вирус "Stone"
                             ─────────────
        Очень опасный вирус, заражает первые физические  сектора дисков:
BOOT-сектор флоппи-диска  и  Master Boot Record винчестера.

	Состоит  из  двух  частей:  первая  часть содержит тело вируса и
хранится   в   первом   физическом   секторе   диска,   вторая  содержит
первоначальный сектор  зараженного диска  и хранится  на флоппи-диске по
адресу 1/0/3 (головка/трек/сектор), на винчестере - по адресу 0/0/7.  На
флоппи-диске вторая часть вируса  занимает один из секторов,  отведенных
под корневое оглавление. Местоположение вируса среди секторов  корневого
оглавления зависит  от объема  диска. Для  диска, отформатированного  на
360K,  это,  как  правило,  последний  сектор  корневого  оглавления. На
винчестере вторая  часть вируса  занимает либо  неиспользуемый (скрытый)
сектор, либо один из секторов в FAT (File Allocation Table).

	Флоппи-диски инфицируются  при чтении  с них  (int 13h,  ah=02).
Винчестер   -   при   загрузке   операционной   системы   с  зараженного
флоппи-диска. Повторного заражения не происходит. При сохранении на диск
второй  части  вируса  никаких  проверок  не производится, поэтому вирус
может уничтожить часть информации  на диске (на флоппи-диске  может быть
уничтожен один из секторов корневого оглавления, на винчестере - один из
секторов FAT).

        Вирус изменяет вектор прерывания 13h. При загрузке с зараженного
флоппи-диска с вероятностью 1/8 на экране появлается сообщение: "Your PC
is now Stoned!". Помимо указанной содержит строку "LEGALISE MARIJUANA!".

                         Вирус "Stone Rostov"
                         ────────────────────
        Прислан из  г. Ростов-на-Дону.  Почти полностью  повторяет вирус
"Stone". Отличия:
	- не содержит текстовых строк и не выводит текст на экран;
	- при  загрузке с  зараженного флоппи-диска  с вероятностью 1/32
	  стирает на винчестере 8 секторов.


                             Вирус "Joshi"
                             ─────────────
	Очень  опасный  вирус,  длина  4086  (1400h)  байт (9 секторов).
Заражает BOOT-сектор флоппи-дисков и MBR винчестера.

	Диски инфицируются при обращении  к ним (int 13h,  ah=2,3,4,0Ah,
0Bh).  Повторного заражения не происходит.

	Состоит из  двух частей:   первая часть  содержит тело  вируса и
хранится в BOOT-секторе (или MBR) диска, вторая содержит  первоначальный
сектор зараженного  диска и  остальные 8  секторов вируса  и хранится на
флоппи-диске  на  40-м  или  80-м  треке  в зависимости от формата диска
(используется нестандартное форматирование);  на винчестере - начиная со
2-го сектора 0-го трека. При  сохранении своей копии на винчестер  может
уничтожить FAT.

	Вирус  перехватывает  прерывание  DOS  21h.  Для  этого он после
активизации  (загрузки  системы)  постоянно  опрашивает значение вектора
прерывания 21h и, как только оно изменяется, считывает его.

	Перехватывает прерывание  9h (клавиатура).  Обрабатывает нажатие
клавиш Alt-Ctrl-Del (перезагрузка)  и эмулирует ее:  гасит экран и  т.д.
При этом вирус  остается резидентным даже  при загрузке с  незараженного
защищенного от записи диска.

	Проявляется  5-го   января:  выводит   сообщение  "Type   `Happy
Birthday,  Joshi'!"  и  ждет  ввода  с клавиатуры фразы "Happy Birthday,
Joshi!". Изменяет вектора прерываний  8, 9, 13h, 21h.

                            Вирус "Den Zuk"
                            ───────────────
	Очень  опасный  вирус,  длина  4086  (1400h)  байт (9 секторов).
Заражает BOOT-сектор флоппи-дисков.

	Диски инфицируются  при обращении  к ним  (int 13h, ah=2,3,4,5).
Повторного заражения не происходит. При сохранении на диск второй  части
вируса никаких проверок не производится, поэтому вирус может  уничтожить
часть информации на диске (расположенной на 40-м треке).

	Вирус изменяет вектора прерываний 9 и 13h.

	При "теплой" перезагрузке крупными буквами выводит на экран свое
имя: "Den Zuk". Изменяет метку заражаемого диска на "Y■C■1■E■R■P".

	Вирус не  имеет деструктивной  функции, но  очень опасен:  может
уничтожить информацию на 40-м треке заражаемого диска.

                          Вирус "Disk Killer"
                          ───────────────────
	Очень опасный вирус, длина 3072 (C00h) байта (5 секторов).

	Состоит из двух  частей:  первая  часть вируса, оформленная  как
BOOT-сектор,  располагается  в  BOOT-секторе  диска  и  содержит  начало
вируса; вторая  часть располагается  в пяти  последовательных секторах и
содержит продолжение вируса (4 сектора) и оригинальный BOOT-сектор диска
(5-й сектор).

	Заражает  BOOT-секторы  дисков  при  обращении  к  ним (int 13h,
ah=02).   Расположение вируса  на флоппи-диске  - стандартное. Винчестер
заражается  только  в  том  случае,  если  число  скрытых секторов (т.е.
расположенных  между  BOOT-сектором  и  первым  сектором FAT) больше или
равно 5. Вторая часть вируса при этом записывается в последние 5 скрытых
секторов.

	Изменяет вектора прерываний  8, 9, 13h.

	Вирус может  уничтожить всю  информацию на  диске. При  чтении с
диска (int 13h, ah=02) вирус опрашивает свой внутренний счетчик времени,
и, если значение счетчика удовлетворяет некоторым условиям,  совершаются
следующие действия:

	а) на экране появляется сообщение:

	   "Disk Killer -- Version 1.00 by COMPUTER OGRE 04/01/1989
	    Warning !!
	    Don't turn off the power or remove the diskette
	    while Disk Killer is Processing!
	    PROCESSING";

	б) уничтожается  информация  на  всех  треках  диска:  все байты
	   информации  на  нечетных  треках  двоично суммируются (XOR) с
	   байтом 55h, все байты на четных секторах - с байтом AAh;

	в) на экране появляется сообщение:

	   "Now you can turn off the power
	    I wish you luck !";

	г) компьютер "зависает" (совершает холостой цикл).

                          Вирус "PrintScreen"
                          ───────────────────
	Очень опасный вирус, длина 512 (200h) байт (1 сектор).  Заражает
BOOT-сектор флоппи-дисков и винчестера.

	Диски инфицирует при  чтении с них  (int 13h, ah=2).  Повторного
заражения не производит. Старый Boot-сектор сохраняет на флоппи-диске по
адресу 0/1/3  (трек/сторона/сектор), на  винчестере -  по адресу 1/3/13.
При этом  может уничтожить  один из  секторов FAT  или сектор  данных (в
зависимости от объема диска). При заражении винчестера предполагает, что
Boot-сектор  расположен   по  адресу   0/1/1  (это   говорит  о   низкой
квалификации автора вируса.

	Судя по листингу вируса, при инфицировании диска с  вероятностью
1/256  (в  зависимости  от  значения  своего внутреннего счетчика) вирус
должен  вызывать  прерывание  5  (печать  экрана), но допущена ошибка, в
результате которой новое значение счетчика не сохраняется.

	Перехватывает вектор 13h.


                    3.4. Файлово-загрузочные вирусы
                    ═══════════════════════════════

                            Вирус "Liberty"
                            ───────────────
        Резидентный  опасный  вирус.  Поражает  COM-  и EXE-файлы при их
выполнении  (int  21h,  ax=4B00h).  Внедряется  в  конец  файла:  EXE  -
стандартно; COM  - в  начало файла  записывает 78h  байт, старое  начало
шифрует и сохраняет внутри своего  тела.  Если при инфицировании  файла,
расположенного  на  флоппи-диске,  не  хватило  свободного  места, вирус
инфицирует Boot-сектор флоппи-диска.   Старый Boot-сектор и тело  вируса
записывает  в  40-й  трек  дискеты  (использует  при  этом нестандартное
форматирование),  при  этом  может  уничтожить  информацию  на  дискетах
размера 1М.

        Память заражается либо при старте инфицированного COM-файла либо
при загрузке с инфицированного флоппи-диска.

        Через  некоторое  время  после  загрузки  с  флоппи-диска  вирус
расшифровывает  и  выдает  на  экран,  принтер  и последовательные порты
строку  "MAGIC  MAGIC  MAGIC  MAGIC   ......".   При  10-й  загрузке   с
флоппи-диска лечит его.

        Перехватывает  прерывания  8,  10h,  13h,  14h,  17h,  1Ch, 21h.
Содержит  строки  "Liberty",  "DRKAVGRCOM"  и  "- MYSTIC - COPYRIGHT (C)
1989-2000, by SsAsMsUsEsL".



  ═════════════════════════════════════════════════════════════════════

	Заранее благодарю всех, кто пришлет свои замечания,  предложения
или сообщит об обнаруженных в тексте неточностях.


                                        'Доктор'  Е. Касперский.

                                         Москва, 3 января 1991 г.

