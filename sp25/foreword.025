Cофтпанорама 1990, No. 5 (9)            
******************************************************************

             *****************************************
             *   К О Л О Н К А   Р Е Д А К Т О Р А   *
             *****************************************


                       Уважаемые коллеги !

     Исполнилось чуть больше года с момента проведения первого семинара,
посвященного  проблеме  компьютерных вирусов.  Сейчас уже можно сказать,
что киевские программисты оказались несколько более организованными, чем
наши  коллеги  в  других  городах и сумели оперативнее наладить анализ и
распространение информации  о  вирусах  и  соответствующих  антивирусных
программ.  Напомню основные доклады и сообщения, зачитанные на том семи-
наре.

                   З А С Е Д А Н И Е   4 (13 апреля)

            I.  Тематическое заседание: компьютерные вирусы
                лекция (п.1) и сообщения

   1. Безруков Н.Н. Грозит ли нам эпидемия ?
   2. Брусиловский В.Я. Структура и поведение вирусов V648 и V1701.
   3. Карандасов П.Л. Вирус, встраивающийся в библиотеку Тurbo Pascal.
   4. Изварин И.В. Обзор программных средств защиты.
   5. Колодный А.Я. О вирусе Brain
   6. Яблоновский.  Строки для контекстного поиска вирусов V648,
V1701, V1813

     Конечно сейчас информация,  содержавшаяся в этих сообщениях,  стала
широко известна благодаря многочисленным публикациям,  как в СОФТПАНОРА-
МЕ,  так и в "бумажных" изданиях,  но в то время наш семинар был практи-
чески единственным источником оперативной информации о компьютерных  ви-
русах  и сооотвествующих антивирусных программах.  Данный пример еще раз
демонстрирует преимущество инициативы снизу перед неповоротливой,  неэф-
фективной и дорогостоящей государственной машиной (сейчас наверняка где-
то кто-то получил госфинансирование по  антивирусной  тематике  и  будет
долго  ею кормиться независимо от объективных результатов своей деятель-
ности;  хотя в цивилизованных странах поступают проще и эффективней: вы-
деляют деньги, объявляют конкурс и "пусть победит сильнейший").

     Поскольку, как  говорится  в  известной пословице,  "полдела сделал
тот, кто начал", мне хочется выразить благодарность моим коллегам Вадиму
Брусиловскому и Игорю Изварину,  благодаря которым тот,  первый, семинар
стал возможен и которые внесли важный вклад на начальном этапе  борьбы с
компьютерными вирусами.  К сожалению,  за исключением автора этих строк,
участники стартовой киевской "антивирусной команды" в  дальнейшем отошли
от этой тематики.

     В настоящее  время  в  области компьютерной вирусологии наблюдается
настоящий бум,  одним из свидетельств которого является  тот  факт,  что
практически  в каждом компьютерном журнале чуть ли не каждый месяц появ-
ляются статьи посвященные данной тематике.  Количество известных  автору
разработчиков  антивирусных  программ  в настоящее время составляет нес-
колько десятков человек. Интерполируя, можно считать, что их общее коли-
чество в Союзе составляет несколько сот человек.  Поэтому становится не-
обходимой  какая-то  форма  организации,  возможно  в  виде   ассоциации
разработчиков  антивирусных  программ.  Важным  шагом в этом направлении
могла бы стать запланированная на октябрь этого года  Всесоюзная  конфе-
ренция  "Методы и средства защиты от компьютерных вирусов в операционной
системе MS DOS" (как я уже писал в ранних редакциях "Компьютерной  виру-
сологии",  поданные в феврале 1988 года предложения автора по проведению
указанной конференции, несмотря на поддержку со стороны МГА и Госкомите-
та  по  науке  и  технике  СССР,  натолкнулись  на отрицательное решения
зам.пред.  Совмина УССР В.Г.Урчукина, принятое не без участия зав. отде-
лом науки А.С.Корниенко).

     Поэтому последний  месяц  автор  предпринимал  значительные усилия,
чтобы вывести эту идею из тупика,  в который ее загнали решением Совмина
УССР.  Фактически идея провести бесплатную конференцию по очень актуаль-
ной тематике погибла из-за недостаточной компетенции чиновников из отде-
ла наука Совмина УССР. Действительно, разве может эта тема сравниться по
актуальности с конференцией по вопросам повышения  эфективности учебного
процесса или чем-нибудь подобным.

     В настоящее  время  автору  удалось  убедить руководство Авиацентра
НТТМ в целесообразности проведения рассматриваемой конференции  на  ком-
мерческой основе. Хотя официального разрешения еще не получено, есть ос-
нования полагать, что в таком "коммерческом" варианте конференция состо-
ится.  Более  подробная информация,  включая сроки ее проведения,  будет
опубликована в следующем номер бюллетеня.

     Теперь перейдем к теме нынешнего "юбилейного" антивирусного семина-
ра.  Появление  вируса RCE-2000 (Bontchev) представляет собой достаточно
тревожный "звонок",  значение которого, по мнению автора, состоит в том,
что  каждый  вирус постепенно преобразуется в группу (точнее семейство),
причем новые члены этого семейства добавляют к исходной  "концепции" все
более и более неприятные детали.  До сих пор наиболее многочисленным се-
мейством было семейство TP-вирусов.  Поэтому нетрудно  представить  себе
всю опасность "эволюции" вируса RCE-1800, если считать его "базовой" мо-
делью семейства (типа RCE-1206 (TP-05) для TP-вирусов).  Например, одним
из "достижений" RCE-2000,  по сравнению с его предшественником, является
маскировка заражения,  достигаемая за счет  принудительного  обеспечения
фиксироанного  приращения длины,  причем значение этого приращения (2000
байтов) таково,  что оставляет неизменными три последние цифры длины  и,
следовательно,  менее заметно при визуальном просмотре.  Например, зара-
женный COMMAND.COM MS DOS версии 3.3 имеет длины 27307, что при визуаль-
ном  просмотре  не так отличается от исходной цифры 25307,  как,  скажем
27112.  Дополнительные соображения  на  этот  счет  приведены  в  статье
В.Ю.Гайковича  "О некоторых направлениях раэвития вредоносного программ-
ного обеспечения",  опубликованной в данном номере СОФТПАНОРАМы, хотя не
со всеми утвержениями автора можно согласиться.

     Поэтому, как мне кажется,  наступает новый этап,  который как и два
предудущих выдвигает на первый  план  новый  тип  антивирусных  средств.
Действительно, на первом этапе, условно продолжавшемся, скажем, с октяб-
ря 1988 года (начало эпидемии вируса С-648) до,  скажем,  сентября  1989
года (появление многочисленных штаммов вируса семейства TP) основным ан-
тивирусным средством были фаги, поскольку количество вирусов исчислялось
единицами и "индивидуальный" подход к ним был вполне оправдан. На втором
этапе,  условно продолжавшемся с сентября 1989 года по апрель 1990  года
(появление  вируса  RCE-2000),  на  первый  план выдвинулись резидентные
фильтры,  хотя фаги продолжали играть важное значение.  Нынешний, третий
этап  выдвигает  на первый план средства входного контроля,  практически
единственными представителями среди которых в настоящее  время  являются
контекстные детекторы (SCAN, VL, и фаги в режиме детектирования).

     Действительно, в настоящее время основной задачей является предотв-
ращение попадания вируса в ЭВМ,  а не борьба с уже начавшим  распростра-
няться  вирусом.  Поэтому  основное  внимание  должно уделяться входному
контролю используемых программ.  Этот входной контроль  должен  осущест-
вляться как в момент получения программы (собственно, входной контроль),
так и перед каждым выполнением программы (текущий входной контроль).

     Поэтому необходимо как можно  быстрее  разработать  соответствующие
инструментальные  средства  и  распространить их среди пользователей.  В
частности, ощущается необходимость разработки более мощных детекторов. В
этом плане,  по мнению автора, наиболее предпочтительными представляются
позиции разработчиков,  работающих на языке ассемблера (И.Сысоев, Е.Сус-
ликов, В.Пономаренко и др.).

     Повышение мощности детекторов требует,  естественно, разработки но-
вых методов анализа (по сравнению с простым контекстным поиском),  вклю-
чая  эвристические.  Необходимо также повышение гибкости старых методов,
включая уже упоминавшееся комбинирование сигнатур. Можно, условно, выде-
лить следующие направления повышения мощности распознавания вирусов:

     Во-первых, процесс  поиска  должен задаваться на некотором языке (в
качестве основы можно использовать язык регулярных выражений,  однако он
представляется не совсем адекватным). Например, процесс поиска некоторо-
го гипотетического вируса можно представить себе как

   ИНТЕПРЕТИРОВАТЬ jmp
   ПРОВЕРИТЬ НАЛИЧИЕ СТРОКИ "xxxxx" В 1 КИЛОБАЙТЕ
   ЕСЛИ ДА, ТО
            ПРОВЕРИТЬ НАЛИЧИЕ СТРОКИ "zzzzzz" N БАЙТОВ ОТ КОНЦА
            ЗАРАЖЕННОЙ  ПРОГРАММЫ ... ... ... ... ... ... ...
   ... ... ... ... ...

     Как уже  указывалось,  в простейшем случае можно использовать поиск
нескольких сигнатур и механизм "голосования" при  выдаче соответствющего
диагностического сообщения. Я надеюсь, что соответствующая программа по-
явится уже к следующему семинару.

     Аналогичную идею можно применить и к фагам,  поставив задачу сконс-
труировать  фаг  с  "открытой" системой управления выкусыванием.  Однако
здесь есть ряд трудностей, связанных с тем, что не все операции по выку-
сыванию  можно  формализовать в виде ограниченного набора типовых опера-
ций, а превращать фаг в интерпретатор языка С вряд ли целесообразно.

     Во-вторых, контекстные детекторы должны быть доработаны с тем, что-
бы обеспечить детектирование неполного совпадения сигнатур.  Такое приб-
лизительное сопоставление может использовать технику распознавания обра-
зов  или,  скажем,  классический  алгоритм  учета  удалений,  вставок  и
транспозиций одной буквы,  используемый при  автоматическом  исправлении
орфографических  ошибок  можно использовать при поиске сигнатур вируса в
анализируемой программе (см.,  например,  статью Безруков Н.Н. Синтакси-
чески-ориентированные методы ввода и контроля информации, ПРОГРАММИРОВА-
НИЕ,  1985 ? (год и номер журнала я уточню в следующем выпуске СОФТПАНО-
РАМЫ)).

     В-третьих, можно  использовать  символическое исполнение начального
участка программы и определения "вирусоподобных" приемов  программирова-
ния.  В частности,  для большинства файловых вирусов,  дописывающих свое
тело в конец  заражаемой  программы,  характерно  наличие  на  начальном
участке кода команд,  обеспечивающих автоматическое базирование,  напри-
мер:

                 CALL M
           M:    POP  <регистр>

     В-четвертых, следует использовать различные эвристические приемы. В
качестве примера полезного эвристического  приема  стоит  упомянуть  уже
применяемый  рядом  разработчиков  фагов прием,  состоящий в определении
размера кода от точки входа до конца программы.  В случае,  если  размер
этого кода меньше чем,  скажем, 5K, то данная программа должна считаться
подозрительной и должно выдаваться соответствующее диагностичское  сооб-
щение. Другой эвристический прием состоит в анализе текстовых сообщений,
встречающихся в файле,  и поиск в них "подозрительных" слов  типа  kill,
destroy, virus, stupid и т.д.

    Необходимость повышения  оперативности  определения зараженных прог-
рамм диктует необходимость разработки средств подсчета  контрольных сумм
"на лету", т.е. непосредственно перед передачей управления загруженной в
память программы.  Саму контрольную сумму можно хранить,  например,  для
COM-файлов в  конце программы или в неиспользуемых байтах оглавления,  а
для EXE-программ - в заголовке файла. В наилучшей позиции для реализации
этой идеи находятся разработчики резидентных фильтров, в частности автор
CHECK21 Двоеглазов,  и я надеюсь,  что кто-нибудь из них выполнит данный
социальный заказ.

    Возвращаясь к  проблеме  эволюции  компьютерных  вирусов и взглядам,
высказанным в статье В.Ю.Гайковича, следует отметить, что автор выполнил
достаточно интересный анализ.  Статья иллюстрирована удачными рисунками.
Однако ряд высказанных соображений не совсем верен,  а общая картина ри-
суется  слишком пессимистичной.  Например,  автор ошибочно считает,  что
"при заражении другой программы существует такая часть  вируса,  которая
не изменяется от заражения к заражению". Приводимые автором "в предвари-
тельном плане" общие выводы об эволюции "вредоносного программного обес-
печения"  представляются  умозрительными  и  не подкрепляются известными
фактами.  Кроме того,  на мой взгляд,  автор недостаточно учел тот факт,
что  количество  базовых идей,  используемых известными вирусами сравни-
тельно невелико и его не так просто расширить, а ограниченный размер ви-
руса  в какой-то мере ограничивает возможность эволюции.  Действительно,
хотя можно выделить ряд возможностей "усиления" тех или иных  идей,  ис-
пользуемых  конкретным  вирусом (например,  упоминаемую в статье возмож-
ность получения управления методом прямой "врезки" команды передачи  уп-
равления  в  определенное  место MS DOS),  для каждой из них легко найти
простые и корректные технические опровержения.

     Как мне кажется,  важную роль в эволюции вирусов играют  социальные
условия,  совершенно  не упомянутые в статье.  Для того,  чтобы вирус из
идеи превратился в реальность,  должна существовать обстановка  попусти-
тельства и поощрения такого рода "изысканиям",  как это, например, прои-
зошло в печально известном болгарском институте ВМЕИ им.В.И.Ленина. Поэ-
тому  проблема  эволюции  во многом зависит от социальных условий,  а во
всем мире,  как известно, наблюдается ужесточение законодательных мер по
отношению к разработчикам компьютерных вирусов,  что отражает негативное
социальное отношение к подобного рода разработкам.  Действительно недав-
нее,  хотя и условное (два года условно + 100 тысяч долларов + 400 часов
общественных работ) осуждение Р.Морриса-младшего,  автора сетевого виру-
са, поразившего в ноябре 1988 года американскую сеть INTERNET, показыва-
ет, что общество уже осознает опасность и предпринимает меры по борьбе с
ней.  Поэтому, на мой взгляд, принципиально важно относиться к разработ-
чикам вируса с тем презрением,  которого они  заслуживают,  и  пресекать
случайные попытки вести разработки такого рода,  даже если они прикрыва-
ются фальшивым флагом "защиты программного обеспечения от несанкциониро-
ванного копирования". Я довольно подробно останавливался на этом вопросе
в "Компьютерной вирусологии".  Дополнительно,  пожалуй,  стоит отметить,
что в программировании, как и в любой деятельности, важна не только сама
цель, но и методы ее достижения. Поэтому использование "грязных" методов
компроментирует саму цель.

10.05.90                                 С уважением Н.Н.Безруков