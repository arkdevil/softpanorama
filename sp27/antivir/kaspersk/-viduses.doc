                                                 'Доктор'  Е. Касперский
                                                 ═══════════════════════

			  Компьютерные вирусы
			  ═══════════════════

	Вирусом  называется  программа,  которая  может  cоздавать  свои
копии (не обязательно полностью совпадающие с оригиналом) и внедрять  их
в файлы, системные  области компьютера, вычислительные  сети и т.д.  При
этом копия должна сохранять способность дальнейшего распространения.


		 1. Классификация компьютерных вирусов
		 ═════════════════════════════════════

	Вирусы  можно  разделить  на  классы  по следующим признакам: по
среде  обитания  вируса,  по  способу  заражения  среды  обитания  и  по
деструктивным возможностям.

	По cреде обитания вирусы можно разделить на сетевые, файловые  и
загрузочные.   Сетевые  вирусы  распространяются  по  компьютерной сети,
файловые внедряются  в выполняемые  файлы, загрузочные  - в  загрузочный
сектор диска (BOOT-сектор) или в сектор, содержащий системный  загрузчик
винчестера (Master Boot Record).

	Способы  заражения  делятся  на  резидентный  и   нерезидентный.
Резидентный вируc при  инфицировании компьютера оставляет  в оперативной
памяти  свою  резидентную  часть,  которая затем перехватывает обращение
операционной  системы  к   объектам  заражения  и   внедряется  в   них.
Резидентные вирусы  находятся в  памяти и  являются активными  вплоть до
выключения или перезагрузки компьютера. Нерезидентные вирусы не заражают
память компьютера и являются активными ограниченное время.

	По деструктивным возможностям вирусы можно разделить на:

	а) безвредные,  т.е.  никак  не   влияющие  на работу компьютера
	   (кроме  уменьшения  свободной  памяти  на  диске в результате
	   cвоего распространения);

       	б) неопасные,   влияние   которых   ограничивается   уменьшением
	   свободной памяти  на диске  и графическими,  звуковыми и  пр.
	   эффектами;

        в) опасные вирусы,  которые могут привести  к серьезным сбоям  в
	   работе компьютера;

       	г) очень  опасные,  которые  могут  привести к потере  программ,
	   уничтожить данные, стереть необходимую для работы  компьютера
	   информацию, записанную  в системных  областях памяти,  и даже
	   способствовать быстрому  износу движущихся  частей механизмов
	   (например, головок винчестера).


      2. Способы распространения и cтруктура компьютерных вирусов
      ═══════════════════════════════════════════════════════════

	Ниже  приводятся  примеры  структур  и  способов распространения
файловых и загрузочных вирусов.

			 2.1. Файловые вирусы
                         ════════════════════

	Выполняемые  двоичные   файлы  имеют   форматы  COM   или   EXE,
отличающиеся  заголовком  и  способом  запуска  программ  на выполнение.
Расширение  имени  файла  (".COM"  или  ".EXE")  не всегда соответствует
действительному формату файла,  что, правда, никак  не влияет на  работу
программы. Файлы  COM и  EXE заражаются  по-разному, следовательно вирус
должен отличать файлы одного формата  от файлов другого.  Вирусы  решают
эту задачу  двумя способами:   одни анализируют  расширение имени  файла
(".COM" или  ".EXE"), другие  - заголовок  файла.   Первый способ  далее
будет  называться  заражением  .COM-   (или  .EXE-)  файлов,  второй   -
заражением  COM-  (или  EXE-)   файлов.  В  большинстве  случаев   вирус
инфицирует  файл  корректно,  т.е.   по  информации, содержащейся в теле
вируса, можно полностью восстановить зараженный файл.

	Файловые   вирусы   при   распространении   внедряются   в  тело
заражаемого файла: в его начало, конец или середину.

	┌─────────┐   ┌─────────┐       ┌─────────┐   ┌─────────┐
	│Программа│──>│Программа│       │Программа│──>│Вирус    │
	│         │   │         │       │         │   ├─────────┤
	└─────────┘   ├─────────┤       └─────────┘   │Программа│
	              │Вирус    │       	      │         │
	              └─────────┘                     └─────────┘

	Существует несколько  возможностей внедрения  вируса в  середину
файла: он может быть скопирован  в таблицу настройки адресов, в  область
стека  и  т.д.  Кроме  того,  копирование  вируса в середину файла может
произойти в  результате ошибки  вируса. В  этом случае  файл может  быть
необратимо испорчен.

	Известны два  способа внедрения  вируса в  начало файла.  Первый
способ  заключается  в  том,  что  вирус переписывает начало заражаемого
файла  в  его  конец,  а  сам  копируется  в  освободившееся  место. При
заражении файла вторым способом вирус создает в оперативной памяти  свою
копию,  дописывает  к  ней   заражаемый  файл  и  сохраняет   полученную
конкатенацию на диск.

	Наиболее  распространенным  способом  внедрения  вируса  в  файл
является дописывание вируса в конец этого файла. При этом вирус изменяет
начало  файла   таким  образом,   что  первыми   исполняемыми  командами
программы, содержащейся  в файле,  являются команды  вируса. В COM-файле
это достигается  изменением его  первых трех  байтов на  коды инструкции
JMP  Loc_Virus  (передача  управления  на  тело  вируса);  EXE-файл либо
переводится в  формат COM-файла  и затем  заражается как  COM-файл, либо
модифицируется  заголовок  файла.   В  заголовке  EXE-файла   изменяются
значение  стартового  адреса  (CS:IP)  и  значение длины модуля (файла),
реже - регистры-указатели  на стек (SS:SP)  и др. Дополнительно  к этому
длина  EXE-файла  перед  заражением  должна  увеличиваться  до значения,
кратного параграфу (16 байт).

	     COM-файл		         EXE-файл
           ┌────┬────┐                 ┌─────────┐
        ┌──│JMP │    │            ┌────│Заголовок│
        │  ├────┘    │            │    ├─────────┤
        │  │Программа│            │    │Программа│
        │  │         │            │    │         │
        │  ├─────────┤            V    │         │
        │  │Вирус    │       Стартовый ├─────────┤
        └─>│         │       адрес     │Вирус    │
           │         │       ─────────>│         │
           └─────────┘                 │         │
                                       └─────────┘

	СТАНДАРТНЫМ  СПОСОБОМ  ЗАРАЖЕНИЯ  далее  будет  называться такой
способ,  при  котором  вирус  дописывается  в  конец  файла и изменяет у
COM-файла первые 3 байта (JMP  Loc_Virus), у EXE-файла - увеличивает  до
параграфа его длину и изменяет заголовок.

	Вирус,  после  передачи  ему  управления,  совершает   следующие
действия  (приведен  список  наиболее  общих  действий  вируса  при  его
выполнении; для  конкретного вируса  cписок может  быть дополнен, пункты
могут поменяться местами и значительно расшириться) :

	а) восстанавливает  программу (но  не файл)  в исходном  виде (у
	   COM-программы   восстанавливаются   первые    3   байта,    у
	   EXE-программы вычисляется истинный стартовый адрес);
	б) если вирус резидентный, то он проверяет оперативную память на
	   наличие  своей  копии  и  инфицирует  память компьютера, если
	   копия вируса не найдена;
	в) если  вирус нерезидентный,  то он  ищет незараженные  файлы в
	   текущем  и   (или)  корневом   оглавлении,  в    оглавлениях,
	   отмеченных   командой   PATH   и   т.д.,   а  затем  заражает
	   обнаруженные файлы;
	г) выполняет,   если    они   есть,   дополнительные   функции :
	   деструктивные действия,  графические или  звуковые эффекты  и
	   т.д.;
	д) возвращает управление основной программе.

	Действия а)-д) далее будут упоминаться как СТАНДАРТНЫЕ.

	При  восстановлении  программы   в  первоначальном  виде   вирус
использует  информацию  о  программе,  сохраненную  в  теле  вируса  при
инфицировании файла. Это может быть длина файла, первые три байта  файла
в случае COM-файла или несколько  байтов заголовка в случае EXE-файла  и
др.

	Известны два способа проверки резидентным вирусом наличия  своей
копии в памяти компьютера.   Первый заключается в том, что  вирус вводит
новую  функцию  некоторого  прерывания,  действие  которой заключается в
возврате значения "я здесь". При  старте вирус обращается к ней  и, если
возвращенное  значение  совпадает  со  значением  "я  здесь",  то память
компьютера  уже  заражена  и  повторное  заражение  не производится. При
проверке вторым способом вирус просто сканирует память компьютера.   Оба
способа  могут  в  той  или  иной  мере  сочетаться  друг  с другом. При
инфицировании оперативной памяти  вирус ищет свободное  место в памяти и
записывает  туда  свою  копию.   Затем  вирус  переопределяет  одно  или
несколько прерываний, необходимых ему для поиска заражаемых файлов,  для
выполнения деструктивных действий или звуковых и видеоэффектов.

	При инфицировании  файла вирус  может производить  ряд действий,
маскирующих и ускоряющих его распространение. К подобным действиям можно
отнести  обработку  атрибута  read-only,  снятие  его перед заражением и
восстановление после.  Многие файловые  вирусы считывают  дату последней
модификации файла и восстанавливают  ее после заражения. Для  маскировки
своего распространения  некоторые вирусы  перехватывают прерывание  DOS,
возникающее при  обращении к  защищенному от  записи диску  (int 24h), и
самостоятельно обрабатывают его.

	DOS  предусматривает  единственный  способ  создания резидентных
модулей  (помимо  драйверов,  указываемых  в  CONFIG.SYS)  -  при помощи
функции KEEP (int  21h, ah=31 или  int 27h). Многие  файловые вирусы для
маскировки своего распространения используют другой способ:  обрабатывая
системные области, управляющие распределением памяти (MCB), выделяют для
себя свободный участок памяти,  помечают его как занятый  и переписывают
туда свою копию.


			2.2. Загрузочные вирусы
                        ═══════════════════════

	Загрузочные   вирусы   заражают   загрузочный   (BOOT)    сектор
флоппи-диска и загрузочный сектор или Master Boot Record винчестера. При
инфицировании диска вирус переносит оригинальный BOOT-сектор (или Master
Boot  Record)  в  какой-либо  другой  сектор  диска  (например, в первый
свободный)  и  копирует  себя  в  загрузочный  сектор (или в Master Boot
Record).  Если длина вируса больше длины сектора, то в заражаемый сектор
помещается первая  часть вируса,  остальные части  размещаются в  других
секторах  (например,  в  первых  свободных).  Если  продолжение   вируса
размещается  в  первых  свободных  секторах  диска, то они, как правило,
помечаются как сбойные (точнее,  сектора образуют кластер или  кластеры,
которые и помечаются как сбойные, т.н. псевдосбойные кластеры).

						Незараженный диск
	Номер сектора:
            0     1     2      . . .
	┌─────┬─────┬─────┬───   ──┬─────┬─────┬─────┬─────┬─────┬───
	└─────┴─────┴─────┴───   ──┴─────┴─────┴─────┴─────┴─────┴───
	   │
	   └──  BOOT-сектор  или  Master Boot Record

						Зараженный диск
	    0     1     2      . . .
        ┌─────┬─────┬─────┬───   ──┬─────┬─────┬─────┬─────┬─────┬───
        └─────┴─────┴─────┴───   ──┴─────┴─────┴─────┴─────┴─────┴───
           │                                │     │     │ ... │
           └──  Начало вируса               │ ┌───┴─────┴─────┘
                                            │ └──  Продолжение вируса
                                            │
					    └── Сохраненный BOOT-сектор
						или Master Boot Record

	СТАНДАРТНЫМ  СПОСОБОМ  далее   будет  называться  такой   способ
РАЗМЕЩЕНИЯ загрузочного вируса на диске, при котором продолжение  вируса
размещается в последовательных секторах диска, образующих  псевдосбойные
кластеры.

	Известные  мне  загрузочные   вирусы  всегда  резидентны.    Они
внедряются в память компьютера при загрузке с инфицированного диска. При
этом системный загрузчик считывает  содержимое первого сектора диска,  с
которого производится загрузка, помещает считанную информацию в память и
передает  на  нее  (т.е.  на  вирус)  управление.  После  этого начинают
выполняться инструкции вируса, который :

	а) уменьшает обьем свободной памяти (слово по адресу 0040:0013);
	б) считывает с диска свое продолжение (если оно есть);
	в) переносит  себя в  другую область  памяти (например,  в самые
	   старшие адреса памяти);
	г) устанавливает необходимые вектора прерываний;
	д) совершает, если они есть, дополнительные действия;
	е) копирует в память оригинальный BOOT-сектор и передает на него
	   управление.

	Действия а)-е) далее будут упоминаться как СТАНДАРТНЫЕ.

	В  дальнейшем  загрузочный  вирус  ведет  себя  так  же,  как  и
резидентный файловый вирус: перехватывает обращения операционной системы
к дискам и инфицирует их,  в зависимости от некоторых условий  совершает
деструктивные действия или вызывает звуковые или видеоэффекты.


			  3. Описание вирусов
			  ═══════════════════

	Ниже приводятся результаты анализа алгоритма работы имеющихся  у
меня файловых  и загрузочных  вирусов. Наиболее  общие свойства  вирусов
представлены  в  каталоге,  дополнительная  информация  о  каждом вирусе
содержится в пунктах 3.2 и 3.3.

	Если свойство вируса  отмечено в таблице,  то в описании  вируса
оно может не упоминаться. Если файловый или загрузочный вирус  совершают
стандартные действия (см.  2.1 и 2.2),  то описание этих  действий может
быть опущено.


			  3.1 Каталог вирусов
                          ═══════════════════

	В предлагаемом каталоге для каждого вируса приведена  информация
по свойствам, описанным в пунктах  1 и 2. Символьное представление  этих
свойств во многом повторяет классификационный код Н.Н.Безрукова.

	В качестве основных  опознавателей вируса будет  указываться его
имя и длина. Если вирус имеет несколько имен, то указываться будет  одно
из них,  остальные известные  мне имена  приведены в  конце каталога.

	Длиной файлового вируса считается  длина тела вируса без  всяких
добавок, т.е. минимальное приращение длин файлов при их заражении.  Если
длина вируса в COM- и EXE-файлах различна, то используется длина  вируса
в COM-файле. Если  вирус не изменяет  размер инфицируемых файлов,  то за
значение его длины принимается длина изменяемого участка в файлах (кроме
их заголовков).

	Для загрузочных  вирусов в  качестве длины   принимается  полная
длина тела вируса,  т.е.  число занимаемых вирусом секторов,  умноженное
на число байт в секторе.


	В таблицах каталога встречаются следующие символы:

	+ 		- наличие свойства;
	-		- отсутствие свойства;
	*		- в пунктах 3.2 и 3.3 имеется дополнительная
			  информация;
	&		- одновременное выполнение свойств.

	V		- вызывает видеоэффекты (Video);
	M		- вызывает звуковые эффекты (Music);
	H		- имеет деструктивную функцию (Harm);
	Er		- содержит ошибку, которая может проявляться как
			  деструктивная функция (Error);
	Ch		- изменяет служебную информацию на диске - имя
			  диска и т.п. (Change).

	Для файловых вирусов (табл. 1):

	C		- COM-файлы;
	.C		- .COM-файлы;
	E		- EXE-файлы;
	.E		- .EXE-файлы;
	O		- прочие файлы (Other).

	Для загрузочных вирусов (таб. 2):

	B		- Boot-сектор винчестера;
	M		- MBR винчестера;
	F		- Boot-сектор флоппи-дисков.

	Например,  если  для  файлового  вируса в графе, соответствующей
поражаемым  объектам,  указано  "E  C&.C",  то  это  означает, что вирус
поражает  только  файлы,  имеющие  либо  формат  EXE,  либо формат COM и
одновременно расширение имени ".COM" (т.е. не поражаются файлы,  которые
имеют формат COM и расширение имени ".EXE").

	Колонки таблиц 1 и 2 содержат информацию по следующим свойствам:

	1  - имя вируса;
	2  - длина вируса;
	3  - резидентность вируса;
	4  - поражаемые объекты.

	Для файловых вирусов (табл. 1):

	5  - место внедрения в файл:
			s    - начало (start);
			e    - конец (end);
			i    - середина (insert);
	6  - способ заражения:
			FIND - используя функции FindFirst и FindNext;
			INT  - перехватывая обращения DOS к файлам;
	7  - способ внедрения в оперативную память (только для
	     резидентных вирусов):
			MCB  - оперируя с MCB;
			KEEP - используя прерывания DOS (int 21h f.31
			       или int 27h);
	8  - обработка атрибута read-only;
	9  - восстановление даты последней модификации файла;
	10 - обработка ошибки при обращении к защищенному от записи
	     носителю (int 24h);
	11 - деструктивные действия или проявления.

	Для загрузочных вирусов (табл. 2):

	5  - число, на которое уменьшается размер свободной памяти;
	6  - наличие и число псевдосбойных кластеров;
	7  - деструктивные действия или проявления.


	Таблица 1.  Свойства и характеристики файловых вирусов.

╔════════════════════╤═════╤═╤═══════════╤════╤════╤════╤══╤══╤══╤════╗
║         1          │  2  │3│    4      │ 5  │ 6  │ 7  │8 │9 │10│ 11 ║
╠════════════════════╪═════╪═╪═══════════╪════╪════╪════╪══╪══╪══╪════╣
║Falling Letters-1701│1701 │+│  C        │ e  │INT │MCB*│+ │+ │- │ V  ║
║Falling Letters-1704│1704 │+│  C        │ e  │INT │MCB*│+ │+ │- │ V  ║
╟────────────────────┼─────┼─┼───────────┼────┼────┼────┼──┼──┼──┼────╢
║VACSINA-04          │1212*│+│  CE *     │ e  │INT │MCB │+ │- │+ │ M  ║
║VACSINA-05          │1206*│+│  CE       │ e  │INT │MCB │+ │- │+ │ M  ║
║VACSINA-10          │1239*│+│  CE       │ e  │INT │MCB │+ │+ │+ │ M  ║
║Yankee Doodle - 18  │1760 │+│  CE *     │ e  │INT*│MCB │+ │+ │+ │ M  ║
║Yankee Doodle - 19  │1805 │+│  CE       │ e  │INT │MCB │+ │+ │+ │ M  ║
║Yankee Doodle - 21  │2680 │+│  CE       │ e  │INT │MCB │+ │+ │+ │ M  ║
║Yankee Doodle - 22  │2568 │+│  CE       │ e  │INT │MCB │+ │+ │+ │ M  ║
║Yankee Doodle - 26  │2756 │+│  CEO      │ e  │INT │MCB │+ │+ │+ │ M  ║
║Yankee Doodle - 27  │2772 │+│  CEO      │ e  │INT │MCB │+ │+ │+ │ M  ║
║Yankee Doodle - 29  │2932 │+│  CEO      │ e  │INT │MCB │+ │+ │+ │ M  ║
║Yankee Doodle - 2C  │2885*│+│  CEO *    │ e  │INT │MCB │+ │+ │+ │ M  ║
║Yankee Doodle - 2D  │2901*│+│  CEO *    │ e  │INT │MCB │+ │+ │+ │ M  ║
╟────────────────────┼─────┼─┼───────────┼────┼────┼────┼──┼──┼──┼────╢
║Reset - 648         │648  │-│  .C       │ e  │FIND│ -  │+ │+ │- │ H  ║
║Reset - 627         │627  │-│  .C       │ e  │FIND│ -  │+ │+ │- │ -  ║
║Reset - 623         │623  │-│  .C       │ e  │FIND│ -  │+ │+ │+ │ H  ║
║Microsoft 88        │534  │-│  .C       │ e  │FIND│ -  │+ │+ │- │ -  ║
║Kemerovo - Reset    │256* │-│  .C       │ e* │FIND│ -  │- │- │- │ *  ║
╟────────────────────┼─────┼─┼───────────┼────┼────┼────┼──┼──┼──┼────╢
║IV-345              │345  │-│  .C       │ e  │FIND│ -  │- │- │- │VEr ║
║IV-740              │740  │-│  .C       │ e  │FIND│ -  │- │- │- │VEr ║
║IV-847              │847  │-│  .C       │ e  │FIND│ -  │- │- │- │VEr ║
╟────────────────────┼─────┼─┼───────────┼────┼────┼────┼──┼──┼──┼────╢
║Eddie               │1800 │+│(CE)&(.C.E)│ e  │INT │MCB │+ │+ │+ │ H  ║
║V-2000              │2000 │+│(CE)&(.C.E)│ e  │INT │MCB │+ │+*│+ │ H  ║
╟────────────────────┼─────┼─┼───────────┼────┼────┼────┼──┼──┼──┼────╢
║Jerusalem           │1813*│+│  .C.E *   │CsEe│INT │KEEP│+ │+ │+ │HEr ║
║SunDay              │1631 │+│  .C.E     │CsEe│INT │KEEP│+ │+ │+ │HEr ║
╟────────────────────┼─────┼─┼───────────┼────┼────┼────┼──┼──┼──┼────╢
║V-600               │600  │+│  C        │ s* │INT │MCB │+ │+ │+ │ -  ║
║Voronezh            │1600 │+│  CE       │CsEe│INT │MCB │+ │+ │+ │ Er ║
╟────────────────────┼─────┼─┼───────────┼────┼────┼────┼──┼──┼──┼────╢
║YanShort            │1961 │-│  E&.E     │ e  │FIND│ -  │+ │+ │- │ M  ║
║Murphy              │1277 │+│(CE)&(.C.E)│ e  │INT │MCB │- │+ │+ │ M  ║
║Peterburg           │529  │+│  C&.C     │ s  │INT │KEEP│+ │+ │+ │ -  ║
║RC-492              │492  │+│  C&.C     │ e* │INT │ *  │- │- │- │ H  ║
║LoveChild           │488  │+│  .C       │ e* │INT │ *  │- │- │+ │ H  ║
║ATTENTION           │394  │+│  .C       │ e* │INT │MCB │+*│- │+*│ Er ║
║Bebe                │1004 │*│  .C       │ e* │FIND│ *  │- │- │- │ V  ║
║4096                │4096 │+│  CEO      │ e* │INT │MCB*│+ │+*│+ │ V? ║
╚════════════════════╧═════╧═╧═══════════╧════╧════╧════╧══╧══╧══╧════╝


      Таблица 2.  Свойства и характеристики загрузочных вирусов.

	 ╔════════════════════╤══════╤═══╤════╤═══╤════╤═════╗
	 ║         1          │  2   │ 3 │ 4  │ 5 │ 6  │  7  ║
	 ╠════════════════════╪══════╪═══╪════╪═══╪════╪═════╣
	 ║ Ping-Pong          │ 1024 │ + │ FB │ 2 │ 1  │  V  ║
	 ║ Hacked Ping-Pong   │ 1024 │ + │ FB │ 2 │ 1  │  H  ║
	 ║ Ping-Pong modifyed │ 1024 │ + │ FB │ 2 │ 1  │  V  ║
	 ╟────────────────────┼──────┼───┼────┼───┼────┼─────╢
	 ║ Brain/Ashar        │ 3072 │ + │ F  │ 7 │ 3  │ Ch  ║
	 ╟────────────────────┼──────┼───┼────┼───┼────┼─────╢
	 ║ Stone              │ 512  │ + │ FM │ 2 │ *  │ VEr ║
	 ║ Stone Rostov       │ 512  │ + │ FM │ 2 │ *  │ HEr ║
	 ╟────────────────────┼──────┼───┼────┼───┼────┼─────╢
	 ║ Disk Killer        │ 3072 │ + │ FB │ 8 │ 3* │ HV  ║
	 ║ Den Zuk            │ 4086 │ + │ F  │ 7 │ *  │VErCh║
	 ║ Joshi              │ 4086 │ + │ FM │ 6 │ *  │  V  ║
	 ║ PrintScreen        │ 512  │ + │ FM │ 2 │ *  │ Er* ║
	 ╚════════════════════╧══════╧═══╧════╧═══╧════╧═════╝


		     Таблица 3.  Названия вирусов.

╔═══════════════════╤═══════════════════════════════════════════════╗
║ Falling Letters   │Letterfall, Cascade, Crying screen, Rash,      ║
║                   │Dropper, Листопад, Falling tears, Herbist,     ║
║                   │Autumn, 1704/Cascade, Blackjack                ║
╟───────────────────┼───────────────────────────────────────────────╢
║ VACSINA-NN        │TP-nn, где nn - десятичное представление       ║
║ Yankee Doodle-NN  │                числа NN                       ║
╟───────────────────┼───────────────────────────────────────────────╢
║ VACSINA-NN        │Vacsina, Vacs, Vacsina sound, Sina             ║
╟───────────────────┼───────────────────────────────────────────────╢
║ Yankee Doodle-NN  │Doodle, Yankee Doodle                          ║
╟───────────────────┼───────────────────────────────────────────────╢
║ Yankee Doodle-2C  │Five O'clock Music, Ibris, Music Player, Neww, ║
║                   │Jumbo Brawler                                  ║
╟───────────────────┼───────────────────────────────────────────────╢
║ Reset-648         │Timebomb, Rebooter, Vienna, DOS-62, Timestamp, ║
║                   │Restart, VHP-648, Frier, System reboot, UNESCO ║
╟───────────────────┼───────────────────────────────────────────────╢
║ Microsoft 88      │Toothless, Microsoft 1988, Microsofttyright    ║
║                   │Micro88, Vienna                                ║
╟───────────────────┼───────────────────────────────────────────────╢
║ IV-847            │Canser, Amstrad, Ams                           ║
╟───────────────────┼───────────────────────────────────────────────╢
║ Eddie             │Dark Avenger, Sofia, Pyramides, Diana, Dav     ║
╟───────────────────┼───────────────────────────────────────────────╢
║ V-2000            │2000, Bch, Bontchev, Диана П.                  ║
╟───────────────────┼───────────────────────────────────────────────╢
║ Jerusalem         │Black Hole, Black Friday, Israeli, Hebrew,     ║
║                   │Time, Jeru                                     ║
╟───────────────────┼───────────────────────────────────────────────╢
║ SunDay            │9-Sunday                                       ║
╟───────────────────┼───────────────────────────────────────────────╢
║ YanShort          │Father-1961, Doodle2                           ║
╟───────────────────┼───────────────────────────────────────────────╢
║ 4096              │4K, 100 Years, Frodo, Hiding, Century          ║
╟───────────────────┼───────────────────────────────────────────────╢
║ Ping-Pong         │Ball, Italian Ping-Pong ver.B, Bouncing Ball   ║
║                   │Bouncing dot, Ping, Vera Gruz                  ║
╟───────────────────┼───────────────────────────────────────────────╢
║ Brain/Ashar       │Pakistani Brain/Ashar                          ║
╟───────────────────┼───────────────────────────────────────────────╢
║ Disk Killer       │Killer, Ogre                                   ║
╟───────────────────┼───────────────────────────────────────────────╢
║ Stone             │New Zealand, Mariguana                         ║
╟───────────────────┼───────────────────────────────────────────────╢
║ Den Zuk           │Search, Venezuelan                             ║
╚═══════════════════╧═══════════════════════════════════════════════╝



			 3.2. Файловые вирусы
                         ════════════════════

		     3.2.1. Вирус "Падающие буквы"
		     ─────────────────────────────

	Файловый резидентный  вирус, не  опасен, длина  1701 (6А5h)  или
1704 (6А8h) байт в зависимости от версии.

	Тело вируса, за исключением его начала (32 байта),  зашифровано.
В  качестве  ключа  используется  длина  зараженного  файла, поэтому два
"штамма" вируса в большинстве  случаев будут совпадать только  на первых
32-х байтах.

	При  выполнении  зараженной  программы  управление  командой JMP
передается на  начало вируса.  Первыми командами  вирус определяет длину
исходного файла и расшифровывает свое тело.

	При cоздании своей резидентной копии вирус :

	а) копирует свое тело в старшие адреса памяти;
	б) перемещает в старшие адреса тело основной программы;
	в) перемещает  тело  вируса  в  освободившееся  пространство над
	   телом основной программы;
	г) устанавливает  вектора  прерываний  1Ch,  21h  и  28h на свою
	   копию.

		     а)               б)               в)
        │ ...     │      │ ...     │      │ ...     │      │ ...     │
        ├─────────┤      ├─────────┤      ├─────────┤      ├─────────┤
        │Программа│      │Программа│──┐   │Свободная│  ┌──>│Вирус    │
        │         │      │         │  │   │память   │  │   │         │
        │         │      │         │  │   ├─────────┤  │   ├─────────┤
        ├─────────┤      ├─────────┤  └──>│Программа│  │   │Программа│
        │Вирус    │──┐   │Вирус    │      │         │  │   │         │
        │         │  │   │         │      │         │  │   │         │
        ├─────────┤  │   ├─────────┤      ├─────────┤  │   ├─────────┤
        │ ...     │  └──>│Вирус    │      │Вирус    │──┘   │ ...     │
			 │(копия)  │      │         │
			 ├─────────┤      ├─────────┤
			 │ ...     │      │ ...     │


	Вирус заражает  только COM-файлы  при загрузке  их в  память для
выполнения (int 21h,  ax=4B00h). Инфицирование производится  стандартным
способом. Наиболее  распространенные версии  этого вируса  не производят
повторного заражения файла.

	Изменяет вектора прерываний 1Ch, 21h и 28h.

	Вызывает характерный видеоэффект: осыпание букв на экране. Не
имеет деструктивной функции.


			3.2.2. Вирус "Yanshort"
			───────────────────────

	Файловый нерезидентный вирус, не опасен, длина 1961 (7A9h) байт.

	Стандартным  образом  заражает  EXE-файлы  любой  длины  во всех
оглавлениях текущего диска. Не заражает файлы повторно. Зараженный  файл
содержит строку "motherfucker", по которой вирус различает зараженные  и
незараженные файлы.

	Проявляется  проигрыванием  мелодии  "Yankee  Doodle  Dandy" при
запуске зараженной программы.


	 3.2.3. Семейство вирусов "VACSINA" и "Yankee Doodle"
	 ────────────────────────────────────────────────────

	Семейство вирусов  "VACSINA" (не  "VACCINA"!) и  "Yankee Doodle"
насчитывает  более  десятка  файловых  резидентных  безвредных  вирусов.
Каждый из них содержит в своем теле метку, состоящую из трех байт:  F4h,
7Ah, NNh.  Третий байт NNh рассматривается как номер вируса в  семействе
(номер  версии  вируса)  и  в  дальнейшем  будет  фигурировать  в именах
вирусов ("VACSINA-NN" и  "Yankee Doodle -  NN"). При активизации  вирусы
данного семейства записывают в  память по адресам 0000:00C5,  0000:00C6,
0000:00C7 байты 7Fh, 39h, NNh.  Характерной особенностью вирусов данного
семейства  является  то,  что  они  восстанавливают  файлы,   зараженные
предыдущими версиями вирусов семейства, и затем инфицируют их.

	Вирусы "VACSINA-NN" содержат в своем теле слово "VACSINA".

		      3.2.3.1. Вирус "VACSINA-04"
		      ───────────────────────────

	Длина 1212 (4B6h) байт в COM- и 132 (84h) байт в EXE-файлах.

	Заражаются COM-файлы длиной  от 4BCh до  F587h байт и  EXE-файлы
длиной до FDB3h байт при загрузке  их в память для выполнения (int  21h,
ax=4B00h).

	У заражаемого COM-файла вирус  проверяет первый байт. Если  этот
байт не  равен E9h  (JMP), то  файл не  заражается. При  заражении длина
файла увеличивается до значения,  кратного параграфу (16 байт),  к файлу
добавляются 1212 байт вируса и  изменяются первые 3 байта файла  (JMP на
тело вируса).

	Вирус инфицирует и EXE-файлы. Для этого они переводятся в формат
COM-файлов:  к файлу дописывается небольшой фрагмент вируса (132 байта),
настраивающий адреса по таблице адресов при загрузке файла в память  для
выполнения,  и  изменяются  первые  три  байта  файла (JMP на фрагмент).
Дописанные  к  файлу  132  байта  не  распространяют вируса. Их действие
заключается  только  в  настройке  адресов  программы  при  ее  запуске.
Обработанный таким образом файл будет выполняться операционной  системой
и   заражаться   многими   вирусами   как   COM-файл.   При   выполнении
EXE-программы, содержащейся в  подобном файле, управление  передается на
фрагмент  настройки  адресов,  который  анализирует  таблицу  адресов  в
заголовке  файла  и  соответствующим  образом  корректирует  загруженную
программу. Затем управление передается  на стартовый адрес, указанный  в
заголовке файла.

	При выполнении зараженной COM-программы управление командой  JMP
(Е9h) передается на начало вируса. Первыми командами вирус узнает  длину
исходного файла  и проверяет  наличие своей  копии в  памяти компьютера.
Если компьютер не заражен, то  вирус копирует всю программу в  свободное
место в памяти и, таким образом, остается резидентным.

	Вирус изменяет вектор прерывания  21h.

	Вирус вызывает следующий  эффект: при заражении  файла раздается
звуковой сигнал (BELL).

		      3.2.3.2. Вирус "VACSINA-05"
		      ───────────────────────────

	Длина 1206 (4B6h) байт в COM- и 132 (84h) байт в EXE-файлах.

	Заражаются COM-файлы длиной  от 4B6h до  F593h байт и  EXE-файлы
длиной до FDB3h байт при загрузке  их в память для выполнения (int  21h,
ax=4B00h).  Вирус  практически  полностью  совпадает со своей предыдущей
версией.

		      3.2.3.3. Вирус "VACSINA-10"
		      ───────────────────────────

	Длина 1339 (53Bh) байт в COM- и 132 (84h) байт в EXE-файлах.

	Заражаются COM-файлы длиной  от 53Bh до  F489h байт и  EXE-файлы
длиной до FDB3h байт при загрузке  их в память для выполнения (int  21h,
ax=4B00h). Отличия от вируса "VACSINA-05":

	1) Вирус  заражает COM-файлы  вне зависимости  от первого  байта
	   файла (вирус "VACSINA-05" заражает только файлы, первый  байт
	   которых равен E9h).

	2) Звуковой  сигнал  (BELL)  раздается  при  внедрении вируса  в
	   память компьютера.

		  3.2.3.4. Вирус "Yankee Doodle - 18"
                  ───────────────────────────────────

	Длина 1760 (6E0h) байт.

	Заражаются COM-  и EXE-файлы  длиной от  20h до  F077h байт  при
загрузке их в память для выполнения (int 21h, ax=4B00h).

	При заражении  файла вирус  увеличивает его  длину до  значения,
кратного  параграфу,  и   дописывает  свою  копию.  У  EXE- и COM-файлов
изменяются  первые  3  байта  (JMP  на  тело вируса). При этом EXE-файлы
преобразуются в  формат COM-файла  так же,  как и  при заражении вирусом
"VACSINA-04".

	Вирус   определяет   первоначальное   значение   вектора  21h-го
прерывания  и  при  внедрении  в  файлы  вызывает  прерывание  по  этому
значению.  Таким  образом  вирус  обходит  резидентные  антивирусы.  При
определении значения прерывания вирус использует следующий алгоритм:

	а) установка   прерывания  01h   (точка   входа   при   отладке;
	   это прерывание вызывается  в режиме отладки  после выполнения
	   процессором  каждой  команды)  на  подпрограмму   определения
	   истинного значения вектора прерывания;

	б) включение режима отладки;

	в) вызов  "безопасной"  с  точки зрения  резидентных антивирусов
	   функции прерывания 21h.

	При   выполнении   "безопасной"   функции   21h-го    прерывания
последовательно  выполняются  команды  всех  программ,  которые изменяли
вектор прерывания 21h,  затем выполняются команды  операционной системы,
обрабатывающие  данное  прерывание.  При  этом  после каждой выполненной
команды   управление   получает   подпрограмма   вируса,    определяющая
первоначальное  значение  вектора  прерывания.  Она  анализирует   адрес
последней выполненной команды  и, если этот  адрес указывает на  область
памяти, принадлежащую операционной  системе, выключает режим  отладки, а
адрес данной команды  рассматривает как первоначальное  значение вектора
прерывания 21h.

			    │ ...            │
			    ├────────────────┤
			    │Операционная    │
        ┌──────────────────>│cистема         │
        │                   ├────────────────┤
        │                   │COMMAND.COM     │
        │           int 21h ├────────────────┤
        └───────────────────│Пользовательская│───┬─── Программы,
        ┌──────────────────>│программа       │   │    изменявшие
        │                   ├────────────────┤   │    вектор прерывания
        │                   │ ...            │   │    21h.
        │           int 21h ├────────────────┤   │
        └───────────────────│Пользовательская│───┘
        ┌──────────────────>│программа       │
        │                   ├────────────────┤
        │                   │ ...            │
        │                   ├────────────────┤
        │                   │Вирус           │
        │           int 21h │   ─────────────┤
        └───────────────────│команда вызова  │
                            │прерывания 21h  │
           ^  │             │   ─────────────┤
           │  └────────────>│подпрограмма    │
           │                │определения     │
           └────────────────│вектора         │
                            ├────────────────┤
                            │ ...            │


	Вирус изменяет вектора прерываний  1, 9, 21h.

	Вирус  вызывает  следующий  эффект:  при  одновременном  нажатии
клавиш Alt-Ctrl-Del (теплая  перезагрузка) вирус играет  мелодию "Yankee
Doodle Dandy" и лишь затем происходит перезагрузка компьютера.

		  3.2.3.5. Вирус "Yankee Doodle - 19"
                  ───────────────────────────────────

	Длина 1805 (70Dh) байт.

	Заражаются COM-  и EXE-файлы  длиной от  20h до  F01Dh байт  при
загрузке  их  в  память  для  выполнения  (int  21h,  ax=4B00h).   Вирус
отличается  от  своей  предыдущей  версии  лишь  организацией  некоторых
подпрограмм.

		  3.2.3.6. Вирус "Yankee Doodle - 21"
                  ───────────────────────────────────

	Длина 2680 (A78h) байт.

	Заражаются COM-  и EXE-файлы  длиной от  20h до  E837h байт  при
загрузке их в память для выполнения (int 21h, ax=4B00h).

	Отличия от вируса "Yankee Doodle - 19" :

	1) Вирус перехватывает действия, совершаемые отладчиком и,  если
	   под  отладчиком  находится  тело  вируса,  блокирует  процесс
	   отладки.

	2) Вирус кодирует себя линейным блоковым кодом и хранит в  своем
	   теле  проверочные  байты.  Периодически  вирус проверяет себя
	   на наличие исправлений и по возможности восстанавливает их.

	3) Вирус исполняет мелодию "Yankee Doodle Dandy" в 17.00.

	4) Вирус изменяет вектора прерываний  1, 3, 1Ch, 21h.

		  3.2.3.7. Вирус "Yankee Doodle - 22"
                  ───────────────────────────────────

	Длина 2568 (A08h) байт.

	Заражаются COM-  и EXE-файлы  длиной от  20h до  E917h байт  при
загрузке  их  в  память  для  выполнения  (int  21h,  ax=4B00h).   Вирус
практически полностью повторяет свою предыдущую версию.

		  3.2.3.8. Вирус "Yankee Doodle - 26"
                  ───────────────────────────────────

	Длина 2756 (AС4h) байт.

	Заражаются COM- длиной от  20h до  F2F7h байт и EXE-файлы  любой
длины  при  загрузке  их  в   память  для  выполнения  или   организации
перекрытий (int 21h, ah=4Bh).

	Отличия от вируса "Yankee Doodle - 22" :

	1) EXE-файлы  не переводятся  в COM-формат,  у них  производится
	   стандартное изменение заголовка.   При этом заражаются  файлы
	   любой длины.

	2) Заражение файлов происходит при обращени к ним функцией 0x4Bh
	   прерывания 21h. При этом могут заражаться и оверлейные файлы.

		  3.2.3.9. Вирус "Yankee Doodle - 27"
                  ───────────────────────────────────

	Длина 2772 (AD4h) байт.

	Заражаются COM-файлы  длиной от  20h до  F2E7h байт  и EXE-файлы
любой  длины  при  загрузке  их  в  память  (int  21h,  ah=4Bh).   Вирус
практически полностью повторяет свою предыдущую версию.

		 3.2.3.10. Вирус "Yankee Doodle - 29"
                 ────────────────────────────────────

	Длина 2932 (B74h) байта.

	Заражаются COM-файлы  длиной от  20h до  F247h байт  и EXE-файлы
любой  длины  при  загрузке  их  в  память  (int  21h,  ah=4Bh).   Вирус
практически полностью повторяет свою предыдущую версию.

		 3.2.3.11. Вирус "Yankee Doodle - 2C"
                 ────────────────────────────────────

	Длина 2881 (B41h) байт у EXE- и 2885 (B45h) байт у COM-файлов.

	Заражаются COM- длиной  от 20h до  F277h байт и  EXE-файлы любой
длины при загрузке их в память (int 21h, ah=4Bh).

	Отличия от вируса "Yankee Doodle - 29" :

	1) Вирус в EXE- и COM-файлах имеет различную длину: к  COM-файлу
	   помимо тела вируса  дописываются 4 байта  F4h, 7Ah, NNh,  00h
	   (NNh - версия вируса, в данном случае - 2Ch).

	2) Вирус дезактивирует резидентную часть вируса "Ping-Pong".

	3) Вирус  исполняет  мелодию  "Yankee  Doodle  Dandy"  в 17.00 с
	   вероятностью  1/8  в  зависимости   от  числа  открытых   для
	   заражения файлов.

		 3.2.3.12. Вирус "Yankee Doodle - 2D"
                 ────────────────────────────────────

	Длина 2897 (B51h) байт у EXE- и 2901 (B55h) байт у COM-файлов.

	Заражаются COM-файлы  длиной от  20h до  F267h байт  и EXE-файлы
любой  длины  при  загрузке  их  в  память  (int  21h,  ah=4Bh).   Вирус
практически полностью повторяет свою предыдущую версию.


	       3.2.4. Семейство "Иерусалимских" вирусов
	       ────────────────────────────────────────

		    3.2.4.1. "Иерусалимский" вирус
		    ──────────────────────────────

	Этот резидентный файловый вирус очень распространен, упоминается
также  как  "Черная  Дыра",  "Тринадцатая  Пятница", "Вирус Замедления",
"Израильский" вирус.

	Длина 1808 (710h) байт у EXE- и 1813 (715h) байт у COM-файлов.

	Очень опасен 13-го числа любого месяца, если этот день  является
пятницой, и опасен во все остальные дни.

	Заражаются  .COM-  и  .EXE-файлы  при  загрузке  их в память для
выполнения  (int  21h,  ax=4B00h),   ограничений  на  длину  файлов   не
обнаружено. Вирус анализирует имя заражаемого файла и не заражает  файлы
с именем COMMAND.COM, чем несколько затрудняет свое обнаружение.

	При заражении .COM-файла вирус функцией ALLOC (int 21h,  ah=48h)
выделяет  память,  куда  копирует  себя,  а затем зараженный файл (таким
образом, при заражении не вирус дописывается к файлу, а файл к  вирусу).
Затем уже  зараженный файл  сохраняется на  диск и  к нему добавляется 5
байтов (в наиболее распространенной версии  вируса - "MsDos").  По  этим
байтам вирус отличает зараженные  файлы от незараженных и  не производит
повторного инфицирования.

	Инфицирование  .EXE-файлов  производит  стандартным  образом   и
изменяет значение контрольной суммы  на (1984)h).  Проверочные  5 байтов
не дописываются, т.е. .EXE-файлы могут инфицироваться повторно. Возможно
внедрение вируса  в середину  файлов (в  результате ошибки  вируса), что
может привести к их потере.

	При выполнении инфицированной программы вирус проверяет  наличие
своей копии  в памяти  компьютера.   Затем вирус  остается резидентным в
памяти, при этом он выполняет следующие действия:

	а) сохраняет   в  своем  теле  значения байтов памяти с адресами
	   003FCh-003FEh;
	б) по   этим  адресам  вирус  помещает  программу  копирования и
	   передает ей управление;
	в) при  копировании  тело  вируса  перемещается в самые  младшие
	   адреса, выделенные для основной  программы (при этом вирус  в
	   COM-программе  копируется  сам  в  себя,  а  в  EXE-программе
	   стирает часть кода основной программы), возврат из  программы
	   копирования происходит в копию вируса;
	г) восстанавливает  старое содержимое  байтов памяти  с адресами
	   003FCh-003FEh;
	д) уменьшает размер выделенной под основную программу памяти;
	е) определяет имя основной  программы и функцией EXEC  (int 21h,
	   ax=4B00h)  запускает  ее   на  выполнение  (т.е.   происходит
	   повторный запуск основной программы);
	ж) по  окончании  работы  программы  вирус остается  резидентным
           (int 21h, ah=31h).

            а) б) в)        г) д)           е)            ж)

   │ ...     │    │ ...     │   │ ...     │   │ ...     │   │ ...     │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │EXE-     │ ┌─>│Вирус    │   │Вирус    │   │Вирус    │   │Вирус    │
   │программа│ │  ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │         │ │  │         │   │ ...     │   │EXE-     │   │ ...     │
   ├─────────┤ │  ├─────────┤                 │программа│
   │Вирус    │─┘  │Вирус    │                 │         │
   ├─────────┤    ├─────────┤                 ├─────────┤
   │ ...     │    │ ...     │                 │Вирус    │
                                              ├─────────┤
                                              │ ...     │

   │ ...     │    │ ...     │   │ ...     │   │ ...     │   │ ...     │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │Вирус    │───>│Вирус    │   │Вирус    │   │Вирус    │   │Вирус    │
   ├─────────┤    ├─────────┤   ├─────────┤   ├─────────┤   ├─────────┤
   │COM-     │    │COM-     │   │ ...     │   │Вирус    │   │ ...     │
   │программа│    │программа│                 ├─────────┤
   ├─────────┤    ├─────────┤                 │COM-     │
   │ ...     │    │ ...     │                 │программа│
                                              ├─────────┤
                                              │ ...     │


	Вирус изменяет вектора прерываний  8, 21h.

	При активизации вируса в любой день, кроме "13-й пятницы", вирус
перехватывает  прерывание  8  (TIMER  TICKS).  Через  некоторое время на
экране  появляется  черный  прямоугольник  и,  начиная  с этого момента,
работа  компьютера  существенно  замедляется  (при  каждом прерывании 8h
компьютер совершает холостой цикл). При активизации вируса 13-го числа в
пятницу происходит следующее:  при попытке запустить любую программу  на
выполнение файл,  содержащий эту  программу, уничтожается,  и DOS выдает
сообщение о том, что файл не найден.  В результате будут уничтожены  все
файлы, к которым произойдет обращение функции EXEC (int 21h, ax=4B00h).

	Содержит текстовую строку "COMMAND.COM".


			3.2.4.2. Вирус "SunDay"
			───────────────────────

	Длина  1631  (65Fh)  байт.  Модификация "Иерусалимского" вируса.

	Очень опасен: уничтожает файлы  при запуске их на  выполнение. В
воскресенье выдает сообщение: "Today is SunDay! Why do you work so hard?
All work and no play make you a dull boy! Come on! Let's go out and have
some fun!".

	Помимо   указанной   содержит   еще   одну   текстовую   строку:
"COMMAND.COM".


		   3.2.5. Семейство вирусов "Reset"
		   ────────────────────────────────

		      3.2.5.1. Вирус "Reset-648"
		      ──────────────────────────

	Нерезидентный вирус. Очень опасен:  с вероятностью  примерно 1/8
необратимо портит файлы.  Длина 648 (288h) байт.

	Заражаются  только  .COM-файлы  длиной  от  0Ah  до FA00h байт в
текущем каталоге  и в  каталогах, отмеченных  системной переменной PATH.
Заражение  происходит  при  запуске  инфицированной  программы, при этом
заражается не более одного файла.

	При  попытке  заражения  у  файла  проверяется  значение  секунд
последней модификации файла, если оно равно 1fh (62 секунды), то файл не
заражается. При  заражении файла  вирус проверяет  системное время, если
значения последних трех  бит шестнадцатеричного разложения  секунд равны
0, то вирус "убивает" файл, записывая в его начало 5 байтов перехода  на
перезагрузку (JMP F000:FFF0).  Восстановить в первоначальном виде  такой
файл  невозможно.   Если  cреди  значений  последних трех бит разложения
секунд есть хоть одна единица, то вирус дописывает себя к файлу и меняет
первые  3  байта  файла.   Затем  вирус  устанавливает  значение  секунд
последней модификации файла в 1fh.

		      3.2.5.2. Вирус "Reset-627"
		      ──────────────────────────

	Безвредный нерезидентный вирус, длина 627 (273h) байт.

	Почти  полностью  совпадает  с  вирусом  "Reset-648". Отличается
несколькими  командами  и   тем,  что  не   "убивает"  файлы   (обойдены
соответствующие команды).

		      3.2.5.3. Вирус "Reset-623"
		      ──────────────────────────

	Очень  опасный  нерезидентный  вирус,  длина  623  (26F)   байт,
практически полностью совпадает с вирусом "Reset-648". При порче файла в
его начало записывается команда JMP C800:0000.

		     3.2.5.4. Вирус "Microsoft 88"
		     ─────────────────────────────

	Безвредный нерезидентный вирус, длина 534 (216h) байт.

	Заражаются  только  .COM-файлы  длиной  от  100h до FA00h байт в
текущем  и  корневом  каталогах.    Заражение  происходит  при   запуске
инфицированной программы, при этом заражается не более одного файла.

	При  попытке  заражения  у  файла  проверяется  значение  месяца
последней его модификации и, если оно равно 0Dh (13-й месяц), то файл не
заражается.   Заражение производится  стандартным способом.  Затем вирус
устанавливает значение месяца последней модификации файла в 0Dh.

	Содержит текстовую строку "Microsoftyright Microsoft 1988".


		    3.2.5.5. Вирус "Kemerovo-Reset"
		    ───────────────────────────────

	Опасный файловый резидентный вирус, длина 256 (100h) байт.

	Заражает  .COM-  файлы  текущего  оглавления  длиной  до   64767
(FCFFh) байт при запуске инфицированной программы, повторного  заражения
не производит. Копирует себя в конец файла и изменяет его первые 4 байта
( XCHG  AX,DX; JMP  Loc_Virus ).  Длина файлов  перед дописыванием к ним
вируса  увеличивается   на  1   байт  (т.е.   длина  заражаемых   файлов
увеличивается на 256+1 байт).

	В  зависимости  от  текущего  времени может вызвать перезагрузку
компьютера. Содержит строку ".COM".


		   3.2.6. Семейство вирусов "Eddie"
		   ────────────────────────────────

			3.2.6.1. Вирус "Eddie"
			──────────────────────

	Очень  опасный  резидентный  файловый  вирус.  Длина 1800 (708h)
байт. Быстро размножается:  инфицирует COM- и EXE-файлы при загрузке  их
в  память  для  выполнения,  при  создании,  переименовании,  открытии и
закрытии файла (int 21h, ax=4B00h или ah=3Ch, 5Bh, 56h, 3Dh, 2Eh).

	При создании своей копии  в оперативной памяти компьютера  вирус
пытается  занять  область  памяти  с  самыми старшими адресами, разрушая
временную  часть  командного  интерпретатора  COMMAND.COM.  По окончании
работы  программы  командный  интерпретатор  COMMAND.COM восстанавливает
свою временную часть, при этом происходит открытие файла COMMAND.COM  и,
соответственно,  его  заражение.   Таким  образом, наиболее подверженным
заражению файлом является COMMAND.COM.

	Вирус предпринимает ряд эффективных мер для того, чтобы остаться
незамеченным:

	1) При старте любой программы вирус помечает программный сегмент
	   как последний и становится  невидимым для этой программы,  по
	   окончании работы программы вирус помечает программный сегмент
	   как не последний.

        2) Аналогично  вирус  поступает  с  вектором прерывания 21h  при
	   старте  программы:  он  восстанавливает  его   первоначальное
	   значение.

        3) Вирус не позволяет программам изменять вектор прерывания  21h
	   и  защищается  таким  образом  от  резидентных   антивирусов,
	   установленных после того как активизировался вирус .

        4) Вирус пытается обойти программы, следящие за прерыванием 13h,
	   и  установить  вектор  этого  прерывания в его первоначальное
	   значение.

	Вирус  очень  опасен:  периодически  стирает сектор со случайным
номером  ("оплевывает"  диск),  при  этом  он  может  уничтожить   часть
информации на диске. Вирус анализирует 2 байта (8-й и 10-й) BOOT-сектора
диска, с которого была запущена зараженная программа.  Вирус увеличивает
на 1 значение 10-го  байта и сохраняет его  в BOOT-секторе.  Если  новое
значение 10-го  байта кратно  16, то  вирус стирает  на диске  сектор со
случайно выбранным номером, зависящим от значения 8-го байта.

	Вирус изменяет вектора прерываний 13h, 21h, 27h.

	Содержит  текстовые  строки  "Eddie  lives...somewhere in time",
"Diana P.", "This program was written  in the city of Sofia (C)  1988-89
Dark Avenger".


			3.2.6.2. Вирус "V-2000"
			───────────────────────

	Очень опасный  резидентный файловый  вирус.   Длина 2000  (7D0h)
байт.  Быстро размножается:  инфицирует COM-файлы длиной от 1959  (7A7h)
до  62947  (F5E3h)  байт  и  EXE-файлы  длиной  от  1959 (7A7h) байт при
загрузке  их  в  память  для  выполнения,  при создании, переименовании,
открытии и закрытии файла, при  чтении или изменении его атрибутов  (int
21h, ax=4B00h или ah=3Ch, 3Dh, 3Eh, 43h, 56h, 5Bh).

	Вирус следит за тем, чтобы длины заражаемых файлов увеличивались
ровно  на  2000  байт  (к  EXE-файлам,  помимо  выравнивания  на границу
параграфа, дописывается соответствующее число байт). У заражаемых файлов
(как и  при поражении  вирусом "Reset")  устанавливается новое  значение
секунд даты последней модификации - 62 секунды.

	Вирус предпринимает ряд эффективных мер для того, чтобы остаться
незамеченным, многие из них  повторяют аналогичные меры вируса  "Eddie".
Маскирующую  функцию  играет  длина  вируса:  достаточно трудно заметить
приращение длины, кратное 1000 байтам. Введена и другая функция  защиты:
вирус перехватывает функции DOS  FindFirst и FindNext (int  21h, ah=11h,
12h) и  "уменьшает" длины  зараженных файлов  на 2000  байт, т.е.  вирус
невозможно  определить  по  изменению  длин  файлов  (если,  конечно, он
резидентно находится в памяти). Утилиты, которые не используют указанные
функции  DOS  (например,  Norton   Commander),  а  напрямую   используют
содержимое  секторов,  хранящих  каталог,  показывают  правильную  длину
зараженных  файлов.  При  "уменьшении"  длин  файлов вирус определяет их
зараженность по значению секунд даты последней модификации (62  секунды)
и  не  проверяет  истиннюх  длин  файлов.  Если  такое  значение  секунд
встретится у файла  небольшой длины (меньше  2000 байт), то  команда DIR
выдаст несколько странную длину файла - около 4 гигабайт.

	Вирус очень опасен: аналогично вирусы "Eddie" стирает cектор  со
случайным  номером.  При  этом  вирус  обращается  напрямую  к драйверу,
обслуживающему диск, и обходит многие резидентные блокировщики.

	Содержит текстовые строки: "Zopy me - I want to trawel",  "Диана
П.", "(c) 1989 by Vesselin Bontchev".

	Вирус изменяет вектора прерываний 13h, 21h, 27h.


			  3.2.7. "Peterburg"
			  ──────────────────

	Файловый резидентный  вирус, не  опасен, длина  529 (211h) байт.

	Инфицирует .COM-файлы длиной от 6D0h до EF00h байт при  загрузке
их в память для выполнения (int 21h, ax=4B00h). Вирус внедряется в  файл
по следующей схеме:

	а) переписывает первые 529 байт файла в его конец;
	б) записывает в начало файла свое тело.

	     ┌────────┐  а)   ┌────────┐  б)   ┌────────┐
             │Файл    │───┐   │Свободно│       │Вирус   │
             │--------│   │   ├────────┤       ├────────┤
             │        │   │   │Файл    │       │Файл    │
             │        │   │   │        │       │        │
             └────────┘   │   │--------│       │--------│
                          └──>│        │       │        │
		              └────────┘       └────────┘

	При   выполнении   инфицированной   программы   вирус   остается
резидентным в памяти, совершая следующие действия:

	а) изменяет  размер  выделенной  под основную программу  памяти,
	   резервируя дополнительную память для своих нужд;
	б) определяет имя основной  программы и функцией EXEC  (int 21h,
	   ax=4B00h)  запускает  ее   на  выполнение  (т.е.   происходит
	   повторный запуск основной программы);
	в) по  окончании  работы  программы  вирус остается  резидентным
	   (int 21h, ah=31h).

		     а)              б)              в)
	│ ...     │     │ ...     │     │ ...     │     │ ...     │
	├─────────┤     ├─────────┤     ├─────────┤     ├─────────┤
	│Вирус    │────>│Вирус    │     │Вирус    │     │Вирус    │
	├─────────┤     │- - - - -│     │- - - - -│     │- - - - -│
	│Программа│     │         │     │         │     │         │
        │         │     ├─────────┤     ├─────────┤     ├─────────┤
	├─────────┤     │ ...     │     │Вирус    │     │ ...     │
	│ ...     │                     ├─────────┤
			                │Программа│
			                │         │
			                ├─────────┤
			                │ ...     │

	Вирус никак не проявляется и не имеет деструктивной функции.


	       3.2.8. Семейство вирусов "IV" ("Canser")
	       ────────────────────────────────────────

			3.2.8.1. Вирус "IV-345"
			───────────────────────

	Нерезидентный очень  опасный   вирус,   длина   345 (159h) байт.
Заражает .COM-файлы в текущем оглавлении, дописывая себя в начало файла.

	При старте ищет все .COM-файлы в текущем оглавлении и инфицирует
их. Повторного заражения не происходит.

	Быстро  проявляется:  начиная  с  пятого  "поколения" вируса при
старте  зараженной  программы  с  вероятностью  1/2 на экране появляется
сообщение :  "Programm  sick  error:  Call doctor or buy PIXEL for  cure
description".

	Вирус  не  имеет  деструктивной  функции,  но  очень опасен: при
инфицировании  файла  не  проверяет  его  длину.  Это  может  привести к
уничтожению файла.


			3.2.8.2. Вирус "IV-740"
			───────────────────────

	Нерезидентный  очень  опасный  вирус,  длина  740  (2E4h)  байт.
Заражает .COM-файлы в текущем оглавлении, дописываясь в начало файла.

	Вирус является мутацией предыдущего вируса данного семейства.
Отличия:

	а) возможно   повторное   заражение   файлов,  что   увеличивает
	   опасность вируса;
	б) не выдаются сообщения на экран.


			3.2.8.3. Вирус "IV-847"
			───────────────────────

	Нерезидентный  очень  опасный  вирус,  длина  847  (34Fh)  байт.
Заражает .COM-файлы в текущем оглавлении, дописываясь в начало файла.

	Вирус является мутацией предыдущего вируса данного семейства.


			 3.2.9. Вирус "Murphy"
			 ─────────────────────

	Неопасный резидентный файловый вирус.   Длина 1277 (4FDh)  байт.
Быстро размножается:   стандартным способом инфицирует  COM-файлы длиной
от 1277 (4FDh) до 64226 (FAE2h)  и EXE-файлы длиной от 1277 (4FDh)  байт
при загрузке их  в память и  при открытии файлов  (int 21h, ah=3D,  4Bh,
6Ch).

	Процедура копирования вируса в память во многом повторяет  вирус
"Eddie", после чего вирус "Murphy",  как и вирус "Eddie", поражает  файл
COMMAND.COM.

	Через некоторое время после активизации вирус начинает  издавать
мерзкий свист очень высокого тона.

	Изменяет вектор прерывания  21h.

	Содержит  текст:  "I'm  Murphy.  Nice  to  meet  you friend. I'm
written since  Nov/Dec.   Copywrite (c)1989  by Lubo  & Ian,  Sofia, USM
Laboratory."

		      3.2.10. Вирусы С.Олейникова
                      ───────────────────────────

			3.2.10.1. Вирус "V-600"
			───────────────────────

	Файловый резидентный  вирус, безобиден,  длина 600  (258h) байт.
Часть вируса (50 байт) зашифрована (XOR DDh).

	Инфицирует .COM-файлы длиной от 600 (258h) до 60000 (EA60h) байт
при  загрузке  их  в  память  для  выполнения (int 21h, ax=4B00h). Вирус
внедряется в файл по схеме, напоминающей вирус "Peterburg": переписывает
начало вируса (600 байт) в конец файла, а сам записывается в его начало.
При этом переписываемая часть файла шифруется (XOR BBh).

	Изменяет вектор прерывания  21h.

	Вирус никак не проявляется  и не имеет деструктивной  функции. В
теле    вируса    содержится    зашифрованный    (XOR    1Ah)     текст:
"Oleynikoz S.,1990".

		      3.2.10.2. Вирус "Voronezh"
		      ──────────────────────────

	Резидентный файловый опасный вирус, длина 1600 (640h) байт.

	Поражает COM-файлы длиной от  1600 (640h) до 61000  (EE48h) байт
и  EXE-файлы  любой  длины  при  их  выполнении  или  открытии (int 21h,
ax=4B00h или 3D00h). COM-файлы заражаются по схеме вируса V-600.

	EXE-файлы инфицируются по сложному алгоритму:  у них  изменяется
5 байт точки входа  в программу на код  команды CALL FAR Loc_Virus,  при
этом изменение адреса точки входа в заголовке файла не требуется.  Вирус
корректирует  таблицу  настройки  адресов  (ТНА):   добавляет в нее один
элемент, соответствующий команде CALL FAR Loc_Virus; необходимым образом
изменяет 1  элемент ТНА,  указывающий на  измененные 5  байт (если такой
элемент существует). Затем вирус дописывает  к  файлу свою копию  (длина
файла  при этом НЕ увеличивается до параграфа).

	Перехватывает прерывание 21h.

	Вирус содержит ошибки: анализируются не более 640 элементов ТНА;
не анализируется случай, когда  модифицируемый элемент ТНА указывает  на
5-й байт от точки входа (т.е. слово, которое настраивается при  загрузке
файла, лежит  на границе  изменяемых 5  байт). При  запуске такого файла
возможно зависание компьютера.

	Судя по информации, предоставленной Д.Н.Лозинским, вирус написан
неким  "мелким   пакостником"  Стасом   Олейниковым  специально   против
антивируса   AIDSTEST.EXE.  Механизм  прикрепления  вируса  к EXE-файлам
разработан таким  образом, что  AIDSTEST.EXE не обнаруживает изменений в
своем  теле.  Вероятно,  С.Олейников  не  остановится  на  достигнутом и
принесет  немало  неприятностей  организациям,  в  которых ему предстоит
работать.

			3.2.11. Вирус "RC-492"
			──────────────────────

	Очень опасный файловый резидентный вирус, длина 492 (1ECh) байт.

	Заражает  COM-файлы  при  запуске  их  на  выполнение  (int 21h,
ax=4B00h),  длин  файлов  не  проверяет.  Копирует  себя в конец файла и
изменяет его первые 6 байт (JMP xx xx zz zz zz).

	При активизации ищет файл C:\COMMAND.COM и инфицирует его. Затем
остается резидентным  в памяти.  Для этого  он копирует  себя в  область
памяти,  содержащую  таблицу  векторов  прерываний, по адресу 0000:0200.
Если в памяти компьютера находятся программы, использующие  уничтоженные
таким образом вектора прерываний, то произойдет зависание системы.

	Имеет  деструктивную  функцию:  периодически  стирает  несколько
секторов со случайными номерами.

	Изменяет вектора прерываний  1Сh и 21h.

	Содержит  команду  `push  100h',  поэтому не распространяется на
компьютерах с процессором 8086/88 (кроме Olivetti).


		       3.2.12. Вирус "LoveChild"
		       ─────────────────────────

	Очень опасный файловый резидентный вирус, длина 488 (1E8h) байт.

	Заражает .COM-файлы  при их  загрузке в  память, при  открытии и
создании (int 21h,  ah=3Ch, 3Dh, 4Bh  и 5Bh), длин  файлов не проверяет.
Копирует себя в  конец файла и  изменяет его первые  4 байта (  STI; JMP
Loc_Virus ).

	При создании своей резидентной копии переписывает себя в область
памяти, содержащую таблицу векторов прерываний, по адресу 0000:01E0.

	Если на компьютере установлена DOS 3.30, то вирус  предпринимает
маскирующие действия - вирус "знает" адрес обработчика прерывания 21h  и
адрес, по которому хранится исходное значение прерывания 13h.  Используя
это,  вирус  модифицирует  память,  занятую операционной системой, таким
образом, что обрабатывает вызов прерывания 21h непосредственно перед ОС.
С  прерыванием  13h   вирус  поступает  проще   -  восстанавливает   его
первоначальное значение.

	Имеет деструктивные функции:  в зависимости от  счетчика времени
может уничтожать файлы или создавать вместо файла подкаталог с таким  же
именем.  Вирус  периодически  модифицирует  COM-файлы таким образом, что
их  запуск   вызовет  стирание   секторов  винчестера   (стирается   вся
информация, расположенная на всех секторах, соответствующих 0-3 головкам
записи/чтения).

	Перехватывает вектор прерывания 21h.

	Содержит текстовые строки: "v2 (c) Flu Systems (R)" и "LoveChild
in reward for software sealing".


		       3.2.13. Вирус "ATTENTION"
		       ─────────────────────────

	Опасный файловый резидентный вирус, длина 394 (18Ah) байт.

	Заражает .COM-файлы длиной от 786 (312h) до 64921 (FD99h) при их
загрузке  в  память  (int  21h,  ah=4Bh).  Копирует себя в конец файла и
изменяет его первые 16 байт :

        ┌───┬────┬────┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬───┬───────────
        │JMP Loc_Virus│A T T E N T I O N     !│1Ah│   файл
        └───┴────┴────┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴───┴───────────
	    3 байта            12 байт        1 байт

	При создании  своей резидентной  копии использует  самые старшие
адреса доступной  памяти (как  и вирусы  семейства Eddie). Перехватывает
прерывание 24h, но не восстанавливает его первоначальное значение -  это
может  привести  к  зависанию  системы.  Снимает атрибут  read-only и не
восстанавливает его.

	Перехватывает вектор прерывания 21h.

	Проявляется при заражении файлов на защищенном от записи диске -
у дисковода A:  включается мотор (вне  зависимости от диска,  к которому
идет обращение). Зараженные файлы, начиная с 4-го байта, содержат строку
"ATTENTION !".

			 3.2.14. Вирус "Bebe"
			 ────────────────────

	Опасный файловый резидентный вирус, длина 1004 (3ECh) байт.

	Заражает  .COM-  файлы  текущего  оглавления,  длин  файлов   не
проверяет,  повторного  заражения  не  производит.  Увеличивает   размер
заражаемого файла до параграфа, копирует  себя в конец файла и  изменяет
его первые 14 байт ( PUSH AX; ... ; JMP FAR Loc_Virus ).

	Создает резидентную программу.  Для этого копирует  часть своего
тела в таблицу векторов  прерываний по адресу 0000:01CE  и устанавливает
на  нее  прерывание  1Ch  (таймер).  Через  некоторое  время  на  экране
появляется сообщение:
			╔════════ VIRUS ! ══════╗
			║  Skagi "bebe" >       ║
			╚═══════════════════════╝
	После того, как с  клавиатуры вводится "bebe", вирус  добавляет:
"Fig Tebe !". По словарному запасу вируса можно вполне точно  определить
его происхождение.

	Содержит ошибку - не  восстанавливает DTA. Это может  привести к
зависанию компьютера.

	Помимо перечисленного текста содержит строку "*.COM".


			 3.2.15. Вирус "4096"
			 ────────────────────

	Файловый резидентный вирус, длина 4096 (1000h) байт.

	Поражает  COM-файлы  длиной  до  61440  (F000h) байт и EXE-файлы
любой длины при их запуске или закрытии (int 21h, ax=4B00h или  ah=3Eh).
Возможно поражение файлов данных. Перед заражением файлы дополняются  до
параграфа.  Дописывает  свою  копию  так,  чтобы размер файла увеличился
ровно  на  4096  байт  (см.   3.2.6.2).  У пораженных файлов увеличивает
значение  времени  последней  модификации  на  100  лет.  У   COM-файлов
изменяются первые 6 байт, у EXE - заголовок.

	При внедрении в  файлы пользуется истинными  значениями векторов
прерываний  13h  и  21h,  которые  получает по алгоритму "Yankee Doodle"
(3.2.3.4).   Дополнительно  к  этому,  как  и  "LoveChild", модифицирует
первые 5 байт обработчика прерывания 21h.

	При создании резидентной копии располагается в старших  адресах,
что приводит к  заражению файла COMMAND.COM.  Устанавливает в своем  MCB
адрес владельца (owner),  совпадающий с адресом  владельца первой MCB  в
системе,  маскируясь   под  DOS.   В  дальнейшем   копия  вируса   может
перемещаться  по  памяти  в  направлении  младших  адресов, выделяя себе
новые участки памяти и освобождая старые.

	Перехватывает прерывание  21h, обрабатывает  20 (!)  его функций
(FindFirst, FindNext, Read,  Write, Lseek, Open,  Create, Close, Exec  и
т.д.) и хорошо маскируется. При обращении DOS к зараженному файлу  вирус
подставляет его  первоначальную длину  и время  модификации. При  чтении
файла  или  загрузке  его  в  память  модифицирует  считанную  с   диска
информацию таким образом, что файл  предстает в незараженном виде.   При
открытии файла  для записи  вирус лечит  его (т.к.  запись в  файл может
уничтожить часть вируса) и снова заражает при закрытии.

	Вирус  проявляется  с  22  сентября  по  31  декабря   ежегодно.
Проявления  вируса  мне  неизвестны,  поскольку  соответствующий участок
программы  оказался  уничтоженным.   Но  можно  предположить,  что вирус
"подвешивает" DOS и что-то выводит на экран.



			3.3. Загрузочные вирусы
			═══════════════════════

		3.3.1. Семейство "Итальянских" вирусов
		──────────────────────────────────────

		      3.3.1.1. Вирус "Ping-Pong"
		      ──────────────────────────

	Не  опасен,  длина  1024  (400h)  байт  (2  сектора).   Заражает
BOOT-секторы дисков при обращении к ним (int 13h).

	На диске располагается стандартным способом.

	Заражает  диски,   имеющие  следующие   характеристики:   размер
сектора - 200h байт, число секторов в кластере - 2.

	"Ping-Pong"  имеет  байт,  содержащий  номер версии вируса. Если
вирус  обнаруживает  диск,  зараженный  своей  предыдущей версией, то он
"обновляет" ее.

	Вирус изменяет вектора прерываний  8 и 13h.

	Вызывает видеоэффект скачущего шарика (знак 07h ASCII),  который
перемещается по экрану, отражаясь от знаков и границ экрана.

		   3.3.1.2. Вирус "Hacked Ping-Pong"
		   ─────────────────────────────────

	Очень опасен: стирает первые 8 секторов флоппи-диска.

	Является модификацией вируса  "Ping-Pong" и почти  полностью его
повторяет. Отличие: вместо запуска скачущего шарика происходит установка
прерывания 13h на подпрограмму уничтожения секторов флоппи-диска.

	 3.3.1.3. Вирус "Ping-Pong modified by Yankee Doodle"
	 ────────────────────────────────────────────────────

	Является модификацией вируса  "Ping-Pong" и почти  полностью его
повторяет.   Изменен  вирусом  "Yankee  Doodle"  таким  образом, что при
каждой  загрузке  вируса  "Ping-Pong"  его  версия  (байт, содержащий ее
значение) увеличивается на 1.  При достижении версией нулевого  значения
(255+1), вирус дезактивируется.


		   3.3.2. Семейство вирусов "Stone"
		   ────────────────────────────────

			3.3.2.1. Вирус "Stone"
			──────────────────────

	Очень опасный вирус, длина 512 (200h) байт (1 сектор).  Заражает
первые физические  сектора дисков:   BOOT-сектор флоппи-диска  и  Master
Boot Record винчестера.

	Состоит  из  двух  частей:  первая  часть содержит тело вируса и
хранится   в   первом   физическом   секторе   диска,   вторая  содержит
первоначальный сектор  зараженного диска  и хранится  на флоппи-диске по
адресу 1/0/3 (головка/трек/сектор), на винчестере - по адресу 0/0/7.  На
флоппи-диске вторая часть вируса  занимает один из секторов,  отведенных
под корневое оглавление. Местоположение вируса среди секторов  корневого
оглавления зависит  от объема  диска. Для  диска, отформатированного  на
360K,  это,  как  правило,  последний  сектор  корневого  оглавления. На
винчестере вторая  часть вируса  занимает либо  неиспользуемый (скрытый)
сектор, либо один из секторов в FAT (File Allocation Table).

	Флоппи-диски инфицируются  при чтении  с них  (int 13h,  ah=02).
Винчестер   -   при   загрузке   операционной   системы   с  зараженного
флоппи-диска. Повторного заражения не происходит. При сохранении на диск
второй  части  вируса  никаких  проверок  не производится, поэтому вирус
может уничтожить часть информации  на диске (на флоппи-диске  может быть
уничтожен один из секторов корневого оглавления, на винчестере - один из
секторов FAT).

	Вирус изменяет вектор прерывания 13h.

	При загрузке  с зараженного  флоппи-диска с  вероятностью 1/8 на
экране появлается сообщение: "Your PC is now Stoned!".

	Помимо указанной содержит строку "LEGALISE MARIJUANA!".


		     3.3.2.2. Вирус "Stone Rostov"
		     ─────────────────────────────

	Почти полностью повторяет вирус "Stone". Отличия:

	- не содержит текстовых строк и не выводит текст на экран;
	- при  загрузке с  зараженного флоппи-диска  с вероятностью 1/32
	  стирает на винчестере 8 секторов.



		      3.3.3. Вирус "Disk Killer"
		      ──────────────────────────

	Очень опасный вирус, длина 3072 (C00h) байта (5 секторов).

	Состоит из двух  частей:  первая  часть вируса, оформленная  как
BOOT-сектор,  располагается  в  BOOT-секторе  диска  и  содержит  начало
вируса; вторая  часть располагается  в пяти  последовательных секторах и
содержит продолжение вируса (4 сектора) и оригинальный BOOT-сектор диска
(5-й сектор).

	Заражает  BOOT-секторы  дисков  при  обращении  к  ним (int 13h,
ah=02).   Расположение вируса  на флоппи-диске  - стандартное. Винчестер
заражается  только  в  том  случае,  если  число  скрытых секторов (т.е.
расположенных  между  BOOT-сектором  и  первым  сектором FAT) больше или
равно 5. Вторая часть вируса при этом записывается в последние 5 скрытых
секторов.

	Изменяет вектора прерываний  8, 9, 13h.

	Вирус может  уничтожить всю  информацию на  диске. При  чтении с
диска (int 13h, ah=02) вирус опрашивает свой внутренний счетчик времени,
и, если значение счетчика удовлетворяет некоторым условиям,  совершаются
следующие действия:

	а) на экране появляется сообщение:

	   "Disk Killer -- Version 1.00 by COMPUTER OGRE 04/01/1989
	    Warning !!
	    Don't turn off the power or remove the diskette
	    while Disk Killer is Processing!
	    PROCESSING";

	б) уничтожается  информация  на  всех  треках  диска:  все байты
	   информации  на  нечетных  треках  двоично суммируются (XOR) с
	   байтом 55h, все байты на четных секторах - с байтом AAh;

	в) на экране появляется сообщение:

	   "Now you can turn off the power
	    I wish you luck !";

	г) компьютер "зависает" (совершает холостой цикл).


		      3.3.4. Вирус "Brain/Ashar"
		      ──────────────────────────

	Безобиден (?), длина - 3072 (C00h) байта (5 секторов).

	Заражает  BOOT-секторы  флоппи-дисков  при  обращении к ним (int
13h, ah=02). Расположение  на диске -  стандартное. У зараженного  диска
устанавливается новая метка тома:  "(C) Brain".

	Вирус  трудно  обнаружить:  при  попытке  просмотра BOOT-сектора
зараженного диска вирус "подставляет" истинный BOOT-сектор.



			3.3.5. Вирус "Den Zuk"
			──────────────────────

	Очень  опасный  вирус,  длина  4086  (1400h)  байт (9 секторов).
Заражает BOOT-сектор флоппи-дисков.

	Диски инфицируются  при обращении  к ним  (int 13h, ah=2,3,4,5).
Повторного заражения не происходит. При сохранении на диск второй  части
вируса никаких проверок не производится, поэтому вирус может  уничтожить
часть информации на диске (расположенной на 40-м треке).

	Вирус изменяет вектора прерываний 9 и 13h.

	При "теплой" перезагрузке крупными буквами выводит на экран свое
имя: "Den Zuk". Изменяет метку заражаемого диска на "Y■C■1■E■R■P".

	Вирус не  имеет деструктивной  функции, но  очень опасен:  может
уничтожить информацию на 40-м треке заражаемого диска.


			 3.3.6. Вирус "Joshi"
			 ────────────────────

	Очень  опасный  вирус,  длина  4086  (1400h)  байт (9 секторов).
Заражает BOOT-сектор флоппи-дисков и MBR винчестера.

	Диски инфицируются при обращении  к ним (int 13h,  ah=2,3,4,0Ah,
0Bh).  Повторного заражения не происходит.

	Состоит из  двух частей:   первая часть  содержит тело  вируса и
хранится в BOOT-секторе (или MBR) диска, вторая содержит  первоначальный
сектор зараженного  диска и  остальные 8  секторов вируса  и хранится на
флоппи-диске  на  40-м  или  80-м  треке  в зависимости от формата диска
(используется нестандартное форматирование);  на винчестере - начиная со
2-го сектора 0-го трека. При  сохранении своей копии на винчестер  может
уничтожить FAT.

	Вирус  перехватывает  прерывание  DOS  21h.  Для  этого он после
активизации  (загрузки  системы)  постоянно  опрашивает значение вектора
прерывания 21h и, как только оно изменяется, считывает его.

	Перехватывает прерывание  9h (клавиатура).  Обрабатывает нажатие
клавиш Alt-Ctrl-Del (перезагрузка)  и эмулирует ее:  гасит экран и  т.д.
При этом вирус  остается резидентным даже  при загрузке с  незараженного
защищенного от записи диска.

	Проявляется  5-го   января:  выводит   сообщение  "Type   `Happy
Birthday,  Joshi'!"  и  ждет  ввода  с клавиатуры фразы "Happy Birthday,
Joshi!".

	Помимо  указанной  содержит  строки  "Your  PC  is now Stoned!",
"LEGALISE".

	Изменяет вектора прерываний  8, 9, 13h, 21h.


		      3.3.7. Вирус "PrintScreen"
		      ──────────────────────────

	Очень опасный вирус, длина 512 (200h) байт (1 сектор).  Заражает
BOOT-сектор флоппи-дисков и MBR винчестера.

	Диски инфицирует при  чтении с них  (int 13h, ah=2).  Повторного
заражения  не  производит.   Старый  Boot-сектор  или  MBR  сохраняет на
флоппи-диске по адресу 0/1/3  (трек/сторона/сектор), на винчестере -  по
адресу 1/3/13. При этом может уничтожить один из секторов FAT.

	Судя по листингу вируса, при инфицировании диска с  вероятностью
1/256  (в  зависимости  от  значения  своего внутреннего счетчика) вирус
должен  вызывать  прерывание  5  (печать  экрана), но допущена ошибка, в
результате которой новое значение счетчика не сохраняется.

	Перехватывает вектор 13h.

  ═════════════════════════════════════════════════════════════════════

	Заранее благодарю всех, кто пришлет свои замечания,  предложения
или сообщит об обнаруженных в тексте неточностях.


			'Доктор'  Е. Касперский.
			 125183, Москва, ул. Б.Академическая, 73-3-11.
			 Телефон (095) 482-60-05   (21.30-23.00).

			 12 сентября 1990 г.

