Cофтпанорама 1991, No. 3 (17) *** REPRINTS ***  Составитель: Н.Н. БЕЗРУКОВ
**************************************************************************
                                    Данный материал опубликован в журнале
                                    КомпьютерПресс 1991 No.2.
                                    Перепечатывается с разрешения редакции

             СРЕДСТВА ОРГАНИЗАЦИИ МНОГООКОННОГО ИНТЕРФЕЙСА

   Наиболее распространенными  языками программирования при разра-
ботке программного  обеспечения (ПО)  для персональных компьютеров
(ПК) класса IBM PC являются Бейсик, Паскаль, Модула-2 и Си. Неотъ-
емлемым компонентом каждой программной системы является ее пользо-
вательский интерфейс.  При разработке  ПО на  этих языках возможны
два подхода. Один заключается в применении аппарата ESC-последова-
тельностей и возможностей драйвера ANSI.SYS. Другой ї в применении
разнообразных инструментальных  средств, позволяющих  организовать
гораздо более  эффективный интерфейс пользователя при затрате зна-
чительно меньших  усилий на его создание. Рассмотрение именно этих
средств и является нашей целью.

   Пакет Basic Windowing Toolbox (B-Window)
   Фирма Image Computer Systems

   Инструментальный пакет Basic Windowing Toolbox (B-Window) пред-
ставляет собой набор функций, которые позволяют реализовать много-
оконный интерфейс при программировании на Бейсике. Как обычно, ок-
но может  иметь статус  открытого или закрытого. При закрытии окна
восстанавливается предыдущее изображение на экране. Пакет B-Window
написан на Ассемблере с целью реализации высокой скорости исполне-
ния. Система  поддерживает программы на Бейсике в сочетании с при-
менением интерпретатора  или компилятора Microsoft QuickBasic 4.0.
Компилятор TurboBasic фирмы Borland не поддерживает работу с паке-
том, однако в будущем этот недостаток предполагается устранить. B-
Window  работает   как  с   монохромными   видеоадаптерами   (MDA,
Hercules), так и с цветными (CGA, EGA, VGA).
   При определении окна задается один из шести имеющихся типов ра-
мок. Для каждого объявленного окна формируется файл поддержки, ко-
торый помещается  в некоторую  область памяти,  называемую буфером
окна. Помимо  этого для  функционирования окна  необходим доступ к
видеопамяти на  том участке экрана, который перекрывает данное ок-
но. Расположение  окна на  экране легко изменяется по желанию про-
граммиста.
   Цена системы 20 долл. Дистрибутивная версия B-Window  обеспечи-
вает   полную   поддержку интерпретаторов Basic, Basica, GWBasic и
им подобных,  а также  поддерживает работу  с библиотекой QBV4.QLB
компилятора QuickBasic  4.0. Ведутся  работы по включению  системы
B-Window  в  интегрированное окружение  этого  транслятора.  Заре-
гистрированным пользователям  система  будет  поставляться  с реа-
лизованной возможностью  создания  автономных EXE-файлов и генера-
ции исходных кодов Ассемблера.

   Пакет Turbo Professional
   Фирма Borland International

   Turbo Professional, пакет интегрированного типа,   это наиболее
распространенная система  для расширения  возможностей стандартных
библиотек Turbo  Pascal,   аналогичная   системе   Repertoire  для
Модулы 2. Пакет  дает пользователю  возможность производить   дей-
ствия,   не   предусмотренные  в  системе Turbo Pascal. Библиотека
Turbo  Professional  включает в себя ряд процедур, позволяющих:
   - организовать интерфейс пользователя (т.е. создавать на экране
дисплея окна меню и обрабатывать информацию в них);
   - производить расширенную обработку символьных переменных;
   - дополнить стандартную  математическую  библиотеку  (например,
увеличить точность вычислений и т.п.);
   - работать с  расширенной памятью  компьютера, создавать  рези-
дентные программы и многое, многое другое.
   Мы рассмотрим  более подробно  лишь первый  пункт, поскольку он
имеет непосредственное  отношение к теме нашего обзора. Процедуры,
включающие функции  по организации  интерфейса пользователя, можно
разделить на следующие основные группы:
   - процедуры создания окон и работы с ними;
   - процедуры, позволяющие строить системы меню;
   - процедуры поддержки виртуальных экранов.
   По возможностям работы с окнами система Turbo Professional зна-
чительно превосходит  пакет Power Tools Plus, поскольку входящие в
нее процедуры позволяют осуществлять множество дополнительных сер-
висных операций, например, перемещать курсор и изменять его форму;
прокручивать окна вверх и вниз; считывать информацию из окон и за-
писывать ее  в   видеопамять   с  высокой  скоростью;  сохранять и
восстанавливать   окна;   перемещать   и   изменять их  параметры;
включать и  выключать режимы  43 линий для  видеоадаптера EGA и 50
 для VGA  без очистки  экрана и т.п. Кроме того, основным отличием
данного пакета  является поддержка  виртуальных экранов. Для этого
предусматривается возможность рассмотрения любого  отрезка  опера-
тивной   памяти   как видеобуфера,  содержимое которого может быть
выведено на  экран. Обычно  виртуальные  экраны  располагают в до-
бавочных   видеостанциях   или  помещают  буфер в свободную опера-
тивную память. Максимальное количество  одновременно  существующих
виртуальных экранов  может быть  равным 10. Это позволяет формиро-
вать изображение  "за кадром",  а затем  мгновенно пересылать  его
на   экран, что   создает видимость молниеносной реакции программы
на действия пользователя.
   По возможностям  работы с меню пакет Turbo Professinal мало чем
отличается от  аналогичных систем  и поддерживает 5 основных типов
меню: горизонтальные,  вертикальные, меню Lotus-стиля, иерархичес-
кие и типа сетки.
   В заключение отметим, что пакет Turbo Professional является од-
ной из наиболее мощных систем подобного класса.

   Пакет Power Tools Plus
   Фирма Blaise Computing

   Среди прочих  инструментальных средств по разработке интерфейса
на языке Pascal, наибольшего внимания  заслуживает  система  Power
Tools Plus,  предназначенная   для  работы  с  Turbo  Pascal  раз-
личных версий.  Пакет  является  интегрированным - он обеспечивает
не    только   поддержку   программирования   интерфейса   пользо-
вателя,    но  и  ряд  других   возможностей, например,  поддержку
печатающего   устройства,  управление  памятью,  обработку  преры-
ваний и  т.п. Однако   организация   интерфейса  пользователя (ИП)
занимает в нем центральное место.
   Пакет Power  Tools Plus  обеспечивает следующие возможности для
программирования ИП:  поддержку экрана, управление окнами, органи-
зацию работы  с меню. Процедуры, входящие в библиотеку Power Tools
Plus, позволяют выполнять следующие основные функции:
   - создание окон с различными типами рамок и заголовков;
   - обеспечение наличия собственного курсора в каждом окне;
   - наложение окон друг на друга;
   - организация такого  количества окон,  которое ограничено лишь
объемом свободной оперативной памяти.
   Таким образом,  процедуры работы  с окнами  позволяют построить
простейший пользовательский интерфейс без необходимости программи-
рования на низком уровне.
   В составе  пакета имеется  возможность создания различных типов
меню: горизонтального,  вертикального, типа системы Lotus и сетча-
того. Поскольку  имеются процедуры,  позволяющие создавать  меню с
учетом конкретных  задач пользователя (определение назначений кла-
виш реакции  и т.п.),  это ставит данный пакет в один ряд со сред-
ствами, ориентированными специально на работу с многооконным поль-
зовательским интерфейсом.  Но так  как данная система является ин-
тегрированной (т.е.  содержит и  дополнительные процедуры, не свя-
занные с созданием системы пользовательского интерфейса), она, ес-
тественно, не обладает такими мощными возможностями и столь гибким
интерфейсом,  как  специализированные  пакеты.  Однако  применение
Power Tools Plus для создания многооконного интерфейса в небольших
программах представляется целесообразным, так как на его разработ-
ку много  времени не  потребуется, а  программа пользователя в ре-
зультате будет  выглядеть профессионально.  Необходимо также отме-
тить, что пакет довольно прост в освоении.

   Наиболее распространенными системами программирования для языка
Модула-2 являются  TopSpeed Modula-2  фирмы J&P International, из-
вестная также под названием JPI Modula-2, и Logitech Modula-2 фир-
мы Logitech.  Существенным доводом  в пользу версии Модулы-2 фирмы
Logitech является наличие на рынке программного обеспечения допол-
нительных инструментальных  средств,  значительно  расширяющих  ее
возможности. К  таким средствам относятся система Repertoire фирмы
PMI и  система Window Machine (WM) фирмы Amber System Inc, которые
позволяют дополнить  программу множеством  сервисных функций  - от
организации интерфейса пользователя до работы с базами данных.

   Пакет Repertoire
   Фирма PMI, Charles Bradford
   and Cole Brecheen

   С момента  своего появления  в 1985  г. система Repertoire была
реализована в  пяти версиях  и на  сегодняшний день превратилась в
наиболее совершенную  и надежную  инструментальную систему, широко
применяемую во всем мире при программировании на Модуле-2 и специ-
ально ориентированную  на организацию интерфейса пользователя. Она
обеспечивает независимость разрабатываемой программы как на уровне
исходного, так и объектного кодов; исходный код работает без изме-
нений  с   любым  компилятором   Модулы-2,  объектный -   с  любым
Microsoft-совместимым языком. Система  включает  в  себя  необычно
мощный экранный  конструктор,  в  состав  которого  входят  анали-
затор   естественного   языка,  текстовый  редактор,  а  также ин-
тенсивная  поддержка  манипуляции  строками.
   Система Repertoire обеспечивает выполнение трех основных задач:
   - работу с расширенной памятью (Expanded Memory Specification);
при этом программы пользователя получают возможность поддерживаеть
работу с  памятью, расширенной  до 8  Мбайт. Наличие таких модулей
позволяет совместно с использованием компилятора Modula-2 Logitech
создавать системы, аналогичные Lotus 1-2-3, которые могут работать
с большим  числом данных,  выходящих за мегабайтную границу опера-
тивной памяти;
   - создание баз данных и работу с ними, причем данные имеют фор-
мат широко распространенной СУБД dBASE III;
   - организацию работы  в графическом  режиме (Graphix). При этом
предусмотрена возможность  использования  объектно-ориентированной
системы Meta  Window (фирма  MetaGraphix), которая  обладает очень
широким набором  функций для  построения графических  изображений,
поддерживает около  20 типов  графических адаптеров и обеспечивает
работу с графическими окнами.

   Пакет Window Machine (WM)
   Фирма Amber Systems

   Система WM  предназначена для создания многооконного интерфейса
пользователя (Virtual Screen Interface) в текстовых режимах работы
дисплея. Она  проста в  использовании и  занимает всего  лишь  100
Кбайт памяти на жестком диске. Система позволяет работать одновре-
менно с  255 окнами  и осуществляет  все типичные для многооконных
систем операции.
   Пакет C Tools Plus
   Фирма Blaise Computing

   Одним из  самых распространенных  инструментальных средств  при
программировании на  языке Cи является пакет C Tools Plus. Послед-
няя версия  системы - C Tools  Plus 6.0 - появилась  на рынке про-
граммного обеспечения в конце 1989 г. Дистрибутив системы занимает
5 дискет емкостью  по 360 Кбайт.  В ее состав входят файлы включе-
ния, исходные  тексты программ,  библиотеки функций  для различных
моделей памяти  и файлы,  обеспечивающие демонстрацию возможностей
системы и получение помощи.
   Версия 6.0 C Tools Plus  предназначена для  работы с  системами
программирования на  языке Си  фирмы Microsoft версий 5.0 и 5.1, а
также с  QuickC версий  1.00, 1.01  и 2.00. Кроме того, специально
для  системы   QuickC  созданы  две  базы  данных  Ct6help1.hlp  и
Ct6help2.hlp для  обеспечения возможности  получения пользователем
контекстуально-зависимой помощи.  Главным файлом  определения  для
создания окон  является bwindow.h, в котором содержатся объявления
трех  основных  структур,  описывающих  параметры  программируемых
окон. Преимуществом данной системы по сравнению с другими подобны-
ми средствами является мощная поддержка функций редактирования ин-
формации в  окнах. Для  создания системы помощи пользователю в со-
ставе C Tools Plus имеется ряд функций и структур. При этом преду-
смотрена возможность  выделения цветом наиболее важной информации,
а также  возможность создания  баз данных,  содержащих информацию,
предназначенную для вывода на экран в режиме помощи. С применением
C Tools Plus возможно создание самых разнообразных меню. Все поль-
зовательские меню поддерживают работу с манипулятором "мышь". Кро-
ме перечисленных  возможностей имеются также средства, позволяющие
производить различные  манипуляции с  курсором, перемещать окна по
экрану, изменять их размеры и т.п. Система поддерживает видеоадап-
теры Hercules,  CGA, EGA, MCGA, VGA и целый ряд других, менее рас-
пространенных.

   Пакет C_SCAPE
   Фирма Oakland Group

   Позволяет пользователю работать с элементами данных экрана, ме-
ню, заголовками  и т.п. Все операции могут производиться с экраном
больше стандартного размера (т.е. 25 строк по 80 позиций), так как
система обеспечивает вертикальную и горизонтальную прокрутку экра-
на. Она, по существу, является редактором интерфейса пользователя,
позволяющим заносить информацию в свободное поле экрана дисплея. В
дополнение к  этому система обеспечивает такие специфические функ-
ции, как  определение поля,  его редактирование и рисование линий.
Конечным результатом  работы по  созданию пользовательского интер-
фейса являются  программы на  языке Си, которые впоследствии могут
быть оттранслированы  и помещены  в библиотеку для дальнейшего ис-
пользования. Описание  и создание окон осуществляется путем выпол-
нения программы  LNF. EXE. После этого можно приступать к редакти-
рованию интерфейса выбором варианта из предлагаемого меню.
   Наиболее важной операцией является работа с полем. Для создания
поля необходимо сначала маркировать его, а затем по подсказке, по-
являющейся на  экране, выбрать тип заносимых данных или же создать
новый. В режиме рисования можно создать на экране линии различного
вида (одиночные,  двойные или символьные). Поле редактируемого эк-
рана  превышает  стандартный  размер  и  содержит  100 колонок  по
100 строк каждая.  Операции с блоками позволяют перемещать, дубли-
ровать и  удалять маркированные  части текста. Одновременно с этим
можно измененять цветовые атрибуты всего блока или только его мар-
кированной части  и увеличивать  маркированную часть  до  размеров
всего поля.  Загрузка, сохранение  файлов, а   также  перевод  со-
зданного   разработчиком интерфейса  в  программу,  написанную  на
языке  Си, осуществляются выбором операции DISK из главного меню.

   Пакет C Power Window
   Фирма Entelekon

   Пакет предназначен для организации дружественного пользователь-
ского интерфейса  на основе работы с окнами. При этом имеется воз-
можность осуществлять следующие операции: самостоятельно организо-
вывать меню  или использовать  один из предлагаемых видов; переме-
щать созданные  окна на  экране; уменьшать или увеличивать размеры
окон; считывать  данные из  файла, находящегося на диске, в окно и
наоборот из  окна заносить  информацию в файл; заносить информацию
из окна  в память  или из  памяти в окно; очищать окно целиком или
его часть  от данных;  изменять атрибуты  цвета всего окна или его
части; выделять подсветкой часть данных в окне; организовывать на-
ложение и  пересечение окон на экране без потери информации; уста-
навливать приоритет  окна. Система  содержит исходные  тексты про-
грамм, написанных  на языках  Си и Ассемблер, оттранслировав кото-
рые, пользователь может получить библиотеку программ для различных
моделей памяти.  Основной для  C Power Window  является  концепция
"виртуального экрана".  Она заключается в следующем: все множество
операций, производимых  с окнами,  осуществляется сначала в рамках
"виртуального экрана"  системы, который  затем методом "перекачки"
передается на  экран монитора,  что обеспечивает практически мгно-
венную смену  информации на  экране. Организация окон основывается
на соглашениях,  принятых в языке Си, и вся работа, осуществляемая
пользователем с  окнами, проводится  со структурами  типа WINDOW и
FILEWW, определенными  в файле  window.h. Дополнительные структуры
типа BORDERCH и BORDERSTR по умолчанию включены в структуру WINDOW
и дают  информацию о  видах рамок окон. Фундаментальной концепцией
системы организации  окон в  C POWER  WINDOW является  положение о
статусе окна,  которое заключается в том, что окно может быть "су-
ществующим", "готовым" или "активным".
      Пакет Window for C
   Фирма Vermont Creative Software

   Инструментальный пакет Window for C включает в себя библиотеки,
позволяющие пользователю  организовать систему  различных  меню  и
окон для  общения с ПЭВМ. Этот пакет является единственным из всех
рассматриваемых в  данной статье, который обеспечивает возможность
работы с операционными оболочками TopView и Microsoft Windows. При
этом программа  пользователя, обращающаяся  к библиотекам системы,
может выполняться  в режиме  фоновой задачи. Система раcсчитана на
применение компилятора  языка Си фирмы Microsoft версии 2.00 и вы-
ше. Она предоставляет пользователю следующие возможности:
   - организация такого  числа окон, которое ограничено только ре-
сурсами ПЭВМ;
   - использование файлов  неограниченной длины, записанных в коде
ASCII, для  просмотра в окне (при этом осуществляется автоматичес-
кая горизонтальная и вертикальная прокрутка окна);
   - организация перекрытия  окон в зависимости от приоритета окна
(ключа в структуре WINDOW);
   - организация пользовательского  меню, которое может иметь дли-
ну, превышающую размеры окна;
   - использование функций  работы со  строками, которые позволяют
размещать или изменять информацию на экране;
   - создание буфера экрана, который облегчает управление и выдачу
на экран файлов, содержащихся в памяти. Эти файлы могут быть любо-
го размера, и данные могут динамически пересылаться на экран;
   - запоминание информации  о параметрах окна в структуре WINDOW,
которая занимает около 50 байт (сами исполняемые модули для работы
с окнами  имеют малые  размеры, что  является преимуществом данной
системы);
   - определение цвета  и вида  границ окна пользователем (система
также позволяет  высвечивать часть текста в окне заданными атрибу-
тами);
   - занесение информации  в окно  по заданным  ключам с переносом
слов и автоматической прокруткой полного экрана;
   - копирование информации,  содержащейся в  окне, в  файл или на
печатающее устройство в заданном формате;
   - использование функций, позволяющих работать с клавиатурой;
   - считывание и сохранение содержащихся в окне символов и их ат-
рибутов для дальнейшего использования;
   Отметим, что  система позволяет  работать с  двумя графическими
адаптерами: EGA  и Monochrome  Display Adapter,  а также  содержит
библиотеку для работы с графикой.

   Пакет Vitamin C
   Фирма Сreative Programming Consultants

   Является наиболее мощной системой, предназначенной для создания
многооконного интерфейса.  Ее библиотеки  включают почти 200 функ-
ций. Она  содержит файлы  с исходными текстами модулей, библиотеки
для различных  моделей памяти,  демонстрационные примеры,  а также
несколько сервисных  программ. Как и все системы подобного класса,
Vitamin C включает в себя несколько групп функций, позволяющих ра-
ботать с:
   - окнами (изменение  размеров окна,  его перемещение, изменение
атрибутов части  или всего окна, наложение окон друг на друга, вы-
деление яркостью или цветом части информации в окне, очистку части
или всего  экрана, а также занесение необходимой информации в поле
верхней и  нижней границы  окна; осуществление  горизонтальной или
вертикальной прокрутки окон);
   - файлами (считывание информации из файла и занесение ее в окно
с заданными  или определяемыми  по умолчанию атрибутами, занесение
информации из окон в файл);
   - курсором (установка  размеров курсора, установка позиции кур-
сора в  окне по  абсолютным координатам; относительное перемещение
курсора в  окне, прокрутка  содержимого окна вверх или вниз на за-
данное количество  строк и вправо или влево на заданное количество
позиций, считывание позиции курсора в окне, занесение и считывание
информации, начиная с текущей позиции курсора);
   - клавиатурой (очистка  буфера клавиатуры,  выдача кода нажатой
клавиши, помещение считанного символа в текущую позицию курсора).
   Сервисные функции позволяют организовать считывание строки сим-
волов и  занесение ее  в окно  с заданными  или установленными  по
умолчанию атрибутами, определить день недели, число, месяц, год, а
также занести эту информацию в окно и т.д.).
   Таким образом,  система Vitamin C предоставляет разработчику ПО
довольно разнообразные  возможности в решении задач по организации
интерфейса пользователя.
   Отметим, что  пакеты Vitamin  C и Window for C имеют библиотеки
функций работы  с окнами  для всех  моделей памяти, используемых в
языке программирования Си, в пакет же C Power Window такие  библи-
отеки не  включены. Принципиальное  различие между системами обус-
ловлено разными  подходами к  организации многооконного интерфейса
пользователя. Система  C_SCAPE, например, позволяет увидеть на эк-
ране то,  что будет получено при использовании данного фрагмента в
программе, а  системы Window for C, C Power Window, C Tools Plus и
Vitamin C для  инициализации окон предоставляют готовые структуры,
включающие одни  и те  же параметры - координаты окон, вид границ,
атрибуты поля  и границ, вид курсора, возможности горизонтальной и
вертикальной прокрутки и т.п. Как правило, такая структура занима-
ет около  50 байт памяти  и ее изначально заданные установки можно
изменять в процессе работы программы. Библиотеки систем существен-
но отличаются  друг от  друга. Лишь  система Window for C содержит
графические функции, необходимые для построения на экране диаграмм
простейшего  вида.   Наиболее  характерной   особенностью   систем
C_SCAPE, C Tools  Plus и  C Power Window является  наличие  в  них
функций, обеспечивающих  построение готовых  меню сразу нескольких
видов; система  Vitamin C  предоставляет возможность  извлечения и
занесения в окна дополнительной информации, как, например, дни не-
дели, числа, месяцы и т.п. По остальным своим возможностям системы
разнятся незначительно.  С точки зрения простоты создания приклад-
ных программ  на основе многооконного интерфейса, все системы тре-
буют от  пользователя определенной квалификации и опыта программи-
рования на  языке Си.  Они значительно отличаются друг от друга по
величине создаваемого  загрузочного кода.  Размер кода минимален у
систем Window  for C и C Power Window (30 Кбайт) для программ, ис-
пользующих лишь  основные операции по манипулированию окнами (ини-
циализация, занесение  информации в  окно из файла и занесение ин-
формации в окно с клавиатуры, выделение информации в окне, переме-
щение и изменение размеров окна, осуществление перекрытия окон, их
удаление). Пакеты Vitamin C и C_SCAPE за счет своей универсальнос-
ти при  тех же  условиях дают  код, приближающийся  по размерам  к
100 Кбайтам. Промежуточной  по данным характеристикам системой яв-
ляется C  Tools Plus,  у которой  загрузочный код составляет около
60-70 Кбайт.

                                                     С.Ансилевский
                                                    А.Смородинский

По материалам:
Software Exchange News. PC Report, 1989, June.
Pascal, Ada & Modula-2, 1988, √6.
New Products: Vitamin C Enhanced. The C User's Journal, 1989, √6.
New Products: C TOOLS PLUS /5.0. The C User's Journal, 1989, √6.
Neil Freeman.  Vitamin C: A Comprehensive Screen Handling Library.
The C User's Journal, 1988, √4.
