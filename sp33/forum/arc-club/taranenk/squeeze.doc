		        ПРОЦЕДУРА  УПАКОВКИ  ДАННЫХ 

			     S Q U E E Z E

	Представляемая процедура SQUEEZE предназначена для упаковки 
данных. Она была построена на основе анализа пакета упаковки EXE - 
файлов LZEXE, в составе которого находился исходный модуль распаков-   
ки (UNLZEXE), написанный на Си. Поэтому процедура SQUEEZE фактически
действует по принципу упаковщика LZEXE.
	Принцип  действия процедуры SQUEEZE следующий:
	Входные данные читаются в буфер размером 0x4500 байт. После
чтения производится поиск во входном буфере повторяющихся последова-
тельностей байтов. При обнаружении повторения последовательности по-
вторяющиеся байты отбрасываются, а в выходной поток выводится длина 
последовательности и расстояние от текущей позиции в буфере данных
до начала предыдущей соответствующей последовательности. Максималь-   
ная длина последовательности 0xff байт, максимальное расстояние меж-    
ду последовательностями 0x2000 байт.
	Применяемый алгоритм упаковки одинаково пригоден для сжатия 
как дублирующихся (например:  ....abcd...........abcd......), так и
повторяющихся (например:  ....eeeeeeeeeeeeeeeeeeeeeee......) после- 
довательностей. Во втором случае длина последовательности будет рав-   
на числу повторяющихся байт без одного, а расстояние между последо- 
вательностями - единице.
	Поиск последовательностей в буфере производится для каждого 
байта. Если последовательность для байта не была найдена, в выходной 
поток выводится признак отсутствия упаковки (единичный бит) и этот
байт. Если последовательность найдена, выводится признак наличия упа- 
ковки (нулевой бит) и информация о последовательности (её размер и 
расстояние до предыдущей). Информация о последовательности при запи-
си пакуется в битовые поля, если это возможно.
	Главными достоинствами процедуры SQUEEZE являются ее просто-
та и достаточно высокая эффективность сжатия. Упаковщик PKZIP версии
1.10 "отказался" сжимать дальше файлы, обработанные процедурой SQUEEZE.
Упаковщик LHICE смог сжать их всего на 5-6%.
	Недостатком процедуры является относительно малая скорость ее
работы, особенно при сжатии больших файлов. Однако быстродействие 
представленной версии возросло в 3-4 раза по сравнению с предыдущей,
так как в ней использованы ассемблерные вставки в местах, наиболее 
критичных по времени выполнения. Процедура распаковки не изменилась с 
предыдущей версии.
	Процедура упаковки принимает в качестве параметров два указа-
теля на открытые файлы - входной и выходной, и возвращает размер вы- 
ходного файла в байтах или -1 в случае ошибки:

                long squeeze (FILE *inf, FILE *outf)

	Процедура распаковки принимает в качестве параметров два указа-
теля на открытые файлы - входной и выходной, и возвращает 0 в случае
успешного завершения или -1 в случае ошибки:

                int    unsqu (FILE *ifile,FILE *ofile)

	Представленные процедуры предназначены для работы с файлами. 
Однако при необходимости их можно легко адаптировать для работы с мас- 
сивами в памяти (например, для сохранения изображений).
	Проверка процедур упаковки и распаковки осуществляется с помо-
щью тестовой программы SQ (модуль SQ.C). При ее запуске ей передаются 
три параметра командной строки - имя входного файла, промежуточного фай-
ла (упакованного) и выходного файла (распакованного). Программа SQ про-
изводит упаковку и распаковку входного файла путем вызова процедур 
SQUEEZE и UNSQU, а затем сравнивает входной и выходной файлы.
	В дальнейших модификациях автор надеется увеличить быстродейст-
вие процедуры упаковки и довести его до быстродействия LZEXE.
	Тех, кого заинтересует данная разработка, автор просит сообщать
о возможно найденных способах увеличения скорости работы процедур и 
ошибках в них (если найдутся) по телефону 446-26-52.

						    Тараненко Игорь
						    11/03/1991
