<HTML>
<HEAD><TITLE>Турбо-Бейсик - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng16575.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ngcca6.html">[^^Up^^]</A>
<A HREF="ng1912a.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
      Этот тип  файлов  состоит  из записей,доступ к которым возможен в
 любой последовательности.Места под данные эти файлы  занимают  меньше,
 т.к. хранимые на диске данные не преобразуются в коды ASCII.
      Вообще говоря,файлы с этой организацией более  привлекательны для
 баз  данных,чем файлы с последовательным доступом,хотя и они не лишены
 недостатков:Вы не можете заглянуть внутрь этих файлов с помощью редак-
 тора  текстов  или  вывести  их на печать,сохраняя при этом смысл фай-
 ла.Перенос этих файлов на другие компьтеры или языки возможно потребу-
 ет   их   дополнительной   трансляции.Например,интерпретирующий  Basic
 использует нестандартный формат MICROSOFT для значений с плавающей за-
 пятой,а Turbo-Basic - стандартное соглашение IEEE.Поэтому файлы с про-
 извольным доступом Basic и Turbo-Basic не совместимы друг с другом.
      Мы имеем  четыре  специальные  функции для решения этой проблемы:
 CVMS и CVMD для преобразования числовых полей формата MICROSOFT в чис-
 ла  с  одинарной  и  двойной точностью,и MKMS$ и MKMD$ для превращения
 значений одинарной и двойной точности в цепочки формата MICROSOFT.
      Основным преимуществом файлов с произвольным организацией являет-
 ся свободный доступ к любой записи файла без каких-либо затруднений.
      В то  же  время эти файлы 'расточительны' на предмет пространства
 диска,т.к.  размер записей файла устанавливается одинаковым  и  равным
 длине  самой  длинной  записи.Но при записи чисел файлы с произвольной
 выборкой позволяют сэкономить дисковое пространство,т.к.  числа одного
 типа занимают нa диске строго определенное пространство,в то время как
 в файле последовательного доступа числа требуют  столько  байт,сколько
 они имеют знаков в коде ASCII.
      При работе с файлами произвольного доступа следуйте  правилам:
 1. Открыть файл и определить длину каждой записи:

  <B>    OPEN filespec AS [#] filenum LEN = record.size</B>

 Параметер LEN указывает,что файл открывается для прозвольного доступа.
 После открытия файла Вы можете читать с него информацию или записывать
 ее.
 2. Выполнить оператор FIELD для определения размеров полей записи:

<B>      FIELD filenum,width AS string-var [width AS string-var] ...</B>

 По результатам работы оператора FIELD формируется буфер  обмена  между
 диском и ОЗУ.
 3. Перед записью данных на диск заполните буфер обмена с помощью опера
 торов  LSET и RSET.Числа перед этой операцией должны преобоазовываться
 в цепочки с помощью соответствующих функций.После заполнения полей за-
 писи используйте оператор PUT для записи данных на диск.
 4. Для считывания данных из файла в буфер  используйте  оператор  GET.
 При  выборке данных из буфера преобразуйте числовые данные из цепочной
 формы.
 5. По окончанию работы закройте файл (CLOSE). Сведем операторы и функ-
 ции Turbo-Basic,управляющие файлами произвольного доступа в таблицу:
..page18

<B> ---------------------------------------------------------------------</B>
<B> Оператор/функция                        Операция</B>
<B> ---------------------------------------------------------------------</B>
<B> CLOSE              Оканчивает операции на файле(ах)</B>
<B> CVI,CVL,CVS,CVD    Преобразует цепочку знаков в соответствующий число-</B>
<B>                  вой тип</B>
<B> FIELD              Определяет размеры полей записи</B>
<B> GET                Считывает запись</B>
<B> LOC                Определяет номер последней считанной записи</B>
<B> LSET,RSET          Подготовка поля для записи</B>
<B> MKI$,MKL$,MKS$,    Преобразует соответствеющие числовые типы в строки</B>
<B> MKD$</B>
<B> MKMS$,MKMD$,       Функции трансляции формата MICROSOFT</B>
<B> CVMS,CVMD</B>
<B> OPEN               Открывает файл для чтения/записи</B>
<B> PUT                Записывает запись</B>
<B> ---------------------------------------------------------------------</B>

 Далее следует типовая программа обработки файлов с произвольной выбор-
 кой (данные взяты из программы с почтовым перечнем):

<B>      OPEN "ADD.DTA" AS #1 LEN=81</B>
<B>      FIELD #1,25 AS name$,25 AS addres$,15 AS city$,2 AS state$,_</B>
<B>             4 AS zip$,2 AS class$,8 AS contrib$</B>
<B>      INPUT "Which record do you want to see: ",recnumber</B>
<B>      GET #1,recnumber</B>
<B>      PRINT "Data for record"recnumber</B>
<B>      PRINT "Name: "name$</B>
<B>      PRINT "Addres: "addres$</B>
<B>      PRINT "City/State/Zip: "city$,state$,CVL(zip$)</B>
<B>      PRINT "Class: "CVI(class$)</B>
<B>      PRINT "Most recent contrib: "SVL(contrib$)</B>
<B></B>
 Примечание:никогда не используйте переменные поля,определенные в  опе-
 раторе  FIELD,в операциях присваивания с левой стороны,т.к.  тогда они
 теряют свою связь с буфером.Например,после

<B>      zip$=a$</B>

 переменная zip$ больше не относится к буферу обмена.
</PRE>

</BODY>
</HTML>
