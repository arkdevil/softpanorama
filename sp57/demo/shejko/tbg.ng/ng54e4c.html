<HTML>
<HEAD><TITLE>Турбо-Бейсик - Long Entry</TITLE></HEAD>
<BODY>

[&lt;&lt;Previous Entry]
<A HREF="ng54de5.html">[^^Up^^]</A>
<A HREF="ng56533.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>


         Турбо-Бейсик  поддерживает способность обработки на заднем фоне, из-
   вестную как отслеживаниесобытий, которая может сразу и упрощать и ускорять
   определенные операции. Отслеживание событий означает получение  Турбо-Бей-
   сиком возможности проверить различные "события", такие как назначение спе-
   циальной  клавиши вместо необходимости писать заявления для выполненияэтой
   проверки самим программистом. Турбо-Бейсик способен производить  эту  про-
   верку между всеми заявлениями вашей программы, гарантируя возможно наиско-
   рейший  ответ.  Если  и когда происходит событие, автоматически вызывается
   подпрограмма, которую вы определили для обработки этого события.
         Можно проверить следующие типы событий:
         Клавишные удары: Была ли нажата F10? Или планка пробела?  Вы  можете
   проверить до 20 различных клавиш в одно и то-же время прогона.
         Состояние таймера обратного отсчета - управление дается подпрограмме
<B>          -  ловушке по истечению n секунд; например для обновления каждые 60 секунд</B>
<B>   экранных часов.</B>
<B>         - нажатие кнопок ручек управления</B>
<B>         - задействование светового кода</B>
<B>         - литеры, прибывающие на последовательное  внешнее  устройство  (для</B>
<B>   коммуникационных областей применения)</B>
<B>         -  состояние музыкального буфера заднего фона ( с целью проверки не-</B>
<B>   обходимости загрузки в него дополнительного количества нот)</B>
         Вы можете получить краткое описание того, что доступно  отслеживанию
   и  того,  что  недоступно,  в нулевом разделе главы 5 " Словарь-справочник
   Турбо-Бейсика" данного руководства.  Большинство  заявлений  "ON  что-либо
   GOSUB"  относится к отслеживанию событий.
         Вам  нет необходимости специфицировать Турбо-Бейсику, что вы желаете
   генерирования кода отслеживания событий. Код отслеживания событий  генери-
   руется автоматически всякий раз, когда компилятор встречает какую-либо от-
   слеживаемую инструкцию.


<B>         Пример</B>

         Представьте бухгалтерскую программу с дюжинами меню для выбора и эк-
   ранов для заполнения. Как автор этой сложной области применения, вы желае-
   те  включить  экран помощи, который предоставляет базисную информацию о ее
   применении; например, клавишные удары, необходимые для редактирования  по-
   лей данных или отбрасывания какого-то выбора из меню. Ради простоты систе-
   ма  помощи,  которую мы намареваемся описать, не является чувствительной к
   контексту; т.е. без относительно к тому, где вы находитесь в  программе  в
   момент обращения за помощью, всегда появляется один и тот-же текст.

         Давайте  сделаем  клавишей  помощи F1 . Другими словами, когда бы не
   нажималась F1, каким бы не был текст, на экране будет даваться текст помо-
   щи.
         Способность Турбо-Бейсика к отслеживанию событий позволяет вам коди-
   ровать возможность отображения текста помощи в одном месте, а вызывать его
   из всех мест программы без дополнительных усилий. Без отслеживания событий
   вам пришлось бы проверить состояние F1 ( с помощью  GOSUB  к  подпрограмме
   помощи)  в каждом месте программы, где пользователь был-бы обязан затрачи-
   вать некоторое количество времени.
         Прежде всего, поскольку имеется клавиша, которую вы отслеживаете (не
   кнопка ручки управления или световое перо), вы должны использовать заявле-
   ние ON KEY (n) для определения подпрограммы, которая получает  управление,
   когда-бы ни была нажата F1. n- это целое выражение,определяющее подлежащую
   отслеживанию  клавишу;  так получилось, что 1 есть имя, по которому ON KEY
   узнает функциональную клавишу 1.
<B>         ON KEY (1) GOSUB  отобр.помощи текст</B>

         Этой строкой говорится: Когда включается ловушка клавиши,  проверить
   между  всеми  заявлениями  не  нажата ли уже F1. Если она уже была нажата,
   вызвать подпрограмму ОтобрПомощи и Текст; если это не было, исполнять сле-
   дующее заявление. Сама подпрограмма ОтобрПомощиТекст не многим больше, чем
   ряд заявлений PRINT. Поскольку нет желания разрушить ту  часть  программы,
   которая  была прервана, перед тем, как что-нибудь будет делаться, сохраня-
   ется текущее положение курсора, а затем оно восстанавливается. Подпрограм-
   ма выводит текст помощи в четырех нижних строках экрана, где по соглашению
   никакая другая часть программы не записывается.
<B>         ОтобоПомощиТекст</B>
<B>         ----------------</B>
<B>         Старая Курсстр % = POS (0)% старая курсстр = CSRLIN</B>
<B>         LOCATE 22.1</B>
<B></B>

<B>        PRINT 'Эта программа была отгружена с фантастическим руководством."</B>
<B>         PRINT "тщательно подготовленным профессиональными писателями при ог-</B>
<B>   ромных расходах".</B>
<B>         PRINT"Пользуйтесь ею. Для продолжения нажмитеEnter (ввод).",пусто $</B>
<B>         LOCATE старая курсстр %, старая курсстр</B>
<B>         RETURN</B>
        Теперь, когда подпрограмма - ловушка уже заявлена (код, который будет
   получать управление при нажатии F1), с помощью заявления KEY (n) включает-
   ся отслеживание;
<B>         KEY (10) ON</B>
         После исполнения этого заявления, Турбо-Бейсик переходит в режим от-
   слеживания  событий.  Между  исполнениями  каждого следующего заявления он
   быстро провепяет не нажата ли уже F1. Если  нет,  исполнение  продолжается
   нормально с переходом к следующему заявлению. Если F1 обнаруживается нажа-
   той,  то вызывается подпрограмма Отобр Помощи Текст. Когда она дает RETURN
   (возврат), управление переходит к следующему заявлению прерванной последо-
   вательности.
         Когда происходит захват события, исполняется неявное заявление  "ос-
   танов  по ловушке" с целью удержать подпрограмму-ловушку от повторного са-
   мовызова из себя самой (и переполнения стека). Закрывающее RETURN подпрог-
   рамма обработки ловушки автоматически выполняет неявное заявление "ловушка
   включена", если в подпрограмме, в ее теле, не исполняется явное  заявление
   "ловушка  включена".  Слово ловушка вы можете заменить словами PEN (перо),
   PLAY (играть),KEY(клавиша),STRIC ( кнопка ручки управления), TIMER(таймер)
   и COM (коммуникация)

</PRE>

</BODY>
</HTML>
