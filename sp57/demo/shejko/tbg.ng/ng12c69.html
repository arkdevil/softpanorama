<HTML>
<HEAD><TITLE>Турбо-Бейсик - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng12a75.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ngcca6.html">[^^Up^^]</A>
<A HREF="ng13b76.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
      Есть два  вида функций:стандартные (заранее определенные) функции
 (например,COS или LEFT$)  и  определяемые  ползователем,которые  могут
 быть   одно   или   многострочными  (подробнее  см.  Гл.5  'Справочник
 TurboBasic').
      Синтаксис для  определения однострочной функции представляет соб-
 бой:

<B>      DEF FNidentifier [(parameter list)]=expression</B>

 где
 identifier (идентификатор) представляет собой имя,однозначно определя-
 ющую данную функции;
 parameter list  (перечень  параметров) - необязательная последователь-
 ность параметров,разделенных запятыми (максимальное  количество  пара-
 метров - 16);

 <B>expression (выражение) </B>- определяет  возвращаемые  функцией  значения.

 Например,рассмотрим  метеорологическую программу,которая должна преоб-
 разовывать значение температуры либо в градусы по Цельсию, либо по Фа-
 ренгейту.

<B>      temp=100</B>
<B>      PRINT FNFtoC(temp),FNCtoF(temp)</B>
<B></B>
<B>      DEF FNFtoC(degrees)=(degrees-32) * .555555</B>
<B>      DEF FNCtoF(degrees)=(1.8 * degrees)+32</B>
<B></B>
      В отличие от интерпретирующего Basic,Turbo-Basic позволяет созда-
 вать многострочные функции:

<B>      DEF FNidentifier [(parameter list)]</B>
<B>      [variable declaration]</B>
<B>      .</B>
<B>      . statements</B>
<B>      .</B>
<B>      [EXIT DEF]</B>
<B>      [FNfunction name=expression]</B>
<B>      END DEF</B>

 где
 identifier (идентификатор) объявляет имя функции;
 parameter list (перечень параметров) -  необязательная  последователь-
 ность  формальных параметров,разделенных запятыми.
 В качестве примера рассмотрим многостроковую функцию Factorial, вычис-
 ляющую факториал числа:

<B>      100 DEF FNFactorial#(x%)</B>
<B>      110   LOCAL i%,total#</B>
<B>      120   IF x%&lt;0 OR x%&gt;170 THEN FNFactorial=-1:EXIT DEF</B>
<B>      130   total#=1</B>
<B>      140   FOR i%=x% TO 2 STEP -1</B>
<B>      150     total#=total# * i%</B>
<B>      160   NEXT i%</B>
<B>      170   FNFactorial#=total#</B>
<B>      180 END DEF</B>

 Функция начинается оператором DEF FNname (name - имя функции),а конча-
 ется оператором END DEF.Строка 100 присваивает функции  имя,а  в  пос-
 ледствии и тип.FNFactorial имеет один целочисленный формальный параме-
 тер  x%.Строка  110  объявляет   пару   локальных   переменных   (т.е.
 переменных,создаваемых  лишь в пределах данной функции или процедуры).
 Строка 120 осуществляет поиск ошибочных аргументов (либо отрицательно-
 го  числа,либо  числа,факториал которого больше 10^308).В этом случае
 Вы устанавливаете значение,возвращаемое функцией,в -1 и  переходите  к
 оператору  EXIT DEF,который является для функции тем же,чем RETURN для
 подпрограммы.Если аргумент функции корректен,то выполняется вычисление
 факториала (строки 130-160).В строке 170 определяется значение,возвра-
 щаемое функцией.Функция Factorial завершается в строке  180 оператором
 END  DEF (аналогичен EXIT DEF).Поскольку параметер Factorial определен
 как целочисленный,то аргументы с плавающей запятой округляются до  це-
 лых чисел (например,при FNfactorial(2.7) будет вычисляться FNFactorial
 (3)).

<B>            Формальные и фактические параметры.</B>

      Переменные в списке  параметров  определения  функции  называются
 формальными и служат лишь для определения функции и полностью отделены
 от других переменных программы с одинаковым именем:

<B>      100 DEF FNArea(x,y)=x * y</B>
<B>      110 x=56</B>
<B>      120 PRINT x,FNArea(2,3),x</B>

 Переменная x в строках 110 и 120 не связана с формальным параметром x
 в строке 110 определения функции.
      Значения,переданные функции  во  время  прогона,часто  называются
 фактическими  параметрами.В  последнем  примере это были числа 2 и 3 в
 сторке 120.Фактические параметры могут быть как постоянными,так и  пе-
 ременными величинами:

<B>      a=2:b=3</B>
<B>      PRINT FNArea(a,b)</B>

 Функции могут возвращать любой из 4 типов чисел,а так же цепочные  ти-
 пы.Тип  функции,подобно  типам переменных,управляется ее именем (здесь
 используются знаки объявления типа и оператор типа DEF:

<B>      DEF FNRepeatFirst$(a$)=LEFT$(a$,1)+a$</B>
<B>      PRINT FNRepeatFirst("Hello")</B>
</PRE>

</BODY>
</HTML>
