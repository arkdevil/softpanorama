<HTML>
<HEAD><TITLE>Турбо-Бейсик - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng15e1b.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ngcca6.html">[^^Up^^]</A>
<A HREF="ng17fc6.html">[Next Entry&gt;&gt;]</A>
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
      Turbo-Basic предлагает  три  различных  способа хранения и поиска
 информации на диске:чтение/запись последовательного файла,файла с про-
 извольным  доступом и двоичного файла.Каждый из них имеет свои преиму-
 щества и недостатки и выбор того или иного типа файла зависит от Ваших
 конкретных условий.

<B>                 Состав файла базы данных.</B>

      Традиционная система  программирования  разбивает файлы данных на
 так называемые записи,каждая из которых состоит из одного или несколь-
 ких полей.Например,в программе с почтовым перечнем имеется три записи:


<B> ---------------------------------------------------------------------</B>
<B> Имя/фамилия   Адрес         Город       Штат   Код     Класс   Вклад</B>
<B> ---------------------------------------------------------------------</B>
<B> Cathy Harvej  1010 E.Red    Sioux City  IA     51103   73      0.00</B>
<B> Andrew Rich   37 Anderson   Houston     TX     77018   58      500.00</B>
<B> Larry Irving  3210 Main     Lindsborg   KS     67456   81      0.00</B>
<B> ---------------------------------------------------------------------</B>

 Каждая запись состоит из 7 полей.Обычно делается различие между число-
 выми и цепочными полями.В этом примере три поля - числовые,остальные -
 цепочные.

<B>                  Последовательные файлы.</B>

      Обработка файлов по принципу  последовательных  наиболее  проста.
 Все данные в этом файле должны содержать текстовую информацию и разде-
 ляться стандартными разделителями текста  (возврат  каретки,запятые),в
 связи с чем этот тип файлов совместим с файлами текстовых редакторов и
 может легко переноситься на другие типы компьютеров.

<B>      Для записи данных в файл выполнить последовательность:</B>
 1. Открыть файл (команда OPEN) в режиме записи (режим OUTPUT  - запись
 в начало или режим APPEND - дозапись в конец).
 OUTPUT :  если файл не существыет,то создается новый файл,в  противном
 случае  он  стирается и затем файл обрабатывается как новый.
 APPEND :  если файл не существует, то создается новый файл,в противном
 случае  данные  дозаписываются  в  конец  файла.
 2. Вывести данные в файл,используя операторы WRITE #,PRINT  #,PRINT  #
 USING.
 3. После завершения работы с файлом закрыть его оператором CLOSE.

<B>      Для считывания последовательного файла:</B>
 1. Открыть файл (оператор OPEN) в режиме чтения (режим INPUT).
 2. Считать данные из файла,используя операторы INPUT #,INPUT$,LINE
 INPUT #.
 3. После завершения работы с файлом закрыть его оператором CLOSE. Под-
 робнее см. Гл.5 'Каталоги Turbo-Basic'.
      Недостаток этого  метода заключается в последовательном просмотре
 записей файла,начиная с первой записи.Т.е.  если Вы хотите добраться к
 последней записи файла,состоящего из 23000 записей,то Вы должны прежде
 просмотреть предыдущие 22999 записи.
      Последовательные файлы,поэтому,лучше  всего  подходят для решения
 задач последовательной обработки данных или  когда  все  данные  могут
 храниться  при обработке в памяти ЭВМ.Это позволит Вам целиком считать
 весь файл (например в массив),быстро откорректировать его,а затем  за-
 писать обратно на диск.
      Но в то же время это метод позволяет создавать  записи переменной
 длины,что  бывает иногда очень важно.При использовании Turbo-Basic мо-
 гут создаваться два типа последовательных  файлов:(1) последовательный
 файл  с ограниченным полем,где каждое поле в каждой строке файла огра-
 ничивается специальным знаком;(2) файлы с неограниченным размером  по-
 ля.Эти  типы  создаются  операторами WRITE # и PRINT # соответственно.
 Способ чтения из этих файлов одинаковый.

<B>        Последовательные файлы с ограниченным полем.</B>

      При рассмотрении последовательного файла видно,что данные в файле
 разделяются  запятыми  и  любые  цепочки заключаются в двойные кавычки
 (кавычки предохраняют Вас от хлопот с вкрапленными запятыми  в  цепоч-
 ке).Рассмотрим  формирование и внутреннее представление последователь-
 ного файла ADD.BAS:

<B>      OPEN "ADD.BAS" FOR OUTPUT AS #1</B>
<B>      String$="This is a string of text"</B>
<B>      Integer%=1000</B>
<B>      Floating!=30000.1234</B>
<B>      WRITE #1,String$,Integer%,Floating!</B>
<B>      String$="Appol"</B>
<B>      Integer%=-32767</B>
<B>      Floating!=12345.54296875</B>
<B>      WRITE #1,Integer%,String$,Floating!</B>
<B>      CLOSE #1</B>
<B>      END</B>

      Содержимое файла ADD.BAS:
      "This is a string of text",1000,30000.1234
      -32767,"Appol",12345.54296875

 Самым выжным здесь является то,что оператор WRITE #  записывает данные
 в том виде,в котором оператор INPUT # хочет их найти.  Следующая прог-
 рамм считывает данные из последовательного файла:

<B>      OPEN "ADD.BAS" FOR INPUT AS #1</B>
<B>      String$="":Integer%=0:Floating!=0</B>
<B>      INPUT #1,String$,Integer%,Floating!</B>
<B>      PRINT String$,Integer%,Floating!</B>
<B>      String$="":Integer%=0:Floating!=0</B>
<B>      INPUT #1,Integer%,String$,Floating!</B>
<B>      PRINT Integer%,String$,Floating!</B>
<B>      CLOSE #1</B>
<B>      END</B>

 Важно заметить,что программа не будет работать правильно,если файл был
 сформирован с помощью команды PRINT #,а не WRTIE #.

<B>           Неограниченные последовательные файлы.</B>

      Данные в  этих файлах представлены так,как они выглядят на экране
 дисплея ил после печати:

<B>      OPEN "ADD.BAS" FOR OUTPUT AS #1</B>
<B>      String$="This is a string of text"</B>
<B>      Integer%=1000</B>
<B>      Floating!=30000.1234</B>
<B>      PRINT #1,String$,Integer%,Floating!</B>
<B>      String$="Appol"</B>
 <B>     Integer%=-32.767</B>
<B>      Floating!=12345.54296875</B>
<B>      PRINT #1,USING "+##### &amp; ##.##^^;Integer%,String$,Floating!</B>
<B>      CLOSE #1</B>
<B>      END</B>

      Содержимое файла ADD.BAS:
      This is a string of text     1000        30000.1234
      -32767 Appol 12.35E+03

 Если Вы попытаетесь считать данные из этого файла с  помощью оператора
 INPUT  #1,String$,Integer%,Floating!,то  в  строковую переменную будет
 считано слово This,а затем программа попытается считать числовое  зна-
 чение,наткнется  на  цепочку  is и выдаст ошибку.Поэтому прменим здесь
 другие операторы для считывания:

<B>      OPEN "ADD.BAS" FOR INPUT AS #1</B>
<B>      String$=""</B>
<B>      String$=INPUT$(80,1)</B>
<B>      PRINT String$</B>
<B>      LINE INPUT #1,String$</B>
<B>      PRINT String$</B>
<B>      CLOSE #1</B>
<B>      END</B>

 Сведем операторы  и  функции Turbo-Basic,управляющие последовательными
 файлами, в таблицу:
..page16

<B> ---------------------------------------------------------------------</B>
<B> Оператор/функция                        Операция</B>
<B> ---------------------------------------------------------------------</B>
<B> CLOSE              Оканчивает операции на файле(ах)</B>
<B> EOF                Сигнализирует о достижении конца файла</B>
<B> INPUT #            Считывает запись (строку текста) в указанную</B>
<B>                  переменную(ые)</B>
<B> INPUT$             Считывает n знаков в цепочную переменную</B>
<B> LINE INPUT #       Считывает целую строку в цепочную переменную</B>
<B> OPEN               Открывает файл для режима INPUT,OUTPUT,APPEND и</B>
<B>                  присваивает ему номер</B>
<B> PRINT #,           Заносит данные в файл без ограничительных запятых</B>
<B> PRINT # USING</B>
<B> WRITE #            Заносит данные в файл без ограничительных запятых</B>
<B> ---------------------------------------------------------------------</B>
</PRE>

</BODY>
</HTML>
