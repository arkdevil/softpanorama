<HTML>
<HEAD><TITLE>Турбо-Бейсик - Long Entry</TITLE></HEAD>
<BODY>

<A HREF="ng5a86a.html">[&lt;&lt;Previous Entry]</A>
<A HREF="ng56f95.html">[^^Up^^]</A>
[Next Entry&gt;&gt;]
<A HREF="menu.html" >[Menu]</A>
<A HREF="info.html">[About The Guide]</A>
<HR>
<PRE>
         Предположим  мы  подошли  к алгоритму, для которого требуется, чтобы
   некоторое нулевое значение, скажем 100, быстро загружалось в  каждый  эле-
   мент 200-элементного целого массива. Это можно реализовать в цикле, подоб-
   ном следующему:
<B>         DEFINT a-n</B>
<B>         DIM a (199)</B>
<B>         FOR n=0 O 199</B>
<B>         a(n) = 100</B>
<B>         NEXT n</B>

         К  сожалению  для  вашей конкретной области применения эта схема "по
   элементу зараз" слишком тихоходна. Поэтому вы  ищете  ассемблерно-языковое
   решение  проблемы  установки  каждого  члена массива в некоторое значение,
   насколько возможно, мгновенной.
         Как упоминалось ранее, ассемблерно-языковую процедуру вы вызываете в
   Турбо-Бейсике точно так-же как и  обычную  Бейсик-процедуру.  Определением
   процедуры  специфицируется,  что  вы  используете INLINE-код ассемблерного
   языка. Взгляните на следующий программный пример:
<B>         DEFINT A-Z</B>
<B>         DIM Массив (200)</B>
<B>         CALL Заполнить массив (0)</B>
<B>         FOR  = 0 TO 199</B>
<B>         PRINT A(1)</B>
<B>         NEXT I</B>
<B>         END</B>
<B>         SUB Заполнить INLINE</B>

<B>         $INLINE &amp;H55 'PUSH BP - хранить базисный указатель</B>
<B>         $INLINE &amp;H89, &amp;HES 'MOV BP,SP - переместить стековый указатель в BP</B>
<B>         $INLINE &amp;HC4,H7E,&amp;HO6' LES DI (BP+6) - адрес смещения парам.</B>
<B>         $INLINE &amp;HEB,&amp;H64,&amp;HDO' MOV AX,64H - констанкта  - заполнить</B>
<B>         $INLINE &amp;HB9,&amp;HCB,HDO 'MOV CX,CBH -длина - заполнить</B>
<B>         $INLINE &amp;HFC      ' OLD -очистить флаг направления</B>
<B>         $INLINE &amp;HF3      'REP- заполнить слова</B>
<B>         $INLINE &amp;HAB      'STOSW</B>
<B>         $INLINE $H5D      ' POP BP - восстановить базовый указатель</B>
<B>         END SUB</B>

         Процедура Заполнить вINLINE -коде на языке ассемблера не  предназна-
   чается  для  заботы  о массивах. Все, что от нее требуется - это загружать
   некоторое постоянное значение определенное число раз в память,  задаваемую
   особой  начальной  точкой.  Это  будет делаться посредством подачи первого
   элемента в массив А.

         На рис. С-1 представлена упрощенная карта периода прпогона.

<B>       0000:0000</B>
<B>              --------------------------------------</B>
<B>                           DOS</B>
<B>              ---------------------------------------</B>
<B>             Другие резидентные программы            Сайдкик,Суперкей,Лайтнинг</B>
<B>             ------------------------------------------</B>
<B>              Турбо-Бейсик</B>
<B>              Система периода прогона</B>
<B>              Зона данных</B>
<B>              Стек периода прогона                           FRE (-2)</B>
<B>         -----------------------------------------------</B>
<B>             Зона пользовательских программ            До 16 по 64К</B>
<B>                                                       Сегменты пользователь-</B>
<B>                                                       ского кода yyyy:0000</B>
<B>         --------------------------------------------------</B>
<B>               Скалярный сегмент</B>
<B>               Опрашиваемые константы</B>
<B>               Скалярные переменные</B>
<B>               Строчные дескрипторы</B>
<B>               Массивные дескрипторы</B>
<B>         -------------------------------------------------- yyyy:FFFF</B>
<B>               Пространство массивов                       АКУ (-1)переменный</B>
<B>                                                                   размер</B>
<B></B>
<B>  xxxx:0000 ----------------------------------------------</B>
<B>                 Строчный сегмент                            FRE (SS)</B>
<B>         --------------------------------------------------</B>
<B> xxxx:FFFF      Свободное пространство                        MEMSET</B>
<B>         -----------------------------------------------------</B>
<B>       A000:FFFF ----------------------------------------------</B>
<B></B>
               Рисунок С-1. Карта периода прогона.
</PRE>

</BODY>
</HTML>
