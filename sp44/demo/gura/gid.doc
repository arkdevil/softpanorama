
















                           ГУРА А.В.


E  ПАКЕТ ДЕЛОВОЙ ГРАФИКИ  Г И Д.   F
E            ДЛЯ ПЭВМ              F


                       ОПИСАНИЕ ПРИМЕНЕНИЯ


























                         Днепропетровск
                              1990



                            - 1 -


                         Аннотация

     Документ предназначен для программистов, занимающихся
вопросами использования деловой графики в своем программном
обеспечении.
     В документе подробно описаны назначение, область
применения, функции, интерфейсная часть с примерами
конкретных программ и порядок работы с пакетом деловой
графики ГИД.


                            - 2 -


                         Содержание

         Аннотация . . . . . . . . . . . . . . . 1

     1.  Назначение  . . . . . . . . . . . . . . 3

     2.  Условия применения  . . . . . . . . . . 4

     3.  Описание пакета программ  . . . . . . . 5

     3.1.Описание функциональной части . . . . . 5

     3.2.Описание интерфейсной части . . . . . . 6

     4.  Порядок работы с пакетом программ . . . 12


     Приложение 1. Пример заполнения структуры
                   интерфейсной части  . . . . . 15

                1.1. Интерфейсная часть  . . . . 15

                1.2. Контрольный пример  . . . . 17

     Приложение 2. Примеры вывода на печать
                   графического изображения  . . 21

     Приложение 3. Состав дистрибутивного
                   носителя  . . . . . . . . . . 26

                            - 3 -


     1. Назначение

     Пакет деловой графики ГИД (графики и диаграммы)
предназначен для представления числовой информации в удобной
для восприятия графической форме. Источником числовой
информации может быть либо база данных, либо задача
пользователя. Тип графического изображения (диаграмма или
график), полученного в результате работы пакета, зависит от
запроса пользователя.
     Пакет обеспечивает следующие возможности:
     расчет и отображение на экране дисплея секторной
диаграммы;
     расчет и отображение на экране дисплея гистограмм (двух
или трехмерных по выбору пользователя);
     расчет и отображение на экране дисплея графиков;
     вывод на экран дисплея краткой информации о каждом
элементе изображения;
     ведение динамической подсказки;
     поддержка многооконного режима (вывод изображения в
заданное окно, вывод нескольких изображений на экран,
перемещение окна по экрану, изменение размеров изображения-
режим мультипликации).
     Работа с окнами реализована в интерфейсном режиме. Для
взаимодействия пользовательских задач с пакетом ГИД
определена структура интерфейсной части.
     Пакет ГИД может быть использован в следующей предметной
области:
     управление предприятием (например, в АРМ руководителя);
     различные экономические расчеты;
     имитационное моделирование.

                            - 4 -


     2. Условия применения пакета

     Пакет может взаимодействовать с внешними данными,
подготовленными задачей пользователя, реализованной на языке
Turbo-Pascal версии 4.0 и выше.
     Пакет может быть использован на ПЭВМ типа IBM PC, PC
XT, PC AT и совместимых с ними компьютерами.
     Минимальная конфигурация ЭВМ должна включать:
     256 Кбайт оперативной памяти;
     накопитель на гибких дисках емкостью 360 Кбайт или
жесткий диск типа "Винчестер";
     любой из дисплеев типа CGA, MCGA, EGA, EGA-64,
EGA-mono, Hercules, ATT400, VGA PC 3270;
     печатающее устройство (необязательно), совместимое с
IBM PC PRINTER или EPSON.
     Пакет деловой графики ГИД функционирует под управлением
операционных систем PC-DOS и MS-DOS версий 3.0 и выше.
     Пакет постовляется на одной дискете. Состав дистрибутив-
ного носителя приведен в Приложении 3.

                            - 5 -


     3. Описание пакета программ

    3.1. Описание функциональной части
    3.1.1. Функциональная часть является основной частью
пакета ГИД, доступ к которой возможен пользователю только
через интерфейсную часть данного пакета.
     Функциональная часть пакета состоит из процедур
Initialize и CloseGid, а также функции StartGid.

     3.1.2. Процедура Initialiaze выполняет последовательно
следующие действия:
     сканирует тип драйвера терминала;
     выбирает наилучший режим для этого драйвера;
     переводит терминал в графический режим;
     определяет максимальную прямоугольную область вывода
изображения;
     записывает координаты левого верхнего угла (MinX и
MinY) и правого нижнего угла (MaxX и MaxY) в интерфейсную
часть для дальнейшей работы пользователя.

     3.1.3. Функция StartGid осуществляет следующее:
     рассчитывает и выводит графическое изображение на экран
терминала ;
     производит работу с окнами (вывод изображения в
заданное окно, вывод нескольких изображений на экран,
перемещение окна по экрану, изменение размеров изображения);
     тестирует интерфейсную структуру данных и выдает код
возврата.
     Код возврата имеет следующую структуру:

        Х    Х
       ─┬─  ─┬─
        │    └───── код ошибки
        └────────── номер описания изображения

     Номер описания изображения при нормальном завершении
имеет значение 0, при ошибке может иметь значения от 1 до 5.
     Код ошибки может принимать следующие значения:
     0 - нормальное завершение;
     1 - ошибка заполнения интерфейсной структуры;
     2 - координаты окна превышают допустимые;
     3 - площадь, занимаемая секторами, не равна 100%
окружности;
     4 - количество элементов изображения превышает
допустимое.


                            - 6 -


     3.1.4. Процедура CloseGid переводит терминал в
текстовый режим и обрабатывает код возврата (если код
возврата не 0, то на экран терминала выводится сообщение об
ошибке).
     Перечень сообщений в зависимости от значений кода
возврата приведен в табл.1.
                                          Таблица 1
     Перечень сообщений по коду возврата

┌────────┬────────────────────────────────────────────────┐
│  Код   │           Сообщение на экране                  │
│возврата│                                                │
├────────┼────────────────────────────────────────────────┤
│ [i]1   │ Ошибка заполнения структуры изображения [i]    │
│        │                                                │
│ [i]2   │ Некорректно задана координата окна             │
│        │ изображения [i]                                │
│        │                                                │
│ [i]3   │ Площади секторов изображения [i] заданы        │
│        │ некорректно                                    │
│        │                                                │
│ [i]4   │ Количество элементов изображения [i]           │
│        │ превышает допустимое                           │
│        │                                                │
├────────┴────────────────────────────────────────────────┤
│ Примечание: i - номер описания изображения (может       │
│                 иметь значения от 1 до 4)               │
└─────────────────────────────────────────────────────────┘

     3.2. Описание интерфейсной части пакета

     Для взаимодействия пользовательских задач
функциональной части пакета ГИД разработана структура
интерфейсной части.
     Пример заполнения структуры интерфейсной части приведен
в Приложении 1.
     Структура интерфейсной части состоит из следующих
элементов:
     DatGid - массив структур переменных (полное описание
массива осуществляет пользователь в зависимости от своих
задач);
     описание констант, используемых при описании массива
DatGid;
     DatBarTyp - описание структуры для формирования первого
элемента гистограммы, используемого при описании массива
DatGid;
     DatPlayTyp - описание структуры для формирования
первого элемента секторной диаграммы, используемого при
описании массива DatGid;
     DatGrafTyp - описание структуры для формирования
первого элемента графика, используемого при описании массива
DatGid;
     GrafixTyp - описание структуры общих переменных для
формирования изображения одного элемента графика,
гистограммы, секторной диаграммы (используется при описании
массива DatGid);

                            - 7 -


     MinX, MinY, MaxX, MaxY - значения координат выводимого
изображения, записываемые в интерфейсную часть процедурой
Initialiaze.
     Описание элементов, используемых в массиве DatGid,
приведены в табл. 2.
     При заполнении пользователем массива DatGid необходимо
учитывать следующие особенности:
     массив DatGid может состоять максимально из пяти
элементов (структур), из которых каждый элемент должен
содержать описание одного вида изображения;
     в каждом элементе массива DatGid может быть описано от
1 до 3 альтернативных групп (график, гистограмма и
диаграмма), заполнять которые необходимо очень внимательно,
потому что может произойти наложение одного типа на другой,
что вызовет ошибочную ситуацию в процедуре StartGid;
     если Cod = BARCOD(Cod = BAR3COD), то элемент структуры
DatGid Common не должен превышать MAXBAR, при Cod = PLAYCOD
Common не должен превышать MAXPLAY, а при Cod = GRAFCOD
Common не превышает MAXGRAF;
     если цвет и штриховка определяются программно, то
пользователь присваивает значение Flag = 0 и не заполняются
определения цвета (Play[i].Color для диаграмм, Bar[i].Color
для гистограмм, Graf[i].Color для графиков)  и  определения
типа штриховки  (Play[i].Font для диаграмм, Bar[i].Font для
гистограмм) или линии (Graf[i].Ln для графиков).


                            - 8 -
                                                  Таблица 2
  Характеристика и порядок заполнения данных пользователем
───────────────┬────────────┬────┬────────────┬──────┬──────
 Идентификатор │Наименование│Дли-│ Возможные  │ Тип  │При-
  описания     │   данных   │на ,│  значения  │изобра│меча-
   данных      │            │байт│            │жения │ние
───────────────┼────────────┼────┼────────────┼──────┼──────
    Name       │Название    │ 40 │            │Диагр.│Любое
               │рисунка     │    │            │график│наиме-
               │            │    │            │гисто-│нова-
               │            │    │            │грамма│ние
               │            │    │            │      │
    Flag       │Выбор режима│ 2  │0-выбирается│То же │
               │для выбора  │    │пакетом;    │      │
               │цвета и     │    │1-выбирается│      │
               │штриховки   │    │пользовател.│      │
               │(тип линии) │    │            │      │
    x1, y1     │Координаты  │ 2  │Целое число,│ -"-  │
               │левого верх.│    │лежащее в   │      │
               │угла окна, в│    │интервале   │      │
               │котором бу- │    │MinX(MinY)- │      │
               │дет выведено│    │MaxX(MaxY) и│      │
               │изображение │    │не превышаю-│      │
               │            │    │щее x2(y2). │      │
    x2, y2     │Координаты  │ 2  │Целое число,│ -"-  │
               │правого ниж.│    │лежащее в   │      │
               │угла окна, в│    │интервале   │      │
               │котором бу- │    │MinX(MinY)- │      │
               │дет выведено│    │MaxX(MaxY) и│      │
               │изображение │    │не меньше   │      │
               │            │    │чем x1(y1). │      │
    Cod        │Параметр оп-│ 2  │BARCOD-2-х  │ -"-  │Данные
               │ределяющий  │    │мерная стол-│      │опре-
               │каким должно│    │биковая диа-│      │деляют
               │быть изобра-│    │грамма      │      │с каки
               │жение       │    │BAR3COD-3-х │      │ми по-
               │            │    │мерная стол-│      │лями
               │            │    │биковая диа-│      │необ-
               │            │    │грамма      │      │ходи-
               │            │    │PLAYCOD-сек-│      │мо в
               │            │    │торная диа- │      │даль-
               │            │    │грамма      │      │ней-
               │            │    │GRAFCOD-гра-│      │шем
               │            │    │фики        │      │рабо-
               │            │    │            │      │тать
               │            │    │            │      │
    Common     │Количество  │ 2  │Положителное│Диаг- │
               │элементов   │    │целое число │раммы,│
               │изображения │    │не превышаю-│графи-│
               │(столбиков, │    │щее для     │ки,ги-│
               │секторов    │    │ст. MAXBAR, │стог- │
               │графиков)   │    │сек.MAXPLAY,│раммы │
               │            │    │граф.MAXGRAF│      │
Play[i].Procent│Указывает % │ 4  │Вещественное│Сектор│
               │занимаемый  │    │число,      │ная   │
               │сектором "i"│    │изменяется  │диаг- │
               │в диаграмме │    │от 1 до 100 │рамма │
               │            │    │            │      │
               │            │    │            │      │

                            - 9 -
                                      Продолжение таблицы 2
───────────────┬────────────┬────┬────────────┬──────┬──────
 Идентификатор │Наименование│Дли-│ Возможные  │ Тип  │При-
  описания     │   данных   │на ,│  значения  │изобра│меча-
   данных      │            │байт│            │жения │ние
───────────────┼────────────┼────┼────────────┼──────┼──────
Play[i].Color  │Определяет  │ 2  │0-черный    │Сектор│При
               │цвет "i"    │    │1-синий     │ная   │зна-
               │сектора     │    │2-зеленый   │диаг- │чении
               │            │    │3-бирюзовый │рамма │Flag=
               │            │    │4-красный   │      │0 за-
               │            │    │5-малиновый │      │да-
               │            │    │6-коричневый│      │вать
               │            │    │7-светло-сер│      │не
               │            │    │8-темно-сер │      │нужно
               │            │    │9-светло-гол│      │(оп-
               │            │    │10-светл-зел│      │реде-
               │            │    │11-светл-бир│      │ляет-
               │            │    │12-свет-крас│      │ся
               │            │    │13-светл-мал│      │прог-
               │            │    │14-желтый   │      │рам-
               │            │    │15-белый    │      │мно)
               │            │    │            │      │
Play[i].Font   │Определяет  │ 2  │0-фоновый   │То же │То же
               │тип штрихов-│    │  цвет      │      │
               │ки сектора  │    │1-заданный  │      │
               │"i"         │    │  цвет      │      │
               │            │    │2-пунктир   │      │
               │            │    │3-косые лин/│      │
               │            │    │4-косые жир-│      │
               │            │    │ные линии //│      │
               │            │    │5-косые жир-│      │
               │            │    │ные линии \\│      │
               │            │    │6-косые лин\│      │
               │            │    │7-редкая    │      │
               │            │    │штриховка   │      │
               │            │    │8-частая пе-│      │
               │            │    │ресекающая  │      │
               │            │    │штриховка   │      │
               │            │    │9-прерывная │      │
               │            │    │линия       │      │
               │            │    │10-редкие   │      │
               │            │    │точки       │      │
               │            │    │11-частые   │      │
               │            │    │точки       │      │
               │            │    │            │      │
Play[i].Text   │Определяет  │ 13 │Например:   │ -"-  │
               │кратко со-  │    │┌───┐       │      │
               │держимое "i"│    ││││││-март  │      │
               │сектора     │    │└───┘       │      │
               │            │    │┌┬┬┬┐       │      │
               │            │    │├┼┼┼┤-апрель│      │
               │            │    │└┴┴┴┘       │      │
               │            │    │┌───┐       │      │
               │            │    ││───│-май   │      │
               │            │    │└───┘       │      │
               │            │    │            │      │

                            - 10 -
                                      Продолжение таблицы 2
───────────────┬────────────┬────┬────────────┬──────┬──────
 Идентификатор │Наименование│Дли-│ Возможные  │ Тип  │При-
  описания     │   данных   │на ,│  значения  │изобра│меча-
   данных      │            │байт│            │жения │ние
───────────────┼────────────┼────┼────────────┼──────┼──────
Cursiv         │Указывает   │ 2  │0-ни один из│Сектор│Гисто-
               │номер выдви-│    │секторов не │ная   │грамма
               │гаемого сек-│    │выдвигается;│диаг- │смотри
               │тора        │    │N-выдвигает-│рамма │ниже
               │            │    │ся сектор N │      │
               │            │    │"1" и т.д.  │      │
               │            │    │            │      │
Xmax, Ymax     │Максимальное│ 2  │            │Гисто-│
               │значение ко-│    │            │грамма│
               │ординаты по │    │            │График│
               │оси X (по   │    │            │      │
               │оси Y)      │    │            │      │
               │            │    │            │      │
Ymin, Xmin     │Минимальное │ 2  │            │График│
               │значение ко-│    │            │      │
               │ординаты по │    │            │      │
               │оси X (по   │    │            │      │
               │оси Y)      │    │            │      │
               │            │    │            │      │
X_Flag         │Наличие ин- │ 2  │0-значение  │График│ При
               │формации в  │    │шага (Xstep)│Гисто-│ X_Flag=0
               │TextX       │    │умножается  │грамма│ (Y_Flag=0)
               │            │    │на шаг;     │      │ под отмет-
               │            │    │1-значение  │      │ кой имеет-
               │            │    │массива     │      │ ся число
               │            │    │LabeX       │      │ равное ша-
               │            │    │            │      │ гу, умно-
Y_Flag         │Наличие ин- │ 2  │0-значение  │ То же│ женному на
               │формации в  │    │шага (Ystep)│      │ количество
               │TextY       │    │умножается  │      │ шагов
               │            │    │на шаг;     │      │
               │            │    │1-значение  │      │
               │            │    │массива     │      │
               │            │    │LabeY       │      │
               │            │    │            │      │
Xstep, Ystep   │Шаг по оси X│ 2  │            │ -"-  │
               │(оси Y)     │    │            │      │
               │(Расстояния,│    │            │      │
               │имеющие от- │    │            │      │
               │метки по    │    │            │      │
               │осям коорди-│    │            │      │
               │нат)        │    │            │      │
               │            │    │            │      │
               │            │    │            │      │
               │            │    │            │      │
               │            │    │            │      │
               │            │    │            │      │
               │            │    │            │      │
LabeX, LabeY   │Единицы из- │ 10 │час, км,    │Гисто-│
               │мерения по  │    │м и т.д.    │грам- │
               │оси X (по   │    │            │ма,   │
               │оси Y)      │    │            │график│
               │            │    │            │      │

                            - 11 -
                                      Продолжение таблицы 2
───────────────┬────────────┬────┬────────────┬──────┬──────
 Идентификатор │Наименование│Дли-│ Возможные  │ Тип  │При-
  описания     │   данных   │на ,│  значения  │изобра│меча-
   данных      │            │байт│            │жения │ние
───────────────┼────────────┼────┼────────────┼──────┼──────
TextX, TextY   │Строковый   │ 10 │Наименование│Гисто-│Если
               │массив (в   │    │месяца, года│грамма│X_Flag=1
               │строке не   │    │и т.д.      │график│(Y_Flag=1)
               │более 10    │    │            │      │то значе-
               │символов),  │    │            │      │ния шагов
               │определяю-  │    │            │      │берутся из
               │щий значения│    │            │      │Text X
               │шагов по оси│    │            │      │(Text Y)
               │X (оси Y)   │    │            │      │
               │            │    │            │      │
Bar[i].X       │Координата  │ 2  │0 < X < Xmax│Гисто-│
               │правой сто- │    │            │грамма│
               │роны "i"    │    │            │      │
               │столбика    │    │            │      │
               │            │    │            │      │
Bar[i].Y       │Координата  │ 2  │0 < Y < Yмax│Гисто-│
               │верхней сто-│    │            │грамма│
               │роны "i"    │    │            │      │
               │столбика    │    │            │      │
               │            │    │            │      │
Bar[i].Color   │Определение │ 2  │См. Play[i].│Гисто-│При зна-
               │цвета "i"   │    │Color       │грамма│чении
               │столбика    │    │            │      │Flag=0
               │            │    │            │      │задавать
               │            │    │            │      │не нужно
               │            │    │            │      │(опреде-
               │            │    │            │      │ляется
               │            │    │            │      │програм-
               │            │    │            │      │мно)
Graf[i].Color  │Определение │ 2  │См. Play[i].│график│То же
               │цвета "i"   │    │Color       │      │
               │линиии гра- │    │            │      │
               │фика        │    │            │      │
Bar[i].Text    │Определение │ 13 │Например:   │Гисто-│ -"-
               │краткого со-│    │            │грамма│
               │держимого   │    │┌───┐       │      │
               │"i" столбика│    ││││││-март  │      │
               │            │    │└───┘       │      │
               │            │    │┌┬┬┬┐       │      │
               │            │    │├┼┼┼┤-апрель│      │
               │            │    │└┴┴┴┘       │      │
               │            │    │┌───┐       │      │
               │            │    │├───┤-май   │      │
               │            │    │└───┘       │      │
Graf[i].Text   │Определение │ 13 │Например:   │График│ -"-
               │краткого со-│    │            │      │
               │держимого   │    │____ налич- │      │
               │"i" линии   │    │     ность  │      │
               │графика     │    │_._._ посту-│      │
               │            │    │     пления │      │
               │            │    │----- выпла-│      │
               │            │    │       ты   │      │

                            - 12 -
                                      Продолжение таблицы 2
───────────────┬────────────┬────┬────────────┬──────┬──────
 Идентификатор │Наименование│Дли-│ Возможные  │ Тип  │При-
  описания     │   данных   │на ,│  значения  │изобра│меча-
   данных      │            │байт│            │жения │ние
───────────────┼────────────┼────┼────────────┼──────┼──────
Cursiv         │Расстояние  │ 2  │ 0 < Cursiv │Гисто-│
               │между столб-│    │<MaxX       │грамма│
               │цами по     │    │            │      │
               │оси X       │    │            │      │
               │            │    │            │      │
Graf[i].Common │Определяет  │ 2  │ 1 < Common │График│Должно
               │количество  │    │<MAXPOINT   │      │быть не
               │точек в те- │    │            │      │более,
               │кущем графи-│    │            │      │чем
               │ке          │    │            │      │MaxPoint
               │            │    │            │      │
Graf[i].X[j],  │Массив коор-│ 4  │MinX<X<MaxX,│То же │
Graf[i].Y[j]   │динат узло- │    │MinY<Y<MaxY │      │
               │вых точек   │    │            │      │
               │"j" на линии│    │            │      │
               │"i" графика │    │            │      │
               │            │    │            │      │
Graf[i].Ln     │Тип линии   │ 2  │0-непрерыв- │ -"-  │При зна-
               │            │    │ная линия;  │      │чении
               │            │    │1-линия из  │      │Flag=0
               │            │    │точек;      │      │задавать
               │            │    │2-линия из  │      │не надо
               │            │    │точек и тире│      │
               │            │    │3-пунктирная│      │
               │            │    │линия       │      │
               │            │    │            │      │
───────────────┴────────────┴────┴────────────┴──────┴───────────

     4. Порядок работы с пакетом программ

     4.1. Перед началом работы необходимо скопировать файл
GID.TPU с дистрибутива в рабочий каталог на который настоен
ваш TURBO-PASCAL. GID, кроме возможностей описанных в этом
документе, поддерживает все функции модуля GRAPH(см. док.
TURBO-PASCAL 4.0 или 5.0).
     4.2. Для работы с пакетом пользователь обязан заполнить
структуру DatGid в зависимости от требований пользовательских
задач. Правила и особенности описания массива DatGid представлены
в подразделе 3.2. Описание примера заполнения структуры DatGid
приведено в Приложении 1.
     4.3. Оператор "uses gid" подключает интерфейсную часть
пакета ГИД и делает ее доступной для пользователя, разрешая
работу с ним. Оператор Initialize осуществляет запуск процедуры
Initialize, которая переводит терминал в графический режим и
определяет переменные интерфейсной части, не входящие в структуру
DatGid и определяющие размеры максимального окна для вывода
изображения (MaxX, MaxY, MinX, MinY).
     4.4. Для получения изображения программа запускает функцию
StartGid (Namber_Displ:integer). Namber_Displ - это количество
рисунков, выводимых на экран за один сеанс, и для контрольного
примера равняется 3 (не должно превышать 5 рисунков за один
сеанс).
     4.5. Для вывода из графического режима в текстовый программа
осуществляет запуск процедуры CloseGid.

                            - 13 -

     4.6. Контрольный пример составлен для трех различных
рисунков секторной диаграммы, графика и гистограммы, которые
описаны соответственно как отдельные элементы массива DatGid[1],
DatGid[2], DatGid[3]. Во всех трех рисунках осуществляется выбор
цвета и типа штриховки (типа линии) программно (Flag:=0), поэтому
не используются переменные выбора цвета и типа штриховки (типа
линии) (см. табл.2). Описание всех переменных массива DatGid
определен в п.3.2 (см. табл.2).
     4.6.1. Для секторной диаграммы (DatGid(1)) определены
следующие переменные:
     имя и код диаграммы;
     количество секторов;
     процент занимаемой площади каждым сектором;
     цвет и тип штриховки каждого сектора;
     легенда секторов;
     координаты выводимого изображения;
     4.6.2. Для графиков (DatGid(2)) определены следующие
переменные:
     имя и код графика;
     шаги по оси координат;
     координаты выводимого изображения;
     значения максимальных и минимальных координат;
     количество графиков;
     координаты узловых точек на каждый график;
     легенда по трем графикам.
     4.6.3. Для гистограммы (DatGid(3)) определены следующие
переменные:
     имя и код гистограммы;
     шаги по осям координат;
     значения максимальных координат;
     количество столбиков гистограммы;
     координаты и легенда пяти столбиков;
     координаты выводимого изображения.
     4.7. Достаточным условием является, чтобы выводимое
изображение помещалось на экране (т.е. чтобы не превышались
координаты максимального окна MaxX, MaxY, MinX, MinY). А затем в
интерактивном режиме можно расположить изображение в удобном для
восприятия виде. Для контрольного примера координаты выводимого
изображения рассчитывались таким образом, чтобы три вида
изображений могли помещаться на экран.
     4.8. При активной работе пакета ГИД на терминале появляется
графическое изображение данных пользователя и ПЭВМ переходит в
интерактивный режим, в процессе которого можно менять величину
изображения и перемещать изображение по экрану, а также
осуществлять переход на следующее изображение.
     Примеры вывода графического изображения диаграммы,
гистограммы и графика, согласно описанию контрольного примера
(как на отдельных экранах, так и на одном), приведены в
Приложении 2.
     4.9. На экране ПЭВМ выделяются несколько рабочих зон.
Строка с наименованием рисунка (изображения) располагается в
самой верхней части экрана. В нижней части экрана располагается
строка динамической подсказки, которая указывает, какими
основными клавишами в данный момент можно пользоваться и какие
команды выполняются при нажатии клавиши.

                            - 14 -

     Описание полей динамической подсказки и вспомогательных
клавиш представлены в табл. 3.

                                              Таблица 3
Описание полей динамической подсказки и вспомогательных  клавиш

     ┌────────┬───────┬───────────────────────────────────┐
     │        │  Имя  │                                   │
     │   Имя  │функции│    Функциональная  возможность    │
     │клавиши │по под-│                                   │
     │        │сказке │                                   │
     ├────────┼───────┼───────────────────────────────────┤
     │        │       │                                   │
     │  F1    │ help  │Вызов на экран "легенды" данного   │
     │        │       │изображения                        │
     │        │       │                                   │
     │>(стрел-│ inc X │Увеличение изображения по оси X    │
     │ка впра-│       │                                   │
     │во)     │       │                                   │
     │        │       │                                   │
     │<(стрел-│ dec X │Уменьшение изображения по оси Y    │
     │ка вле- │       │                                   │
     │во)     │       │                                   │
     │        │       │                                   │
     │   ∙    │ inc Y │Увеличение изображения по оси Y    │
     │        │       │для графиков и гистограмм (увели-  │
     │        │       │чение секторной диаграммы)         │
     │        │       │                                   │
     │   °    │ dec Y │Уменьшение изображения по оси Y    │
     │        │       │для графиков и гистограмм (умень-  │
     │        │       │шение секторной диаграммы)         │
     │        │       │                                   │
     │  Ins   │ lock  │Перевод экрана в режим перемещения │
     │        │       │текущего окна (в этом режиме рабо- │
     │        │       │тают стрелки)                      │
     │        │       │                                   │
     │  Esc   │ exit  │Возврат в основную программу       │
     │        │       │                                   │
     │        │       │                                   │
     │  F10   │ end   │1) если экран в режиме перемещения,│
     │        │       │то происходит фиксация изображения;│
     │        │       │2) в основном изображении переход к│
     │        │       │следующему изображению (описан в   │
     │        │       │DatGid)                            │
     │        │       │                                   │
     │  F9    │       │Захват всего экрана под изображение│
     │        │       │                                   │
     │        │       │                                   │
     │  F2    │ pred  │Вывод на экран предыдущего изобра- │
     │        │       │жения                              │
     │        │       │                                   │
     │        │       │                                   │
     └────────┴───────┴───────────────────────────────────┘

     4.10. Вывод на печать изображения на экране осуществляется
системными средствами.

                            - 15 -
                                                    Приложение 1
                Порядок заполнения структуры
                   интерактивной части

      1.1. Интерфейсная часть.

unit gid;
interface
uses
  Crt,Graph;
const
  OFF = 0;
  ON  = 1;
  BARCOD = 2;
  BAR3COD = 3;
  PLAYCOD = 4;
  GRAFCOD = 5;
  MAXBAR = 18;
  MAXPlAY = 10;
  MAXSTRING = 10;
  MAXGRAF = 5;
  MAXPOINT = 25;

type
  DatBarTyp = record
     Color : word;
     Font  : word;
     X     : word;
     Y     : word;
     Text  : string[13];
   end;

  DatPlayTyp = record
     Prozent :  real;
     Color   : word;
     Font    : word;
     Text    : string[13];
   end;

  DatGrafTyp = record
     Common                   : integer;
     Color                    : word;
     Ln                       : word;
     X     : array[1..MAXPOINT] of  real;
     Y     : array[1..MAXPOINT] of  real;
     Text : string[13];
   end;
  GrafixTyp = record
     Name                     : string[40];
     LabeX,LabeY              : string[10];
     Flag,X_Flag,Y_Flag       : integer;
     x1,x2,y1,y2              : integer;
     Xstep,Ystep,Xmax,Ymax    : integer;
     Xmin,Ymin                : integer;
     Cursiv                   : integer;
     Common                   : integer;
     TextX : array[1..10] of  string[10];
     TextY : array[1..10] of  string[10];
     case Cod : 2..6 of

                            - 16 -


       BARCOD  ,
       BAR3COD : (Bar : array[1..MAXBAR]  of DatBarTyp );
       PLAYCOD : (Play: array[1..MAXPLAY] of DatPlayTyp);
       GRAFCOD : (Graf: array[1..MAXGRAF] of DatGrafTyp);
   end;
var
  DatGid      : array[1..5] of GrafixTyp;
  MaxX, MaxY  : word;     { The maximum resolution of the screen }
  MinX, MinY  : word;     { The minimum resolution of the screen }

procedure Initialize;
procedure StartGid(NambeDispl : integer);
procedure CloseGid;


                            - 17 -
      1.2 Контрольный пример.

{$M 4096 0 640000}
uses gid;
var
 Kz : integer;
begin                 { КОНТРОЛЬНЫЙ ПРИМЕР }
  Initialize;
           {──────────────────────────────────────────────────}
           {   Запуск процедуры Initiflize проиводится перед  }
           { заполнением структуры DatGid, тат как определе-  }
           { ление рамеров окна вывода изображения должно     }
           { определятся следующим образом :                  }
           {         MinX <= x1 < x2 <= MaxX ;                }
           {         MinY <= y1 < y2 <= MaxY .                }
           {   Переменные MinX,MaxX,MinY,MaxY определяются в  }
           { Initiflize в зависимости от типа драйвера терми- }
           { нала .                                           }
           {__________________________________________________}

                    { заполнение структуры DatGid }
  with DatGid[3] do
   begin
    Name := 'оборот капитала за II полугодие 1989 года';
    Cod :=BARCOD;                     { двумерная гистограмма }
    Xstep := 10;                     { шаг по оси X равен 10  }
    Ystep := 1;                      { шаг по оси Y равен  1  }
    Xmax  := 70;          { ось X имеет 70 расчетных делений  }
    Ymax  := 8;           { ось Y имеет  8 расчетных делений  }
    Cursiv:= 4;      { разрядка между столбиками по оси X = 4 }
    Common:= 7;                        { кол-во столбиков = 7 }
    Flag:=OFF;         { выбор цвета и типа штриховки пакетом }
    X_Flag:=ON;             { метки по оси X берутся из TextX }
    Y_Flag:=OFF;                   { метки по оси Y расчетные }
    LabeX:='месяц';                               { имя оси X }
    LabeY:='млн.руб.';                            { имя оси Y }

    Bar[1].X := 1; Bar[1].Y := 0;   { не отображается, служит }
                                    { для выравнивания        }
    Bar[2].X := 6; Bar[2].Y := 7;
    Bar[3].X := 6; Bar[3].Y := 1;   { отображаемые столбики   }
    Bar[4].X := 6; Bar[4].Y := 2;   { в данном случае имеют   }
    Bar[5].X := 6; Bar[5].Y := 4;   { одинаковую ширину       }
    Bar[6].X := 6; Bar[6].Y := 5;
    Bar[7].X := 6; Bar[7].Y := 3;

    TextX[1] := 'июль';
    TextX[2] := 'август';
    TextX[3] := 'сентябрь';      { определение меток по оси X }
    TextX[4] := 'октябрь';
    TextX[5] := 'ноябрь';
    TextX[6] := 'декабрь';
    TextX[7] :='';
                  { определение кординат окна под изображение }
    x1:=MinX;
    y1:=MaxY-MaxY div 2;     { под окно отводится  }
    x2:=MaxX;                { нижняя часть экрана }
    y2:=MaxY;
   end;

                            - 18 -
  with DatGid[1] do
   begin
    Name := 'процентное соотношение аккредитива';
    Cod :=PLAYCOD;                       { секторная диограма }
    Cursiv:= 2;                          { выделяем сектор №4 }
    Common:= 6;                        { кол-во столбиков = 6 }
    Flag:=ON;    { выбор цвета и типа штриховки пользователем }

    Play[1].Prozent:= 10;
    Play[2].Prozent:= 15;
    Play[3].Prozent:= 22;       { процент занимаемый сектором }
    Play[4].Prozent:= 15;       {        в диограмме          }
    Play[5].Prozent:= 18;
    Play[6].Prozent:= 20;

    Play[1].Text := 'июль';
    Play[2].Text := 'август';
    Play[3].Text := 'сентябрь';       { краткая информация    }
    Play[4].Text := 'октябрь';        { о содержимом секторов }
    Play[5].Text := 'ноябрь';
    Play[6].Text := 'декабрь';

    Play[1].Color := 9;
    Play[2].Color := 10;
    Play[3].Color := 11;            { цвет секторов от 0 до 15 }
    Play[4].Color := 12;  { 0 и 8 использовать не рекомедуется }
    Play[5].Color := 13;
    Play[6].Color := 14;

    Play[1].Font := 7;
    Play[2].Font := 8;
    Play[3].Font := 9;             { тип штриховки от 0 до 12 }
    Play[4].Font := 10;
    Play[5].Font := 11;
    Play[6].Font := 6;

                  { определение кординат окна под изображение }
    x1:=MinX;
    y1:=MinY;                  { под окно отводится  }
    x2:=MaxX div 3;        { левая верхняя часть экрана }
    y2:=MaxY-MaxY div 2;
   end;

                            - 19 -
  with DatGid[2] do
   begin
    Name := 'поступления и выплаты за III-IV кв.1989г.';
    Cod :=GRAFCOD;                                  { графики }
    Xstep := 2;                      { шаг по оси X равен  2  }
    Ystep := 1;                      { шаг по оси Y равен  1  }
    Xmax  := 13;             { максимальное значение по оси X }
    Ymax  := 10;             { максимальное значение по оси Y }
    Xmin  := 0;               { минимальное значение по оси X }
    Ymin  := 0;               { минимальное значение по оси Y }
    Common:= 3;                         { кол-во графиков = 3 }
    Flag:=OFF;         { выбор цвета и типа штриховки пакетом }
    X_Flag:=ON;             { метки по оси X берутся из TextX }
    Y_Flag:=OFF;                   { метки по оси Y расчетные }
    LabeX:='месяц';                               { имя оси X }
    LabeY:='млн.руб.';                            { имя оси Y }

    TextX[1] := 'VII';
    TextX[2] := 'VIII';
    TextX[3] := 'IX';            { определение меток по оси X }
    TextX[4] := 'X';
    TextX[5] := 'XI';
    TextX[6] := 'XII';

                  { определение кординат окна под изображение }
    x1:=MaxX div 3;
    y1:=MinY;                  { под окно отводится  }
    x2:=MaxX;              { правая верхняя часть экрана }
    y2:=MaxY-MaxY div 2;

                 { определение узловых точек в графиках }
    Graf[1].Common:= 8;           { кол-во узлов в графике №1 }
    Graf[1].X[1] := 0; Graf[1].Y[1] := 3;
    Graf[1].X[2] := 2; Graf[1].Y[2] := 3.4;
    Graf[1].X[3] := 4; Graf[1].Y[3] := 3.9;
    Graf[1].X[4] := 6; Graf[1].Y[4] := 4.6;
    Graf[1].X[5] := 8; Graf[1].Y[5] := 4.4;
    Graf[1].X[6] :=10; Graf[1].Y[6] := 5.2;
    Graf[1].X[7] :=12; Graf[1].Y[7] := 5.8;
    Graf[1].X[8] :=13; Graf[1].Y[8] := 6.1;
    Graf[2].Common:= 7;           { кол-во узлов в графике №2 }
    Graf[2].X[1] := 0; Graf[2].Y[1] := 4;
    Graf[2].X[2] := 2; Graf[2].Y[2] := 4;
    Graf[2].X[3] := 4; Graf[2].Y[3] := 6;
    Graf[2].X[4] := 6; Graf[2].Y[4] := 2;
    Graf[2].X[5] := 8; Graf[2].Y[5] := 1;
    Graf[2].X[6] :=10; Graf[2].Y[6] := 9;
    Graf[2].X[7] :=13; Graf[2].Y[7] := 7;
    Graf[3].Common:= 6;           { кол-во узлов в графике №3 }
    Graf[3].X[1] := 0; Graf[3].Y[1] := 10;
    Graf[3].X[2] := 2; Graf[3].Y[2] := 3.6;
    Graf[3].X[3] := 4; Graf[3].Y[3] := 6.1;
    Graf[3].X[4] := 6; Graf[3].Y[4] := 1.3;
    Graf[3].X[5] :=10; Graf[3].Y[5] := 8.2;
    Graf[3].X[6] :=13; Graf[3].Y[6] := 6.7;

                            - 20 -

                        { краткая информация о графиках }
    Graf[1].Text := 'наличность';
    Graf[2].Text := 'поступления';
    Graf[3].Text := 'выплаты';
   end;

  Kz:=StartGid(3);{ отображение информации в графическом виде }

  CloseGid(Kz);         { переход в символьный режим и выдача }
                        { сообщений о ошибке                  }

end.        { конец контрольного примера }

                            - 21 -

                                                 Приложение 2









        Примеры вывода на печать графического изображения










                            - 26 -

                                                 Приложение 3
                Состав дистрибутивного носителя .

   GID.TPU - модуль GID.
   GID.PAS, CLOSEGID.IMP, INIT.IMP, HAVEPROC.IMP, WORDPROC.IMP,
PIEPLAY.IMP, BARPLAY.IMP, GRAFPLAY.IMP, STARTGID.IMP - исходники.
   ATT.BGI, CGA.BGI, EGAVGA.BGI, HERC.BGI, IBM8514.BGI, PC3270.BGI
- графические драйверы.
   START.PAS, START.EXE - контрольный пример.
   GID.DOC - документ, лежащий перед вами.
   GID.TXT - краткое описание возможностей пакета.

