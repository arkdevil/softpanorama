

        ┌───────────────────────────────────────────────────────────┐
        │                                                           │
        │   Данная копия Локатора может свободно распространяться,  │
        │   в том числе и по любым компьютерным сетям, при условии  │
        │   соблюдения традиционных правил приличия по отношению к  │
        │                       SHAREWARE.                          │
        │                                                           │
        └───────────────────────────────────────────────────────────┘



                          Вирусный Локатор.
                        ( Virus Locator 2.51)





             ╔══════════ Антивирусная программа ════════════╗
             ║                                              ║
             ║ Дистрибутивная версия распознает 276 вирусов ║
             ║     с помощью 193 масок (сигнатур).          ║
             ║                                              ║
             ╚══════════════════════════════════════════════╝



                              Содержание.

1.  Введение.
2.  Полная поставка Локатора.
3.  Пакетный режим работы.
4.  Диалоговый (основной) режим работы.
5.  Использование Локатора с VGA-дисплеем.
6.  Формат масок, хранимых Локатором.
7.  Формат файлов и описание утилит из полной поставки.
8.  Поиск вирусов в режиме Turbo Search и типы вирусов.
9.  Дамп и дизассемблирование подозрительных файлов.
10. Warnings - предупреждения о подозрительных файлах.
11. История создания и развития Вирусного Локатора.
12. Самоконтроль на заражаемость.
13. Разное.
14. Вопросы и ответы.




                        1. Введение.

  Программа VL ( Virus Locator )  предназначена  для  поиска  вирусов,
размножающихся через файлы,  по  маскам  вирусов.  Под  маской  вируса
понимается та часть  кодов  вируса,  которая  не  изменяется  при  его
размножении.
  VL ищет в файле  все  маски  вирусов  одновременно,  а  также  может
работать без остановки при обнаружении  вируса,  выводя  информацию  о
зараженных файлах на принтер и/или  в  файл.  Кроме  того,  VL  удалит
инфицированный файл (если Вы выберете режим удаления), избавив Вас  от
этой нудной на большом винчестере работы.

  Локатор обладает исключительным свойством: способностью  накапливать
новые маски  вирусов  и  информацию  о  них.  Следовательно,  Вирусный
Локатор  не  просто  очередной   детектор,   а   записная   книжка   и
информационно-справочная система по вирусам.

  Вирусный Локатор может  использоваться  в  двух  вариантах,  которые
условно называются пассивным и активным.
  Пассивный вариант  -  это  если  Вы  не  разбираетесь  и  не  хотите
разбираться  в  вирусных  проблемах,  ассемблерных  кодах   и   прочей
дребедени, и не желаете обременять себя поиском  новых  вирусов  и  их
масок. В этом случае Вы используете VL с тем  набором  масок,  который
Вы получили. В таком варианте VL не лучше и не  хуже  других  вирусных
детекторов.
  Активный вариант - это тот  случай,  когда  Вы  понимаете  (пусть  в
общих чертах) механизм работы вируса и можете определить маску  вируса
(не обязательно с первой попытки, я тоже ошибаюсь  иногда).  Тогда  Вы
сможете пополнять список вирусов  в  Локаторе,  надежно  защищаясь  от
компьютерной заразы.
  И действительно,  даже  сколь  угодно  мощный  вирусный  детектор  с
нерасширяемым набором масок вирусов станет  бессильным  при  появлении
нового вируса (а новой версии этого детектора придется ждать  неделями
или месяцами). Ну а если у Вас есть  VL,  то  через  небольшое  время,
потраченное на выделение  маски  вируса,  Ваш  компьютер  снова  будет
защищен.

  Набор утилит, прилагаемый к Локатору, позволит Вам выбрать  наиболее
удобный в Ваших условиях метод защиты от вирусов и облегчит  выделение
маски нового вируса.



                        2. Полная поставка Локатора.


  Полная поставка VL включает следующие файлы:


   VL.DOC        - файл, который Вы сейчас читаете
   VL.EXE        - собственно Вирусный Локатор (называемый далее VL)
   VL.MSK        - файл, в котором VL хранит маски и имена вирусов, а также
                   техническую информацию
   VL.HLP        - слегка сжатый (на 10%) файл с текстами Help, используемый
                   Локатором
   VL*.DSC       - обычные текстовые файлы с подробной информацией о вирусах,
                   тоже используются Локатором и носят название файлов
                   дескрипторов

   ML.EXE        - Mask Looker (маскоискатель), вспомогательная утилита для
                   облегчения выделения масок из новых вирусов

   RVL.EXE       - Resident Virus Locator, резидентная утилита для защиты
                   компьютера от файловых вирусов
   RI.EXE        - RVL Info, сервисная утилита для RVL

   BT.EXE        - Boot Tester, утилита для защиты компьютера от вирусов
                   в начальном загрузчике (бутовых вирусов)

  Формат файлов и описание утилит смотрите в 7-м разделе.

  Расширенная поставка  VL  extended  edition  дополнительно  включает
следующие файлы:

   RLOCK4.EXE
   RLOCK5.EXE    - утилиты усиления атрибута ReadOnly на файлах
                   в MS-DOS 4.0, 4.01 и 5.0
   HDD4,
   HDD5          - утилиты защиты диска от повреждения и заражения
                   вирусами в MS-DOS 4.0, 4.01 и 5.0

   VL_EXT.DOC    - описание утилит расширенной поставки.


 В VL.MSK уже установлены несколько масок вирусов: те,  с  которыми  я
столкнулся при работе  на  компьютере  или  получил  от  пользователей
Вирусного Локатора и от вирусологов.
  VL ищет  все  необходимые  ему  файлы  в  том  каталоге,  в  котором
находится VL.EXE. Если нужный файл не будет  найден,  Локатор  сообщит
об этом.
  Если Вы переименуете VL.EXE, например, в LOCATOR.EXE,  то  им  будут
искаться файлы  с  именем  LOCATOR.*.  Минимальный  набор  файлов  для
работы Вирусного Локатора: VL.EXE и VL.MSK.



                        3. Пакетный режим работы.


  Пакетный режим работы Локатора практически ничем  не  отличается  от
работы других антивирусов. Вы указываете опции  поиска,  Локатор  ищет
вирусы, по окончании поиска Вы снова оказываетесь в DOS.
  Запуск Локатора :

                 VL [<опции>] [<имя каталога>] [<опции>]

   Опции :
                /F - Полный поиск вирусов в файле (файлах) - поиск
                     с первого по последний байт файла
                /N - Отключить звук
                /A - Поиск во всех файлах (не только .COM и .EXE)
                /W - Поиск по всем дискам, начиная с C:, исключая съемные
                     диски и SUBST - диски
                /E - Аналогично ключу /W, включая сетевые диски. 
                     Используйте, если ключ /W не замечает в Вашей
                     сети некоторые диски
                /X - Поиск по каталогам, определенным  в  PATH  или  в
                     переменной среды DOS с именем VLDIR.  Подкаталоги
                     не сканируются
                /T - Поиск по каталогам, определенным  в переменной
                     среды DOS с именем VLNET.  Подкаталоги сканируются
                /D - Удалять без подтверждения зараженные файлы
                /P - Вывод списка зараженных файлов на принтер
                /L - Вывод списка зараженных файлов в файл *.LST
                /O - Не останавливаться при обнаружении зараженного файла
                /Q - Остановиться при выдаче предупреждения
                     (см. раздел 10)
                /B - Вывод на экран в черно-белой палитре
                /H - Help
                /2 - работа в видеорежиме 25x80 (25 строк по 80 символов
                     в строке)
                /4 - работа в видеорежиме 43x80 (EGA) или 50x80 (VGA)
                /- - отключить контроль "снега" при выводе на экран.
                     Имеет смысл только для CGA-дисплеев
                /1 - запуск Локатора только один раз в сутки.


    <имя каталога> - каталог, в котором Локатор будет искать зараженные
                     файлы. Все его подкаталоги также будут просканированы

   По умолчанию :
                1) Быстрый поиск вирусов в файле (описан в 8-м разделе)
                2) Звук включен
                3) Поиск вирусов только в .COM и .EXE файлах
                4) Не удалять зараженные файлы
                5) Останавливаться при обнаружении зараженного файла
                6) Поиск по всем дискам начиная с C:, исключая съемные
                   диски и SUBST - диски
                7) Работа в текущем текстовом видеорежиме (см. раздел 5)
                8) Автоматический контроль снега при выводе на экран :
                   включен для CGA-дисплеев, выключен для всех остальных.

  Если указана хоть одна из опций (за исключением /B, /2, /4  или  /-)
или имя каталога, то Локатор начнет работать в пакетном режиме.

  После завершения поиска вирусов VL возвратит один из следующих кодов :

                        0 - Нормальное завершение, вирусы не обнаружены
                        1 - Обнаружены один или несколько вирусов
                        2 - Аварийное завершение (Ошибка)




                        4. Диалоговый (основной) режим работы.


  При запуске VL без опций  или  только  с  опциями  /B,  /2,  /4,  /-
Локатор будет работать  в  диалоговом  режиме,  при  котором  возможно
редактирование масок  вирусов,  их  добавление  и  удаление,  а  также
доступны более многообразные режимы поиска вирусов.
  Достаточно  полный  русскоязычный  Help  и   механизм   дескрипторов
вирусов, позволяющий получить  обширную  информацию  о  вирусе,  также
становятся доступными.
  Диалог  осуществляется  с  помощью  меню,  выбором   его   элементов
движением по меню и затем нажатием клавиши Enter.


  В самом начале работы VL выводит на экран головное меню:

                     ┌─── Main menu ───┐
                     │                 │
                     │  Turbo search   │
                     │  Full  search   │
                     │  Select options │
                     │  Show options   │
                     │  Masks showing  │
                     │  Save changes   │
                     │      Info       │
                     │      Quit       │
                     └─────────────────┘
Его элементы:

            Turbo search          - быстрый поиск, описан в 8-м разделе

            Full  search          - поиск вирусов по всему файлу.

            Select options        - выбор опций поиска, ниже будет
                                    описан подробнее

            Show options          - вывод на экран текущих опций поиска
                                    вирусов

            Masks showing         - работа с масками : удаление и
                                    добавление масок, печать масок и
                                    вывод их на экран

            Save changes          - сохранение измененных опций и
                                    отредактированных масок, а также
                                    запись их в программу RVL

            Info                  - краткая информация о VL

            Quit                  - выход из VL



  Если Вы войдете в подменю Select options,  то  получите  возможность
выбора:


        Sound is                  - включения/выключения звукового
                                    сигнала, подаваемого при обнаружении
                                    вируса


        File extensions           - расширения файла, по которому будут
                                    выбираться файлы для поиска в них
                                    вирусов

        Search virus at           - поиска вируса: в каталоге, в
                                    файловой системе (системах), в
                                    конкретном файле. При поиске по
                                    каталогам происходит поиск и по
                                    подкаталогам (за исключением поиска
                                    в PATH).

       Output sent to             - вывода краткой информации о
                                    найденном вирусе : на дисплей,
                                    на принтер и/или в файл
                                    с расширением .LST.

       File with virus            - реакции на зараженный файл: удаление
                                    без подтверждения, с подтверждением
                                    или не удаление.

       Warnings                   - предупреждения о подозрительных
                                    файлах, подробно описаны в разделе 10.


  При работе с меню пользуйтесь клавишами  "стрелка  вверх",  "стрелка
вниз", "cтрелка вправо", "стрелка влево", Home, End, Enter, Esc.
  В каждом элементе меню имеется подсвеченная буква.  Нажатие  клавиши
с этой буквой равнозначно выбору  данного  элемента  меню  с  нажатием
клавиши Enter.
  Вы можете  также  использовать  мышь.  Движение  мыши  соответствует
нажатию клавиш со стрелками. Клавиши мыши  интерпретируются  следующим
образом :


                MicroSoft Mouse           PC Mouse

               ┌────────────┐             ┌───────────────┐
               │┌────┐┌────┐│             │┌───┐┌───┐┌───┐│
               ││    ││    ││             ││   ││   ││   ││
               ││    ││    ││             ││   ││   ││   ││
                Enter   Esc                Enter  F1  Esc




  В любой момент Вы можете вызвать Help по текущей команде. Для  этого
достаточно нажать клавишу F1. Чтобы получить  информацию  о  том,  как
пользоваться самим Help, нажмите клавишу F1 дважды.



                         5.  Использование Локатора с VGA-дисплеем.


  В  Локаторе  большое  внимание  уделено   интерфейсу   программы   с
пользователем,  а  также  тем  возможностям,   которые   предоставляет
видеоадаптер VGA.
  Вообще видеоработа Локатора организована просто :  при  запуске  без
опций  /2  и  /4  он  анализирует  текущий  видеорежим  дисплея  и  по
возможности пытается продолжить работу в нем. Если текущий  видеорежим
является одним из стандартных IBM-режимов (с номерами от 0 до 19),  то
Локатору подходят из них режимы 2, 3 и 7. Для всех остальных  Вирусный
Локатор переустановит режим в 25 строк по 80 символов и  по  окончании
работы восстановит исходный видеорежим.
  Однако, если у Вас дисплей VGA,  то  на  нем  можно  установить  так
называемые расширенные текстовые  видеорежимы  с  размером  экрана  60
строк по 80 символов, 44 строки по 132 символа и  другие.  Эти  режимы
не стандартизованы и их  номера  отличаются  у  разных  производителей
дисплеев.  Поэтому  Локатор  их  не  знает  и  работает  на  принципах
доверия, полагая, что  если  текущим  является  видеорежим  с  номером
больше 19, то этот режим :

            - текстовый;
            - цветной с началом видеопамяти по адресу B800.

  Внимательно прочитайте Users Guide или Users Manual,  прилагаемые  к
дисплею, и выберите те видеорежимы, которые  удовлетворяют  этим  двум
требованиям.
  Для  установки  желаемого  видеорежима   используйте   программу   с
дискеты, которая должна прилагаться к дисплею фирмой-изготовителем.
  При  работе  в   расширенном   видеорежиме   Локатор   автоматически
настроится  на  текущие  размеры  экрана   и   будет   их   эффективно
использовать. Ниже приводится  таблица  изменения  возможностей  VL  в
зависимости от площади экрана.


                                  Видеорежим
                 (NxM означает N строк по M символов в строке)
╔═══════╦═══════╤═══════╤═══════╤═══════╤════════╤════════╤════════╤════════╗
║       ║       │      *│       │       │        │        │        │        ║
║       ║ 25x80 │ 43x80 │ 50x80 │ 60x80 │ 25x132 │ 28x132 │ 44x132 │ 60x132 ║
╠═══════╬═══════╪═══════╪═══════╪═══════╪════════╪════════╪════════╪════════╣
║       ║       │       │       │       │        │        │        │        ║
║   I   ║  16   │  34   │  40   │  50   │   16   │   18   │   34   │  50    ║
╟───────╫───────┼───────┼───────┼───────┼────────┼────────┼────────┼────────╢
║       ║       │       │       │       │        │        │        │        ║
║   II  ║  256  │  544  │  640  │  790  │  406   │  458   │  874   │  1280  ║
╟───────╫───────┼───────┼───────┼───────┼────────┼────────┼────────┼────────╢
║       ║       │       │       │       │        │        │        │        ║
║   III ║  18   │  36   │  43   │  53   │   18   │   20   │   36   │  53    ║
╟───────╫───────┼───────┼───────┼───────┼────────┼────────┼────────┼────────╢
║       ║       │       │       │       │        │        │        │        ║
║   IV  ║   5   │   9   │  11   │  13   │   5    │   5    │   9    │  13    ║
╚═══════╩═══════╧═══════╧═══════╧═══════╧════════╧════════╧════════╧════════╝

   *   - видеорежим доступен и на адаптере EGA


   I   - количество масок вирусов, одновременно выводимых на экран
         в режиме Masks showing & Editing (в свернутом виде)

   II  - размер куска дампа вируса (в байтах), показываемого на экране
         в режиме Show dump

   III - число строк в окне описания вируса в режиме Open descriptor

   IV  - число строк в окне текущих проверяемых файлов в режиме
         поиска вирусов


                        6. Формат масок, хранимых Локатором.


  Маски вводятся в Локатор нажатием клавиши 'A' (Add  mask)  в  режиме
Masks showing & Editing. Локатор может хранить до 500 масок вирусов.
  До версии 2.1 включительно  маска  представляла  собой  неизменяемую
цепочку кодов вирусов длиной до  15  символов.  В  текущей  версии  VL
допускаются символы  шаблона  вперемешку  с  кодами  маски.  Например,
цепочка

               EA 00 00 8C ?? CD *6 AA

означает, что после кодов EA 00 00 8C в маске вируса может  находиться
один любой символ, затем идет символ с кодом CD, затем- ровно 6  любых
символов, затем - символ с кодом AA.
  Допускаются следующие шаблоны :

                ??     -   один любой символ
                *0     -   один любой символ
                *1     -   один любой символ
                *2     -   ровно два любых символа
                     ...
                *F     -   ровно пятнадцать любых символов.

  Теперь, в общем случае, длина маски  может  достигать  197  байт  за
счет символов шаблона.
  Имеется одно очевидное ограничение : первый и последний  коды  маски
не должны быть символами шаблона.
  Алгоритм поиска вирусов таков, что чем длиннее  маска,  тем  быстрее
поиск. Кроме того, поиск ускоряется, если  маска  содержит  одинаковые
символы.
  В одной  из  следующих  версий  Локатора  будет  введен  шаблон  **,
означающий любое количество любых кодов на его месте в маске вируса.
  Несмотря на все мои старания, поиск  масок  с  шаблонами  происходит
медленнее, чем без них. Так что  если  у  Вас  есть  выбор-используйте
маски без символов шаблона.

  Локатор для каждой маски вируса может хранить  его  имя,  длиной  не
более 31 символа.
  При  именовании  вирусов  я  придерживаюсь  следующей  системы:  имя
начинается с типа размножения вируса, затем идет приращение файла  при
записи в него вируса.
  Например: RCE1234 означает, что  вирус  размножается  через  .COM  и
.EXE файлы, увеличивая их  на  1234  байта  и  становясь  резидентным.
Применяется следующая типизация:

               C - размножение через .COM файлы
               E - размножение через .EXE файлы
               R - вирус становится резидентным


  Кроме того, для каждого вируса  может  быть  указан  его  дескриптор
размером до 7 символов.  По  дескриптору  вируса  на  экран  выводится
информация о вирусе из файла VL.DSC.




                         7.  Формат файлов и описание утилит
                             из полной поставки.

                         7.1 Файл VL.MSK.


  Информация  о  вирусах  хранится  в  файле  VL.MSK  (кроме   текстов
описания вирусов в файле VL.DSC). Эта информация  для  каждого  вируса
выглядит так:


          номер по         маска вируса  :
          порядку
            │      в 16-тиричных кодах   в символьном виде
            │              │                   │
            │              │                   │
          ┌─┴─┐ ┌──────────┴─────────┐   ┌─────┴──────┐
           13.   <240000004D73446773>     <$    MsDos>

             Name : [MicroII]     Virus RC1313 : Microsoft II
                   └────┬────┘   └─────────────┬─────────────┘
                        │                      │
                        │                      │
                 дескриптор вируса         имя вируса

  По историческим причинам в файле  VL.MSK  сначала  идут  все  маски,
затем все их имена, а в самом конце - все дескрипторы.
  Маски вирусов хранятся в закодированном  виде  для  того,  чтобы  не
сбивать с толку другие антивирусы или сам Локатор при  поиске  вирусов
по всем файлам.
  В этом же файле хранятся текущие установки режимов Локатора, а также
номер версии Локатора для контроля совместимости Локатора и VL.MSK.


                         7.2 Файл VL.HLP.


  Указанный файл в данную поставку Вирусного Локатора не включен.

                         7.3 Файлы VL*.DSC.

  Указанные файлы в данную поставку Вирусного Локатора не включены.


                         7.4 Утилита ML

  Указанная утилита в данную поставку Вирусного Локатора не включена.


                         7.5 Утилиты RVL.EXE и RI.EXE

  RVL -  Resident  Virus  Locator,  является  резидентной  программой,
которая проверяет все запускаемые на выполнение программы  на  наличие
в них вирусов по тем же маскам вирусов, что и Локатор.

  Программа RVL.EXE представляет собой частично выгружаемый из  памяти
резидент, постоянное ядро которого занимает  около  6  Кб  оперативной
памяти. RVL написан с помощью модуля OPSWAP из OBJECT Professional.

  Маски записываются в RVL Вирусным Локатором версии 2.51 в меню  Save
Options. Кроме масок для RVL имеет значение установка Sound is  ON/OFF
Локатора.

  Текущая  версия  RVL  рассчитана  на  200  масок  вирусов.   Локатор
предупредит Вас при попытке записать в RVL большее количество масок.


                         7.5.1 Описание утилиты RVL



  Запуск RVL:
                    RVL [ключи]


  При запуске без ключей Resident Virus Locator будет искать вирусы  в
режиме Turbo Search.

  В целях оптимизации при поиске в режиме Full Search  (полный  поиск)
файлы размером более 30 Кб проверяются один  раз.  RVL  хранит  список
имен последних 30 исполненных программ с размером свыше  30  Кб.  Если
список уже  полон,  а  нужно  занести  еще  одно  имя,  то  из  списка
удаляется программа самого маленького размера.
  Для уменьшения требуемой памяти RVL  не  хранит  полных  путей  этих
программ,  поэтому  проверьте,  нет  ли  у  вас  на  компьютере   двух
одноименных программ одинакового размера. Если есть, то это  вероятнее
всего одна и та же программа в разных каталогах, так  что  удалите  ее
дубликаты.

 При своем запуске RVL перехватывает  21-е  DOS-прерывание  и  создает
DOS-функцию 0AAH. По этой функции он проверяет свое наличие  в  памяти
для того, чтобы не  загружаться  дважды.  Если  Вы  запускаете  RVL  в
первый раз и он выдает сообщение :

         Resident Virus Locator already installed in memory

то вероятнее всего в памяти Вашего  компьютера  уже  находится  вирус,
который создал эту-же DOS-функцию для своих целей.

  Когда RVL обнаружит маску вируса в запускаемом на выполнение  файле,
то на экране появится сообщение :


                         ╔═══Resident Virus Locator═══╗
                         ║ Detected virus mask No  27 ║
                         ║ In file:     PCSHELL.EXE   ║
                         ║ Stop  Reboot  Continue  Go ║
                         ╚════════════════════════════╝




  Вы можете выбрать одно из предлагаемых  действий,  нажав  клавишу  с
соответствующей буквой, а именно:

           Stop        - прекратить загрузку программы. Программа не
                         исполняется и возвращается  код  ошибки  File
                         not found.

           Reboot      - перезагрузиться. Холодная перезагрузка.
                         Желательно  перезагрузиться  с   незараженной
                         заклеенной системной  дискеты  и  исследовать
                         подозрительный файл.

           Continue    - продолжить загрузку программы с поиском
                         следующих масок вирусов.

           Go          - отправить программу на выполнение без
                         дальнейшего контроля.


  Описание вируса Вы сможете посмотреть по его номеру, запустив  VL  и
войдя в подменю Masks editing.

  Если  в  момент  запуска  зараженного  файла  дисплей  находился   в
графическом  режиме,  то  сообщение  на  экране  не  появится,  однако
сработает звуковой сигнал (при установке Sound  is  ON)  и  RVL  будет
ожидать выбора Вами одного из описанных действий.

  RVL не занимается самоконтролем на зараженность.

  RVL может использовать для своппинга память в стандарте EMS, XMS,  а
также дисковое пространство.

  Ниже приводится таблица возможных мест  своппинга,  необходимых  для
этого  драйверов  и  требуемой  памяти.  Список  составлен  в  порядке
убывания скорости работы RVL при своппинге в указанное место.


  Место своппинга                Требуемая память             Драйвер


1.    EMS                        48 Кб, 3 страницы            EMS.SYS,
                                                              QEMM.SYS

2.    XMS                        96 Кб или 48 Кб              
                                 HIMEM.SYS ( см. ключ /1 )

3. Электронный диск              как для XMS                  VDISK.SYS,
                                                             RAMDRIVE.SYS

4. Жесткий диск                  как для XMS


5. Съемный диск,                 как для XMS
   дискета




   Ключи, которые воспринимает RVL :

      /N          не использовать своппинг
      /E          не использовать  EMS для своппинга
      /X          не использовать  XMS для своппинга
      /M          выводить на экран сообщения о своппинге
      /F          полный поиск вирусов в файле
      /C          компьютер оборудован дисплеем CGA (имеет смысл
                  только при заданном ключе /M)
      /1          использовать для своппинга только один файл
                  (размер требуемой памяти или дискового пространства
                   сокращается вдвое, но и скорость работы слегка
                   падает)
     /Ppathname   в какой каталог осуществлять своппинг, если он
                  производится на диск. Например:  /PE:\
      /S          строгий режим - при обнаружении вируса в файле 
                  не пускать файл на выполнение


   По умолчанию, если своппинг производится на диск, то берется корневой
каталог диска C:.



   Некоторые советы:

    - не используйте SideKick

    - загружайте сетевое программное обеспечение перед RVL

    - не пользуйтесь встроенным Бейсик-ом (а кто им пользуется?)

    - не перенаправляете вывод RVL в NUL, то есть не указывайте
      RVL > NUL, на то есть свои причины

    - если RVL при запуске зависает, попробуйте еще раз без всяких
      ключей, или в другой последовательности с остальными резидентами

    - проверьте, работает ли у Вас RVL, запустив в первый раз его
      с ключом /M.  В  случае  правильной  работы  при  запуске  любой
      программы в нижней строке будет появляться надпись

             Swapping Resident Virus Locator on...
             Swapping Resident Virus Locator out...


    - при своппинге на диск не удаляйте возникшие файлы RVLSWAP.111
      и RVLSWAP.222.


    - RVL не следит за тем, достаточно ли свободного места на диске
      для своппинга и верно ли указан каталог в ключе /P. Расплата
      за ошибки - зависание.


    - Если Вы используете драйвер QEMM и загружаете RVL в расширенную
      память с помощью LOADHI, то при выдаче сообщения о вирусе не
      выбирайте Reboot - иначе машина просто зависнет вместо перезагрузки.



   Поскольку  RVL  написан   с   помощью   OBJECT   Professional,   то
большинство  ограничений  идет  оттуда.   Я   надеюсь   в   дальнейшем
модифицировать и улучшить RVL, в основном полагаясь на Ваши  замечания
и пожелания.


                         7.5.2. Использование утилиты RVL.


  Использование  RVL  имеет  смысл  при  работе  в  сильном   вирусном
окружении и особенно в таких случаях:

  1) Вам принесли большое количество программного обеспечения, из которого
   Вы выбираете себе нужное. Конечно, можно проверить все дискеты с помощью
   Вирусного Локатора, но быстрее и удобнее будет загрузить в память RVL,
   который проверит не все дискеты целиком, а только те программы на них,
   которыми Вы заинтересуетесь и запустите на выполнение.

  2) Вы имеете персональный компьютер общего пользования и являетесь его
   основным хозяином или просто серьезно относитесь к вирусным проблемам.
   Вряд ли Вы сможете заставить всех Ваших коллег проверять программы каким-
   либо антивирусом, прежде чем исполнять их на Вашей машине. Намного проще
   загрузить в память Resident Virus Locator на время работы других
   пользователей (лучше поместить вызов RVL в файл AUTOEXEC.BAT).


                          7.5.3. Утилита RI

  Указанная утилита в данную поставку Вирусного Локатора не включена.

                         7.6 Утилита BT

  Указанная утилита в данную поставку Вирусного Локатора не включена.


                         8. Поиск вирусов в режиме Turbo Search
                            и типы вирусов.


  Одним из несомненных удобств Вирусного Локатора  версий  1.4  -  2.0
был поиск вирусов в режиме Quick Search.
  Алгоритм Quick  Search  выглядел  так  :  определяется  точка  входа
(первый исполняемый оператор  программы),  осуществляется  переход  на
нее и с этого места читается 4 Кб. Очевидно, что  при  быстром  поиске
(Quick search) обычно обнаруживается только последний  из  "севших"  в
файл вирусов.
  Этот   метод  давал  резкое  увеличение   скорости  поиска.  Однако,
вместе с увеличением числа пользователей Локатора и его  популярностью
возросло и количество вирусописателей, желающих "побороть" Локатор.
  Итак, появились вирусы, не обнаруживаемые  в  режиме  Quick  Search.
Распознать такой вирус нетрудно, его дамп,  сделанный  для  нескольких
зараженных  файлов  с  помощью  Маскоискателя  ML  будет  почти   весь
состоять из символов подчеркивания (признак несовпадающих кодов).
  Поэтому в Локатор начиная с версии 2.1  введен  режим  поиска  Turbo
Search :

        1) Файлы, не вызывающие подозрения, исследуются в режиме
           Quick Search;
        2) В подозрительных на вирус файлах исследуются места
           возможного нахождения конкретного вируса, примерно так,
           как это делают прочие антивирусные программы.

  Следовательно   алгоритм   Turbo   Search   выглядит   сложнее     и
нетривиальнее  чем  у  Quick  Search.   В   некоторых   файлах   будет
сканироваться в поисках вируса не 4 Кб кодов, а  больше.  Кроме  того,
Turbo Search гарантирует нахождение только тех  вирусов,  обманывавших
Quick Search, которые мне знакомы.


  С версии 2.2 введено понятие "правой границы  поиска"  маски  вируса
для режима Turbo Search. Она означает количество байт от начала  блока
в 4Кб, в котором будет производиться поиск  данной  маски  вируса.  По
умолчанию правая граница равна 4096 байт,  то  есть  блок  исследуется
целиком.
  Вы можете изменить значение правой границы любой маски,  находясь  в
окне "Masks showing & Editing". Для  этого  необходимо  сделать  маску
текущей и нажать клавишу 'B'. Однако советую  внимательно  исследовать
вирус, прежде чем  оптимизировать  поиск  его  маски  таким  способом,
поскольку в случае слишком малой правой границы маска  может  быть  не
найдена. Рекомендую указывать правую границу  с  запасом  в  несколько
десятков байт.
  Режим Full Search Локатора  и  программы  RVL.EXE  игнорируют  любые
установки правой границы, считая ее равной 4096 байт.

  Важно!  Все  маски  вирусов  из  дистрибутивной  поставки   Локатора
обнаруживаются в режиме Turbo Search.


  С точки зрения Вирусного Локатора вирусы делятся на три категории:
 1. Просто вирусы (около 90%) - можно получить их дамп с  помощью  ML,
поместить полученную маску в Локатор и  обнаруживать  вирус  в  режиме
Turbo Search;

 2. Хитрые вирусы (около 9%) - их дамп с помощью ML состоит  из  одних
символов подчерка, но можно выделить маску вируса "вручную" и  текущая
версия Локатора будет обнаруживать ее в  зараженных  файлах  только  в
режиме Full Search;

 3. Вирусы - призраки (менее 1%) - не  имеют  постоянной  сигнатуры  и
требуют   уникальных   для   каждого   такого   вируса   процедур   их
распознавания.  Такие  вирусы  обнаруживаются  Локатором  версии  2.5.
"Маски" этих вирусов расположены в начале списка масок, имеют  нулевую
длину и их нельзя удалять.

  Если Вам попадется новый вирус-призрак или хитрый  вирус,  то  лучше
всего связаться со мной (адрес указан ниже), передать или выслать  мне
несколько  зараженных  файлов.  В  качестве  благодарности  за  свежую
информацию Вы получите новую версию Локатора,  способную  обнаруживать
вирус в режиме Turbo Search.


              9. Дамп и дизассемблирование подозрительных файлов.


  Как и большинство детекторов файловых вирусов, Локатор ищет в  файле
характерную последовательность кодов и ее наличие считает  необходимым
и достаточным условием для того,  чтобы  считать  файл  зараженным.  К
сожалению, на практике  это  может  привести  к  ложному  срабатыванию
детектора, поскольку  такую  же  маску  вируса  может  хранить  другой
детектор как свои данные.
  Но, в отличие от других детекторов, Локатор предлагает  Вам  тут  же
разобраться, обнаружен ли вирус, или произошло ложное срабатывание.
  Для этого  при  обнаружении  в  файле  маски  вируса  VL  предлагает
посмотреть на дамп куска файла,  содержащего  вирусную  маску.  Размер
куска файла не будет превышать 4096+197 байт. Если вирус расположен  в
конце файла, то дамп может  иметь  меньший  размер,  причем  на  экран
выводятся только те байты, которые принадлежат файлу.
  При выводе дампа на экране появится  та  его  часть,  где  находится
обнаруженная  маска,  причем  коды  маски  будут  выделены  ярко-белым
цветом. Это выделение сохранится при любом листании по дампу.

  Если в дампе  файла  присутствуют  характерные  для  данного  вируса
текстовые строки, то Локатор действительно обнаружил зараженный  файл.
А что делать, если  вирус  не  содержит  текстов?  Тогда  не  помешает
посмотреть дизассемблированные коды дампа файла. И это можно  сделать,
не выходя из Локатора.
  Просто нажмите  клавишу  F2,  находясь  в  режиме  показа  дампа,  и
Локатор переключится в режим показа ассемблерных  команд  этого  куска
файла.
  Маска вируса будет выделена белым цветом, как и в дампе.
  Человеку, который знает ассемблер, бывает достаточно бросить  взгляд
на программу, чтобы оценить, может ли она быть частью вируса или  нет.
Тем более, что в последнее  время  я  старался  подбирать  маски  так,
чтобы они представляли собой традиционно-вирусные цепочки команд.

  Конечно,  для  такой  скромной  программы  как  VL  и   дизассемблер
подобран простой. Он не различает данные и команды, не  поможет,  если
часть вируса зашифрована (верно покажет  лишь  незашифрованные  коды).
Не имеет также смысла пользоваться дизассемблером при поиске в  режиме
Full Search.



             10. Warnings - предупреждения о подозрительных файлах.



  Очевидно, что как и  прочие  детекторы,  Вирусный  Локатор  окажется
полезным при  поиске  уже  известных  ему  вирусов.  А  сможет  ли  он
чем-нибудь помочь,  если  необходимо  найти  новый  вирус,  поразивший
компьютер?
  Да, начиная с версии 2.3 Локатор научился обращать Ваше внимание  на
некоторые подозрительные  моменты,  связанные  с  файлами.  В  подменю
Select  options  появилась  строчка  Warnings  -  предупреждения.  Эти
предупреждения включают в себя:

  а) упакованность файла некоторыми упаковщиков.

     Имеется  несколько  упаковщиков  .EXE  и   .COM-файлов,   которые
уменьшают их размер на диске почти вдвое.  Если  зараженный  файл  был
упакован с помощью одного из них, то Локатор, да и большинство  других
антивирусов вирус в нем  не  найдут.  Таким  образом,  если  на  Вашей
машине неизвестно откуда появляется вирус, то проверьте, не служит  ли
его   источником   один   из   таких   файлов.
     На сегодня Локатор знает формат упаковщиков LZEXE, PKLITE,  DIET,
EXEPACK, а также формат  антивирусных  пакетов  фирм  CARMEL,  CPAV  и
F-PROT Скуласона и пакета Norton Utilities 6.0 и 6.01.  Раньше,  когда
Локатор не  обращал  внимания  на  эти  пакеты,  они  порождали  много
предупреждений как файлы, предположительно зараженные вирусами.

    Примечание специально для тех, кто любит напакостить ближнему.  Не
стоит спешить упаковывать зараженные файлы и раздавать их  окружающим.
Дело в том, что ведь и сам вирус скорее всего  не  сможет  догадаться,
что упакованный файл уже заражен, и вскорости  заразит  его  еще  раз,
уже сверху. Ну а в этом случае Локатор скажет свое слово.


  б) соответствие расширения файла его содержимому.

     Для MS-DOS все равно, какое из двух расширений имеет  исполняемый
файл - .COM или .EXE. Пользуясь этим,  некоторые  простые  вирусы  при
заражении .EXE-файлов сначала преобразовывают их в .COM-формат.  Кроме
того, существует  по  крайней  мере  один  вирус,  написанный  в  виде
EXE-программы, который заражая .COM-файлы  пишет  себя  в  их  начало,
формально превращая COM-файл в EXE-файл.
     Следовательно, несоответствие содержимого  файла  его  расширению
может быть серьезным симптомом зараженности файла.


  в) нахождение в окрестности точки входа кодов E8 00 00.

     На ассемблере данные коды выглядят так:

                         CALL A1
                      A1:

и часто используются вирусами  для  определенной  цели.  К  сожалению,
хотя такие  коды  являются  одним  из  важных  признаков  зараженности
файла, но иногда они попадаются и  в  здоровых  программах,  например,
антивирусах фирмы CARMEL.


  г) нахождение точки входа недалеко от конца файла.

     Более половины из всех вирусов при заражении  файла  записываются
в его конец. В результате точка входа  (первый  исполняемый  оператор)
инфицированного файла находится недалеко от конца  файла.  В  Локаторе
принято решение сообщать обо всех  случаях,  когда  в  файле  размером
более 4096 байт точка входа находится ближе 1024 байт от конца файла.
     Будьте особо внимательны, когда различные программы  разных  фирм
имеют одинаковое расстояние до точки  входа  -  возможно,  они  просто
заражены каким-то новым вирусом.

  д) неверная дата файла.

     Сейчас  появилось  достаточно  много  вирусов,   которые   ставят
неверную дату как признак зараженности файла. Локатор  будет  сообщать
обо всех таких случаях, когда в дате  файла  не  выполняется  хотя  бы
одно из следующих условий:

                  Секунды и минуты - от 0 до 59
                  Час              - от 0 до 23
                  День             - от 1 до 31
                  Месяц            - от 1 до 12
                  Год              - не больше текущего


  Теперь в вывод информации  на  принтер  и  в  файл  *.LST  добавлены
описаные выше предупреждения.

  Конечно, данные  предупреждения  весьма  общие,  и  возможны  ложные
срабатывания Локатора. После того,  как  Вы  приведете  вашу  файловую
систему в порядок (исправите неверную  дату  у  файлов,  приведете  их
расширения  в  соответствие  с  содержимым),  процент   предупреждений
должен  колебаться  от  3%  до  10%  при   выключенном   контроле   на
упакованные   файлы.   Абсолютное   число   предупреждений     должно,
естественно, оставаться неизменным в процессе работы  на  машине,  так
что запомните это число и сравнивайте его с  текущим  значением  после
каждого запуска  Локатора.  Если  они  не  совпали  -  обратите  более
пристальное внимание на свой компьютер - возможно он заражен.

  На моей незараженной машине количество  предупреждений  чуть  меньше
3% - 10 файлов из 360, в то время  как  тестовый  запуск  Локатора  на
коллекцию вирусов дал 75% файлов с предупреждениями.


  При  работе  Локатора  в  пакетном  режиме  использование  флага  /Q
означает включение останова только  для  тех  предупреждений,  которые
были включены при работе с меню Warnings.



                   11. История создания и развития Локатора.


  Первая версия Вирусного Локатора  была  создана  в  ноябре  1989  г.
Толчком к его созданию послужил совет Лизенко Сергея сделать что-либо
простое и удобное для поиска вирусов.

  VL написан на языке Turbo-Pascal.
  Для ускорения поиска маски в файле используются (с версии  1.5)  две
ассемблерные процедуры из TURBO-Professional for PASCAL.
  Начиная с веpсии 1.7 вся файловая pабота в  Локатоpе  пеpеписана  на
ассемблеpе.
  В версиях начиная с 2.0  использован  пакет  интегрированного  Help,
написанного программистом Виктором Романюковым на языке C.
  В  версиях  начиная  с  2.2   используется   модуль   дизассемблера,
написанный программистом Семеном Мещеряковым.
  В версии начиная с 2.4 включена утилита BT, написанная под  влиянием
и  при  активном  участии   Ларионова   Евгения,   зарегистрированного
пользователя Вирусного Локатора.
  В версиях начиная с 2.4 утилита  RVL  переписана  с  помощью  модуля
OPSWAP из OBJECT-Professional,  что  позволило  многократно  сократить
занимаемый ею объем оперативной памяти.

  Ценные советы и замечания  по  работе  Локатора  в  сетях  дали  мне
Ларионов Евгений и Менделевич Борис.

  Помощь в тестировании утилиты HDD оказал мне программист Соложенко.

  Вы работаете с VL версии 2.51.

  Эволюция Локатора в версиях 1.0 - 2.4 выглядела  так  (в  скобках  -
версия, в которой появилось указанное свойство):

(1.0)   Первая,   во   многом   несовершенная   версия.   Широко    не
распространялась и не сохранилась в моих архивах.

(1.1) Для поиска масок вирусов использован  высокоскоростной  алгоритм
текстового поиска Боуера и Мура.

(1.2)  Введено именование вирусов.

(1.4)  Локатор производит самоконтроль на заражаемость.

(1.5)  Реализован алгоритм быстрого поиска Quick Search.

(1.6) Появилась возможность  вывода  на  экран  дампа  части  файла  с
вирусной маской.

(2.0) Максимальное количество хранимых в Локаторе  масок  возросло  до
500.
  В Локатор введен интегрированный Help.
  Реализована работа с мышью.
  Поддерживается механизм дескрипторов, который позволяет  для  вируса
выводить на экран его описание из текстового файла.


(2.1)Введено взаимодействие с  программой  RVL  для  занесения  в  нее
масок вирусов.
  Локатор  может  работать  в   расширенных   текстовых   видеорежимах
дисплеев VGA.
  Режим поиска вирусов Quick Search преобразован в Turbo Search.
  Изменен внешний вид Локатора.

(2.2)В кодах масок возможно указание символов шаблона.
  Локатор пополнился встроенным дизассемблером.
  Поиск вирусов расширился обходом каталогов, указанных в PATH или
  в переменной VLDIR.
  Изменился вывод масок на экран.
  На 20-30% увеличена скорость поиска в режиме Turbo Search.

(2.3)Добавлена возможность предупреждений о подозрительных файлах.

(2.4-2.44)Обеспечено надежное распознавание сетевых дисков.
  Появилась возможность подчитки файла с масками.
  В поставку включена новая утилита BT и переписана утилита RVL.
  Увеличилось количество знакомых Локатору упаковщиков исполняемых
  файлов.
  Улучшен и ускорен метод определения сетевых дисков.

(2.5)Добавлен обход дисков по переменной среды VLNET, с исследованием
  подкаталогов.
  Локатор обнаруживает вирусы - призраки, не имеющие маски.
  В поставку включена утилита RLock.

 Локаторы версий с 2.2 по 2.51 совместимы снизу-вверх по файлу VL.MSK.


                      12. Самоконтроль на заражаемость.


  Для  антивирусной  программы  хорошим  тоном   является   какое-либо
самотестирование на зараженность, поскольку вирус в  антивирусе  штука
довольно опасная.
  Естественно, Вирусный Локатор  соблюдает  правила  хорошего  тона  и
предлагает программный метод контроля :

    При запуске Вирусный Локатор проверяет свой размер и  точку  входа
(первый исполняемый оператор).  Если  обнаружено  изменение  любой  из
этих величин, то Локатор  откажется  продолжать  работу  и  сообщит  о
причине  отказа.  Обычно  в  случае  заражения  Вы   будете   получать
сообщения об изменении обеих величин.  Если  изменилась  только  точка
входа,  значит  в  памяти  Вашего  компьютера  сидит  вирус,   который
подсовывает зараженным программам их размер до заражения  (посмотрите,
например, описание вируса RCE2000 в файле  VL1.DSC).  В  любом  случае
советую  прекратить  работу,  загрузиться  с  заклеенной  незараженной
системной дискеты и исследовать VL.EXE маскоискателем (ML).  Поскольку
зараженный Локатор  работать  не  будет,  рекомендую  сделать  заранее
копию полной поставки VL и хранить  ее  на  заклеенной  дискете.  Этот
совет подходит и для любых других программных продуктов,  используемых
Вами.


 Примечание. Локатор не различает  вакцинированность  и  зараженность,
поэтому любое изменение размера файла VL.EXE  при  его  вакцинировании
будет трактоваться как зараженность Локатора.




                        13. Разное.


    Каждый пользователь Локатора имеет право на получение масок  новых
вирусов, новых версий Вирусного Локатора, а также консультаций по  его
использованию и по прочим вирусным и антивирусным проблемам.

  Все претензии, советы и предложения я принимаю  с  благодарностью  и
постараюсь с Вашей помощью улучшать  Локатор.  В  свою  очередь  готов
предоставлять Вам информацию о новых вирусах,  их  масках  и  о  новых
версиях моей программы.
  Если же  Вам  удастся  обнаружить  новый  вирус,  то  я  буду  очень
признателен, если Вы сообщите мне о нем. Желательно, чтобы  информация
о вирусе включала его дамп (сделанный с помощью ML не  менее  чем  для
3-х зараженных файлов), а лучше всего - сам вирус, переданный  мне  на
дискете или через модем. Возврат дискеты гарантирую  и  постараюсь  ее
заполнить новой версией Локатора.


  По всем вопросам обращайтесь ко мне по рабочему телефону:

   (044) 266-70-18 (Киев,с 10.00 до 18.00 Моск. время по рабочим дням).

 и с  помощью  модема  по  этому-же  телефону  с  21.00  до  10.00  по
московскому времени каждый понедельник и четверг,

 или письменно по адресу:

             252142  Киев-142, ул. Семашко, д.10, кв 16,
                          Шеховцову Александру Людвиговичу



 Дополнительно предлагаются следующие услуги:

1.  Получение  текущего  списка  масок  имеющихся  у  меня  вирусов  и
описание нескольких последних из них.

   Для этого следует выслать 3 рубля (или 1 купон) в  конверте, причем  
в письмо вложите надписанный конверт с Вашим   адресом  (конверт лучше  
сложить вдвое, а не загибать в нем уголки).  Желательно  указать номер 
имеющейся у Вас версии Локатора и количество хранимых в нем масок.

   Пользователи,  купившие  Вирусный  Локатор,  получают  эту   услугу
бесплатно в течение квартала со дня покупки.

   При  наличии  модема  Вы  можете  регулярно  связываться   с   моим
компьютером для считывания свежей информации о вирусах и их масках.

2. Получение свежей версии Вирусного Локатора и его утилит.

   Для получения текущей версии Локатора в индивидуальное  пользование
необходимо выслать по указанному выше адресу бандероль  с  дискетой  5
дюймов или ценное письмо с 3-х дюймовой дискетой. В бандероль  (ценное
письмо)  вложите  также  плату  за  Локатор:

   До 1 мая          на Украине          за пределами        для остальных
                                         Украины, в СНГ      стран

Версии 2.51, 2.6    20 купонов + 5 руб.  30 руб. + 7 руб.       $10

Версия 2.6 extended 25 купонов + 5 руб.  40 руб. + 7 руб.       $10
           edition

Утилиты Extended    10 купонов + 5 руб.  15 руб. + 7 руб.       $4
edition для зарегистрированного
пользователя любой из версий
Локатора

  Сумма + 5 или + 7 рублей взимается за  стоимость  пересылки  дискеты
пользователя ценной бандеролью. По желанию покупателя она  может  быть
уменьшена до 2 рублей,  если  поставка  Локатора  высылается  заказным
письмом.
  При оплате покупателем поставки Вирусного Локатора  в  СКВ  почтовые
расходы - за мой счет.

   Для  пользователей,  купивших  ранее  любую  из  предыдущих  версий
Вирусного Локатора, скидка при покупке свежей  версии  составляет  20%
от текущей стоимости Локатора. В этом случае необходимо указать еще  и
серийный номер Вашего Вирусного Локатора.

   Если у Вас  есть  модем,  достаточно  выслать  мне  только  деньги,
указать телефонный номер и время (Московское), когда я смогу  передать
Вам через модем свежую версию Локатора. В этом случае  сумма  +5  (+7)
рублей взимается за оплату междугородней связи.

3. Можно подписаться на Локатор с утилитами на год за наличные или  по
безналичному расчету.

   Подписка включает в себя поставку новых версий Локатора  в  течение
года и сообщение в письменном виде или через модем о новых  вирусах  -
их описания и маски.

   Напишите  мне  и  я  сообщу  Вам  текущую  цену  подписки  и  адрес
ближайшего к Вам дистрибутора моей программы. Как Вы понимаете, и  то,
и другое со временем меняется. По состоянию на первое  полугодие  1992
года цена годовой подписки составляет 4000 рублей.

   Организация, купившая подписку на Вирусный Локатор  получает  право
на его установку и использование на  всех  своих  компьютерах,  но  не
более 100  штук.  В  случае  если  компьютеров  более  сотни,  условия
покупки Локатора должны оговариваться особо. Могу обещать, что они  не
будут грабительскими.




                         март 1992 г.         Шеховцов Александр



--------------------------- Вопросы и ответы -------------------------

1. Почему длина вирусной маски только 15 символов ?

   Эта  величина  была  выбрана  случайно.  Но   в   дальнейшем,   при
исследовании различных антивирусов я обнаружил, что ни один из них  не
ищет вирус по маске большей длины. Кроме того,  при  увеличении  длины
вводимой маски возрастает риск допустить опечатку  при  вводе.  Честно
говоря, я попробовал увеличить длину маски вдвое,  но  ничего  путного
из этого не вышло.
   Для масок с шаблонами длина может достигать 197 символов.

2. Локатор  сообщает  о  зараженности  некоторых  программ,  а  другие
антивирусы молчат. В чем тут дело?

   Конечно, это может оказаться и вирус, особенно  если  Вы  регулярно
вносите в Локатор маски новых вирусов. Но иногда Локатор  обманывается
на некоторых программах, ведь в его основе : простой текстовый  поиск,
и совпадение цепочек кодов  вполне  возможно.  Часто  это  бывает  при
поиске в антивирусах, если они содержат в себе те  же  маски  вирусов,
что  и  Локатор.  Простейший  выход:  поместить  эти   антивирусы   на
отдельную дискету и удалить их с винчестера.
  В подозрительных случаях помогает исследование  дампа  файла  и  его
ассемблерных команд, предлагаемое Локатором. Также рекомендую прочесть
описание вируса, ведь в описании приводятся свойства и признаки вируса.


3. Почему на моем компьютере  все  меню  имеют  красивые  тени,  а  на
других ПЭВМ они пропадают. Это ошибка?

   Нет, просто у Вас хорошая IBM PC с цветным EGA  или  VGA  дисплеем.
Для таких дисплеев рисование теней  под  окнами  не  замедляет  работу
Локатора,  а  для  дисплеев  похуже  подобные  украшения  использовать
неразумно.


4. Почему при установке поиска по "All hard disks"  Локатор  исследует
файлы и на электронном диске ?

   Дело в том, что стратегия поиска по "All hard disks"  -  это  поиск
по всем устройствам, начиная с C:, кроме, конечно,  съемных  дисков  и
дисков, созданных командой SUBST.  Поэтому  в  список  просматриваемых
устройств попадет и электронный диск.
   Если Вас это  не  устраивает,  заведите  переменную  DOS  с  именем
VLNET, укажите в ней список дисков и осуществляйте поиск  Локатором  с
ключем /T или, через меню, в режиме "VLNET directories".


5. Файл заражен одним вирусом  дважды,  а  Локатор  сообщил  о  вирусе
только один раз. Это "прокол" Локатора?

   Нет, все дело в алгоритме поиска. Файл читается блоками по 4  Кб  и
в каждом блоке каждая маска ищется только один раз. Я полагаю, что  VL
используется для поиска вирусов, а не общего числа  вхождений  в  файл
текстовой цепочки.  При  таком  алгоритме  поиска  если  в  один  блок
уложатся две и более маски одного вируса, то будет выдано только  одно
сообщение о вирусе.


6. Если файл читается  блоками,  то  что  будет,  когда  маска  вируса
начнется в одном блоке, а закончится в другом?

   Для  быстрого  поиска  (Turbo  Search)  такой  вопрос   не   стоит,
поскольку из файла будет читаться  только  один  блок  в  4Кб,  а  при
полном  поиске  (Full  Search)  подобный  случай  учтен  и   корректно
обработается (Вы получите сообщение о вирусе).


7. Почему меню Локатора англоязычное, а его Help и дескрипторный  файл
русскоязычные?

   Я хотел написать программу, подходящую для любого  IBM-совместимого
компьютера, даже  с  зашитой  неизменяемой  болгарской,  основной  или
стандартной IBM-кодировкой. Для этого  пришлось  писать  все  меню  на
английском языке. Ну а Help и описания вирусов - это  удобства,  а  за
удобства  нужно  платить.  Для  Локатора  такая  плата:   загрузка   в
знакогенератор альтернативной кодировки.


8. Почему Локатор не ищет BOOT - вирусы?

   Вирусы в BOOT - это совсем  другое,  чем  вирусы  в  файлах.  Нужны
другие алгоритмы их поиска, отдельный список масок бутовых вирусов.
   Вместо этого предлагается  утилита  BT  -  Boot  Tester,  способная
защитить компьютер от любого бутового вируса. Пользуйтесь BT, а  кроме
того не загружайтесь с первой  попавшейся  дискеты  и  бутовые  вирусы
будут Вам не страшны.

9. Как заставить Локатор тестировать оперативную память на вирусы?

   Да никак, он этого не делает из принципа. Стандартом начала  поиска
вирусов  на  компьютере  служит  загрузка  с  заклеенной  незараженной
системной дискеты. Следуйте  этому  совету,  а  также  проверяйте  все
новопринесенные программные  продукты  и  тестирование  памяти  станет
ненужным.


10. Какие требования к "железу" и DOS пред'являет Вирусный Локатор?

   Локатор  работает   на   всех   IBM-совместимых   компьютерах   под
управлением MS-DOS версии не ниже 3.0, в том числе из отечественных  :
на ПЭВМ серии ЕС-1840.
  Но лучшие результаты VL покажет на компьютерах типа IBM PC AT и  IBM
PS/2 с большим винчестерским диском и "ветвящимся"  файловым  деревом,
и с дисплеем EGA или VGA.
  Для  использования  всех  возможностей  Локатора  необходимо   иметь
принтер и мышь.


11. Имеет ли Локатор недокументированные клавиши?

   Да, одна из них - Alt-R в главном меню. Она позволяет  восстановить
картинку  Вирусного  Локатора,  если  она  была  испорчена   чем-либо,
например выводом на экран сообщения резидентной программы.
   Также Локатор  имеет  клавишу  вывода  на  экран  своего  серийного
номера, но как это сделать - знают только покупатели и подписчики.
   Об остальных недокументированных клавишах  -  как-нибудь  в  другой
раз.


12. Какие глобальные перспективы развития Локатора?

   Работа под Windows! Но только если Вы будете как следует давить  на
меня, чтобы я этим занялся...
