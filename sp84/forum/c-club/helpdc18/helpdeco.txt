HELPDECO - Utility-Programm zum Zerlegen von Windows Hilfedateien
HELPDECO - utility program to dissect Windows help files

HELPDECO zerlegt eine HLP-Datei von Windows 3.0, 3.1, 3.11 und '95 und
viele MVB-Dateien des Multimedia-Viewers in alle für den jeweiligen
Hilfecompiler HC30, HC31, HCP, HCW, HCRTF, WMVC, MMVC oder MVC zum
erneuten Zusammenbau erforderlichen Dateien. Dazu gehören:
HPJ - die Projektdatei, als Parameter für den Hilfecompiler anzugeben
MVP - die Multimediaprojektdatei, als Parameter für den MM-Compiler
RTF - die Textdatei mit dem gesamten Hilfetext und allen Fußnoten
PH  - die Phrasen-Datei (wie sie auch vom Hilfecompiler erzeugt wird)
ICO - ein eventuell der Hilfedatei zugeordnetes Icon
BMP/WMF/SHG/MRB - alle Bilder in Dateien mit passendem Format
Baggage - alle als Baggage in der Hilfedatei enthaltenen Dateien

HELPDECO dissects Windows 3.0, 3.1, 3.11 und '95 HLP files and many
multi media viewer MVB files into all files required for a rebuild using
appropriate help compiler HC30, HC31, HCP, HCW, HCRTF, WMVC, MMVC or MVC:
HPJ - help project file, use as parameter when calling help compiler
MVP - multi media project file, parameter for multi media help compiler
RTF - text file containing whole content of help file and all footnotes
PH  - phrases file (same as produced by help compiler)
ICO - icon of help file if embedded
BMP/WMF/SHG/MRB - embedded pictures in appropriate format
Baggage - all baggage files contained in help file

HELPDECO wird von der MS-DOS Kommandozeile aus mit dem Namen der zu
bearbeitenden Datei, eventuell dem Namen einer internen Datei und
eventuellen Optionen aufgerufen. HELPDECO läuft von der Kommandozeile
von Windows 95 oder Windows NT als 32-bit Applikation.
Call HELPDECO from MS-DOS command line. Supply name of help file
to use, optional name of internal file, and options if appropriate.
HELPDECO executes from Windows 95 or Windows NT command line as 32 bit
application.

HELPDECO
Zeigt Benutzungshinweise
Displays usage

HELPDECO helpfilename
Zerlegt die Hilfedatei in alle zum erneuten Zusammenbau benötigten
Dateien. Diese Dateien werden im aktuellen (möglichst leeren)
Verzeichnis abgelegt. Existierende Dateien werden ohne Rückfrage
überschrieben wenn die Option /y angegeben wird.
Decompiles help file into all sources needed for rebuild. All files
are created in current directory (should be empty). Existing files
will be overwritten without asking if option /y was specified.

Options: /m kann verwendet werden, um das Durchsuchen von macros
            nach Topicnamen zu verhindern, wenn dabei Probleme
            auftreten. Hilfecompiler wird Warnung 4131 melden.
            May be used to stop parsing macros for topic names.
            Help compiler will emit Warning 4131.
         /b kann verwendet werden, um das Auflösen von Browse-
            Sequenzen zu verhindern, wenn dabei Probleme auftreten.
            Hilfequelltextdatei enthält dann keine +-Fußnoten.
            May be used to stop resolving browse sequences. Help
            source file than contains no + footnotes.
         /w Erlaubt die Anzeige von Warnungen, die die Meldung 'HELPDECO
            had problems with' erklären.
            Enables display of warnings explaining message 'HELPDECO
            had problems with'.

HELPDECO helpfilename /a [annotationfilename.ANN]
Wie HELPDECO helpfilename, fügt aber zusätzlich alle Anmerkungen aus der
Anmerkungsdatei als Anmerkungen des Benutzers ANN in die RTF-Datei ein.
Fehlt der annotationfilename, verwendet HELPDECO helpfilename.ANN dafür.
Works like HELPDECO helpfilename, but additionally adds all annotations
from annotationfile as hidden annotations from user ANN into RTF file.
Default annotationfilename is helpfilename.ANN.

HELPDECO helpfilename /r
Erzeugt aus der Hilfedatei eine RTF-Datei, die von WinWord geladen
dasselbe Aussehen hat wie die von WinHelp angezeigten Hilfeseiten.
Damit kann eine Hilfedatei komplett gedruckt oder weiterverarbeitet
werden.
Converts help file into RTF file of same appearance if loaded into
WinWord as if displayed by WinHelp. To print or work with complete
content.

HELPDECO helpfilename /c
Erzeugt aus der Hilfedatei eine *.CNT-Datei für WinHlp32, die alle
Kapitel mit Überschriften in der Reihenfolge enthält, in der sie in
der Hilfedatei auftreten. Die Datei muß dann mit HCW 4.00 oder einem
Texteditor in eine hierarchische Struktur überarbeitet werden.
Generates a *.CNT file used by WinHlp32, containing all chapters that
have titles assigned in the order they appear in the helpfile. This
file should then be edited using HCW 4.00 or any text editor into a
hierarchical order.

HELPDECO helpfilename /e
Zeigt alle Referenzen auf externe Hilfedateien. Option /f zeigt zusätzlich
die Titel der Topics an, wo die externen Referenzen auftraten.
Lists all references to external help files. Option /f additionally shows
titles of topics that contained the external references.

HELPDECO helpfilename /p
Prüft Referenzen auf externe Hilfedateien.
Checks references to external help files.

HELPDECO helpfilename /d
Zeigt das interne Inhaltsverzeichnis der Hilfedatei. Es kann auch eine
*.ANN Datei anstelle der Hilfedatei angegeben werden.
Displays internal directory of help file. You may supply an *.ANN file
instead of the help file name.

HELPDECO helpfilename /x
Zeigt das interne Inhaltsverzeichnis als HexDump
Displays hex dump of internal directory

HELPDECO helpfilename "internalfilename"
Zeigt die genannte interne Datei in einem passenden Format an, soweit
die interne Datei anzeigbar ist, sonst als HexDump
Displays internal file in appropriate format if known, else hex dump

HELPDECO helpfilename "internalfilename" /x
Zeigt die genannte interne Datei als HexDump
Displays hex dump of internal file

HELPDECO helpfilename "internalfilename" filename
Exportiert die genanntet interne Datei in filename
Exports internal file into filename

*.ANN, *.CAC, *.AUX
Diese Dateien sind auch wie Hilfedateien formatiert, HELPDECO kann aber
nur verwendet werden, um ihr Inhaltsverzeichnis anzuzeigen oder um
einzelne Dateien anzuzeigen oder zu exportieren.
These files are formatted like helpfiles, but HELPDECO can only be used
to display their internal directory or display or export embedded files.

HELPDECO wurde erstellt von / was written by
Manfred Winterhoff, Geschw.-Scholl-Ring 17, 38444 Wolfsburg, Germany
CIS 100326,2776

Informieren Sie mich, wenn Sie HELPDECO modifizieren oder erweitern um
mehr Features und größere Hilfedateien zu bearbeiten. Sie wollen wirklich
kommentierte Quelltexte ? HELPDECO.C ist bereits 250k gross.
Please give me a note if you modify HELPDECO to handle more formats or
bigger help files. You really want commented source ? HELPDECO.C is
already at 250k.

HELPDECO basiert auf HELPDUMP von Pete Davis veröffentlicht in:
HELPDECO is based upon HELPDUMP from Pete Davis published in:
The Windows Help File Format, Dr. Dobbs Journal, Sep/Oct 1993

Die neueste Version von HELPDECO befindet sich stets in:
The newest public version of HELPDECO is always available at:
CompuServe Dr. Dobbs Journal DDJFOR Undocumented Corner HELPDCxx.ZIP

HELPDECO ist public domain Software. Der Einsatz erfolgt auf eigene
Gefahr. Kein Programmteil darf kommerziell verwendet werden. Für das
Kopieren dürfen keine Gebühren verlangt werden (Sharewarehandel
Finger weg). Immer auch die Quelltexte weitergeben, da es für einige
Hilfedateien erforderlich sein kann, das Programm zu verändern.
HELPDECO is donated to the public domain. Use at your own risk. No
part of the program may be used commercially. No fees may be charged
on distributing the program (shareware distributors keep off).
Always distribute with source as it may be neccessary to modify the
program to handle certain help files.

Version 1.8: used some spare days to clean up the to-do list...
better tracking of TopicOffset during decompilation
lists and checks references to external files, shows referencing topics
can add annotations from .ANN file to decompiled .RTF file
fixed bug in handling of pictures containing JumpId-macro hotspots
changed parsing of macros (3rd attempt to guess what Microsoft did)
fixed bug in popup/jump to external file / secondary window
fixed bug in > footnote / |VIOLA internal file handling
fixed bug in keyword assignment
now removes LZ77 compression from exported SHGs/MRBs
recreates Win 95 (HCW 4.00) [MACROS] section from internal |Rose file
32 bit version available
handles LANGUAGE, [CHARTAB] and [GROUP] section of media view files

Version 1.7
removed unneccessary output statement

Version 1.6 can now check references to external help files plus:
duplicate macro names preceeding picture hotspot info skipped
does not write Win95 commands to multi-media help project files
changed unhash to circumvent Microsoft-C++ float rounding error
handles keywords defined inside topic text

Version 1.5
fixed static on buffer of TopicName function (affected HC30 files)

Version 1.4 fixes some bugs reported by different users:
buffer overflow in expanding LZ77&RunLen (byPacked 3) images fixed
embedded images {bmxwd} larger than 32k supported
extract topic names from jump into external file if no file specified
handles more phrases on HCRTF generated (Win95) help files
Windows 3.1 (HC31) |Phrases always Zeck compressed
LinkData2 buffer enlarged 1 byte to store trailing NUL character

Version 1.3
parses examples of {bmc} etc. statements contained in help text correctly
can now generate a *.CNT content file for Windows 95 / WinHlp32
Microsoft C: ctype macros (isalnum/isprint) don't work with signed char

Version 1.2 fixes some severe bugs introduced in version 1.1 and:
tells you which help compiler to use
collects multiple keyword footnotes into single lines
handles \r\n in COPYRIGHT
converts SPC-macro (but only in [CONFIG] section)
does not generate duplicate MAP-statements if possible
{button} and {mci,mci_left,mci_right} commands supported
[BITMAP]-section in HCRTF help files irritated transparent bitmaps

Version 1.1 now supports more features of Win95/HCRTF 4.00/WinHlp32:
Supports LCID, CHARSET, AUTO-SIZE HEIGHT, CNT, INDEX_SEPARATORS
Additional Win95 Macros (to extract original topic names)
[CONFIG:n] of Win95 supported (internal file |CFn)
Secondary windows with > footnote supported (internal file |VIOLA)
Transparent bitmaps supported (bmct,bmlt,bmrt)
Expanded internal limits as HCRTF allows larger items
Now does RunLen compressed device dependend bitmaps
Bugs in handling of metafiles removed
Bug in placement of pack(1) removed
Parsing of macros changed (is it really better now ?)

HELPDECO wurde mit über 500 Hilfedateien getestet. Aber einige gehen nicht:
HELPDECO was tested with more than 500 help files. But some don't work:
PRINTMAN.HLP      50.743 03/10/92  3:10 (Hilfe zum Druck-Manager) corrupt
WHATSNEW.HLP      92.649 09/26/94 11:38 (Dr. GUI's Espresso Stand -- October 1994)
  HELPDECO does not mark 'Espresso Stand' in Topic 'The Back Page' correctly.
  HCP issued Warning 4171: topic..13 of WHATSNEW.RTF : Cannot use secondary window with popup....
DK_DOC.MVB     3.974.572 11/18/93 23:00 (VfW 1.1e) Can not link...
DK_DOC.HLP     2.673.969 11/19/93  0:00 Can not link...
WIN31WH.HLP    3.390.373  8/14/93 17:28 (Windows 3.1 SDK) Can not link...

