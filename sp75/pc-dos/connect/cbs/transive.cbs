Beep(1000,200)
Rem Connect demo program
Rem –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞
if InitRS("COM2,9600,8,2,N") <> 1 then goto ErrIn
Start:
Select=Menu("d:\connect\Connect.mnu") Rem –í—ã–≤–æ–¥ –º–µ–Ω—é
if Select == 1 then goto TransiveText
if Select == 2 then GoTo Receive
if Select == 3 then GoTo TransiveFile
goto Quit

 Receive: Rem –ü—Ä–∏–µ–º
  Rem –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–∏–µ–º–∞
  PrintS("[5;1;37;40m–ü—Ä–∏–µ–º ...")
  Rem –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—á–∏
  Rem –ü—Ä–∏–µ–º –¥–ª–∏–Ω—ã —Ñ–∞–π–ª–∞
  rts(1); dtr(1)
  if (Code = Receiv(Size,2,0)) <> 0 then goto NotOk
  Rem –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –¥–ª—è –ø—Ä–∏–Ω–∏–º–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
  GetBuf(Buff,Size);
  IndBar(1,Size);
  Rem –ü—Ä–∏–µ–º —Ñ–∞–π–ª–∞ –≤ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä
  if (Code = RecBlk(Buff,Size,1)) <> 0 then goto NotOk
  Rts(0) Rem –ó–∞–ø—Ä–µ—Ç –ø–µ—Ä–µ–¥–∞—á–∏
  PrintS("–ö–æ–Ω–µ—Ü –ø—Ä–∏–µ–º–∞[0;37;40m"); IndBar(0); Beep(1000,200);
  PrintS("–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö")
  Rem –û—Ç–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞ –¥–ª—è –ø—Ä–∏–Ω—è—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  Prints("–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ñ–∞–π–ª ",1)
  PrintS(Open(File,"",1)) Rem –û—Ç–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏ (!)
  WrBlk(File,Buff,Size) Rem –ó–∞–ø–∏—Å—å –ø—Ä–∏–Ω—è—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª
  Close(File) Rem –ó–∞–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞ –ø—Ä–∏–Ω—è—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  DisBuf(Buff) Rem –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
  GoTo Start Rem –í–æ–∑–≤—Ä–∞—Ç –∏–∑ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –ø—Ä–∏–µ–º–∞

TransiveText:
  Rem –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–µ—Ä–µ–¥–∞—á–∏ —Ç–µ–∫—Å—Ç–∞
  TextConv ={Ld:\connect\txtcnv.bin} Rem –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–ºa –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∫–∏
  Rem –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
  PrintS("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞");
  PrintS("–ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª ",1)
  Size = 0;PrintS(Open(File,"",Size)) Rem –û—Ç–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è (!)
  if Size <> 0 then goto TransTxt1
  Prints("[1;40;31m–ü—É—Å—Ç–æ–π —Ñ–∞–π–ª[0;37;40m"); Close(File); Goto Start
TransTxt1:
  GetBuf(Buff,Size) Rem –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –¥–ª—è –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
  RDBlk(File,Buff,Size) Rem –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
  Close(File) Rem –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
  Rem                  –ü–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∫–∞
  Rem –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ TXTCNV.BIN –ø–æ–ª—É—á–µ–Ω–∞ –ø—É—Ç–µ–º –∞—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
  Rem TXTCNV.ASM ,–ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤—è–∑–µ–π –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞-
  Rem –Ω–∏—è –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —ç—Ç–æ–≥–æ EXE- —Ñ–∞–π–ª–∞ –≤ BIN- —Ñ–∞–π–ª —É—Ç–∏-
  Rem –ª–∏—Ç–æ–π –î–û–° EXE2BIN. –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ TXTCNV –ø–µ—Ä–µ–∫–æ–¥–∏—Ä—É–µ—Ç –≤—Ö–æ–¥–Ω–æ–π
  Rem –±—É—Ñ–µ—Ä –≤ –≤—ã—Ö–æ–¥–Ω–æ–π, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–∞–±–ª–∏—Ü—É –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∫–∏, –∏—Å–∫–ª—é—á–∞–µ—Ç
  Rem —Å–∏–º–≤–æ–ª—ã 0Ah –∏–∑ –≤—Ö–æ–¥–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –∏ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –≤—ã—Ö–æ–¥–Ω–æ–≥–æ
  Rem –ø–æ—Ç–æ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ USER.
  Size = USER(TextConv,Buff,Buff)
  dtr(1)
  GoSub WaitCTS
  if Code == 27 then goto Esc
  PrintS("[5;1;37;40m–ü–µ—Ä–µ–¥–∞—á–∞ ... ",1)
  IndBar(1,Size+3)
  Rem –ü–µ—Ä–µ–¥–∞—á–∞ –¥–ª–∏–Ω—ã —Ñ–∞–π–ª–∞+1 –±–∞–π—Ç –¥–ª—è –º–∞—Ä–∫–µ—Ä–∞ –∫–æ–Ω—Ü–∞ —Ç–µ–∫—Å—Ç–∞
  if (Code = Send(Size + 1,2)) <> 0 then goto NotOk
  if (Code = SndBlk(Buff,Size)) <> 0 then goto NotOk Rem  –ü–µ—Ä–µ–¥–∞—á–∞ –§–∞–π–ª–∞
  if (Code = send(255,1)) <> 0 then goto NotOk Rem –ü–µ—Ä–µ–¥–∞—á–∞ –º–∞—Ä–∫–µ—Ä–∞ –∫–æ–Ω—Ü–∞ —Ç–µ–∫—Å—Ç–∞
  PrintS("–ö–æ–Ω–µ—Ü –ø–µ—Ä–µ–¥–∞—á–∏[0;37;40m"); IndBar(0); Beep(1000,200); dtr(0)
  DisBuf(Buff) Rem –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
  Goto Start Rem –í–æ–∑–≤—Ä–∞—Ç –∏–∑ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–µ—Ä–µ–¥–∞—á–∏

TransiveFile: Rem –ü–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–µ—Ä–µ–¥–∞—á–∏ —Ñ–∞–π–ª–∞
Rem –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
PrintS("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞");
Prints("–ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª ",1)
Size = 0; PrintS(Open(File,"*.BIN",Size))
if Size <> 0 then goto TransFile1
 Prints("[1;40;31m–ü—É—Å—Ç–æ–π —Ñ–∞–π–ª[0;37;40m"); Close(File); GoTo Start
TransFile1:
 GetBuf(Buff,Size) Rem –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –¥–ª—è –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
 RDBlk(File,Buff,Size) Rem –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
 Close(File) Rem –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞
 IndBar(1,Size+2)
 dtr(1)
 Gosub WaitCTS Rem –û–∂–∏–¥–∞–Ω–∏–µ CTS
if Code == 27 then goto Esc
 PrintS("[5;1;37;40m–ü–µ—Ä–µ–¥–∞—á–∞ ...",1)
 if (Code = Send(Size,2)) <> 0 then goto NotOk Rem –ü–µ—Ä–µ–¥–∞—á–∞ –¥–ª–∏–Ω—ã —Ñ–∞–π–ª–∞
 if (Code = SndBlk(Buff,Size)) <> 0 then goto NotOk Rem  –ü–µ—Ä–µ–¥–∞—á–∞ –§–∞–π–ª–∞
 PrintS("–ö–æ–Ω–µ—Ü –ø–µ—Ä–µ–¥–∞—á–∏[0;37;40m"); IndBar(0); Beep(1000,200);dtr(0)
 DisBuf(Buff) Rem –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
 GoTo Start Rem –í–æ–∑–≤—Ä–∞—Ç –∏–∑ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–µ—Ä–µ–¥–∞—á–∏
Rem ----------------------------------------------------------------------
WaitCTS:
   if CTS()==1 then PrintS("[1;5;37;40m–û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–∏–µ–º–Ω–∏–∫–∞. Esc - aborts",1)
  Loop: Rem –û–∂–∏–¥–∞–Ω–∏–µ CTS
   if ((CTS()==1) and ((Code = KeyPrs())<> 27)) then goto Loop
   PrintS("[0;37;40m")
Ret
Rem ----------------------------------------------------------------------
ErrIn:
 PrintS("[1;40;31m–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏[0;37;40m"); Stop()
NotOK:
 if Code == 1 then goto Esc else goto Error
Esc:
 PrintS("[1;40;31m–ù–∞–∂–∞—Ç–∞ Esc[0;37;40m");
 GoTo Start
Error:
 Beep(2000,100);
 PrintS("[1;40;31m–û—à–∏–±–∫–∞ –æ–±–º–µ–Ω–∞[0;37;40m");
 Beep(0,100);
 Beep(2000,100)
Exit:
Quit:
 PrintS("[1;40;31m–í—ã—Ö–æ–¥[0;37;40m");
 Beep(1000,200);
 Stop()
