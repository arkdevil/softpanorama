             ┌────────────────────────────────────────────╖
             │  * Обнинский институт атомной энергетики * ║──┐
             │  * Лаборатория "Тренажер" * (08439)20806 * ║▒▒│
             │  * Tsyganok Service * 1992 * Fast Abort  * ║▒▒│
             │  * Свободное распространение * Ver 3.0   * ║▒▒│
             │     * README.FA * 15 ноября 1992 года *    ║▒▒│
             ╘═╤══════════════════════════════════════════╝▒▒│
               │▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ Tsyganok Service '92▒▒▒▒│
               └─────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────╖
│       Мне очень  понравилась программка  "RELEASE", и по глупости  я ее ║
│установил у  себя. Очень  скоро я  понял, что  ЗАМЕЧАТЕЛЬНАЯ идея, может ║
│быть  "нехорошо"  реализована.  Так  как  мне  было  лень  заниматься ее ║
│реассемблированием, то  пришлось написать  эту программу.                ║
│                                                                         ║
│       Итак, что не делает RELEASE, но делает Fast Abort :               ║
│                                                                         ║
│   --  после   установки,  программа  вызывается  в  любой момент, после ║
│       нажатия ???+'='. ( см. ниже )                                     ║
│       [ RELEASE  мне вообще  не удавалось  вызвать из  DOS-а, только из ║
│         NORTON-а ]                                                      ║
│                                                                         ║
│   --  проверяет  наличие в памяти  контролируемых резидентов, т.  е.  у ║
│       вас  может  не  болеть  голова  при удалении резидентных программ ║
│       "автономно".                                                      ║
│       [ RELEASE в этом случае ведет себя непредсказуемо... ]            ║
│                                                                         ║
│   --  может  показывать,  какие  вектора   перехватываются  резидентной ║
│       программой.                                                       ║
│       [ RELEASE не дает такой возможности ]                             ║
│                                                                         ║
│   --  правильно считает размер памяти занимаемой резидентом             ║
│       [ RELEASE почему  - то забывает,  что блоки MCB  тоже имеют длину ║
│         ( 16 байт ) ]                                                   ║
│                                                                         ║
│   --  показывает  сколько  всего свободной  памяти, максимальную  длину ║
│       непрерывного  блока  свободной  памяти,  а  также приблизительный ║
│       объем памяти, выделяемый для загрузки задачи.                     ║
│       [ RELEASE все мешает в одну кучу ]                                ║
│                                                                         ║
│   --  не  повисает  при  установке  в  резидент   задачи  снявшей  свое ║
│       окружение.                                                        ║
│                                                                         ║
│   --  обеспечивает правильную работу с блоками UMB ( DOS 5.00 )         ║
│                                                                         ║
│   --  корректно обрабатывает "резидентов" без PSP                       ║
│                                                                         ║
│   --  поддерживает работу в пакетном режиме ( с версии 3.0 )            ║
│                                                                         ║
╘═════════════════════════════════════════════════════════════════════════╝


                ┌────────────────────────────────────╖
┌───────────────│ Как пользоваться этой программой ? ║────────────────────╖
│               ╘════════════════════════════════════╝                    ║
│       Имеется  2  версии  программы  :  "FA.COM"  ->  русскоязычная,  и ║
│"FAE.COM" -> англоязычная. Они полностью одинаковы, но выдают  сообщения ║
│на  разных  языках.  Далее  рассматривается  программа  "FA.COM", но все ║
│сказанное о ней, относится и к "FAE.COM".                                ║
│                                                                         ║
│       Запустите ее, по команде FA. задача станет резидентной. Далее  вы ║
│можете  вызвать  ее   в  любой   момент   времени  по   ???+'='.  Вместо ║
│??? вы можете задать  свою управляющую клавишу (  Ctrl или Alt или  та и ║
│другая вместе,  по умолчанию  - Ctrl  ).   Задача активируется и покажет ║
│список задач. В графическом режиме активации не происходит.              ║
│       Далее при помощи стрелок "^"  и "v" отмечайте задачи, которые  вы ║
│желаете снять, и нажимаете "Enter".                                      ║
│                                                                         ║
│       Для  выбора  режима  представления  пользуйтесь  стрелками "->" и ║
│"<-".                                                                    ║
│                                                                         ║
│       Если вы не желаете удалять никакого резидента, используйте "Esc"  ║
│                                                                         ║
│       В  предпоследней   строке  даются   данные  о   текущей  активной ║
│программе Однако  имя сообщаемое  в этой  строке НЕ ВСЕГДА соответствует ║
│имени действительно активной  задачи. Это связано  с тем, что  FastAbort ║
│не  отслеживает  завершение  задач,  поэтому  при  выходе  в порождающий ║
│процесс, его имя теряется. Я не захотел увеличивать эту программу еще  и ║
│на буфер отслеживания отношений "родитель"-"потомок". Мои извинения !!!  ║
│                                                                         ║
│    P.S.  Версии 2.0+ отслеживают завершение  задач, но  для  корректной ║
│          работы в любой версии MS DOS  ( 3.30  и  выше )  потребовалось ║
│          бы выделять слишком много памяти.                              ║
│                                                                         ║
│       В последней строке выдается информация о текущем состоянии памяти ║
│вашей машины (  по блокам MCB + UMB ).                                   ║
│       Total free      - показывает размер ВСЕЙ свободной памяти         ║
│       Max free block  - показывает максимальный размер непрерывного     ║
│                         блока свободной памяти                          ║
│       Memory to load  - размер   памяти   для   загрузки   задачи.  Эта ║
│                         величина  равна  длине  текущей активной задачи ║
│                         плюс Max free block ( Что бы легче соображалось ║
│                         при работе в NORTON COMANDER-е )                ║
│                                                                         ║
╘═════════════════════════════════════════════════════════════════════════╝


              ┌───────────────────────────────────╖
┌─────────────│ Формат списка резидентных задач : ║───────────────────────╖
│             ╘═══════════════════════════════════╝                       ║
│  xxxx filename.txt llllll  ?? ?? ?? ?? ?? ?? ??                         ║
│  └┬─┘ └─────┬────┘ └─┬──┘  └───┴──┴──┼──┴──┴──┘                         ║
│   │         │        │               └─ необязательный список векторов  ║
│   │         │        │                  перехватываемых задачей         ║
│   │         │        └─ длина программы в байтах                        ║
│   │         └─ имя резидентной задачи                                   ║
│   └─ PSP резидентной задачи                                             ║
╘═════════════════════════════════════════════════════════════════════════╝


                   ┌─────────────────────────────╖
                   │ П Р Е Д У П Р Е Ж Д Е Н И Е ║
┌──────────────────╘═════════════════════════════╝─────────────────────╖
│        Если ваша резидентная программа напрямую обслуживает какое  - ║
│либо устройство ( диск или сеть ), т. е. выполняет функции  драйвера, ║
│то   ее   снятие   программой   "Fast   Abort"   может   привести   к ║
│непредсказуемым результатам. ( Впрочем это редкий случай ... )        ║
╘══════════════════════════════════════════════════════════════════════╝

                      ┌─────────────────────────╖
                      │ Р Е К О М Е Н Д А Ц И Я ║
┌─────────────────────╘═════════════════════════╝────────────────────────╖
│        Старайтесь   все   резедентные   задачи   запускать   из   файла║
│"AUTOEXEC.BAT", тогда вы значительно уменшите фрагментацию памяти       ║
╘════════════════════════════════════════════════════════════════════════╝


                      ┌──────────────────╖
┌─────────────────────│ О запуске задачи ║────────────────────────────────╖
│                     ╘══════════════════╝                                ║
│       После первого запуска задача всегда остается в резиденте.         ║
│При повторных запусках корректируются параметры резидента.               ║
│                                                                         ║
│       По команде  "FA ?"  программа выдаст  краткую подсказку  по своей ║
│работе.                                                                  ║
│       По  команде  "FA  A"  программа  перейдет  в  режим активации при ║
│нажатии "Alt+'='".                                                       ║
│       По  команде  "FA  C"  программа  перейдет  в  режим активации при ║
│нажатии "Ctrl+'='".                                                      ║
│       По  команде  "FA  CA" программа  перейдет  в  режим активации при ║
│нажатии "Ctrl+Alt+'='".                                                  ║
│       По  команде  "FA -NN" программа удалит NN последних резидентов.   ║
│FastAbort не удаляется в любом случае.                                   ║
│       По  команде  "FA R" программа удаляет ВСЕ резиденты, а затем      ║
│ снимает себя.                                                           ║
│       По  команде  "FA L" на консоль выводится список резидентов.       ║
│                                                                         ║
│       В одной  командной строке  могут присутствовать  хоть все команды ║
│сразу,  можете  посмотреть,  что  получится  при  выполнении   следующей ║
│команды :  FA a?cl-1r                                                    ║
╘═════════════════════════════════════════════════════════════════════════╝


        ┌────────────────────────────────────────────────────────╖
┌───────│ Для интересующихся, несколько слов об алгоритме работы ║────────╖
│       ╘════════════════════════════════════════════════════════╝        ║
│       FastAbort  перехватывает    функцию    4Bxx/(int  21h   DOS  )  И ║
│запоминает  во   внутреннем  буфере   таблицу  векторов. При  выполнении ║
│функций  31xxh DOS или  int  27  DOS  во  внутреннем буфере  формируется ║
│таблица содержащая PSP, имя задачи и перехваченные вектора.              ║
│                                                                         ║
│       При каждом вызове по горячей клавише происходит проверка  наличия ║
│правильных  блоков   MCB  резидентов,  и  при  их отсутствии  считается, ║
│что задача уже снята. Соответственно корректируются внутренние данные.   ║
│                                                                         ║
│       Таблица   резидентов  рассчитана  на   20  задач,   при   условии ║
│что каждая   перехватывает    не   более    10  векторов.    Если   ваша ║
│задача перехватывает   больше   векторов,    то   автоматически    будет ║
│уменьшенно  максимальное   число    отслеживаемых   задач.   (    Короче ║
│говоря,  половина памяти программы занята этой таблицей )                ║
│                                                                         ║
│       При  снятии  задачи,  сначала  восстанавливаются вектора, а потом ║
│освобождаются блоки MCB ( UMB ).                                         ║
│                                                                         ║
│      Из  -  за  вынужденного  использования функций  MS - DOS программа ║
│перехватывает кучу векторов, для  обеспечения правильной работы во  всех ║
│версиях системы старше 3.30                                              ║
│                                                                         ║
│  P.S. Описанный алгоритм применялся в версиях до 2.0.                   ║
│       Сейчас алгоритм изменен, но подробное его описание на мой взгляд  ║
│       нельзя делать достоянием всех и каждого. ( Зачем дарить хорошие   ║
│       идеи начинающим авторам вирусов ? )                               ║
│                                                                         ║
╘═════════════════════════════════════════════════════════════════════════╝

                ┌──────────────────────────────────╖
                │ Замечание от 22 апреля 1992 года ║
┌───────────────╘══════════════════════════════════╝──────────────────────╖
│       У  меня  появился  конкурент  !   Надо  честно  признать,  что С. ║
│Балтер проделал большую  работу  и  значительно улучшил   старый, добрый ║
│RELEASE.   Хотя и   остались кое  - какие  недочеты.   Но его  RELEASE.M ║
│занимает меньше  памяти !  Так что  сравнивайте память  и возможности, и ║
│выбирайте наиболее подходящий вам вариант.                               ║
│                                                 ( Soft - панорама 44 )  ║
╘═════════════════════════════════════════════════════════════════════════╝


                      ┌─────────────────────────╖
┌─────────────────────│ Для борцов с вирусами : ║─────────────────────────╖
│                     ╘═════════════════════════╝                         ║
│       В процессе  установки, задача  удаляет из  памяти свое окружение, ║
│а оставшаяся   длина  равняется   4352  байта  (  110h   параграфов   ), ║
│также перехватываются следующие вектора : 08h, 09h, 21h, 27h, 28h .      ║
│       Программа "FA.COM" имеет  длину 3381 байт, и дату создания  :     ║
│15 ноября 1992 года.  Время создания 4:40.                               ║
│       Программа "FAE.COM" имеет длину 3289 байт, и дату создания  :     ║
│15 ноября 1992 года. Время создания 4:40.                                ║
╘═════════════════════════════════════════════════════════════════════════╝

                       ┌─────────────────╖
                       │ Общие замечания ║
┌──────────────────────╘═════════════════╝────────────────────────────────╖
│                                                                         ║
│       По идее программа должна работать  в DOS 3.30 и выше,  на машинах ║
│класса XT,  AT, PS/2.  Я отлаживал  программу на  машине AT/286 в MS-DOS ║
│5.00.  (  Не  могу  гарантировать  правильную  работу в версиях DOS выше ║
│5.00, кроме того программа не работает в BOX/DOS OS/2 1.2 )              ║
│       Проверена правильность работы в MS - DOS 3.30, 4.0 , 5.0          ║
│                                                                         ║
│       Программа  отслеживает  выполнение  функций  4Bxxh/(int  21h)   и ║
│31xxh/(int  21h)  в  связи  с  чем,  старые  версии  "AIDSTEST",   могут ║
│реагировать  на  нее  сообщением  о  возможном  вирусе  под   сегментным ║
│адресом  ????.  Рекомендую  вызвать  FastAbort,  проверить  соответствие ║
│сегментных адресов, и только после этого давать ответ "AIDSTEST"-у.      ║
│                                                                         ║
│       То же самое относится к программе "-V".                           ║
│                                                                         ║
│       Эта программа  принадлежит к  классу СВОБОДНОГО  распространения, ║
│т.е. вы можете  свободно копировать ее  своим друзьям, знакомым  и т. д. ║
│при условии неизменности ее внутреннего содержимого.                     ║
│                                                                         ║
│       Любое  КОММЕРЧЕСКОЕ   использование  может   происходить   только ║
│по согласованию с автором. ( Адрес дан ниже ... )                        ║
╘═════════════════════════════════════════════════════════════════════════╝

      ┌───────────────────────────────────────────────────────────────╖
      │ ПРЕДУПРЕЖДЕНИЕ  любителям  всякого  рода  "Disk  Editor"ов  : ║
┌─────╘═══════════════════════════════════════════════════════════════╝───╖
│                                                                         ║
│Не следует пытаться менять что - либо  внутри программы. Я не уверен что ║
│после вашей  "правки" программа  будет продолжать  работать. Кроме того, ║
│не  так  уж  много  мозгов  требуется  для  пользования  ЧУЖИМИ ГОТОВЫМИ ║
│программами.   А  может  лучше  вашу  энергию  направить  на   написание ║
│лучшей программы ?                                                       ║
╘═════════════════════════════════════════════════════════════════════════╝

            ┌─────────────────────────────────────────────╖
            │ Как определить наличие программы в памяти ? ║
┌───────────╘═════════════════════════════════════════════╝───────────────╖
│                                                                         ║
│                 Привожу пример ассемблерного кода :                     ║
│                                                                         ║
│       ..........                                                        ║
│                                                                         ║
│cnm:   db      'FA3TV',0 ;; Сюда уже указывает DS                        ║
│                                                                         ║
│       ..........                                                        ║
│                                                                         ║
│       mov     ax,0efefh                                                 ║
│       int     21h                                                       ║
│       cmp     ah,0efh                                                   ║
│       jz      ???     ;; "FA" not loaded.                               ║
│       mov     es,ax                                                     ║
│       xor     di,di                                                     ║
│       lea     si,cnm                                                    ║
│       mov     cx,6                                                      ║
│       cld                                                               ║
│       repe    cmpsb                                                     ║
│       or      cx,cx                                                     ║
│       jnz     ???     ;; "FA" not loaded.                               ║
│                                                                         ║
│;;   "FA" already loaded.                                                ║
│                                                                         ║
│       ..........                                                        ║
│                                                                         ║
╘═════════════════════════════════════════════════════════════════════════╝

                      ┌───────────────────╖
                      │ Хроника изменений ║
┌─────────────────────╘═══════════════════╝───────────────────────────────╖
│                                                                         ║
│       Версия 1.00   / 24 марта 1992 года /                              ║
│               Длина резидентной части 4096 байт                         ║
│               Самая первая версия.                                      ║
│                                                                         ║
│       Версия 1.01   / 18 апреля 1992 года /                             ║
│               Длина резидентной части 3904 байта, работает так - же.    ║
│               Исправлены  мелкие  ошибки  (  иногда неверно востанавли- ║
│               вались вектора )                                          ║
│               Для  текущей   задачи  показываются   все   перехваченные ║
│               вектора.                                                  ║
│       / 22 апреля 1992 года /                                           ║
│               Узнал о конкуренте С. Балтере !   Кто следующий ?         ║
│                                                                         ║
│       Версия 1.01   / 2 сентября 1992 года /                            ║
│               Исправлены мелкие ошибки.                                 ║
│               Большое спасибо Виктору Кузнецову за ряд интересных       ║
│               замечаний.                                                ║
│                                                                         ║
│       Версия 2.0    / 6 октября 1992 года /                             ║
│               В связи с появлением у меня вполне приличной программы  - ║
│               расширителя  форматов  гибких  дисков  PU_1700  ( автор : ║
│               Панков  Ю.  И.  ),  пришлось  коренным образом переделать ║
│               работу  программы.  Теперь  FA  корректно  снимает задачи ║
│               которые остаются резидентными без PSP.                    ║
│               Обеспечивается поддержка  работы с  UMB блоками  для MS - ║
│               DOS  5.00  (  что  заставило  дополнительно перехватывать ║
│               кучу   векторов   для   обеспечения   корректной   работы ║
│               программы. )                                              ║
│               Исправлены очередные мелкие ошибки :                      ║
│                      - работа в монохромном режиме                      ║
│                      - фиксирование снятия задачи                       ║
│                      - правильная обработка блоков памяти > 655 349     ║
│                                                                         ║
│       Версия 3.0     / 15 ноября 1992 года /                            ║
│               Исправлена досадная ошибка : Версия 2.0 конфликтовала с   ║
│               программами типа MicroSoft NMAKE, MicroSoft C 6.00A.      ║
│               ( Спасибо Дмитрию Частикову за сообщение )                ║
│               ( Вообще - то странно : MicroSoft QC 2.5 работал нормаль- ║
│                 но. А полный "C" не захотел... )                        ║
│               Добавлены опции работы в командной строке :               ║
│                      -NN R L                                            ║
│                ( Наконец - то хватило времени... )                      ║
│               Длина резидентной части 4352 байта                        ║
│                 ( Нда.. По сравнению с Ver 1.01 ... )                   ║
│                                                                         ║
╘═════════════════════════════════════════════════════════════════════════╝

                      ┌────────────────╖
                      │ Мои координаты ║
┌─────────────────────╘════════════════╝──────────────────────────────────╖
│                                                                         ║
│       Я уверен, что в этой программе еще имеются неотловленные  ошибки, ║
│поэтому я буду рад, если вы о них сообщите по адресу :                   ║
│                                                                         ║
│       249020 г. Обнинск               ( до марта 1993 года )            ║
│              студгородок ИАТЭ,                                          ║
│              общежитие 15/3                                             ║
│              Цыганку Вадиму Валентиновичу                               ║
│                                                                         ║
│       Если вам очень сильно  понравилась эта программа, можете  выслать ║
│мне некоторую сумму по вашему усмотрению. Честное слово, я не обижусь... ║
│Более того, скажу : "Б О Л Ь Ш О Е   С П А С И Б О" .                    ║
│                                                                         ║
│       Если  очень  не  терпится,  можете  попробовать связаться со мной ║
│через лабораторию "Тренажер" позвонив в Обнинск по телефонам :           ║
│                                                                         ║
│            (084-39) 2-08-06 < мне передадут                             ║
│                     2-03-61 < предпочтительно с 18:00 до 22:00          ║
│                                                                         ║
│       К моему сожелению, я не имею доступа к сетям ( Пока ...? )        ║
│                                                                         ║
│15 ноября 1992 года                                    Цыганок В. В.     ║
╘═════════════════════════════════════════════════════════════════════════╝

                       ┌────────────────────╖
┌──────────────────────│ Большая просьба !!!║────────────────────────────╖
│                      ╘════════════════════╝                            ║
│        Если  Вы  вдруг  обнаружите  какую  - либо программу, снятие    ║
│     которой FastAbort-ом  вызывает зависание  машины, сообщите  мне    ║
│     об этом. А если можно,  то передайте эту программку мне.  Может    ║
│     быть, я что - нибудь придумаю...                                   ║
╘════════════════════════════════════════════════════════════════════════╝

               ┌─────────────────────────────╖
               │ Использованная документация ║
┌──────────────╘═════════════════════════════╝────────────────────────────╖
│                                                                         ║
│    База данных "Tech Help" версия 4.0                                   ║
│          - алгоритм активации                                           ║
│          - структура блоков MCB                                         ║
│                                                                         ║
│    Microsoft MS - DOS Programmer's Reference ( MS - DOS 5.0 )           ║
│          - работа с UMB                                                 ║
│          - уточнение структуры MCB                                      ║
│          - уточнение структуры PSP                                      ║
│                                                                         ║
╘═════════════════════════════════════════════════════════════════════════╝
