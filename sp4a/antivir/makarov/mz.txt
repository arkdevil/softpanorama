
КАТАЛОГ БУТОВЫХ ВИРУСОВ                            (C) Д.А.МАКАРОВ, Москва 1992
_______________________________________________________________________________

     КОД: M-14                                                Редакция 25.08.92

     ИМЯ: MZ (BootChecker)

     УСТАНОВКА: Скрывает от DOS 1 Кб памяти и  создает  там  резидентную  копию
(512 байт).  Перехватывает прерывание 13h (xxxx:0027) - операции с диском, соз-
давая при этом новое прерывание D3h.  При установке с дискеты пытается заразить
жесткий диск.

     ЗАРАЖЕНИЕ: Записывается в сектор 0/0/1,  замещая бут на  дискете,  MBR  на
жестком диске. Хвост (1 сектор) содержит исходный бут или MBR, хранится на дис-
кете в последнем секторе корневого каталога (который вирус вычисляет, используя
BPB), на жестком диске - в секторе 0/0/13 (как правило,  неиспользуемая область
перед первым разделом).  Сохраняет в себе исходные BPB (без OEM ID)  и  таблицу
разделов.
     Попытка заражения жесткого диска происходит при установке вируса с дискеты
(до загрузки DOS), дискеты - при чтении сектора 0/0/1 в дисководах A:,B: (обыч-
но DOS читает этот сектор один раз после смены дискеты, чтобы получить ее пара-
метры). Распознает себя по первым 4-м байтам: E9 14 01 90.

     МАСКИРОВКА: Stealth.  При  чтении сектора 0/0/1 (на любом диске) проверяет
наличие себя в буфере (по первым 4-м байтам),  и если находит,  то  подставляет
правильный бутсектор или MBR. При записи ничего не предпринимает.
     Копирует в себя на дискете байты 0007 - 001D (BPB без OEM ID),  на жестком
диске байты 01BE - 01FF (Partition Table).  Характерных текстов не имеет,  но в
конце BPB (001E-001F) находятся хорошо заметные буквы "MZ".

     ПРОЯВЛЕНИЯ: При чтении с диска ищет какой-то exe-файл по 8 начальным  бай-
там (4D 5A 40 00 88 01 37 0F), и если находит, портит в буфере первый байт, так
что при попытке запустить в присутствии вируса программу с подходящими  первыми
байтами будет выдано сообщение о некорректном формате файла. Оригинал программы
на диске останется в целости,  однако копии также будут испорчены.  Что это  за
программа, установить не удалось; если exe-заголовок корректен, длина ее должна
быть 200256 байт.

     ПОБОЧНЫЕ ЭФФЕКТЫ: Последний сектор каталога дискеты DS/DD используется при
наличии на ней большого количества файлов (более 96).  При заражении такой дис-
кеты попавшие туда файлы будут потеряны.  На дискетах HD это маловероятно.  При
заражении жестких дисков, у которых первый раздел начинается сразу за MBR, сох-
раненный MBR окажется в FAT и может там потеряться.  При этом  для  исправления
FAT можно воспользоваться второй копией,  а правильный вариант таблицы разделов
позаимствовать из тела вируса.
     Исходный бут  на  дискетах DS/DD хранит там же,  где Stoned и его потомки,
поэтому при заражении дискеты, инфицированной ранее кем-нибудь из них, правиль-
ный бут теряется и загрузка становится невозможной.

     ИСТОРИЯ: По  данным  А.Шеховцова,  обнаружен в Институте физики АН Украины
(Киев) летом 1992 года.
