
КАТАЛОГ БУТОВЫХ ВИРУСОВ                            (C) Д.А.МАКАРОВ, Москва 1992
_______________________________________________________________________________

     КОД: M-F0                                                Редакция 25.08.92

     ИМЯ: Turbo Basic (BootChecker, AIDSTEST)

     УСТАНОВКА: Скрывает  от  DOS  2  Кб памяти и создает там резидентную копию
(446 байт).  Перехватывает прерывание 13h (xxxx:000E) - операции с диском.  При
установке с дискеты пытается заразить жесткий диск.

     ЗАРАЖЕНИЕ: Записывается в сектор 0/0/1,  замещая бут на  дискете,  MBR  на
жестком диске. Хвост (1 сектор) содержит исходный бут или MBR, хранится на дис-
кете DS/DD 360 Кб в секторе 0/1/3 (конец корневого каталога),  на других диске-
тах  в секторе 0/1/14 (посдедний сектор корневого каталога для HD 5.25",  пред-
последний - для HD 3.5"),  на жестком диске в секторе 0/0/7 (как правило, неис-
пользуемая область перед первым разделом).  При заражении жесткого диска сохра-
няет в себе исходную таблицу разделов.
     Попытка заражения жесткого диска происходит при установке вируса с дискеты
(до загрузки DOS), дискеты - при каждом обращении к дисководу A: (если в момент
обращения мотор дисковода не был включен).  Распознает себя по первым 4-м  бай-
там: E9 F0 00 39.

     МАСКИРОВКА: Нет.  Копирует  в  себя байты 01BE - 01FF (таблица разделов на
жестком диске, тексты или нули на дискете). В конце тела вируса имеется строка:
"Don't run TurboBasic!".

     ПРОЯВЛЕНИЯ: При чтении с диска секторов, начинающихся на букву "M" (напри-
мер,  заголовков  exe-файлов) считает сумму всех байтов сектора и при некоторых
значениях младшего байта этой суммы (9Ch,  23h,  ABh) портит в нем 2  байта  со
смещением 8 байт от начала, занося туда -1 (FFFFh). В exe-файле это длина заго-
ловка,  так что при попытке запустить в присутствии вируса программу с подходя-
щим первым сектором будет выдано сообщение о некорректном формате файла. Ориги-
нал программы на диске останется в целости, однако копии также будут испорчены.
Судя по  тексту внутри вируса,  значения контрольной суммы рассчитаны на разные
версии Turbo Basic. Текст на экран не выводится.

     ПОБОЧНЫЕ ЭФФЕКТЫ: При заражении дискеты анализирует дескриптор в BPB и де-
лит дискеты на два типа:  DS/DD 360 Кб (дескриптор FD) и все остальные, считаю-
щиеся HD.  На этих дискетах исходный бут попадает в последний или предпоследний
сектор  корневого каталога.  На любых других дискетах (включая QD) исходный бут
попадет в начало области данных, где, скорее всего, испортит какой-нибудь файл,
а потом будет затерт.  Замечу,  что некоторые нестандартные драйверы (например,
800 A.Pasquale) всегда ставят при форматировании дескриптор  F0  (нестандартная
дискета), так что любые отформатированные под ними дискеты, даже на стандартные
360 Кб,  будут восприниматься вирусом как HD, со всеми вытекающими последствия-
ми.
     При заражении жесткого диска никаких проверок не производится,  поэтому на
дисках,  у которых первый раздел начинается сразу за MBR,  сохраненный MBR ока-
жется в FAT.
     Последний сектор каталога дискеты используется при наличии на ней большого
количества файлов (более 96 у DS/DD). При заражении такой дискеты попавшие туда
файлы будут потеряны. На дискетах HD это маловероятно.
     Исходные бут и MBR хранит там же, где Stoned. При заражении диска, инфици-
рованного ранее Stoned или кем-нибудь из аналогов, правильный бут или MBR теря-
ется и загрузка становится невозможной.
     При обработке  операции  16h  (была  ли заменена дискета) часто возвращает
неправильный результат, так как перед этим пытается ее заразить. Это может при-
водить к сбоям и ошибкам катастрофического характера (например, порче FAT).

     ИСТОРИЯ: Обнаружен в Москве в мае 1992 года.  Все,  кроме проявления, дос-
ловно скопировано с вируса March 6 (Michelangelo).
