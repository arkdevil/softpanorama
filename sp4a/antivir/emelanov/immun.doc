
                                     Емельянов Дмитрий Иванович
                                      г.Тольятти, НПЦ "ИНТЕХ"


                           ИММУНИТЕТ

   К числу антивирусных программ добавилась оригинальная разра-
ботка НПЦ "ИНТЕХ" - программа "ИММУНИТЕТ".  Программа дает воз-
можность пользователю иммунизировать имеющиеся у него программы
форматов .COM и .EXE.

   Программа представляет собой систему поиска исполняемых фай-
лов и "заражения" их вырожденным вариантом вируса.  "Вирус" до-
писывается к концу программы и удлинняет ее на 1024 байт (изме-
няется  в  зависимости от версии).  При запуске такой программы
"вирус" получает управление первым и тестирует иммунизированную
программу на предмет заражения ее настоящими вирусами.  Следует
отметить,  что в данном случае безразлично каким именно вирусом
заражена иммунизированная программа, т.е. важен сам факт ее за-
ражения.  Из выше сказанного следует, что в отличии распростра-
ненных  антивирусных средств,  сканирующих диски и программы на
предмет обнаружения уже известных вирусов,  данный метод позво-
ляет своевременно сообщать,  а по возможности и лечить даже не-
известные вирусы.  Достоинства такого метода борьбы с  вирусами
неоспоримы.

   Программа работает со следующими ключами:

   i - установка иммунитета
   u - удаление иммунитета (деиммунизация)

   Программе также указывается имя диска,  на котором  произво-
дится работа,  и путь поиска файлов.  После окончания работы на
экран выводится отчет, содержащий количество найденных исполня-
емых модулей и количество, подвергшееся иммунизации или деимму-
низации.  В ходе работы производится проверка на  возникновение
ошибок и осуществляются действия, направленные на их предотвра-
щение. Сообщения о тех или иных ошибках могут выдаваться на эк-
ран.

   В процессе работы программа может выдавать следующие сообще-
ния:

  - Иммунизирован             Сообщение о успешной иммунизации.

  - Деиммунизирован           Сообщение о успешной деиммуниза-
                              ции.

  - Файл  .COM - структуры    Сообщения о  несоответствии  типа
  - Файл  .EXE - структуры    файла,  указанного  в  расширении
                              имени, с  действительной структу-
                              рой файла.

  - Файл меньше 36 байт       Программа не позволяет иммунизи-
                              ровать файлы, длина кторых меньше
                              36 байт.

  - Файл больше 1Мбайт        Программа не прозволяет иммунизи-
                              ровать файлы,  длина которых пре-
                              вышает 1Мбайт.

  - Длина может превысить 64К Сообщение  выдается  когда  длина
                              .COM файла,   после   иммунизации
                              превышает 64Кбайт

  - Несоответсвие длины файла Сообщение  выдается  при  попытке
                              иммунизировать .EXE файлы,  у ко-
                              торых действительная    длина  не
                              совпадает с длиной,  указанной  в
                              заголовке файла.  Такое сообщение
                              обычно выдается при попытке имму-
                              низировать самораспакующиеся  ар-
                              хивы.


   Запуск зараженного  файла,  которому  был  привит иммунитет,
приводит к тому,  что его выполнение прерывается и на экран вы-
дается сообщение о зараженности данного файла. Следут отметить,
что сообщение о заражении файла может выдаваться при  использо-
вании  различных  утилит и программ,  изменяющих первоначальную
структуру файла.(Например упаковка модуля программой PKLITE или
иммунизация  модулей  сомостоятельно  меняющих свою структуру в
ходе работы.) В сообщении указывается длина,  на которую увели-
чился файл (не надежно),  а также предлагается выбрать дальней-
шие действия:

       - попытку лечения файла
       - продолжение работы
       - выход в DOS

   Лечение файла основвывается на том,  что какой-бы способ за-
ражения  не  применялся  вирусом,  после  загрузки программы на
исполнение и передачи ему управления, вирус должен восстановить
первоначальную  структуру  исполняемого модуля.  Это свойство и
используется ИММУНИТЕТОМ при лечении. После лечения сознательно
не восстанавливаются дата создания файла, его атрибут и не про-
веряется действительно ли вылечился файл,  т.к.  некоторые  ви-
русы,  пререхватывающие большое число функций DOS, при выполне-
нии этих действий заново приведут к заражению файла.  После ле-
чения производится выход в DOS.

   Выбор других  пунктов предлагаемых действий и производимая в
дальнейшем работа в описании не нуждается.

 P.S. Демонстрационные версии программы не  позволяют  произво-
дить  лечение  зараженных  модулей,  ограничиваясь лишь выдачей
сообщения о наличии вируса.
   По вопросам приобретения рабочих  версий  программы  следует
обращяться в НПЦ "ИНТЕХ".

                Приложение для авторов вирусов.

   Иммунизированный модуль в момент  запуска  считывает  начало
собственного  программного файла и проверяет наличие изменений.
К тому же проверяется и точка  входа  в  подпрограмму.  Поэтому
подстановка  в  место  точки входа JMPa не даст никаких положи-
тельных результатов.  И еще,  если  вы  ухитрились  перехватить
достаточное  количество прерываний и функций DOS и удаляете все
следы пребывания вашего вируса в файле, то остается только пох-
валить  вас за ваши труды (вирус не будет обнаружен,  но учтите
программа ИММУНИТЕТ продолжает совершенствоваться).

   Последние версии программы ИММУНИТЕТ производят поиск  изме-
нений  в  иммунизированных модулях непосредственно по секторам,
поэтому такая пакость, как "самоизлечивание" при открытии файла
уже не проходит. Вы знаете как это обойти? Я не знаю.
(Пардон, я уже знаю...)

                           "Дерзайте! Что может быть  приятнее,
                           чем  напакостить  ближнему?  Однако,
                           прежде  всего  советую  основательно
                           подучиться программированию. Учтите,
                           что в вирусе приходится многим  вни-
                           мательно  разбираться и Ваша безгра-
                           мотность сразу станет видна. А кроме
                           того  у Вас появится возможность за-
                           няться чем-нибудь  более  сложным  и
                           полезным, чем изготовление примитив-
                           ных вирусов."

                                               (Лозинский Д.Н.)

   И в заключении нужно еще раз сказать,  что панацеи от компь-
ютерных вирусов не существует.
