                                      Емельянов Дмитрий Иванович

                           АНТИВИРУС

   Данная  антивирусная  программа разработана для обнаружения и
лечения  серии определенного вируса. Этим вирусом является вирус
~Sistor~, который при выдаче программой отчета обозначается, как
~SIS~. Автору  антивируса известны восемь версий данного вируса,
краткое описание  которых  приведены  ниже. Вся серия одинаковым
образом хранит некоторые данные о начальной структуре файла.Если
автор вируса не решит изменить эту структуру,то вполне вероятно,
что антивирус будет ~выкусывать~ и последующие версии вируса.

В антивирус встроена процедура  самопроверки и лечения, т.е. при
заражении программы  выдается  соответствующее сообщение и пред-
лагается возможность лечения. После лечения производится повтор-
ная  проверка  и в  случае зараженности выдается сообщение о не-
удачной попытке лечения.

Sistor 01

   Заражает .COM и .EXE файлы.  Проверка осуществляется по имени
с последующей  проверкой структуры файла (проверяется имеется ли
MZ в начале файла). Вирус перехватывает прерывание INT21h (функ-
ции 4B00h,4B03h,56h,3Dh). Перехватывается также INT24h, что дает
вирусу возможность самому обрабатывать критические ошибки. (Нап-
ример, ошибку, возникающую при попытке записи на защищенную дис-
кету). Вирус  заражает файлы с любым атрибутом, кроме системных.
Время, дата  и атрибут зараженного файла не изменяются. Вирус не
обрабатывает ошибки DOS,  возникшие при работе (например,  пере-
полнение диска),  что может привести к тому, что зараженный файл
оказывается неработоспособным.  Небольшая ошибка, допущенная ав-
тором вируса,  приводит к тому, что вирус иногда может не закры-
вать файлы.

Sistor 02

   Немного подправленная предыдущая версия. В частности, зараже-
ния не происходит при открывании файлов (функция 3Dh в INT21h не
перехватывается), а также исправлена ощибка, приводящая иногда к
незакрытию файлов; введена примитивная проверка на возникновение
ошибок DOS.


Sistor 03

   Автор вируса по всей видимости продолжает свои изыскания. Но-
вая версия   перехватывает  уже  шесть  функций   DOS   (функции
4B00h,4300h,56h,3Dh,0Fh,17h). Запуск зараженного файла на машине
с установленной программной защитой на запись (перехват  INT13h)
приводит к тому, что защита оказывается разблокированной при ус-
ловии, что  на машине установлен DOS 3.30 (вирус  знает  истиный
вектор). В   код вируса введена функция "самоед" (прослеживается
влияние на автора вирусов серии ~Yankey Doodle~). Введена систе-
ма проверки ошибок DOS.


Sistor 04

   К коду предыдущей версии добавлена функция создания  визуаль-
ных эффектов.    Вирус перехватывает прерывание INT1Ch и создает
эффект прыгающего шарика,  который к тому же еще и осыпает буквы
на экране  (автор вируса по всей видимости решил объединить дос-
тижения вирусов ~Ball~ и ~Cascade~ хотя и без намека  на  плаги-
ат). Данная  версия может существовать в двух вариантах: с восс-
тановлением оригинального INT13h и без него.


Sistor 05

   Логическое продолжение версий 03 и 04. К коду вируса добавле-
на функция поиска оригинального вектора INT21h.  Поиск  произво-
дится путем   трассировки имеющегося вектора до попадения в сег-
мент DOS.  После  чего  все  обращения  вируса  к  функциям  DOS
производятся по этому адресу.  Усовершенствован алгоритм зараже-
ния .EXE файлов (предыдущие версии не изменяли значения SS в за-
головке файла, что иногда приводило к нарушению их работы).

Sistor 06

   Ничем не отличается от предудущей версии за исключением того,
что когда сумма текущего числа и дня недели равна двадцати,  за-
пуск зараженного файла сопровождается выводом на экран сообщения
и "зависанием" системы.

Sistor 07

   Версия, подающая надежду на то, что автор не  остановится  на
достигнутом. Код вируса лишился функции из предыдущей версии, но
добавилось число перехватываемых  функций  в  INT21h  (добавлены
функции 4Eh,4Fh,11h,12h). Эти функции используются COMMAND.COM и
другими программами для получения информации о файлах,  располо-
женных на дисках. Вирус, перехватывая их, предоставляет вызываю-
щей программе информацию, не содержащую данные о наличии вируса.
Т.е. просмотр каталога диска отныне покажет вам что длины файлов
не изменились.  Это новое качество вируса позволяет  ему  хорошо
маскироваться.

Sistor 08

   К коду вируса добавилась функция, позволяющая вирусу "пережи-
вать" перезагрузку системы. Достигается это путем перехвата пре-
рывания клавиатуры INT09h.  Теперь  нажатие  клавиш CTRL+ALT+DEL
обрабатывается  вирусом.  Кстати,  как и  в версии 07 визуальные
эффекты возникают при условии, что к моменту их должного появле-
ния  вирус  уже  успел  заразить не менее шестнадцати файлов.  В
более ранних версиях эффекты появлялись после 16 часов.


========= Обнаруживаются антивирусом Лозинского Д.Н. ===========

Sistor-2380
          Заражает COM  и EXE.  Есть основания  подозревать, что
          данный вирус является представителем целого семейства.
          После десяти  заражений происшедших  после 16 часов на
          цветном  экране   появляется  бегающий  мячик,  иногда
          выбивающий  строчные   латинские  буквы   (по   образу
          осыпающихся  букв).   Судя  по  коду,  предусмотрен  и
          звуковой эффект, но мне услышать его не удалось. Слово
          "Sistor"  стоит   в  конце  вируса,  а  за  ним  самый
          последний байт  (05) обозначает,  судя по всему, номер
          версии вируса.

-2225
          Версия 4.  Отличается   весьма   удивительным  методом
          определения кода MS DOS функции.

-1000
          Версия 1.  Только размножается. Алгоритм сравнения,при
          котором  значения,  например,  4Bh и  0Bh неразличимы,
          появился в этой версии и продержался до четвертой.

================================================================
