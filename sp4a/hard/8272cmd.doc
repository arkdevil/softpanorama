



                   Система команд контроллера НГМД i8272

╔═════════════╦═══╦═══════════════════════════════╦════════════════════════╗
║             ║ R ║          Шина данных          ║                        ║
║    Фаза     ║ / ╠═══╤═══╤═══╤═══╤═══╤═══╤═══╤═══╣       Примечание       ║
║             ║ W ║ 7 │ 6 │ 5 │ 4 │ 3 │ 2 │ 1 │ 0 ║                        ║
║═════════════╬═══╬═══╧═══╧═══╧═══╧═══╧═══╧═══╧═══╬════════════════════════╣
║  Приказ     ║ W ║       Read/Write/Scan         ║ Командное слово        ║
║             ║   ╟───┬───┬───┬───┬───┬───┬───┬───╢  (см. таблицу)         ║
║             ║   ║ 0 │ 0 │ 0 │ 0 │ 0 │HDS│DS0│DS1║                        ║
║             ║   ╟───┴───┴───┴───┴───┴───┴───┴───╢                        ║
║             ║   ║             C                 ║                        ║
║             ║   ║             H                 ║                        ║
║             ║   ║             R                 ║                        ║
║             ║   ║             N                 ║                        ║
║             ║   ║            EOT                ║                        ║
║             ║   ║            GPL                ║                        ║
║             ║   ║            DTL                ║                        ║
╠═════════════╬═══╬═══════════════════════════════╬════════════════════════╣
║  Исполнение ║   ║    Выполнение операции        ║                        ║
╠═════════════╬═══╬═══════════════════════════════╬════════════════════════╣
║  Результат  ║ R ║            ST0                ║                        ║
║             ║   ║            ST1                ║                        ║
║             ║   ║            ST2                ║                        ║
║             ║   ║             C                 ║                        ║
║             ║   ║             H                 ║                        ║
║             ║   ║             R                 ║                        ║
║             ║   ║             N                 ║                        ║
╚═════════════╩═══╩═══════════════════════════════╩════════════════════════╝
                              Командные слова
          ╔══════════════════╦═══╤═══╤═══╤═══╤═══╤═══╤═══╤═══╦═══════╗
          ║ Команда          ║ 7 │ 6 │ 5 │ 4 │ 3 │ 2 │ 1 │ 0 ║ Прим. ║
          ╠══════════════════╬═══╪═══╪═══╪═══╪═══╪═══╪═══╪═══╬═══════╣
          ║ Read Data        ║ MT│MFM│ SK│ 0 │ 0 │ 1 │ 1 │ 0 ║       ║
          ║ Read Del.Data    ║ MT│MFM│ SK│ 0 │ 1 │ 1 │ 0 │ 0 ║       ║
          ║ Write Data       ║ MT│MFM│ SK│ 0 │ 0 │ 1 │ 0 │ 1 ║       ║
          ║ Write Del.Data   ║ MT│MFM│ SK│ 0 │ 1 │ 0 │ 0 │ 1 ║       ║
          ║ Read a Track     ║ MT│MFM│ SK│ 0 │ 0 │ 0 │ 1 │ 0 ║       ║
          ╠══════════════════╬═══╪═══╪═══╪═══╪═══╪═══╪═══╪═══╬═══════╣
          ║ Scan Equal       ║ MT│MFM│ SK│ 1 │ 0 │ 0 │ 0 │ 1 ║ *     ║
          ║ Scan Low or Eq.  ║ MT│MFM│ SK│ 1 │ 1 │ 0 │ 0 │ 1 ║ *     ║
          ║ Scan High or Eq. ║ MT│MFM│ SK│ 1 │ 1 │ 1 │ 0 │ 1 ║ *     ║
          ╚══════════════════╩═══╧═══╧═══╧═══╧═══╧═══╧═══╧═══╩═══════╝
    * В командах сканирования последний байт приказа DTL заменяется на STD


╔═════════════╦═══╦═══════════════════════════════╦═══════════════════════╗
║             ║ R ║          Шина данных          ║                       ║
║    Фаза     ║ / ╠═══╤═══╤═══╤═══╤═══╤═══╤═══╤═══╣     Примечание        ║
║             ║ W ║ 7 │ 6 │ 5 │ 4 │ 3 │ 2 │ 1 │ 0 ║                       ║
╠═════════════╩═══╩═══╧═══╧═══╧═══╧═══╧═══╧═══╧═══╩═════════════╦═════════╣
║                            Read ID                            ║ 4AH/0AH ║
╠═════════════╦═══╦═══╤═══╤═══╤═══╤═══╤═══╤═══╤═══╦═════════════╩═════════╣
║  Приказ     ║ W ║ 0 │MFM│ 0 │ 0 │ 1 │ 0 │ 1 │ 0 ║ Командное слово       ║
║             ║   ╟───┼───┼───┼───┼───┼───┼───┼───╢                       ║
║             ║   ║ 0 │ 0 │ 0 │ 0 │ 0 │HDS│DS0│DS1║                       ║
╠═════════════╬═══╬═══╧═══╧═══╧═══╧═══╧═══╧═══╧═══╬═══════════════════════╣
║  Исполнение ║   ║    Выполнение операции        ║                       ║
╠═════════════╬═══╬═══════════════════════════════╬═══════════════════════╣
║  Результат  ║ R ║            ST0                ║                       ║
║             ║   ║            ST1                ║                       ║
║             ║   ║            ST2                ║                       ║
║             ║   ║             C                 ║                       ║
║             ║   ║             H                 ║                       ║
║             ║   ║             R                 ║                       ║
║             ║   ║             N                 ║                       ║
╠═════════════╩═══╩═══════════════════════════════╩═════════════╦═════════╣
║                         Format a Track                        ║ 4DH/0DH ║
╠═════════════╦═══╦═══╤═══╤═══╤═══╤═══╤═══╤═══╤═══╦═════════════╩═════════╣
║  Приказ     ║ W ║ 0 │MFM│ 0 │ 0 │ 1 │ 1 │ 0 │ 1 ║ Командное слово       ║
║             ║   ╟───┼───┼───┼───┼───┼───┼───┼───╢                       ║
║             ║   ║ 0 │ 0 │ 0 │ 0 │ 0 │HDS│DS0│DS1║                       ║
║             ║   ╟───┴───┴───┴───┴───┴───┴───┴───╢                       ║
║             ║   ║             N                 ║ Размер сектора        ║
║             ║   ║            SC                 ║ Количество секторов   ║
║             ║   ║            GPL                ║ Межсекторный GAP      ║
║             ║   ║             D                 ║ Заполнитель           ║
╠═════════════╬═══╬═══════════════════════════════╬═══════════════════════╣
║  Исполнение ║   ║    Выполнение операции        ║                       ║
╠═════════════╬═══╬═══════════════════════════════╬═══════════════════════╣
║  Результат  ║ R ║            ST0                ║                       ║
║             ║   ║            ST1                ║                       ║
║             ║   ║            ST2                ║                       ║
║             ║   ║             C                 ║                       ║
║             ║   ║             H                 ║                       ║
║             ║   ║             R                 ║                       ║
║             ║   ║             N                 ║                       ║
╠═════════════╩═══╩═══════════════════════════════╩═════════════════╦═════╣
║                          Recalibrate                              ║ 07H ║
╠═════════════╦═══╦═══╤═══╤═══╤═══╤═══╤═══╤═══╤═══╦═════════════════╩═════╣
║  Приказ     ║ W ║ 0 │ 0 │ 0 │ 0 │ 0 │ 1 │ 1 │ 1 ║ Командное слово       ║
║             ║   ╟───┼───┼───┼───┼───┼───┼───┼───╢                       ║
║             ║   ║ 0 │ 0 │ 0 │ 0 │ 0 │HDS│DS0│DS1║                       ║
╠═════════════╬═══╬═══╧═══╧═══╧═══╧═══╧═══╧═══╧═══╬═══════════════════════╣
║  Исполнение ║   ║    Выполнение операции        ║ Фазы результата нет   ║
╠═════════════╩═══╩═══════════════════════════════╩═════════════════╦═════╣
║                     Sense Interrupt Status                        ║ 08H ║
╠═════════════╦═══╦═══╤═══╤═══╤═══╤═══╤═══╤═══╤═══╦═════════════════╩═════╣
║  Приказ     ║ W ║ 0 │ 0 │ 0 │ 0 │ 1 │ 0 │ 0 │ 0 ║ Командное слово       ║
╠═════════════╬═══╬═══╧═══╧═══╧═══╧═══╧═══╧═══╧═══╬═══════════════════════╣
║  Результат  ║ R ║            ST0                ║ Фазы исполнения нет   ║
║             ║   ║            PCN                ║                       ║
╠═════════════╩═══╩═══════════════════════════════╩═════════════════╦═════╣
║                            Specify                                ║ 03H ║
╠═════════════╦═══╦═══╤═══╤═══╤═══╤═══╤═══╤═══╤═══╦═════════════════╩═════╣
║  Приказ     ║ W ║ 0 │ 0 │ 0 │ 0 │ 0 │ 0 │ 1 │ 1 ║ Командное слово       ║
║             ║   ╟───┴───┴───┴───┼───┴───┴───┴───╢═══════════════════════╣
║             ║   ║      SRT      │      HUT      ║ Нет фаз результата    ║
║             ║   ╟───────────────┴───────────┬───╢ и исполнения          ║
║             ║   ║            HLT            │ ND║                       ║
╚═════════════╩═══╩═══════════════════════════╧═══╩═══════════════════════╝

╔═══════════════════════════════════════════════════════════════════╦═════╗
║                       Sense Drive Status                          ║ 04H ║
╠═════════════╦═══╦═══╤═══╤═══╤═══╤═══╤═══╤═══╤═══╦═════════════════╩═════╣
║  Приказ     ║ W ║ 0 │ 0 │ 0 │ 0 │ 1 │ 1 │ 0 │ 1 ║ Командное слово       ║
║             ║   ╟───┼───┼───┼───┼───┼───┼───┼───╢                       ║
║             ║   ║ 0 │ 0 │ 0 │ 0 │ 0 │HDS│DS0│DS1║                       ║
╠═════════════╬═══╬═══╧═══╧═══╧═══╧═══╧═══╧═══╧═══╬═══════════════════════╣
║  Результат  ║ R ║              ST3              ║ Фазы исполнения нет   ║
╠═════════════╩═══╩═══════════════════════════════╩═════════════════╦═════╣
║                             Seek                                  ║ 0FH ║
╠═════════════╦═══╦═══╤═══╤═══╤═══╤═══╤═══╤═══╤═══╦═════════════════╩═════╣
║  Приказ     ║ W ║ 0 │ 0 │ 0 │ 0 │ 1 │ 1 │ 1 │ 1 ║ Командное слово       ║
║             ║   ╟───┼───┼───┼───┼───┼───┼───┼───╢                       ║
║             ║   ║ 0 │ 0 │ 0 │ 0 │ 0 │HDS│DS0│DS1║                       ║
║             ║   ╠═══╧═══╧═══╧═══╧═══╧═══╧═══╧═══╣                       ║
║             ║   ║              NCN              ║                       ║
╠═════════════╬═══╬═══════════════════════════════╬═══════════════════════╣
║  Исполнение ║   ║    Выполнение операции        ║ Фазы результата нет   ║
║             ║   ║                               ║ Генерирует прерывание ║
╠═════════════╩═══╩═══════════════════════════════╩═════════════════╦═════╣
║                            Invalid                                ║ XXH ║
╠═════════════╦═══╦═══════════════════════════════╦═════════════════╩═════╣
║  Приказ     ║ W ║   Недопустимый код операции   ║                       ║
╠═════════════╬═══╬═══════════════════════════════╬═══════════════════════╣
║  Результат  ║ R ║            ST0                ║   ST0=80H - признак   ║
║             ║   ║                               ║   ошибки              ║
╚═════════════╩═══╩═══════════════════════════════╩═══════════════════════╝
