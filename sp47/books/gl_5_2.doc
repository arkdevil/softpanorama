                5.4.3.Работа с экраном в текстовом режиме

         Текстовый режим устанавливается автоматически при запуске за-
    дачи на счет или оператором SCREEN 0, если до этого экран работал
    в графическом режиме :

               SCREEN  0 [,[c] [,[ap] [,vp]]]

         По умолчанию емкость строки составляет 80 символов. Однако ее
    можно уменьшить до 40 знаков, применив оператор WIDTH :

                WIDTH  40

         Отображение числовой или символьной информации осуществляется
    путем переписи содержимого выводной строки в участок памяти види-
    мой страницы, начиная с позиции, определяемой текущими координата-
    ми текстового курсора. Положение последнего фиксируется в систем-
    ных переменных CSRLIN (номер строки) и POS (номер столбца). В GW-
    и Quick-системах номер столбца опрашивается с помощью функции
    POS(x), аргумент которой является фиктивным.
         После вывода очередной порции текстовой информации с помощью
    оператора PRINT или WRITE, выводной список которых завершается за-
    пятой или точкой с запятой, курсор перемещается вправо до конца
    выводимых данных. Если выводной список заканчивался символом CR
    ("возврат каретки"), то курсор переводится в начальную позицию
    следующей строки текстового окна. Вывод в последнюю строку тексто-
    вого окна завершается под'емом содержимого экрана на одну строку
    вверх, а курсор переводится в левый нижний угол окна.
         Изменение текущей позиции текстового курсора и способа его
    отображения на экране производится оператором LOCATE :

                LOCATE  [r] [,[c] [,v],[r1][,r2]]

    Параметры r и c задают соответственно номер строки (от 1 до 25) и
    номер столбца (от 1 до 80), на перекрестье которых перемещается
    курсор. Параметр v задает признак видимости (v=1) или невидимости
    (v=0) курсора. Два следующие операнда  определяют номера верхней
    (r1) и нижней (r2) строк в минирастре знакоместа, между которыми
    находится мерцающая часть курсора. Строки минирастра нумеруются
    сверху вниз от 0 .
         При очистке экрана или текстового окна (оператор CLS) курсор
    возвращается в первую позицию начальной строки.
         Вывод текстовой информации производится с помощью операторов
    PRINT, PRINT USING или WRITE, действие которых подробно рассматри-
    валось в разделах 3.2.1, 3.2.2 и 3.2.3.
         С помощью функции SCREEN программа имеет возможность опросить
    код (аргумент cf=1) или цвет (аргумент cf=0 или опущен) символа,
    расположенного на пересечении i-той строки и j-того столбца :

                           N = SCREEN (i, j [,cf])

         Quick BASIC позволяет переписать содержимое одной страницы
    видеопамяти в другую страницу по оператору PCOPY :

                            PCOPY  pg1, pg2

    Первый операнд определяет номер страницы, из которой копируется
    информация, а второй - номер страницы-получателя.


              5.4.4.Работа с экраном в графических режимах

         Экран дисплея переводится в графический режим после выполне-
    ния оператора SCREEN n (1 <= n <= 13). Выбор номера n режима дол-
    жен производиться с учетом типа дисплея, требуемого разрешения и
    желательной цветовой гаммы. Для управления набором допустимых
    цветов и установки необходимых цветовых атрибутов (цвет линий,
    цвет фона) можно воспользоваться операторами COLOR, PALETTE, PALET-
    TE USING, VIEW.
         Для индикации точек дисплея в графическом режиме используется
    система экранных (физических) координат, начало которой расположено
    в верхнем левом углу, а ось y направлена вниз. Физические координа-
    ты измеряются в целых числах от нуля до максимальных значений (Xmax,
    Ymax), однозначно определяемых номером графического режима. Каждая
    точка экрана, представляющая минимальный элемент изображения - пик-
    сель, - характеризуется экранными координатами (x,y) и целочисленным
    кодом цветности.
         Геометрические построения могут производиться как на всей ра-
    бочей области экрана (0 <= x <= Xmax, 0 <= y <= Ymax), так и на
    любой прямоугольной области меньшего размера (0 <= Xmin <= x <=
    Xmax, 0 <= Ymin <= y <= Ymax), называемой графическим окном. По
    умолчанию графическое окно совпадает с полным экраном, однако его
    размеры можно уменьшить с помощью одного из операторов :

             VIEW SCREEN (Xmin,Ymin)-(Xmax,Ymax) [,cf [,cb]]
             VIEW  (dX1,dY1)-(dX2,dY2) [,cf [,cb]]

    В первом случае границы графического окна задаются в физических
    (абсолютных) координатах, а во втором - в приращениях относительно
    положения графического курсора или так называемой текущей точки.
    При установке графического режима текущая точка помещается в нача-
    ло координат. В процессе последующих геометрических построений
    она перемещается в конечную точку очередной воспроизводимой фигуры.
         Программные (математические) координаты точек, задающих кон-
    туры отображаемых фигур, могут не совпадать по своим пределам с
    физическими границами графического окна. Приведение математических
    координат к физическим производится автоматически, если перед вы-
    водом графических об'ектов установить пределы изменения програм-
    мных координат :

               WINDOW [SCREEN] (Xmin,Ymin)-(Xmax,Ymax)

         Преобразование координат из математической системы измерения
    физическую или наоборот можно выполнить с помощью функции PMAP(e,
    i). При i=0 или i=1 эта функция переводит в пиксели значение выра-
    жения e, представляющее координату x или y в математической систе-
    ме измерения. При i=2 или i=3 первый аргумент представляет значе-
    ние координаты x или y в пикселях, преобразуемое в соответствующую
    математическую координату.
         Первую группу графических построений составляют операторы
    отображения элементарных геометрических фигур - точек, отрезков
    прямых или прямоугольников, дуг окружностей или эллипсов.
         Отдельная точка строится с помощью оператора PSET или PRESET :

                      PSET    [STEP]  (x,y) [,c]
                      PRESET  [STEP]  (x,y) [,c]

    Здесь (x,y) - математические координаты отображаемой точки, изме-
    ряемые либо в абсолютной системе координат, либо в приращениях от-
    носительно текущей точки. Последний вариант задается служебным
    словом STEP в теле оператора. Параметр с задает код цветности ото-
    бражаемой точки. Если он задан, то действия операторов PSET и
    PRESET абсолютно идентичны. При отсутствии параметра с оператор
    PSET окрашивает точку в цвет переднего плана, а PRESET - в цвет
    фона. Таким образом PSET строит точку, а PRESET стирает ее. Неза-
    висимо от способа построения новая точка становится текущей.
         Отрезок прямой или прямоугольник, диагональю которого являет-
    ся заданный отрезок, воспроизводится с  помощью оператора LINE :

      LINE  [[STEP](x1,y1)]-[STEP](x2,y2) [,[c][ B [ F ]] [,maska]]

    Начальная и конечная точки отрезка задаются координатами (x1,y1)
    и (x2,y2), которые измеряются либо в абсолютных единицах, либо в
    приращениях (STEP). Если первая точка не задана, то началом отрез-
    ка считается текущая точка.
         Параметр с определяет код цветности отображаемого отрезка или
    границы прямоугольника. Если он не задан, то построение ведется
    цветом переднего плана, установленным ранее по оператору COLOR.
         Символ B (от box) задается в том случае, если вместо отрезка
    прямой должен быть построен прямоугольник. Наличие следующей буквы
    F (от fill) приводит к окраске (заливке) внутренней области прямо-
    угольника.
         Последний параметр, задаваемый целочисленной величиной maska,
    представляет собой 16-разрядную двоичную шкалу, определяющую спо-
    соб воспроизведения линии. Маска накладывается на фрагмент отрезка
    "длиной" в 16 пикселей. Длина измеряется либо по приращению dx, ли-
    бо по приращению dy в зависимости от угла наклона воспроизводимой
    прямой. Единичным разрядам маски соответствуют видимые пиксели от-
    резка, нулевым - невидимые. Затем маска переносится на следующий
    фрагмент отрезка и эта процедура периодически повторяется. Формируя
    соответствующую маску можно строить различные штриховые и штрих-
    пунктирные линии. Маска используется и при заливке прямоугольной
    области, участвуя при окраске очередной горизонтальной линии раст-
    ра.
         После отображения отрезка (прямоугольника) текущей точкой
    становится конечная точка (x2,y2).
         Полная окружность (эллипс) или любой ее фрагмент воспроизво-
    дится с помощью оператора CIRCLE :

            CIRCLE  [STEP] (x,y),R [,[c][,[a1][,a2][,k]]]]

    Точка с абсолютными или относительными (STEP) координатами (x,y)
    задает центр окружности (эллипса). Параметр R определяет радиус
    Rx по оси х (при k<1) или Ry по оси y (при k>1). На самом деле
    речь идет не о двух радиусах, а о двух полуосях Rx и Ry, которые
    участвуют в каноническом уравнении эллипса :

                        x^2/Rx^2 + y^2/Ry^2 = 1

         При Rx=Ry эллипс превращается в окружность, а отношение полу-
    осей Kxy=Rx/Ry  становится равным 1. Окружность, воспроизводимая
    на экране дисплея, трансформируется в эллипс не только за счет не-
    совпадения полуосей, но еще и из-за того, что рабочая область эк-
    рана имеет вид удлиненного прямоугольника и единичные шаги по осям
    x и y имеют различную длину. Для построения идеальной окружности
    коэффициент "сжатия" полуосей эллипса выбирается следующим обра-
    зом :
                      k = ( 4/3 ) * ( Nx / Ny )

    Здесь Nx и Ny - количество пикселей соответственно по осям x и y.
         Параметр с задает код цветности, которым воспроизводится
    контур фигуры. Если он опущен, то контур окрашивается цветом пе-
    реднего плана.
         Построением дуги окружности или эллипса управляют параметры
    a1 и а2, которые задают соответственно углы наклона начального и
    конечного радиус-векторов сектора. Измеряются эти углы в радианах
    и могут принимать любые вещественные значения в диапазоне от
    -2*(пи) до 2*(пи). Углы отсчитываются против часовой стрелки от
    положительного направления оси x до соответствующего радиус-векто-
    ра. На самом деле, границы дуги определяются абсолютными значения-
    ми углов а1 и а2. Отрицательное значение угла вызывает дополнитель-
    ное построение и соответствующего радиус-вектора. Если оба угла от-
    рицательны, то воспроизводится замкнутый круговой или эллиптический
    сектор. Этим свойством обычно пользуются при построении круговых
    диаграмм. По умолчанию а1=0 и а2=2*(пи), что соответствует построе-
    нию полной окружности (эллипса).
         Отображение окружности или эллипса завершается переводом те-
    кущей точки в центр (x,y).
         Достаточно мощными графическими возможностями располагает
    оператор DRAW, тело которого содержит символьную строку, предста-
    вляющую собой последовательность графических команд. Например :

                       DRAW  "U10 R10 D10 L10"

         Отделяются команды друг от друга пробелами. Каждая графичес-
    кая команда состоит из кода операции, задаваемого, как правило,
    одной буквой и определяющего характер построения, вслед за которым
    располагается необходимая числовая информация. В качестве операндов
    графических команд можно использовать значения целочисленных пере-
    менных. Перечень графических команд приведен в табл.18.
         Перемещения графического курсора осуществляются по ребрам ло-
    маной линии, начинающейся из текущей точки. Движение вдоль каждого
    ребра ломаной осуществляется отдельной графической командой. Ко-
    мандам перемещения графического курсора может предшествовать буква
    B или N. Буква B означает, что линейное перемещение не сопровожда-
    ется окрашиванием пройденного отрезка. Буква N приводит к тому, что
    после отображения траектории движения текущая точка возвращается в
    начало отрезка.
         Графическая команда X позволяет компоновать сложные геометри-
    ческие фигуры из ранее описанных графических компонент. Процедуры
    масштабирования, переноса и поворота составных частей предоставля-
    ют пользователю широкие возможности по формированию сложных изо-
    бражений.


                                                   Таблица 18
    ┌────────────────────┬───────────────────────────────────────────┐
    │ Формат графической │                 Пояснение                 │
    │      команды       │                                           │
    ├────────────────────┼───────────────────────────────────────────┤
    │      "Un"          │ Перемещение на n пикселей вверх           │
    │                    │                                           │
    │      "Dn"          │ Перемещение на n пикселей вниз            │
    │                    │                                           │
    │      "Ln"          │ Перемещение на n пикселей влево           │
    │                    │                                           │
    │      "Rn"          │ Перемещение на n пикселей вправо          │
    │                    │                                           │
    │      "En"          │ Перемещение на n пикселей под углом 45    │
    │                    │ градусов                                  │
    │                    │                                           │
    │      "Hn"          │ Перемещение на n пикселей под углом 135   │
    │                    │ градусов                                  │
    │                    │                                           │
    │      "Gn"          │ Перемещение на n пикселей под углом 225   │
    │                    │      градусов                             │
    │                    │                                           │
    │      "Fn"          │ Перемещение на n пикселей под углом 315   │
    │                    │      градусов                             │
    │                    │                                           │
    │   "M[{+|-}]x,y"    │ Перемещение в точку с абсолютными или     │
    │                    │ относительными координатами (x,y)         │
    │                    │                                           │
    │      "Cn"          │ Установка кода цветности n, которым будут │
    │                    │ вестись последующие построения            │
    │                    │                                           │
    │      "An"          │ Установка фиксированного угла поворота    │
    │                    │ (n=0,1,2,3) последующих геометрических    │
    │                    │ элементов. Угол в градусах равен n*90.    │
    │                    │                                           │
    │      "TAn"         │ Установка произвольного угла поворота     │
    │                    │ последующих геометрических элементов в    │
    │                    │ градусах                                  │
    │                    │                                           │
    │      "Sn"          │ Установка масштабного множителя, увеличи- │
    │                    │ вающего или уменьшающего размеры последую-│
    │                    │ щих элементов (по умолчанию действует мас-│
    │                    │ штаб S32). Пределы изменения масштабного  │
    │                    │ коэффициента от 1 до 255                  │
    │                    │                                           │
    │      "Pp,b"        │ Установка цвета заливки (p) и цвета рамки │
    │                    │ (b)                                       │
    │                    │                                           │
    │      "V"           │ Переход на математические координаты      │
    │                    │                                           │
    │    "X"+VARPTR$(A$) │ Выполнение графической подпрограммы,      │
    │                    │ закодированной в переменной A$            │
    └────────────────────┴───────────────────────────────────────────┘

         Если в графическом окне построен любой замкнутый контур, то
    его внутренняя или наружная область может быть окрашена (залита)
    в заданный цвет или заполнена периодически повторяющимся узором.
    Выполняются эти процедуры оператором PAINT, который допускает
    один из двух следующих форматов :

                   PAINT  (x,y), cfill, cbord
                   PAINT  (x,y), mask1$, cbord [,mask2$]

    Здесь  (x,y) - координаты любой внутренней или наружней точки,
                   цвет которой отличается от от цвета граничных
                   точек;
           cfill - целочисленное выражение, задающее код цветности
                   для всех точек окрашиваемой (заливаемой) области;
           cbord - целочисленное выражение, задающее код цветности
                   граничных точек;
          mask1$ - символьное значение, содержащее от 1-го до 64-х
                   знаков, образующих заливающий узор;
          mask2$ - символьное значение, задающее вторую маску узора,
                   предотвращающую досрочное прекращение заливки.

         При заливке области сплошным цветом особых проблем не возни-
    кает за исключением ситуации, когда заливающий цвет (cfill) совпа-
    дает с цветом граничных точек (cbord). Область при этом окрашива-
    ется, но теперь у нее все внутренние (наружние) точки имеют тот
    же цвет, что и граничные. Поэтому последующая попытка окрасить та-
    кую область в любой другой цвет будет игнорироваться.
         Заполнение области узором очень напоминает построение штрихо-
    вых линий с помощью битовой маски. Однако здесь узор имеет площад-
    ный характер и строится следующим образом. Байты маски mask1$ раз-
    ворачиваются в столбец, образуя прямоугольник шириной в 8 бит и
    высотой от 1-го до 64-х бит. Затем этот прямоугольник переносится
    в начало графического окна и начинает последовательно перемещаться
    вправо, формируя своими разрядами новое содержание атрибутов цвет-
    ности внутренних или внешних пикселей области. После окраски точек,
    захваченных сканирующим прямоугольником, шаблон перемещается вниз
    на свою высоту и узором начинает покрываться следующая полоса.
         Вторая маска mask2$ используется в тех случаях, когда узор
    наносится по области, ранее покрытой другим узором или залитой
    цветом, который может встретиться в битовой комбинации нового узо-
    ра. Например, без второй маски нельзя заполнить красно-синими
    штриховыми горизонтальными линиями область, окрашенную в синий
    цвет. Встреча с первым же синим пикселем прервет процедуру залив-
    ки. К досрочному завершению оператора PAINT может привести и сов-
    падение двух соседних байтов заливающего узора.
         Для желающих поэкспериментировать с масками и познакомиться
    со способами формирования узоров предлагаем несколько фрагментов,
    заимствованных из различных источников :

         'Д.Грайс. Графические средства персонального компьютера

         PAINT   (160,100), "ABCCEF", 2, "C"

         'D.Herbert. Turbo BASIC Instant Reference

         CLS : SCREEN  1,0 : COLOR  1,1
         FOR  I%=1  TO  8
              READ  T%
              MASK1$ = MASK1$ + CHR$ (T%)
         NEXT  I%
         FOR  I%=1  TO  8
              READ  T%
              MASK2$ = MASK2$ + CHR$ (T%)
         NEXT  I%
         LINE  (10,10) - STEP(200,150), 3, B
         PAINT STEP(-5,-5), MASK2$, 3
         LINE  (60,60) - STEP(100,50), 3, B
         PAINT STEP(-5,-5), MASK1$, 3, MASK2$
         ....................................
         DATA  24,60,90,153,96,36,102,153
         DATA  24,36,66,129,129,66,36,24

         'V.V.Hari, Murat Tanik & Udo W.Pooch.
         '            Illustrated Quick BASIC

         SCREEN  1 :  CLS
         MASK1$ = CHR$(120)+CHR$(0)+CHR$(128)+CHR$(0)+CHR$(129)+CHR$(0)
         MASK2$ = CHR$(&H80)+CHR$(&H60)+CHR$(&H30)+CHR$(&H6)+CHR$(&H1)
         LINE  (40,40) - (300,150),,B
         PAINT (50,50), MASK2$

         Информация о пикселях, отображаемых в графическом окне, хра-
    нится в видеоЗУ, допускающем не только режим записи (вывода новых
    данных), но и режим чтения. Для реализации процедур опроса графи-
    ческих атрибутов указанного пикселя или текущей точки (графическо-
    го курсора) используется функция POINT, допускающая две модифика-
    ции :

                      COLOR = POINT (x,y)
                      COORD = POINT (n)

         В первом варианте функция POINT выдает атрибут цветности пик-
    селя с заданными координатами. Второй вариант позволяет опросить
    координату x (n=0,2) или y (n=1,3) текущей точки, которая может
    быть выдана в пикселях (n=0,1) или в единицах, установленных про-
    граммой по оператору WINDOW SCREEN (n=2,3).
         С помощью функции POINT можно просканировать точки некоторой
    области экрана и подвергнуть их атрибуты цветности определенным
    преобразованиям. Например, следующий фрагмент осуществляет замену
    позитивного изображения на экране негативным :

                     SCREEN  2
                     FOR  I=0  TO  199
                          FOR  J=0  TO  639
                               PSET (I,J), 1 - POINT (I,J)
                          NEXT  J
                     NEXT  I

         Аналогичным способом можно в цикле прочитать и запомнить со-
    стояние всех точек некоторой прямоугольной области экрана. Однако
    процедуры такого рода выполняются очень медленно и связаны с боль-
    шими затратами памяти, так как на каждый пиксель будет занято не
    менее двух байтов вместо 1-4 битов.
         Гораздо более эффективными являются процедуры обмена с видео-
    памятью с помощью операторов GET и PUT :

            GET  [STEP](x1,y1) - [STEP](x2,y2), A%
            PUT  [STEP](x,y), A% [,mode]

    В первом операторе точки (x1,y1) и (x2,y2) задают прямоугольную
    область, сведения об атрибутах цветности всех ее точек запоминают-
    ся в элементах целочисленного массива A%. Процедура чтения соответ-
    ствующего фрагмента видеоЗУ начинается с левого верхнего угла пря-
    моугольника - пикселя с координатами (x1,y1). Затем извлекается
    атрибут цветности следующего по строке пикселя - (x1+1,y1), и т.д.
    Когда набирается полный байт, содержащий сведения о смежных пиксе-
    лях строки (8,4 или 2 пикселя в зависимости от типа дисплея и уста-
    новленного режима), его записывают в массив A%. Последний байт ска-
    нируемой строки может оказаться не полным и все его незаполненные
    биты сбрасываются в нуль. Первым двум элементам массива A% присва-
    иваются соответственно число битов в строке обрабатываемого прямо-
    угольника и число строк.
         Длина в байтах массива A%, необходимая для размещения инфор-
    мации об изображении, подсчитывается по формуле :

      L = 4 + INT (((x2 - x1 +1) * bpp + 7) / 8) * np * (y2 - y1 +1)

    Здесь bpp - число битов на пиксель в слое видеоЗУ;
           np - число слоев видеоЗУ.

    Параметры bpp и np зависят от установленного режима работы и раз-
    мера видеопамяти (см. табл.19).

                                      Таблица 19
            ┌───────────────────────────────────────┐
            │ Режим       bpp       np              │
            ├───────────────────────────────────────┤
            │   1          2        1               │
            │   2          1        1               │
            │   7,8        1        4               │
            │   9          1        2  (EGA, 64K)   │
            │                       4  (EGA, > 64K) │
            │  10          1        2               │
            │  11          1        1               │
            │  12          1        4               │
            │  13          8        1               │
            └───────────────────────────────────────┘

         Сформированный таким способом графический образ прямоуголь-
    ной области экрана может быть использован для модификации изобра-
    жения или его запоминания в дисковом файле :

                BSAVE  "IMAGE1", VARPTR(A%(0)), L

    Здесь  IMAGE1 - идентификатор дискового файла;
           VARPTR(A%(0)) - начальный адрес массива A%;
           L - длина массива A% в байтах.

         Оператор PUT переносит прямоугольный фрагмент изображения
    из массива A% в область видеопамяти, начиная с пикселя с координа-
    тами (x,y). Третий параметр mode определяет режим взаимодействия
    вновь заносимых атрибутов цветности с находящимися в видеоЗУ. За-
    дается он одним из пяти служебных слов и принимает следкющие зна-
    чения :

           PSET - атрибут цветности из массива A% замещает прежний
                  экранный атрибут пикселя;
         PRESET - новый атрибут цветности инвертируется и замещает
                  прежний экранный атрибут пикселя;
            XOR - новый атрибут цветности поразрядно складывается с
                  экранным по модулю 2 (логическая операция "исклю-
                  чающее ИЛИ");
             OR - новый атрибут цветности логически складывается с
                  экранным;
            AND - новый атрибут цветности логически умножается на
                  экранный.

         Для оживления изображения на экране обычно прибегают к сле-
    дующему приему. Сначала прямоугольный фрагмент запоминается и сра-
    зу выдается в ту же область с режимом XOR. При этом все биты цве-
    товых атрибутов становятся равными нулю, что сооответствует залив-
    ке прямоугольника цветом фона, т.е. стиранию прежнего изображения.
    Затем повторно выполняется оператор PUT, но уже со смещением точ-
    ки привязки области. Скорость перемещения "картинки" по экрану
    можно регулировать путем задержки (пустой цикл, оператор DELAY)
    между стиранием прежнего изображения и выводом нового. Для увели-
    чения скорости вывода можно включить режим TURBO, если в компьюте-
    ре имеется возможность повысить тактовую частоту.

         5.4.5.Использование функций BIOS для управления дисплеями

         Процесс совершенствования аппаратуры обычно опережает разра-
    ботку прикладного программного обеспечения. Поэтому некоторые воз-
    можности современных дисплеев не обеспечиваются стандартными про-
    цедурами Бейсик-систем, особенно если мы имеем дело с их ранними
    версиями. Однако Turbo и Quick BASIC предлагают средства для моде-
    лирования машинной команды прерывания (INT), что позволяет обра-
    титься к дисплейному сервису BIOS путем вызова соответствующей
    процедуры :

       Turbo :   CALL  INTERRUPT   nInt
       Quick :   CALL  INTERRUPT  (nInt, inReg, outReg)
                 CALL  INTERRUPTX (nInt, inReg, outReg)
                 CALL  INT86OLD   (nInt, inArray, outArray)
                 CALL  INT86OLDX  (nInt, inArray, outArray)

    Здесь      nInt - номер прерывания, определяющий класс функций
                      BIOS;
              inReg - переменная типа запись, поля которой предназна-
                      чены для хранения входной информации, переписы-
                      ваемой системой в соответствующие регистры цен-
                      трального процессора перед обращением к функции
                      BIOS;
             outReg - аналогичная переменная, в поля которой система
                      переносит выходную информацию из регистров цен-
                      трального процессора после выполнения процедуры
                      BIOS;
            inArray - целочисленный массив с входной информацией,
                      аналогичной записи inReg;
           outArray - целочисленный массив с выходной информацией,
                      аналогичной записи outReg.

         Все процедуры BIOS получают входную информацию в виде содер-
    жимого тех или иных регистров центрального процессора. Всего таких
    16-разрядных регистров 10, и они имеют стандартные обозначения -
    AX, BX, CX, DX, BP, SI, DI, Flags, DS и ES. Не вдаваясь в конкрет-
    ное назначение каждого из них, отметим лишь, что в ряде процедур
    BIOS задействованы раздельно младшие (к первой букве имени регист-
    ра добавляется L - от Low) и старшие (к первой букве имени регист-
    ра добавляется H - от High) разряды регистра. Очевидно, что содер-
    жимое полного регистра и его компонент связаны элементарными соот-
    ношениями :

                      AX = 256 * AH + AL
                      AL = AX MOD 256
                      AH = (AX - AL) / 256

         В Turbo BASIC'е область памяти, предназначенная для хранения
    содержимого регистров CPU, считается принадлежностью системы. За-
    полняются ее компоненты по оператору REG :

                      REG   nReg, val

    Здесь nReg - числовой номер из интервала от 0 до 9, определяющий
                 позицию соответствующего регистра в системном масси-
                 ве (0 - Flags, 1 - AX, 2 - BX, 3 - CX, 4 - DX, 5 -
                 SI, 6 - DI, 7 - BP, 8 - DS, 9 - ES);
           val - целочисленное значение, записываемое в выбранный
                 элемент служебного массива.

    Заполнение нужных элементов служебного массива должно быть выполне-
    но до обращения к подпрограмме INTERRUPT. После обработки прерыва-
    ния содержимое всех регистров CPU переносится в тот же служебный
    массив, и доступ к нужной компоненте организуется с помощью функ-
    ции REG(nReg).
         В Quick BASIC'е области с информацией для регистров CPU могут
    быть разделены и описываются как обычные переменные задачи :

                 TYPE  RegType
                       AX  AS  INTEGER
                       BX  AS  INTEGER
                       CX  AS  INTEGER
                       DX  AS  INTEGER
                       BP  AS  INTEGER
                       SI  AS  INTEGER
                       DI  AS  INTEGER
                    Flags  AS  INTEGER
                       DS  AS  INTEGER
                       ES  AS  INTEGER
                 END TYPE
                 inReg  AS  RegType
                 ...................
                 inReg.AX = 1
                 CALL  INTERRUPT (&H10, inReg, inReg)

         Единственное отличие подпрограммы INTERRUPTX заключается в
    том, что она обеспечивает работу с полным набором из 10 регистров,
    тогда как в процедуре INTERRUPT используются только первые 8.
         В подпрограммах INT86OLD и INT86OLDX регистровые области опи-
    сываются как обычные целочисленные массивы (inArray(1)=AX,
    inArray(2)=BX, ...) :

                  DIM  inArray  (1 TO 10)  AS INTEGER
                  DIM  outArray (1 TO 10)  AS INTEGER

         Видеосервис BIOS реализуется с помощью прерывания &10H (более
    60 функций и подфункций). Номер функции задается содержимым реги-
    стра AH, номер подфункции - содержимым регистра AL или BL. Подроб-
    ное описание каждой процедуры видеосервиса можно найти в техничес-
    кой документации по BIOS, отдельные из этих функций можно встретить
    в довольно редких пока публикациях по ассемблеру (например, Л.Скэн-
    лон. Персональные ЭВМ фирмы IBM PC и XT. Программирование на языке
    ассемблера.-М.: Радио и связь. 1989).
         Однако техническая литература практически не доступна нашим
    пользователям, так как кооперативные поставки зарубежных средств
    вычислительной техники ведутся, как правило, без всякой документа-
    ции, а дисплеи на отечественных ПЭВМ типа ЕС-1840 и ЕС-1841 пока
    еще находятся на первобытном уровне. Поэтому автор расчитывает на
    снисхождение со стороны любителей Бейсика за включение в настоящий
    раздел казалось бы лишней информации о дисплейных процедурах (табл.
    20 - 23).

           Таблица 20. Дисплейные функции 0 - 16
    ┌───────┬────────────────────────────────┬───────────────────────┐
    │ Номер │      Выполняемая операция      │ Содержимое регистров
    │функции│ (Реализация средствами BASIC'а)│
    │(AH/AL)│                                │
    ├───────┼────────────────────────────────┼────────────────────────
    │   0   │Установка режима работы монитора│ AL = номер режима
    │       │  (Оператор SCREEN, частично)   │      (см.табл.14)
    │       │                                │
    │   1   │ Установка габаритов курсора    │ CH = начальная строка
    │       │     (Оператор LOCATE)          │      минирастра
    │       │                                │ CL = конечная строка
    │       │                                │
    │   2   │ Установка курсора в заданную   │ BH = номер страницы
    │       │            позицию             │       (0 для графич.
    │       │       (Оператор LOCATE)        │        режима CGA)
    │       │                                │ DH = строка (от 0)
    │       │                                │ DL = столбец (от 0)
    │       │                                │
    │   3   │ Опрос позиции курсора и его    │ BH = номер страницы
    │       │           размеров             │ Выходная информация
    │       │    (Функция POINT, частично)   │ DH = номер строки
    │       │                                │ DL = номер столбца
    │       │                                │ CH = нач. строка
    │       │                                │      минирастра
    │       │                                │ CL = конеч. строка
    │       │                                │      минирастра
    │       │                                │
    │   4   │ Опрос состояния светового пера.│ Выходная информация
    │       │ Не поддерживается картой VGA   │ AH = 0|1 (триггер СП)
    │       │      (Функция PEN)             │ DH = номер строки
    │       │                                │ DL = номер столбца
    │       │                                │ CH или CX = коорд. x
    │       │                                │        в пикселях
    │       │                                │ BX = координата y
    │       │                                │        в пикселях
    │       │                                │
    │   5   │ Установка номера активной      │ AL = номер стр. (от 0)
    │       │          страницы              │
    │       │      (Оператор SCREEN)         │
    │       │                                │
    │   6   │ Под'ем текстовой информации в  │ AL = число строк, на
    │       │ заданной прямоугольной области.│    которое происходит
    │       │ При AL=0 происходит очистка    │    под'ем
    │       │ окна                           │ BH = атрибут для очи-
    │       │                                │        щаемых строк
    │       │                                │ CH = номер строки
    │       │                                │      верхнего левого
    │       │                                │      угла окна
    │       │                                │ CL = номер столбца
    │       │                                │      верхнего левого
    │       │                                │      угла окна
    │       │                                │ DH = номер строки
    │       │                                │      нижнего правого
    │       │                                │      угла окна
    │       │                                │ DL = номер столбца
    │       │                                │      нижнего правого
    │       │                                │      угла окна
    │       │                                │
    │   7   │ Спуск текстовой информации в   │ См. функцию 6
    │       │ заданной прямоугольной области.│
    │       │ При AL=0 происходит очистка    │
    │       │ окна                           │
    │       │                                │
    │   8   │ Опрос кода символа и атрибута  │ BH = номер страницы
    │       │ цветности в позиции курсора.   │ Выходная информация
    │       │ В графическом режиме атрибут   │ AH = атрибут
    │       │ смысла не имеет                │ AL = код ASCII
    │       │                                │
    │   9   │ Вывод символа и атрибута в по- │ AL = код ASCII
    │       │ зицию курсора с возможностью   │ BL = атрибут
    │       │ размножения символа. Позиция   │ BH = номер активной
    │       │ курсора не меняется. В графич. │      страницы (для
    │       │ режиме три младших бита BL -   │      текст. режима)
    │       │ цвет переднего плана. Если бит │ CX = число повторений
    │       │ 7 в BL установлен в "1", то    │
    │       │ код цветности складыватся по   │
    │       │ операции XOR с цветом фона     │
    │       │                                │
    │  10   │ Вывод символа подобно функции  │ См. функцию 9
    │       │ 9 без изменения атрибута цвет- │
    │       │ ности в текстовом режиме       │
    │       │                                │
    │  11   │ Установка параметров текущей   │ BH = 0 для установки
    │       │ палитры для CGA                │        цвета рамки
    │       │ (Операторы SCREEN и COLOR)     │        или фона
    │       │                                │ BH = 1 для выбора
    │       │                                │        палитры
    │       │                                │ BL = цвет фона в
    │       │                                │      графич. режиме
    │       │                                │ BL = цвет рамки в
    │       │                                │      текст. режиме
    │       │                                │      при BH=0
    │       │                                │ BL = 0|1 (номер палит-
    │       │                                │      ры при BH=1)
    │       │                                │ DH = строка
    │       │                                │ DL = столбец
    │       │                                │
    │  12   │ Вывод пикселя заданного цвета  │ AL = n * 16 + c
    │       │ в позицию с заданными координа-│    (c - цвет, 0-15
    │       │ тами. При n=0 новый цвет пиксе-│     n - способ вывода)
    │       │ ля замещает атрибут цветности  │ BH = дисплейная стрн.
    │       │ в видеоЗУ, при n=8 новый цвет  │ DX = строка растра
    │       │ складывается с прежним по XOR  │ CX = столбец растра
    │       │ (Операторы PSET и PRESET)      │
    │       │                                │
    │  13   │ Опрос цвета пикселя, располо-  │ BH = дисплейная стрн.
    │       │ женного в указанной позиции    │ DX = строка растра
    │       │        (Функция POINT)         │ CX = столбец растра
    │       │                                │ Выходная информация
    │       │                                │ AL = цвет пикселя
    │       │                                │
    │  14   │ Вывод символа в режиме TTY     │ AL = код ASCII
    │       │ (телетайпа), при котором симво-│ BH = активная стрн.
    │       │ лы с кодами 07(звонок), 08(во- │     (не используется
    │       │ зврат на символ), 0A(перевод   │      в графич.режиме)
    │       │ строки) и 0D(возврат каретки)  │ BL = цвет символа
    │       │ не заносятся в видеоЗУ, а вы-  │     (применяется только
    │       │ полняют свои прямые функции.   │      в графич.режиме)
    │       │ Курсор при выводе отображаемо- │
    │       │ го символа продвигается на од- │
    │       │ ну позицию вправо              │
    │       │                                │
    │  15   │ Опрос текущего видеорежима     │ Выходная информация
    │       │                                │ AL = номер режима
    │       │                                │ BH = число символов
    │       │                                │      в строке
    │       │                                │ BL = номер активной
    │       │                                │        страницы
    │       │                                │
    │ 16/0  │ Запись кода цвета в указанный  │ AL = 0 (номер под-
    │       │ регистр палитры для карт EGA и │         функции)
    │       │ VGA. По умолчанию в регистре   │ BH = код цвета (от 0)
    │       │ с номером n задан цвет n.      │ BL = номер регистра
    │       │      (Оператор PALETTE)        │      (отсчет от 0)
    │       │                                │
    │ 16/1  │ Установка цвета в регистре     │ AL = 1
    │       │ Overscan для EGA и VGA         │ BH = код цвета
    │       │                                │
    │ 16/2  │ Запись массива кодов цветности │ AL = 2
    │       │ в 16 регистров палитры и в ре- │ ES:DX = указатель на
    │       │ гистр Overscan для EGA и VGA   │     17-байтовый массив
    │       │   (Оператор PALETTE USING)     │     с кодами цветности
    │       │                                │
    │ 16/3  │ Переключение режимов мерцания и│ AL = 3
    │       │ яркости для EGA,VGA. Начальные │ BL = 0 (инверсия
    │       │ значения обоих разрядов - 00   │         яркости)
    │       │ (обычная яркость,нет мерцания).│ BL = 1 (инверсия
    │       │ Переключение меняет текущий ре-│         мерцания)
    │       │ жим на противоположный.        │
    │       │                                │
    │ 16/7  │ Опрос содержимого указанного   │ AL = 7
    │       │ регистра палитры               │ BL = номер регистра
    │       │ (только для VGA).              │ Выходная информация
    │       │                                │ BH = содержимое
    │       │                                │      регистра
    │       │                                │
    │ 16/8  │ Опрос содержимого регистра     │ AL = 8
    │       │ Overscan (только для VGA)      │ Выходная информация
    │       │                                │ BH = содержимое
    │       │                                │      регистра
    │       │                                │
    │ 16/9  │ Считывание содержимого всех    │ AL = 9
    │       │ регистров палитры и регистра   │ ES:DX = указатель на
    │       │ Overscan в указанный массив    │    17-байтовый массив
    │       │ (только для VGA).              │
    │       │                                │
    │ 16/16 │ Запись кода цветности в регистр│ AL = 16
    │       │ DAC с указанным номером (только│ DX = номер регистра
    │       │ для VGA).                      │      (от 0 до 255)
    │       │                                │ CH = интенсивность
    │       │                                │     зеленого цвета
    │       │                                │     (от 0 до 63)
    │       │                                │ CL = интенсивность
    │       │                                │      синего цвета
    │       │                                │      (от 0 до 63)
    │       │                                │ DH = интенсивность
    │       │                                │      красного цвета
    │       │                                │      (от 0 до 63)
    │       │                                │
    │ 16/18 │ Запись кодов цветности в задан-│ AL = 18
    │       │ ный блок регистров DAC из мас- │ BX = номер первого
    │       │ сива, в котором чередуются ин- │      регистра DAC
    │       │ тенсивности RGB-компонент      │ CX = количество
    │       │ (только для VGA)               │      заполняемых
    │       │                                │      регистров
    │       │                                │ ES:DX = указатель на
    │       │                                │      массив с кодами
    │       │                                │        цветности
    │       │                                │
    │ 16/19 │ Установка цветового режима     │ AL = 19
    │       │ страниц (BL=0) или выбор (BL=1)│ BL = 0 | 1
    │       │ страницы (только для VGA)      │ BH = 0 - 4 страницы
    │       │                                │        с 64 цветами
    │       │                                │ BH = 1 - 16 страниц
    │       │                                │        с 16 цветами
    │       │                                │ BH = номер страницы
    │       │                                │
    │ 16/21 │ Опрос содержимого указанного   │ AL = 21
    │       │ регистра DAC (только для VGA)  │ BX = номер регистра
    │       │                                │ Выходная информация
    │       │                                │ CH = интенсивность
    │       │                                │     зеленого цвета
    │       │                                │ CL = интенсивность
    │       │                                │       синего цвета
    │       │                                │ DH = интенсивность
    │       │                                │     красного цвета
    │       │                                │
    │ 16/23 │ Считывание содержимого блока   │ AL = 23
    │       │ регистров DAC в указанный      │ BX = номер первого
    │       │ массив (только для VGA)        │      регистра DAC
    │       │                                │ CX = количество
    │       │                                │        опрашиваемых
    │       │                                │        регистров
    │       │                                │ ES:DX = указатель на
    │       │                                │     массив-получатель
    │       │                                │
    │ 16/26 │ Опрос номера текущей цветовой  │ AL = 26
    │       │ страницы (только для VGA)      │ Выходная информация
    │       │                                │  BH = номер страницы
    │       │                                │  BL = цветовой режим
    │       │                                │
    │ 16/27 │ Суммирование кодов цветности   │ AL = 27
    │       │ для формирования сигнала в     │ BX = номер первого
    │       │ полутоновой шкале :            │      DAC
    │       │ I=0.3*I(R(J))+0.59*I(G(J))+    │ CX = количество
    │       │       0.11*I(B(J))             │      суммируемых DAC
    │       │ Суммирование ведется по всем   │
    │       │ J для указанной группы реги-   │
    │       │ стров. Результат заносится в   │
    │       │ каждую из RGB-компонент реги-  │
    │       │ стра управления цветом (только │
    │       │ для VGA).                      │
    └───────┴────────────────────────────────┴────────────────────────


                    Таблица 21. Дисплейная функция 17
                          ( для карт EGA и VGA)
    ┌───────┬────────────────────────────────┬────────────────────────
    │ Номер │       Выполняемая операция     │   Содержимое регистров
    │подфун-│                                │
    │кции,AL│                                │
    ├───────┼────────────────────────────────┼─────────────────────────
    │   0   │ Загрузка шрифта пользователя в │ BL = номер загружае-
    │       │ область видеопамяти, предназна-│      мого блока видеоЗУ
    │       │ ченную для размещения таблицы  │ BH = число байтов на
    │       │ контуров символов.             │      образ символа
    │       │                                │ CX = число символов
    │       │                                │ DX = смещение симво-
    │       │                                │ ла в таблице
    │       │                                │ ES:BP = указатель на
    │       │                                │       начало таблицы
    │       │                                │
    │   1   │ Загрузка из постоянного ЗУ(ROM-│ BL = номер загружае-
    │       │ Read Only Memory) набора симво-│      мого блока
    │       │ лов для монохромного режима без│
    │       │ сброса дисплейного оборудова-  │
    │       │ ния. Размер символов 8х14.     │
    │       │                                │
    │   2   │ Загрузка из ПЗУ набора символов│ BL = номер загружае-
    │       │ размером 8х8 с контурами двой- │      мого блока
    │       │ ной толщины.                   │
    │       │                                │
    │   3   │ Установка разрядов в специфика-│ BL = устанавливаемый
    │       │ ции блока шрифта. Эта функция  │      код
    │       │ определяет выбор двух подмно-  │
    │       │ жеств символов из четырех воз- │
    │       │ можных по третьему биту атрибу-│
    │       │ та. Разряды 0,1 и 4 кода BL за-│
    │       │ дают номер подмножества при ну-│
    │       │ левом бите в атрибуте, разряды │
    │       │ 2,3 и 5 - при единичном бите.  │
    │       │                                │
    │   4   │ Загрузка из ПЗУ набора символов│ BL = номер загружае-
    │       │ размером 8х16                  │      мого блока
    │       │                                │
    │  16   │ Загрузка шрифта пользователя.  │ BH = число байтов
    │       │ Эта процедура напоминает функ- │      на символ
    │       │ цию 0, но она должна выполнять-│ BL = номер загружае-
    │       │ ся сразу вслед за установкой   │      мого блока
    │       │ режима при нулевой активной    │ DX = смещение симво-
    │       │ странице.                      │      ла в таблице
    │       │                                │ ES:BP = указатель на
    │       │                                │       начало таблицы
    │       │                                │
    │  17   │ Загрузка из ПЗУ набора символов│ BL = номер загружае-
    │       │ размером 8х14 для монохромного │      мого блока
    │       │ режима                         │
    │       │                                │
    │  18   │ Загрузка из ПЗУ набора символов│ BL = номер загружае-
    │       │ размером 8х8 и контуром двойной│      мого блока
    │       │ толщины                        │
    │       │                                │
    │  19   │ Загрузка из ПЗУ набора символов│ BL = номер загружае-
    │       │ размером 8х16                  │      мого блока
    │       │                                │
    │  32   │ Установка указателя на вторую  │ ES:BP = указатель на
    │       │ половину кодировочной таблицы  │       начало таблицы
    │       │ пользовательского шрифта с ко- │
    │       │ дами ASCII от 128 до 255       │
    │       │                                │
    │  33   │ Установка указателя кодировоч- │ BL = 1 | 2 | 3  для
    │       │ ной таблицы на пользовательский│      14, 25 или 43
    │       │ набор графических символов     │      строк на экране
    │       │                                │ CX = число байтов на
    │       │                                │      символ
    │       │                                │ ES:BP = указатель на
    │       │                                │       начало таблицы
    │       │                                │
    │  34   │ Загрузка из ПЗУ таблицы симво- │ BL = см. подфункцию 33
    │       │ лов размером 8х14 в графическом│
    │       │ режиме                         │
    │       │                                │
    │  35   │ Загрузка из ПЗУ таблицы симво- │ BL = см. подфункцию 33
    │       │ лов размером 8х8 в графическом │
    │       │ режиме                         │
    │       │                                │
    │  36   │ Загрузка из ПЗУ таблицы симво- │ BL = см. подфункцию 33
    │       │ лов размером 8х16 в графическом│
    │       │ режиме                         │
    │       │                                │
    │  48   │ Опрос параметров генератора    │ BH = 0 - указатель
    │       │ символов. Результаты выдаются в│     прерывания 1Fh
    │       │ регистрах CX (число байтов на  │ BH = 1 - указатель
    │       │ символ), DL (число символов в  │     прерывания 43h
    │       │ строке дисплея минус 1), и паре│ ВН = 2 - указатель
    │       │ ES:BP (адрес соответствующей   │          ПЗУ 8х14
    │       │ таблицы).                      │ ВН = 3 - указатель
    │       │                                │          ПЗУ 8х8
    │       │                                │ ВН = 4 - указатель
    │       │                                │        ПЗУ 8х8 для
    │       │                                │        символов с ко-
    │       │                                │        дами от 128
    │       │                                │ ВН = 5 - указатель
    │       │                                │          ПЗУ 9х14
    │       │                                │ ВН = 6 - указатель
    │       │                                │           ПЗУ 9х16
    └───────┴────────────────────────────────┴────────────────────────

                   Таблица 22.Дисплейная функция 18
    ┌───────┬────────────────────────────────┬────────────────────────
    │ Номер │        Выполняемая операция    │    Содержимое регистров
    │подфун-│                                │
    │кции,BL│                                │
    ├───────┼────────────────────────────────┼─────────────────────────
    │  16   │ Опрос параметров карты EGA или │   Выходная информация
    │       │ VGA. Комбинация переключателей │   ВН = 0 - установлен
    │       │ SW1,SW2,SW3 и SW4 определяет   │        цветной режим
    │       │ текущую конфигурацию карты     │   ВН = 1 - установлен
    │╔═════════════════════════════════════════╗        ч/б режим
    │║ SW1 SW2 SW3 SW4     EA      MA    CGA   ║  BL = 0 (ОЗУ = 64К)
    │╟─────────────────────────────────────────╢  BL = 0 (ОЗУ = 128К)
    │║  1   0   0   1    Первич. Вторич.  -    ║  BL = 0 (ОЗУ = 192К)
    │║                     CD,40x25            ║  BL = 0 (ОЗУ = 256К)
    │║  1   1   1   1    Вторич. Первич.  -    ║
    │║                     CD,40x25            ║
    │║  0   0   0   1    Первич. Вторич.  -    ║
    │║                     CD,80x25            ║
    │║  0   1   1   1    Вторич. Первич.  -    ║
    │║                     CD,80x25            ║
    │║  1   1   1   0    Первич. Вторич.  -    ║
    │║                ECD,режим эмуляции       ║
    │║  1   0   1   1    Вторич. Первич.  -    ║
    │║                ECD,режим эмуляции       ║
    │║  0   1   1   0    Первич. Вторич.  -    ║
    │║                ECD,режим высокого       ║
    │║                    разрешения           ║
    │║  0   0   1   1    Вторич. Первич.  -    ║
    │║                ECD,режим высокого       ║
    │║                    разрешения           ║
    │║  1   0   1   0    Первич.   -    Вторич.║
    │║                    MD            40x25  ║
    │║  1   1   0   1    Вторич.   -    Первич.║
    │║                    MD            40x25  ║
    │║  0   0   1   0    Первич.   -    Вторич.║
    │║                    MD            80x25  ║
    │║  0   1   0   1    Вторич.   -    Первич.║
    │║                    MD            80x25  ║
    │╟─────────────────────────────────────────╢
    │║ Карта VGA не имеет физических переключа-║
    │║ телей. Соответствующая информация об ус-║
    │║ тановленном режиме фиксируется в ОЗУ и  ║
    │║ извлекается с помощью функции BIOS      ║
    │╚═════════════════════════════════════════╝
    │  32   │ Выбор альтернативной программы │
    │       │ печати, позволяющей при нажатии│
    │       │ клавиши PrtScr получить копию  │
    │       │ экрана в режиме 43 строк       │
    │       │ (для EGA и VGA).               │
    │       │                                │
    │  48   │ Установка числа строк растра   │ AL = 0 (200 строк)
    │       │ текстовых режимов (только для  │ AL = 1 (350 строк)
    │       │ VGA).                          │ AL = 2 (400 строк)
    │       │                                │
    │  49   │ Установка или отмена признака  │ AL = 0 (загрузка
    │       │ блокировки загрузки стандартных│         разрешена)
    │       │ значений в регистры палитры при│ AL = 1 (регистры не
    │       │ смене режима работы монитора   │         изменяются)
    │       │ (только для VGA).              │
    │       │                                │
    │  50   │ Разрешение (AL=0) или блокиров-│ AL = 0 | 1
    │       │ ка (AL=1) доступа к входному   │
    │       │ видеопорту и буферу декодирова-│
    │       │ ния адресов (только для VGA).  │
    │       │                                │
    │  51   │ Разрешение (AL=0) или блокиров-│ AL = 0 | 1
    │       │ ка(AL=1) суммирования цветовых │
    │       │ компонент для формирования по- │
    │       │ лутонового сигнала (только для │
    │       │ VGA).                          │
    │       │                                │
    │  52   │ Разрешение (AL=0) или блокиров-│ AL = 0 | 1
    │       │ ка(AL=1) режима эмуляции курсо-│
    │       │ ра (только для VGA).           │
    │       │                                │
    │  53   │ Установка ключей дисплея. Ре-  │ AL = 0 (ключ адаптера
    │       │ зультат (AL=18) свидетельствует│         в "0" - off)
    │       │ о правильности задания входной │ AL = 1 (ключ планар-
    │       │ информации. Обращение с AL=0   │          ного дисплея
    │       │ или 1 должно предшествовать об-│          в "1" - on)
    │       │ ращению с AL=2 или 3(только для│ AL = 2 (ключ активно-
    │       │ VGA).                          │         сти дисплея
    │       │                                │          в "0" - off)
    │       │                                │ AL = 3 (ключ активно-
    │       │                                │         сти дисплея
    │       │                                │          в "1" - on)
    │       │                                │ ES:DX = указатель на
    │       │                                │         буфер в 128
    │       │                                │         байт
    │       │                                │
    │  54   │ Разрешение (AL=0) или блокиров-│ AL = 0 | 1
    │       │ ка(AL=1) доступа к выходному   │
    │       │ видеопорту.                    │
    └───────┴────────────────────────────────┴────────────────────────


                    Таблица 23. Дисплейная функция 19
    ┌───────┬────────────────────────────────┬────────────────────────
    │ Номер │      Выполняемая операция      │  Содержимое регистров
    │подфун-│ (Реализация средствами BASIC'а)│
    │кции,AL│                                │
    ├───────┼────────────────────────────────┼────────────────────────
    │   0   │ Вывод строки символов начиная  │ ВН = номер страницы
    │       │ с указанной позиции дисплея    │ BL = атрибут
    │       │ (только для VGA).После вывода  │ CX = количество сим-
    │       │ курсор остается в своей началь-│      волов в строке
    │       │ ной позиции. (Операторы LOCATE,│ DH = строка на экране
    │       │ COLOR и PRINT).                │ DL = столбец
    │       │                                │ ES:BP = указатель на
    │       │                                │         начало строки
    │       │                                │
    │   1   │ Вывод строки символов по такой │ См. подфункцию 0
    │       │ же информации для EGA и VGA.   │
    │       │ После вывода курсор перемещает-│
    │       │ ся в ближайшую свободную пози- │
    │       │ цию вслед за отображенным текс-│
    │       │ том. (Операторы LOCATE, COLOR  │
    │       │ и PRINT)                       │
    │       │                                │
    │   2   │ Вывод строки символов, в кото- │ ВН = номер страницы
    │       │ рой каждая позиция экрана пред-│ CX = число символов
    │       │ ставлена двумя байтами - кодом │       и атрибутов в
    │       │ ASCII и атрибутом. После вывода│       строке
    │       │ курсор устанавливается на пер- │ DH = строка на экране
    │       │ вый отображенный символ        │ DL = столбец
    │       │ (для EGA и VGA).               │ ES:BP = указатель на
    │       │                                │         начало строки
    │       │                                │
    │   3   │ Процедура, аналогичная функции │ См. подфункцию 2
    │       │ 2 с позиционированием курсора в│
    │       │ конце выводимой строки         │
    └───────┴────────────────────────────────┴────────────────────────