Borland Visual Control Pack

Версия 1.0

Первое знакомство

Borland International, Inc.

100 Borland Way

PO Box 660001

Scotts Valley, CA 95067-001

Борланд А/О, Москва, Россия...

Содержание



Введение

Добро пожаловать в обзор по Borland Visual Control Pack !
Borland Visual Control Pack - главный сопутствующий Borland C++
4.0 продукт и данное руководство предоставит вам описание
характеристик этого замечательного дополнения линии компиляторов
Borland.

Предполагается, что читатель знаком с Borland C++ 4.0 и его
поддержкой VBX форм (custom control). Если же не знаком, то мы
будем рады предоставить вам первоначальное введение.



Что есть орган управления ?

Орган управления - готовая к использованию компонента,
позволяющая разработчику визуально добавлять функциональные
характеристики к своим Windows-приложениям, при этом пости не
прибегая к помощи программирования, что сохраняет дни или даже
недели программисткого времени. Орган управления прозрачно для
пользователя интегрируются в поддерживающее их программное
окружение, предоставляя разработчикам огромное множество готовых
решений разнообразных задач типа компонент БД и трехмерной
графики.

Множество сторонних разработчиков первоначально начали
разрабатывать управляющие элементы для Microsoft Visual Basic,
потому по отношению к данному классу приложений часто используют
термин VBX , обозначающй Visual Basic eXtension (расширение
Visual Basic).

С явлением Borland C++ 4.0 народу данные мощные органы
управления стало возможным использовать и разработчикам,
использующим Borland C++, тем самым подтверждая наши
обязательства обеспечивать многочисленных пользователей
новейшими технологиями.

Общий обзор продукта

Borland Visual Control Pack - это мощный, всеобъемлющий набор
более 25 CC. Используя Visual Control Pack разработчик может
ввести в свое приложение:

	Компоненту базы данных, работающую с таблицами dBASE и Paradox
методом ■Запроса-По-Форме■ (Query-By-Form) и поддерживающую
нескольких пользователей.

	Полнофункциональную электронную таблицу, показывающую и
персчитывающую данные.

	Блокнотные ■закладки■, организующие электронные таблицы или
другие приложения в трўхмерный блокнот, аналогично QuattroPro
for Windows.

	Текстовый WYSIWYG процессор, поддерживающий работу со стилями,
шрифтами, символами различных размеров и с форматной линейкой
для установки границ, табуляций и пробелов.

	Коммуникационный интерфейс , эмулирующий терминалы ANSI и TTY,
передающий файлы с использованием протокола XModem.

	Редактор графических образов, работающий с несколькими
стандартами форматов файлов. Он может увеличивать(zooming), 
панорамировать (panning), наводить зернистость (cropping),
увеличивать четкость изображений (sharpening) и проводить
сглаживание (softening).

	Свыше 30 трўх- и двумерных гистограмм, которые можно вращать,
изменять размер графиков и формат представления каждого элемента.

	Кучка красивых безделушек, придающих вашему пользовательскому
интерфейсу профессиональный вид, среди них оживляемые кнопки,
индикаторы, вращатели, ползунки, шатерчики(marquees),  часы,
звоночки, и даже игральные кости и игральные карты для любителей
побаловаться.

Требования к системе

Borland Visual Control Pack создавался для использования в любой
среде, поддерживающей VBX, включая Borland C++ 4.0, Microsoft
Visual Basic и Microsoft Visual C++.

Рекомендуется иметь около  10М байт свободного дискового
пространства для установки всех элементов пакета.

О Борланд

Для миллионов разработчиков и конечных пользователей по всему
миру компания Borland International является лидером в
разработке инструментальных средств программирования. Компания
Borland, являясь пионером в области использования
объектно-ориентированных технологий, старается предлагать лучшие
в мире системы управления базами даннных, языки
программирования, инструментальные средства разработки,
электронные таблицы и прикладные продукты. В число продуктов
Borland входят dBASE, Paradox,  InterBase, QuattroPro, Borland
C++ и Borland Pascal with Objects. Головное отделение компании,
основанной в 1983 году Филиппом Каном (Philippe Kahn),
располагается в Шотландской Долине (Scotts Valley) в Калифорнии.

Борланд - акционерная компания открытого типа. Акции продаются
на нью-йоркской фондовой бирже (NASDAQ) через представительство
BORL.

Использование органов управления в Resource Workshop

Управляющие элементы можно прозрачно для пользователя добавить к
Borland C++ 4.0, добавляя тем самым к набору инструментов
разработчика мощные и готовые к использованию компоненты. Данные
элементы доступны в Resource Workshop при создании диалогов,
через изображения в виде иконок в палитре средств Tools Palette.
За дополнительной информацией по использованию управляющих
элементов в Microsoft Visual Basic и Visual C++ обращайтесь к
соответствующей документации данных продуктов.

Установка органа управления

После проведения установки управляющего элемента с
соответствующих дискет на ваш компьютер добавление элемента
происходит при первой загрузке соответствующего файла. 

В меню Resource Workshop выберете File | Install control library
и выберете файл органа управления из списка, он будет иметь
расширение  VBX. Инсталяционная программа помещает все
управляющие элементы и сопутствующие им файлы в каталог
WINDOWS\SYSTEM.Рис.1 Установка органов управления

После того как вы сделаете выбор, к Tools Palette добавляется
иконка представляющая данный элемент. На рис.2 показана
ситуация, когда все органы управления пакета добавлены к Tools
Palette, это расширяет палитру вдвое против стандартного
размера.Рис.2 Палитра средств (Tools Palette) Resource Workshop
со всеми загруженными управляющими элементами пакета.

Использование органов управления

Чтобы задействовать орган управления щўлкните мышкой иконку и
переместите еў на диалоговую поверхность, так же как вы это
делаете со стандартными диалоговыми элементами. Чтобы
модифицировать характеристики элемента, например цвет или шрифт,
дважды щўлкните кнопкой мыши над управляющим элементом и
появится список его характеристик (Рис. 3). Данные
характеристики могут быть изменены или во время создания в
Resource Workshop, или во время запуска программы, при помощи
класс TVbxControl, если вы создаўте приложение ObjectWindows
2.0. Рис.3 Изменеие характеристик управляющего элемента.



Добавление обработчика событий

Для любого события управляющего элемента VBX можно добавить
обработчик. Если приложение первоначально было создано с помощью
AppExpert, то добавление обработчика события вызывается простым
нажатием правой кнопки мыши, после чего всплывает окно
ClassExpert.Рис.4 Добавление обработчика события.

ObjectWindows 2.0 содержит класс TVbxControl для доступа к
характеристикам органов управления VBX и их модификации. Это
значительно упрощается благодаря наличию утилиты VBXGen,
расположенной в каталоге BC4\BIN. VBXGen порождает класс
наследник TVbxControl для выбранного управляющего элемента и и
генерирует необходимые функции-члены класса для дальнейшей
модификации всех характеристик, свойственных данному
управляющему элементу, что облегчает его использование. При этом
создается заголовочный файл, содержащий определение
соответсвующего класса на Си++. В Borland C++ 4.0 можно
использовать для доступа к характеристикам управляющего элемента
как Си++, так и Си.Рис.5 Использование VBXGen для порождения
наследника управляющего элемента.

Детальное описание управляющих элементов

Borland Visual Control Pack содержит свыше 25 органов
управления, разработанных большим количеством сторонних
поставщиков. Некоторые из управляющих элементов являются немного
облегчўнными версиями ■боевых■ вариантов, но по-прежнему
обладающие значительными функциональными характеристиками,
позволяющие создавать мощные и изощрўнные приложения.
Разработчики, желающие получить дополнительные возможности,
исключўнные из данного пакета, за полными версиями могут
обратиться к самим производителям. В этой главе дано подробное
описание каждого управляющего элемента, входящего в данный
продукт. Желающие получить ещў более детальную информацию могут
обращаться ■Руководству пользователя■ (■User■s Guide■) пакета.

База данных

Орган управления БД состоит из набора 12 элементов, позволяющие
разработчику легко снабжать программу, развитой компонентой базы
данных, почти при этом не кодируя. Управляющий элемент реализуют
важнейшие характеристики СУБД, включая способность визуальной
генерации простых форм и форм c отношением один ко многим,
привязывать  поля к столбцам БД и выполнять ■Запрос-По-Форме■.
Вам нужно просто схватить и перетащить управляющий элемент в
диалоговое окно, установив их характеристики. Органы управления
были созданы фирмой Coromandel Industries и являются облегчўнной
версией хорошо зарекомендовавшей себя СУБД Integra VDB.
Приложения использующие эти управляющие элементы смогут работать
с файлами форматов dBASE и Paradox 3.5.

12 управляющих элементов элементов Integra VBX можно разделить
на две группы - 4 органа управления архитектуры БД и 8 органов
управления визуализаторов БД.

Управляющие элементы архитектуры БД помогут вам организовать
структуру приложения, работающего с базами данных, преобразовать
программное окружение в визуальный ■верстак■ СУБД. Данная группа
включает:

	Управляющий элемент приложения - устанавливающий такие
глобальные характеристики, как тип обработки ошибок и режим
отладки. Определяя первую характеристику, вы можете видеть
сообщения об ошибках в текстовых полях. Устанавливая другую,  вы
разрешаете трассировку, определяете возможность получать
распечатку команд SQL и диагностической информации в текстовый
файл.

	Управляющий элемент исходных данных предоставляет  связь с
данными. Характеристики данного органа управления определяют
каким образом заводится связь с исходными данными, логическое
имя связи и связующую строку для начала сеанса связи с машиной
БД.

	Управляющий элемент запроса позволяет интерактивно производить
запросы, генерировать команды SQL, определять сложные отношения
между таблицами ■один-ко-многим■.

	Управляющий элемент определения формы связывает поля со
столбцами таблицы.

Визуализаторы обладают специализированными свойствами для работы
с БД, включая возможность связываться непосредственно со
столбцами таблицы базы, и состоят из следующих органов
управления:

	Операционные управляющие элементы - похожие на обыкновенные
кнопки, но дополнительно определяющие операцию по работе с базой
данных, типа перейти на следующую  запись, извлечь значение,
обновить запись, выполнить ■запрос по форме■ и т.п.

	Управляющие элементы сетки - оптимизированные для доступа к
данным ■только для чтения■.

Остальные элементы аналогичны тем, что можно найти в Resource
Workshop, с добавлением возможности связываться с файлом базы
данных:

	Ячейка

	Комбинированная ячейка

	Рамка

	Список

	Радиокнопка

	ТекстРис. 6 СУБД



Электронная таблица

Элемент управления электронной таблицы предоставляет
полно-функциональную таблицу, которая может обрабатывать
табличный ввод и показывать данные в сетке размером до 500x500.
Этот управляющий элемент был создан фирмой FarPoint Technologies
и является уменьшенным вариантом их элемента Spread/VBX. Главные
функциональные черты данного управляющего элемента:

	поддерживает 4 типа ячеек: действительное число(Float),
статический текст (Static Text), редактируемый текст (Edit) и
картинка (Picture);

	обладает мощным вычислительным механизмом, обеспечивающим
возможность ввода формул в ячейки пользователем или приложением;

	поддерживает множественность шрифтов и цветов, которые можно
применять и над рядами и столбцами таблицы.

Управляющий элемент  предоставляет более 60 способов
форматирования и организации ячеек таблицы, в зависимости от
необходимости. Есть мощные функции AutoCalc и CalcDependencies,
управляющие автоматическим пересчўтом затронутых данных и
зависящими таблицами, с помощью которых можно поддерживать
выполнение пересчўта таблицы с вводом формулы. Характеристика
Formula поддерживает 9 математических операций и до 8
функций.Рис. 7 Электронная таблица

Коммуникационный управляющий элемент

Коммуникационный управляющий элемент интегрирует в ваше
приложение возможность последовательной связи, эмуляции
терминалов и пердачи бинарных файлов. За считанные минуты ваша
программа станет обладать изощренным коммуникационным
интерфейсом. Управляющий элемент создан фирмой Sax Software и
поддерживает эмуляцию терминалов TTY и ANSI с возможностью
передачи файлов по протоколу XModem.

Характеристика Port определяет коммуникационный порт, который вы
хотите откоыть. При присвоении AutoReceive и  AutoSend значения
TRUE, Управляющий элемент автоматически обрабатывает приходящие
на коммуникационный порт данные и передаўт в порт печатаемые на
клавиатуре символы в момент получения вашим окном фокуса ввода.

Так как TTY - подмножество терминала ANSI ,то не возникает
необходимости переключаться между этими эмуляторами, оба
доступны одновременно.

Функции Download и Upload управляют передачей данных с
использованием протокола XModem. Когда для этих характеристик
задано имя файла, начинается передача данных и появляется
соответсвующее диалоговое окно, отображающее текущий статус
передачи.Рис. 8 Коммуникационный управляющий элемент

Табулярный управляющий элемент

Табулярный управляющий элемент показывает несколько таблиц
аналогично QuattroPro for Windows в виде блокнота. Управляющий
элемент создан Sax Software и может использоваться, для
обеспечения переключения между несколькими страницами, например,
для создания электронной таблицы с применением органа управления
электронной таблицы или для переключения между страницами одного
диалогового окна. При выборе одной из ■закладок■, еў состояние
становится ■активным■ и генерируется событие ■нажатие на кнопку
мыши■. В последствии можно добавить обработчик данного события
для определения соответсвующей реакции. Характеристика Active
Tab используется для определения какая именно ■закладка■ была
выбрана.Рис. 9 Табулярный управляющий элемент

Текстовый процессор

	Управляющий элемент Текстовый Процессор позволяет создавать
полно-функциональный WYSIWIG текстовый процессор. Он был создан
фирмой Access Softek, является уменьшенной версией их элемента
P.I. Document Editor и в дополняет базовые возможности
редактирования:

	поддержкой множественности шрифтов, размеров и стилей, таких
как Courier, Times  Roman, полужирный и курсив;

	форматной линейкой, расположенной у верхнего края управляющего 
элемента, что позволяет определять границы, устанавливать
позиции табуляции, определять разреженность без единого усилия
по программированию;

	возможностью читать и записывать тексты в формате Rich Text
Format;

	возможностью передавать ANSI текст через буфер обмена.

Направляющая линейка обеспечивает наиболее общие функции линеек
в других текстовых процессорах, ниже показано какие еў части
отвечают за управление границами, отступом, выключкой текста и
положением табуляций.Рис. 10 Текстовый процессор

Графический редактор

Управляющий элемент редактора графических образов показывает и
редактирует картинки, позволяя вам легко встраивать
профессиональную обработку графики в своў приложение. Данный
орган управления был создан Media Architects и является
облегченной версией ImageKnife/VBX. Он позволяет:

	показывать 24-битные true color, 8-битные SVGA и 4-битные VGA 
графические образы;

	работать с форматами BMP, PCX, DIB и TGA;

	вращать, увеличивать(zooming), панорамировать (panning),
наводить зернистость (cropping), уточнять (sharpening) и
размывать (softening) картинки;

	обеспечивать программу мощными функциями по работе с графикой.

Характеристики и функции данного управляющего элемента могут
быть объеденены в простые и мощные задаваемые команды. Вы можете
передавать  образы между разными экземплярами органа управления,
передавать исходную картинку нескольким целевым, изменять
размеры исходного и целевого образа. Одновременно с этим вы
можете одной из функций обрабатывать картинку. Творчески
используя задаваемые команды, можно резко уменьшить сложность
написания программ. Например, отдельные задаваемые команды могут
быть использованы для вырезания некоторой графической области,
изменения еў размера, уменьшения количества цветов, с
последующей вставкой в другую картинку.Рис. 11 Графический
редактор

Трўхмерные гистограммы

Управляющий элемент трўхмерных гистограмм позволяет разработчику
добавить к приложению впечатляющие графики. Данный элемент может
использоваться и как обычное средство рисования графиков, и как
компонента СУБД отображающая данные . Управляющий элемент был
создан Kansmen Corporation и включает следующие черты:

	свыше 30 двух- и трўхмерных графиков ( региональные , линейные,
столбцовые, долевые и гистограммы );

	свыше 50 разнообразных стилей оформления ( стили легенд, стили
меток, стили осей координат, заголовков графиков и т.п.);

	поддержка вращения трўхмерных  графиков, так что они могут быть
рассмотрены под разными углами зрения. Также возможно
автоматическое самовращение вокруг оси y для поддержания
3-мерных вращений.

	поддержка сдвига вдоль оси x ( для bar-chart вдоль оси y  ),
полезное при показе большого количества точек данных.

Если гистограммы используются как компонента СУБД, набор данных
будет  кешироваться в памяти. Управляющий элемент автоматически
достает данные из базы, обращаясь за дополнительными данными
только при необходимости. Если гистограммы используются как
обычное устройство вывода графиков, то все данные хранятся в
памяти.Рис. 12 Трўхмерные гистограммы



■Безделушки■

Чтобы помочь разработчику украсить свою программу и придать ей
профессиональный вид, даўтся 9 ■безделушек■ : оживляемые кнопки 
(animated buttons), индикаторы (gauges), вращатели (spinners),
ползунки (sliders), шатерчики(marquees),  часы (clocks),
звоночки (alarms), игральные кости(dice) и карты (cards).

Оживляемые Кнопки были разработаны фирмой Desaware, являются
облегченным вариантом Custom Control Factory и позволяют вам
создать разнообразные кнопочные элементы. Например:

	Оживляемые кнопки (Animated Buttons) с определением
последовательности графических образов, которые будут
отображаться при нажатии на кнопку. Возможны 4 разных
анимационных цикла.

	Кнопки с множеством состояний (Multistate Buttons), которые
могут иметь любое количество состояний, и каждое обладающее
своей картинкой.

	Оживляемые кнопки с 2 состояниями (2-State Animated Buttons)
(как ячейка), но переход между этими состояниями можно полностью
оживить.

	Расширенные стандартные кнопки (Enhanced Standard Buttons),
являющиеся расширениями стандартных ячеек и кнопок, но вы можете
определять их вид и в нажатом, и в отжатом состоянии.

	Кнопки линейки инструментария (Toolbar Buttons), похожие на
аналогичные линейки в других Windows-приложениях.

Дополнительно каждый из этих управляющих элементов поддерживает
следующие возможности:

	гибкое размещение текста - текст кнопки может быть расположен с
любой стороны кнопки, или в любом месте внутри графического
образа;

	сохранение в /загрузка из файла - последовательность картинок и
характеристики кнопки могут сохранены в файле с созданием
библиотек органов управления;

	настройка во время исполнения - большинство характеристик (
включая и отображаемые образы ) могут быть изменены программой
во время исполнения;

	нет дополнительной необходимости в программировании - единожды
создав кнопки не требуется программирования для создания или
использования элементов;

	настраиваемая скорость анимацииРис. 13 Оживляемые кнопки

Остальные элементы были созданы компанией MicroHelp и являются
подмножеством их VBTools:

	Индикатор (Gauge Control) - показывает на ва выбор линейный (с
заполнением), круговой со стрелкой или задаваемый битовой картой
 индикатор. В качестве индикатора вместо предопределенных
картинок можно использовать задаваемую вами битовую карту.Рис.
14 Индикаторы

	Вращатель (Spin Control) - используемый для увеличения или
уменьшения значения, изображаемый в трўхмерном виде с
необязательной меткой. По-умолчанию элемент выглядит следующим
образом:Рис. 15 Вращатель

	Ползунок (Slide Control) - управляющий элемент похож на полосу
прокрутки, но показывает задаваемый диапазон и кнопку.
Перемещаясь, кнопка ползунка определяет значение. Обеспечивается
4 заданных вида элемента и вы можете задать свой. По-молчанию
ползунок выглядит так:Рис. 16 Ползунок

	Шатўр ( Marquee Control ) - расширенный управляющий элемент
метки, способный показывать движущийся транспарант, возможно в
сопровождении графической картинки.Рис. 17 Шатровый управляющий
элемент

	Часы ( Clock Control ) - показывающие время в цифровом или
аналоговом виде. Имеет дополнительно функцию будильника. Вы
можете использовать заданный образ часов или определить
свой.Рис. 18 Часы

	Звонки (Alarm Control) - аудио-визуальный ■обострятель
внимания■ , который может быть трўх видов : телефон, будильник
или пищалка наручных часов. Также вы можете задать свою картинку
для показа звонка или использовать связанную битовую карту
вместо иконки при минимизации формы.Рис. 19 Звонки

	Игральные кости (Dice Control) - рисованный кубик, изображающий
игральные кости.Рис. 20 Игральные кости

	Игральные карты (Cards Control) - позволяют вам отображать
любую карту из стандартной колоды 52 карт.Рис. 21 Карты

Заключение

Borland Visual Control Pack - это абсолютно новый продукт,
сопутствующий Borland C++ 4.0, Microsoft Visual Basic и
Microsoft Visual C++. Органы управления, включенные в данный
продукт дают большое множество решений для актуальных задач
программирования. Сегодня нет другого продукта, предоставляющего
такого многообразия свойств: от компонент СУБД и электронных
таблиц -  до текстовых процессоров и трўхмерных гистограмм, и
всў в одной коробке.

Мы думаем вы разделите наш энтузиазм по поводу этого нового
продукта в нашей орденоносной линий инструментальных средств
разработчика. Если у вас имеются вопросы по поводу этого
продукта, обращайтесь к нам.

