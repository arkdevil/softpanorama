     ASSOC.EXE - утилита для расширения возможностей функции 
           Associate в File Manager и Norton Desktop.


     Предлагая новую программу на суд общественности, всегда приходит-
ся отвечать на 3 основных вопроса : зачем она нужна, как с ней рабо-
тать и (для заинтересовавшихся) - как она работает. Итак, по порядку.



                   1. Зачем она нужна ?

     Немного поработав в Windows, я почувствовал, что желательно бы 
иметь возможность ассоциировать одно расширение с несколькими обра-б
отчиками. Например, всегда ли стоит запускать Resource Workshop для
того, чтобы отредактировать пару строк в RC-файле ? Или немного другой
случай - имея файл TMK (проект для MAKE) не всегда хочется его трансли-
ровать в нормальном режиме, а, скажем, перестроить, а то и вообще отре-
дактировать. Я уже не говорю о том, что вызов Winword для каждого DOC -
это несколько назойливо.

     В Norton Desktop'е эта задача в принципе разрешима - вы вытаскиваете
на desktop иконки всех обработчиков, которые могут понадобиться, затем
перетаскиваете файл на нужную иконку. Проблема только в том, чтобы эта
иконка была видна в данный момент и вы смогли сориентироваться в той до-
вольно живописной картинке, которая получится, если на desktop'е распо-
ложено десятка полтора иконок. И вообще, для drag & drop физических уси-
лий нужно затратить больше, чем для double-click :-).

     Для того, чтобы решить эту задачу, и написаны эти две программы.
Работают они в паре и должны находиться в одном каталоге. Почему две ?
Как-то рука не поднялась писать приложение, которое загружалось бы с диска
в ответ на каждый запрос, в то время, как в Windows существует возмож-
ность оставлять программы в памяти до тех пор, пока они снова не понадо-
бятся. Но тут возникает другая проблема - Windows всегда вызывает обра-
ботчик с диска, и в разделе [Extensions] файла WIN.INI никак не укажешь,
что не нужно грузить с диска копию уже запущенного приложния. В предлага-
емом варианте задача решена по принципу "из 2-х зол - меньшее", т.е. в
ответ на запрос грузится 6 Kb клиент, который передает запрос находяще-
муся в памяти серверу, размер которого в 4 раза больше.

     Кроме того, появилась возможность задавать Run Style обработчика, 
т.е. вы можете указать, будет ли окно его максимизировано при запуске, 
минимизировано или отображено на экране с размерами по умолчанию.

     И, наконец, возможно, кому-то будут полезны исходные тексты всего
этого. Но о них более подробно - в файле SOURCE.DOC в каталоге SOURCE.

                    2. Как с ней работать ?

     Прежде всего, скопируйте файлы ASSOC.EXE, ASSOCSRV.EXE и ASSOC.INI
в тот каталог, где вы держите утилиты. После этого ассоциируйте расшире-
ние файла с ASSOC.EXE. Дальнейшая настройка может производиться 2 путями -
либо вы редактируете файл ASSOC.INI вручную, либо делаете это при помощи
диалога настройки ASSOCSRV.EXE.

     Рассмотрим сначала более простой вариант - настройка при помощи диа-
лога. Он открывается сразу после запуска ASSOCSRV. Диалог содержит 2
списка - ассоциированных расширений и альтернатив меню для расширения,
выбранного в первом списке. Кроме того, внизу - линейка кнопок, названия
которых говорят сами за себя. Тем не менее, стоит, во избежание недоразу-
мений, описать их функции :

     Edit      - редактирование выбранного элемента текущего списка (либо
                 расширений, либо альтернатив меню). Текущим списком счи-
                 тается тот, который имеет фокус ввода.

     Append    - добавление нового элемента в текущий список.

     Delete    - удаление (с подтверждением) выбранного элемента из теку-
                 щего списка.

     Save      - сохранение внесенных изменений

     Close     - закрытие диалога редактирования

     В качестве отправной точки можете использовать уже имеющийся ASSOC.INI
(это фрагмент файла, который использую я), либо можно вообще удалить этот
файл (он затем будет создан программой) и начать from scratch. Каковы же 
должны быть действия в этом случае? Сначала вы при помощи Append добавляете
нужное вам расширение в список расширений, затем переходите в список аль-
тернатив меню и добавляете туда нужные вам пункты. При этом высветится
диалог, который должен быть хорошо знаком пользователям Norton Desktop :

     Text           - текст пункта меню. Символ '&' здесь играет ту же 
                      роль, что и при описании меню в файле ресурсов - 
                      следующая за ним буква определяет hot key.

     Command Line   - командная строка запуска обработчика + возможные до-
                      полнительные параметры командной строки

     Если вы забыли, где находится обработчик или вам не хочется писать
длинный путь, можте воспользоваться командой Browse и выбрать нужный файл
в диалоге. После всего этого можете выбрать стиль запуска обработчика - 
Normal, Maximized или Minimized. Естественно, значение этого поля будет
учитываться только при запуске Windows-приложений, run style DOS програм-
мы зависит от установок PIF файла.

     Альтернатив меню не обязательно должно быть несколько. Если вы опре-
делили только одну, то ASSOCSRV не будет предлагать вам меню, а запустит
сразу единственный обработчик. Единственное внешнее отличие (и преимущес-
тво) в данном случае то, что программа-обработчик запустится с укзанным
вами run style.

     Второй вариант настройки программы - отредактировать ASSOC.INI вруч-
ную. Формат его таков : сначала идет секция [Extensions], далее - секции
[EXT], где EXT - одно из расширений, описанное в секции [Extensions]

     Секция [Extensions] содержит информацию о расширениях, обрабатывае-
мых программой. Она содержит строки вида

     EXT=

     где EXT - одно из расширений, которое обрабатывает программа.

     Секция [EXT], где EXT - некоторое расширение файла состоит из строк
вида

     MenuItem=ProgName [Options][;RunStyle]

     MenuItem       - произвольная строка, которая будет появляться как  
                      пункт pop-up меню     

     ProgName       - имя программы-обработчика, которая запустится при
                      выборе соответствующего пункта меню.

     Options        - необязательные параметры запуска программы-обработ-
                      чика. Командная строка сформируется таким образом :

          ProgName Options filename.ext

     RunStyle       - необязательный стиль запуска. Задается в виде числа
                      от 0 до 2 :
                      0  - Normal,
                      1  - Maximized,
                      2  - Minimized.
                      Значением по умолчанию принят Normal

     Если вы решили редактировать INI файл вручную, делать это надо до за-
пуска ASSOCSRV, так как он читает установки из файла только при запуске.
Если ASSOCSRV уже загружен, изменить установки можно в режиме диалога, при-
чем, даже если вы не сделали Save перед Close, внесенные изменения сохраня-
ются до конца сеанса работы ASSOCSRV.

     Ну вот, с настройкой разобрались, теперь выберите файл с нужным рас-
ширением в File Manager или Drive Window (для Desktop'а) double-click на
нем или нажмите Enter. Если при настройке вы указали несколько альтернатив,
рядом с курсором мыши появится меню. Вы выбираете нужный пункт, и соответ-
ствующий обработчик запускается (если это - Windows приложение - то с ука-
занным Run Style).


                        3. Как она работает ?

     При вызове ассоциированного обработчика запускается ASSOC с именем 
файла в командной строке. ASSOC читает это имя, создает окно (котрое ис-
пользуется только для DDE), пытается найти ASSOCSRV среди уже запущенных
программ, а если его нет - запустить его из того каталога, откуда стар-
товал сам. Если из этого ничего не получается - выводится сообщение от
ошибке и программа завершается. Если же сервер удалось запустить, да
еще установить с ним DDE, ASSOC (клиент) передает ASSOCSRV (серверу) имя
файла из командной строки и завершается.

     ASSOCSRV при запуске читает файл установок ASSOC.INI, получив через
DDE имя файла для обработки, ищет среди своих установок соответствующее рас-
ширение, если находит - считает количество альтернатив и, в зависимости от
результата, либо высвечивает меню, затем запускает нужный обработчик, либо
сразу формирует строку запуска и вызывает программу-обработчик, после чего
остается  в памяти.

     При double-click на иконке или выборе пункта Restore в меню System
ASSOCSRV выводит диалог настройки. 




                            Заключение.

     В принципе, все это можно еще дорабатывать и дорабатывать. Скажем,
можно ввести в настройку имя каталога, который будет текущим для обра-
ботчика (сейчас для него текущим является текущий каталог Windows). Или,
для полной крутизны, сделать так, чтобы 2 этапа настройки слились в 1 -
только вы ассоциировали расширение с ASSOC, а тут сразу ASSOCSRV пред-
лагает изменить настройку. Кое-какие мысли на этот счет есть, но, к сожа-
лению, текучка заедает :-(. А если кому-нибудь захочется сделать это са-
мому - все исходники прилагаются. Только большая просьба - если кому 
удасться совместить File / Associate с настройкой ASSOCSRV - дайте хоть
одним глазом взглянуть !


---------------------------------------------------------------------------
     Данная программа и исходные тексты принадлежат к классу FREEWARE.
Вы можете свободно ими пользоваться и распространять.

     Условия:
          - При распространении вы не можете изменять содержимое архива
            либо какого-то отдельного файла

          - Запрещено коммерческое использование программы без согласования
            с автором
----------------------------------------------------------------------------

Тел.:  (052-72)37-110 (рабочий)
Адрес: 323000, Днепропетровская обл., г. Павлоград, ул. Днепровская, 424-50,
       Маркилюк Александр

        