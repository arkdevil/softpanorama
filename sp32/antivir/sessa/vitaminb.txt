                                       А.В.Сесса (MasterSoft)

         ПРОГРАММА ВАКЦИНИРОВАНИЯ ЗАГРУЗЧИКОВ "ВИТАМИН-Б"
__________________________________________________________________________

     Название программы - VITAMINB.EXE,
     Версия 1.3 ( Ярварь 1991г.)

     Тип программы - инсталлятор нерезидентной вакцины против
вирусов, поражающих загрузчики дисков.

     Назначение программы - замена имеющегося загрузчика на
вакцинированный загрузчик, предотвращающий работу бутовых
вирусов.

     Язык программирования - ассемблер

     Вызов - VITAMINB без параметров. Программа запрашивает имя
диска, подлежащего вакцинированию.

     Ограничения и противопоказания:

    - при вакцинировании операционной системы DR DOS системные
файлы DRBIOS.COM и DRBDOS.COM должны размещаться в самом начале
диска (как это принято в MS DOS и PC DOS);

    - ВИТАМИН-Б 1.3 не вакцинирует диски ПЭВМ "Amstrad PC 1640"
(возможно в следующей версии это ограничение будет снято) и других
недостаточно совместимых с IBM PC компьютеров;

    - возможно зависание некоторых "неполноценных" ПЭВМ (в частности
"Amstrad PC 1640", "Искра 1030.11" и первых версий "Нейрона" с ROM-
BIOS версии 3.21) в момент загрузки с зараженной вакцинированной
дискеты, при этом вирус с дискеты не удаляется, но пользователь все
же успеет получить сообщение о наличии вируса;

    - полное вакцинирование жесткого диска возможно лишь при наличии
свободного места между сектором MBR и загрузчиком первого раздела,
при отсутствии такового MBR не вакцинируется;

    - загрузчик ВИТАМИН-Б непереносим, поэтому если Ваш системный
диск вакцинирован и Вы предпочитаете форматировать дискеты
нестандартной программой форматирования (SF, MAXI, FDFORMAT и т.п.),
то следует использовать встроенный (internal) вариант загрузчика и
обработать вновь отформатированную дискету ВИТАМИНОМ-Б.

     Что делает собственно VITAMINB.EXE:

     При инсталляции вакцины анализируется информация в существующем
загрузчике. При обнаружении некорректного загрузчика выводится
предупреждающее сообщение (рекомендуется проверить неопознанный
загрузчик на возможное наличие вируса). Полученые сведения вместе
с адресами обработчиков некоторых прерываний сохраняются в новом
вакцинированном загрузчике. При вакцинировании жесткого диска
кроме загрузчика анализируется содержимое нулевой дорожки, и при
возможности внедрить вакцину в MBR VITAMINB просит пользователя
подтвердить необходимость внесения изменений в эту область диска.
     Программа общается с пользователем сразу на двух языках -
альтернативном русском и английском (excuse me my bad English),
причем последний использован не столько для зарубежных потреби-
телей этой программы сколько для не имеющих альтернативного
знакогенератора отечественных.

     Взаимодействие вакцины с вирусом:

     Процесс заражения вакцинированного диска бутовым вирусом
ничем не отличается от заражения обычных дисков - вирус переносит
содержимое BOOT-сектора в свободное место диска, а на место
загрузчика помещает свое тело.
     При загрузке зараженной системы первой получает управление
находящаяся в BOOT-секторе программа инсталляции вируса, при этом
будет перехвачено прерывание Int13 и,возможно, некоторые другие
прерывания. После этого считывается спрятанный вирусом BOOT-сектор
и следует нормальная загрузка ДОС, первой фазой которой будет запуск
вакцинированного загрузчика. Вакцина первым делом нейтрализует вирус,
восстанавливая важнейшие вектора прерываний. При обнаружении следов
работы вируса на экран выводится значение векторов захваченных
прерываний, после чего на экране появится предупреждающее сообщение
с предложеним о восстановлении загрузчика:

              Virus sterilized. Cure BOOT?

или MBR-сектора жесткого диска:

              Virus sterilized. Cure MBR?

     При желании провести исследование вируса пользователь может
отказаться от удаления вируса и продолжить загрузку, нажав клавишу
[n]. В этом случае и в памяти и на диске останутся безобидные копии
"стерилизованного" вируса. При загрузке с зараженной вакцинированной
дискеты на машине с жестким диском после нейтрализации вируса
блокируется доступ к "винчестеру". Для возобновления возможности
работы с жестким диском следует загрузиться с жесткого диска или
здоровой дискеты (можно с той же, если вы не отказались от
восстановления загрузчика).
     Аналогично работает вакцинированный MBR.
     Традиционный путь переноса бутовых вирусов - загрузка с рабочей
дискеты, "забытой" в дисководе А: - будет блокирован, если все ваши
дискеты будут предварительно вакцинированы "ВИТАМИНОМ-Б".

     Выводимые на экран адреса захваченных вирусом прерываний
можно использовать для идентификации вирусов:

Int08-ХХХ0:01CE
Int09-ХХХ0:010A
Int13-ХХХ0:04FA - JOSHI

Int08-ХХХ0:027B
Int13-ХХХ0:028F - DISK KILLER

Int09-ХХХ0:04D9
Int13-ХХХ0:0526 - DEN ZUK

Int13-ХХХ0:7CD0 - BALL (Italian)

Int13-ХХХ0:0276 - BRAIN/ASHAR

Int13-ХХХ0:0095 - PRINT SCREEN (Abs-1)

Int13-ХХХ0:0015 - STONED (Marijuana)

здесь ХХХ0 - обозначает сегмент вируса, который может различаться
на разных машинах в зависимости от объема доступной ДОСу памяти.

     Некоторые неприятные ситуации после вакцинирования:

    - если Вы не обратили внимание на противопоказания или
предупреждения во время запуска программы VITAMINB, то скорее
всего после вакцинирования Ваша система зависнет при первой же
загрузке. В этом случае Вам уже обязательно придется загрузиться
с дискеты и исправить загрузчик, выполнив команду SYS;

    - не исключено появление вируса вытирающего на жестком диске
занятый вакциной сектор (известные к данному моменту на это не
способны) - в этом случае система также не будет загружаться -
загрузившись с дискеты, повторно вакцинируйте жесткий диск -
при этом работоспособность диска должна восстановиться; если
и это не поможет - очистите Нортон Утилитой абсолютный(!)
сектор 11 (десят.) на 0-й стороне 0-й дорожки и повторите
вакцинирование.

     Отличия новой версии от предыдущих:

Версия 1.3:
    - исправлена появившаяся в предыдущей версии ошибка - после
вирусной атаки вакцинированный MBR не желал продолжать загрузку, ибо
хранимый в MBR адрес настоящего Int13 был смещен на 1 байт относительно
положенного места; по этой же причине на экране возникал мусор при 
выводе на экран сообщения о вирусе;
    - теперь ВИТАМИН-Б действительно работает с дисками объемом более
32 Мегабайт - объявленная в версии 1.1 возможность вакцинирования
таких дисков основывалась на моем ошибочном предположении о работе
Int25 в MS DOS 4.01 (а форматировать винчестер ради такого "пустяка"
не хотелось).

Версия 1.2:
    - исправлены две дающие "троянский эффект" ошибки предыдущей
версии - одна из них не позволяла загрузить DOS 3.30 с некоторых
(или DOS 3.21 и ниже со всех) вакцинированых жестких дисков,
другая оказалась более серъезной - при определенном стечении
обстоятельств при вакцинировании дискеты мог уничтожаться MBR-сектор
(утешает, что такое сочетание обстоятельств весьма нестандартно и
вообще невозможно при точном соблюдении приведенных выше ограничений
и противопоказаний);
    - изменен способ определения обработчика тринадцатого прерывания
в ROM BIOS, что позволило снять ограничения на версии ДОС, с которыми
может работать VITAMINB;
    - за счет некоторой оптимизации программы загрузчика появилась
возможность при загрузке контролировать еще два вектора прерываний
(пока еще не решено какие именно - буду очень благодарен, если
получу ценные предложения по этому вопросу).

Версии 1.1 и 1.11 (распространялись на конференции "ANTIVIR-90"):
    - исправлена досадная ошибка, не позволявшая инсталлирующей
программе и вакцинированным дискетам работать на компьютерах класса
ХТ (надеюсь на то, что их владельцы простят меня за те минуты
волнения, которые они получили после сообщения о бутовом вирусе в
совершенно здоровой системе);
    - отныне ВИТАМИН-Б преодолевает большинство резидентных фильтров,
препятствующих записи в системные области жесткого диска; это было
сделано не из спортивного интереса, а для исключения возможных
неприятностей при вакцинировании жесткого диска, неизбежно возникавших
в системах с драйверами ADM.SYS, HARDRIVE.SYS (и некоторыми другими);
    - вслед за MS DOS 4.01 ВИТАМИН-Б преодолел 32-мегабайтный барьер
для загружаемых дисков (имеется ввиду как размер раздела, так и его
смещение относительно начала жесткого диска);
    - для полной совместимости с MS DOS 4.01 создаваемый программой
ВИТАМИН-Б расширеный MBR теперь позволяет иметь на жестком диске
до 8-ми(!) разделов и загружаться со второго жесткого диска.

Версия 1.0 - первая распространявшаяся версия (бюллетень "Софтпанорама")


     Права распространения программы:

     VITAMINB.EXE версии 1.3 может свободно распространяться в
некоммерческих целях (желательно при этом не терять ее описание).
Если же программа понравится Вам настолько, что Вы рискнете стать
зарегистрированным пользователем (это стоит 30 рублей), то Вы
будете со временем вознаграждены получением новой версии программы
(стоимость пересылки включена в регистрационный взнос). В этом
случае Вы можете также расчитывать на получение консультаций. Автор
будет очень рад, если VITAMIN-B сможет поймать новый вирус (не
упомянутый в этом описании) - в этом случае Вы можете переслать
дискету с вирусом и бесплатно стать зарегистрированным пользователем.

Взносы, вирусы и замечания направлять по адресу:

           320130 Днепропетровск
           пер.Фестивальный 12, кв.54
           Сессе Александру Владимировичу